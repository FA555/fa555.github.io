<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>èµ›åšç¡¬å¸</title>
      <link href="/2024/cyber-coin/"/>
      <url>/2024/cyber-coin/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ç¡¬å¸ï¼Ÿ</p></blockquote><span id="more"></span><p>ä¸€ä¸ªäººç¡®å®éœ€è¦ç¡¬å¸æ¥å¸®è‡ªå·±åšå†³å®šã€‚</p><p>ä¸ä¸€å®šæ˜¯å› ä¸ºç¡¬å¸å¯ä»¥å¸®å¿™åšå‡ºé€‰æ‹©ï¼Œè€Œæ˜¯å› ä¸º<strong>åœ¨ç¡¬å¸å‡ç©ºçš„ä¸€ç¬é—´ï¼Œä½ å¸¸å¸¸å°±çŸ¥é“äº†è‡ªå·±æƒ³é€‰çš„æ˜¯å“ªä¸€ä¸ª</strong>ã€‚</p><hr><p>æœ€è¿‘æ–°æ¢äº† fishã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sleep</span> 2 &amp;&amp; math (<span class="built_in">dd</span> <span class="keyword">if</span>=/dev/random bs=1 count=1 2&gt;/dev/null | <span class="built_in">od</span> -An -vtu1) % 2</span><br></pre></td></tr></table></figure><p>æŒ‰ä¸‹ ^Cï¼Œ<strong>æŠŠè¿˜æ²¡è½åœ°çš„ç¡¬å¸ä¸€æŠŠæŠ“å›æ‰‹é‡Œ</strong>ã€‚</p><hr><p>å¦‚æœä½ åœ¨ç”¨ zsh æˆ–è€… bashï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sleep</span> 2 &amp;&amp; <span class="built_in">echo</span> $(( $(dd if=/dev/random bs=<span class="number">1</span> count=<span class="number">1</span> <span class="number">2</span>&gt;/dev/null | od -An -vtu1) % <span class="number">2</span> ))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CSAPP å¤ä¹ </title>
      <link href="/2023/CSAPP-%E5%A4%8D%E4%B9%A0/"/>
      <url>/2023/CSAPP-%E5%A4%8D%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>hexo æ¸²æŸ“è¿™ä¸ªé¡µé¢æœ‰é—®é¢˜ã€‚è¯·å‚è§ <a href="/files/html/CSAPP-review.html">csapp-review.html</a>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å‘¨è¡Œ 2022 æ–°æ˜¥ç æ‹‰æ¾éƒ¨åˆ†é¢˜è§£</title>
      <link href="/2022/ZXOJ2022Spring/"/>
      <url>/2022/ZXOJ2022Spring/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><!-- å†™è¿™ç©æ„çº¯å±æ˜¯é—²ç€æ²¡äº‹ + æƒ³è¦å¥–å“ã€‚ --><span id="more"></span><h3 id="1-4-å®Œç¾ï¼Œè¿‘ä¹å®Œç¾"><a href="#1-4-å®Œç¾ï¼Œè¿‘ä¹å®Œç¾" class="headerlink" title="1-4 å®Œç¾ï¼Œè¿‘ä¹å®Œç¾"></a><a href="http://47.102.108.97/contest/6/problem/4">1-4 å®Œç¾ï¼Œè¿‘ä¹å®Œç¾</a></h3><h4 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ªå¤§å°ä¸º $n \ (2 \le n \le 2 \times 10^5)$ çš„å¯é‡é›†åˆï¼Œè¯¢é—®åˆ å»é›†åˆä¸­çš„å“ªäº›å…ƒç´ åï¼Œé›†åˆä¸­å­˜åœ¨ä¸€ä¸ªå…ƒç´ ç­‰äºå…¶ä½™æ‰€æœ‰å…ƒç´ çš„å’Œã€‚é›†åˆä¸­å…ƒç´ æœ‰å€¼åŸŸ $[1, 10^6]$ã€‚</p><h4 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h4><p>é›†åˆä¸­å­˜åœ¨ä¸€ä¸ªå…ƒç´ ç­‰äºå…¶ä»–å…ƒç´ çš„å’Œï¼Œå½“ä¸”ä»…å½“è¯¥å…ƒç´ çš„å¤§å°ç­‰äºé›†åˆä¸­æ‰€æœ‰å…ƒç´ çš„å’Œçš„ $\dfrac 12$ã€‚äºæ˜¯å¯ä»¥å¤„ç†å‡º</p><ol><li>é›†åˆä¸­æ‰€æœ‰å…ƒç´ çš„å’Œ $s$ï¼›</li><li>å€¼åŸŸä¸­æ¯ä¸ªæ•°å­—åœ¨é›†åˆä¸­å‡ºç°çš„æ¬¡æ•°å’Œä½ç½®ã€‚</li></ol><p>æšä¸¾æ¯ä¸ªå…ƒç´  $x$ï¼Œåˆ¤æ–­åˆ å»è¯¥å…ƒç´ åæ˜¯å¦ä»å­˜åœ¨æŸä¸ªå…ƒç´ ç­‰äº $s - x$ å³å¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ $O(n)$ã€‚</p><h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><p>æ³¨æ„éœ€è¦ C++17ã€‚</p><p><code>s: int64</code>  å³å‰è¿°çš„ $s$ï¼Œ<code>v[i]: std::vector&lt;int&gt;</code> è®°å½• $i$ å‡ºç°çš„æ‰€æœ‰ä½ç½®ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> z[<span class="number">200003</span>];</span><br><span class="line">std::vector&lt;<span class="keyword">int</span>&gt; ans, v[<span class="number">1000003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N;</span><br><span class="line">  <span class="keyword">int64_t</span> s = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  std::cin &gt;&gt; N;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    std::cin &gt;&gt; z[i];</span><br><span class="line">    s += z[i];</span><br><span class="line">    <span class="comment">// è¿™é‡Œåˆ¤ä¸€ä¸‹ if (v[z[i]].size &gt; 1) åˆ™ä¸ push ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ²¡å¿…è¦</span></span><br><span class="line">    v[z[i]].<span class="built_in">emplace_back</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">int64_t</span> x = s - z[i]; x &lt;= <span class="number">2000000</span> &amp;&amp; x % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">      <span class="keyword">if</span> (v[x / <span class="number">2</span>].<span class="built_in">size</span>() &gt; <span class="number">1</span> || (v[x / <span class="number">2</span>].<span class="built_in">size</span>() == <span class="number">1</span> &amp;&amp; v[x / <span class="number">2</span>][<span class="number">0</span>] != i))</span><br><span class="line">        ans.<span class="built_in">emplace_back</span>(i);</span><br><span class="line"></span><br><span class="line">  std::cout &lt;&lt; ans.<span class="built_in">size</span>() &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (ans.<span class="built_in">size</span>())</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x : ans)</span><br><span class="line">      std::cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="1-5-å›æ–‡ï¼Œæ’ç‰ˆé”™è¯¯"><a href="#1-5-å›æ–‡ï¼Œæ’ç‰ˆé”™è¯¯" class="headerlink" title="1-5 å›æ–‡ï¼Œæ’ç‰ˆé”™è¯¯"></a><a href="http://47.102.108.97/contest/6/problem/5">1-5 å›æ–‡ï¼Œæ’ç‰ˆé”™è¯¯</a></h3><h4 id="problem-1"><a href="#problem-1" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®š $n \ (1 \le n \le 100)$ ä¸ªé•¿åº¦å‡ä¸º $m \ (1 \le m \le 50)$ çš„å­—ç¬¦ä¸² $s_i$ã€‚åˆ¤æ–­è¿™äº›å­—ç¬¦ä¸²æ‹¼æ¥è€Œæˆçš„æœ€é•¿çš„å›æ–‡ä¸² $P$ çš„é•¿åº¦ã€‚å­—ç¬¦é›†å°å†™æ‹‰ä¸å­—æ¯ã€‚å­—ç¬¦ä¸²ä¸èƒ½é‡å¤ä½¿ç”¨ã€‚</p><h4 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h4><p>æ‰€æœ‰å­—ç¬¦ä¸²é•¿åº¦éƒ½ç›¸ç­‰å®åœ¨æ˜¯å¾ˆå¼ºçš„çº¦æŸæ¡ä»¶ï¼Œä¸ç„¶è¿™é¢˜å°±å¤ªæ¯’äº†ã€‚</p><p>è€ƒè™‘ä¸€ä¸ªå­—ç¬¦ä¸² $s$ èƒ½å¤Ÿå‚ä¸æ‹¼æ¥è¿› $P$ï¼Œå½“ä¸”ä»…å½“ $s$</p><ol><li><p>æœ¬èº«æ˜¯å›æ–‡ä¸²ï¼Œæˆ–</p></li><li><p>ç»™å®šäº†å¦ä¸€ä¸ªå­—ç¬¦ä¸² $t$ ä½¿å¾— $s + t$ æ˜¯å›æ–‡ä¸²ï¼ˆæ­¤å¤„ $+$ è¡¨ç¤ºå­—ç¬¦ä¸²çš„æ‹¼æ¥æ“ä½œï¼Œæ˜¾ç„¶è¿™æ—¶ $t + s$ ä¹Ÿæ˜¯å›æ–‡ä¸²ï¼‰</p></li></ol><p>æ»¡è¶³æ€§è´¨ 1 çš„ä¸² $s$ å¯ä»¥ç½®äº $P$ çš„ä¸­å¿ƒï¼Œè€Œæ»¡è¶³æ€§è´¨ 2 çš„ä¸² $s, t$ å¯ä»¥å¯¹ç§°åœ°ç½®äº $P$ ä¸­å¿ƒçš„ä¸¤ä¾§ã€‚ä¸ºäº†æœ€å¤§åŒ– $|P|$ï¼Œå½“ä¸€ä¸ªä¸² $s$ åŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ€§è´¨æ—¶ï¼Œä¼˜å…ˆæŒ‰ç…§æ€§è´¨ 2 å‚ä¸æ‹¼æ¥ã€‚å¹¶ä¸”å¯ä»¥å‘ç°ï¼Œè‡³å¤šåªèƒ½æœ‰ä¸€ä¸ªåªæ»¡è¶³æ€§è´¨ 1 çš„ä¸²å‚ä¸æ„é€  $P$ã€‚</p><p>äºæ˜¯å¯ä»¥é¢„å¤„ç†å‡ºæ¯ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ»¡è¶³ä»¥ä¸Šä¸¤ä¸ªæ€§è´¨ï¼Œå¹¶æ®æ­¤æ„é€  $P$ï¼Œå®ç°ç»†èŠ‚è§ä»£ç ã€‚æ€»å¤æ‚åº¦ $O(n^2 m)$ã€‚</p><h4 id="code-1"><a href="#code-1" class="headerlink" title="code"></a>code</h4><p>æ³¨æ„éœ€è¦ C++11ã€‚</p><p><code>v1[i]: bool</code> å³å­—ç¬¦ä¸² $s_i$ æ»¡è¶³æ€§è´¨ 1 ä¸å¦ï¼›<code>v2[i]</code> ä¸­çš„æ‰€æœ‰å…ƒç´  $x$ è¡¨ç¤º $s_i, s_x$ æ»¡è¶³æ€§è´¨ 2ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isPalin</span><span class="params">(<span class="keyword">const</span> std::string &amp;s)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * Returns if $s is a palindrome</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function">std::string <span class="title">t</span><span class="params">(s)</span></span>;</span><br><span class="line">  std::<span class="built_in">reverse</span>(t.<span class="built_in">begin</span>(), t.<span class="built_in">end</span>());</span><br><span class="line">  <span class="keyword">return</span> t == s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::string s[<span class="number">103</span>];</span><br><span class="line">std::vector&lt;<span class="keyword">int</span>&gt; v2[<span class="number">103</span>];</span><br><span class="line"><span class="keyword">bool</span> v1[<span class="number">103</span>], used[<span class="number">103</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line">  std::cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    std::cin &gt;&gt; s[i];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    v1[i] = <span class="built_in">isPalin</span>(s[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= N; ++j)</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">isPalin</span>(s[i] + s[j])) &#123;</span><br><span class="line">        v2[i].<span class="built_in">emplace_back</span>(j);</span><br><span class="line">        v2[j].<span class="built_in">emplace_back</span>(i);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  std::string ans1, ans2;</span><br><span class="line">  <span class="comment">// æ€§è´¨ 2</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    <span class="keyword">if</span> (v2[i].<span class="built_in">size</span>())</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> j : v2[i])</span><br><span class="line">        <span class="keyword">if</span> (!used[j]) &#123;</span><br><span class="line">          ans1 += s[i];</span><br><span class="line">          ans2 = s[j] + ans2;</span><br><span class="line">          used[i] = used[j] = <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">  <span class="comment">// æ€§è´¨ 1</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    <span class="keyword">if</span> (v1[i] &amp;&amp; !used[i]) &#123;</span><br><span class="line">      ans1 += s[i];</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  std::string ans = ans1 + ans2;</span><br><span class="line">  std::cout &lt;&lt; ans.<span class="built_in">size</span>() &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (ans.<span class="built_in">size</span>())</span><br><span class="line">    std::cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="1-9-ççœ¼ï¼Œä¾¿æ˜¯ç»ˆå±€-amp-2-7-ççœ¼ï¼Œä¾¿æ˜¯ç»ˆå±€"><a href="#1-9-ççœ¼ï¼Œä¾¿æ˜¯ç»ˆå±€-amp-2-7-ççœ¼ï¼Œä¾¿æ˜¯ç»ˆå±€" class="headerlink" title="1-9 ççœ¼ï¼Œä¾¿æ˜¯ç»ˆå±€ &amp; 2-7 ççœ¼ï¼Œä¾¿æ˜¯ç»ˆå±€"></a><a href="http://47.102.108.97/contest/6/problem/9">1-9 ççœ¼ï¼Œä¾¿æ˜¯ç»ˆå±€</a> &amp; <a href="http://47.102.108.97/contest/7/problem/7">2-7 ççœ¼ï¼Œä¾¿æ˜¯ç»ˆå±€</a></h3><h4 id="problem-2"><a href="#problem-2" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šé•¿ä¸º $n$ çš„æ•°åˆ— $\{ a_i \} \ (1 \le a_i \le 10^9)$ï¼Œåœ¨å…¶ä¸­é€‰ä¸­ $x$ ä¸ªæ•°å­—ï¼Œä¸”è¿ç»­ $k$ ä¸ªæ•°å­—ä¸­è‡³å°‘æœ‰ä¸€ä¸ªè¢«é€‰ä¸­ï¼Œæœ€å¤§åŒ–é€‰ä¸­çš„æ‰€æœ‰æ•°å­—çš„å’Œã€‚</p><p>Constraint of Easy Version(1-9): $1 \le k, x, n \le 200$â€‹ï¼›</p><p>Constraint of Hard Version(2-7): $1 \le k, x, n \le 5000$ï¼›</p><h4 id="solution-for-Easy-Version"><a href="#solution-for-Easy-Version" class="headerlink" title="solution for Easy Version"></a>solution for Easy Version</h4><p>ç»å…¸ dpï¼ˆ</p><p>è®¾ $f_{i, j}$ è¡¨ç¤ºå‰ $i$ ä¸ªæ•°å­—ä¸­é€‰ä¸­äº† $j$ ä¸ªæ•°å­—ï¼Œä¸”ç¬¬ $i$ ä¸ªæ•°å­—è¢«é€‰ä¸­çš„ç­”æ¡ˆã€‚æœ‰æ˜¾ç„¶çš„è½¬ç§»ï¼š</p><script type="math/tex; mode=display">f_{i, j} = \max_{k' = i - k + 1}^{i - 1}{f_{k', j - 1} + a_i}</script><p>è¾¹ç•Œæ¡ä»¶ $f_{i, j} = - \infty, f_{0, 0} = 0$ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ $O(nxk)$ï¼›ç©ºé—´å¤æ‚åº¦ $O(nx)$ï¼Œå¯ä»¥å‹ä¸€ç»´åˆ° $O(n)$ï¼Œä¸è¿‡æ²¡å¿…è¦ï¼Œæ¯•ç«Ÿæ—¶é—´å¤æ‚åº¦æ‘†åœ¨é‚£ã€‚</p><h4 id="code-for-Easy-Version"><a href="#code-for-Easy-Version" class="headerlink" title="code for Easy Version"></a>code for Easy Version</h4><p><code>f[i][j]</code> å³å‰è¿°çš„ $f_{i, j}$ã€‚è¿™é‡Œç”¨äº† $-1$ æ ‡è®° $-\infty$ï¼Œè¿™æ ·æ°å¥½æŠŠæ— è§£è¾“å‡º <code>-1</code> å¤„ç†æ‰äº†ï¼Œä¸ç”¨å•ç‹¬å†åˆ¤ã€‚æ³¨æ„ä¸€ä¸‹å†™æ³•é—®é¢˜åˆ«è¶Šç•Œã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> z[<span class="number">203</span>];</span><br><span class="line"><span class="keyword">int64_t</span> f[<span class="number">203</span>][<span class="number">203</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N, K, X;</span><br><span class="line"></span><br><span class="line">  std::cin &gt;&gt; N &gt;&gt; K &gt;&gt; X;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    std::cin &gt;&gt; z[i];</span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="keyword">sizeof</span> f);</span><br><span class="line">  f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; ++j) <span class="comment">// è¿™é‡Œ j &lt;= min(i, X) å°±å¯ä»¥</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> k = i - <span class="number">1</span>; k &gt;= std::<span class="built_in">max</span>(<span class="number">0</span>, i - K); --k) <span class="comment">// è¿™é‡Œæ­£ç€æˆ–åç€æšä¸¾æ˜¯æ— æ‰€è°“çš„</span></span><br><span class="line">        <span class="keyword">if</span> (f[k][j - <span class="number">1</span>] != <span class="number">-1</span>)</span><br><span class="line">          f[i][j] = std::<span class="built_in">max</span>(f[i][j], f[k][j - <span class="number">1</span>] + z[i]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int64_t</span> ans = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = N - K + <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    ans = std::<span class="built_in">max</span>(ans, f[i][X]);</span><br><span class="line">  std::cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="solution-for-Hard-Version"><a href="#solution-for-Hard-Version" class="headerlink" title="solution for Hard Version"></a>solution for Hard Version</h4><p>æˆ‘è¿™ä¸ªçŠ¶æ€æ•°åªæœ‰ $O(nx)$ ä¸ªå•Šï¼Œå¹²å•¥è¦ $O(nxk)$ çš„å¤æ‚åº¦å‘¢ï¼Ÿ</p><p>å¦‚æœå›ºå®šä¸€ä¸ª $j$ï¼Œæšä¸¾æ¯ä¸ª $i$ï¼Œå°±ä¼šå‘ç°æšä¸¾è½¬ç§»çš„æ—¶å€™å†…å±‚çš„ä¸¤ç»´ï¼ˆå¯¹äºæ¯ä¸ª $i$ æšä¸¾ $kâ€™$ æ±‚ $\max f_{kâ€™, j - 1}$ï¼‰å’Œ $i$ æ— å…³ï¼Œéå¸¸çš„æ»‘åŠ¨çª—å£ï¼Œäºæ˜¯å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–è½¬ç§»ï¼Œæ—¶é—´å¤æ‚åº¦é™åˆ°äº† $O(nx)$ã€‚</p><p>ç©ºé—´ä¹Ÿå¯ä»¥å‹åˆ° $O(n)$ï¼Œä½†æ˜¯åŒä¸Šæ²¡æœ‰å¿…è¦ã€‚</p><p>å‚è€ƒé¢˜ç›®ï¼š<a href="https://www.luogu.com.cn/problem/P1886">æ´›è°· P1886 æ»‘åŠ¨çª—å£ /ã€æ¨¡æ¿ã€‘å•è°ƒé˜Ÿåˆ—</a></p><h4 id="code-for-Hard-Version"><a href="#code-for-Hard-Version" class="headerlink" title="code for Hard Version"></a>code for Hard Version</h4><p><code>f[i][j]</code> å³å‰è¿°çš„ $f_{j, i}$ã€‚æ³¨æ„ä¸¤ç»´åœ¨æ€è€ƒä¼˜åŒ–çš„è¿‡ç¨‹ä¸­åè¿‡æ¥äº†ï¼Œäºæ˜¯ä»£ç é‡Œé¡ºæ‰‹ä¹Ÿåè¿‡æ¥å†™äº†ã€‚</p><p>è¿™é‡Œç”¨äº† $-1$ æ ‡è®° $-\infty$ï¼Œè¿™æ ·æ°å¥½æŠŠæ— è§£è¾“å‡º <code>-1</code> å¤„ç†æ‰äº†ï¼Œä¸ç”¨å•ç‹¬å†åˆ¤ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> z[<span class="number">5003</span>];</span><br><span class="line"><span class="keyword">int64_t</span> f[<span class="number">5003</span>][<span class="number">5003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N, K, X;</span><br><span class="line"></span><br><span class="line">  std::cin &gt;&gt; N &gt;&gt; K &gt;&gt; X;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    std::cin &gt;&gt; z[i];</span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="keyword">sizeof</span> f);</span><br><span class="line">  f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= X; ++j) &#123;</span><br><span class="line">    std::deque&lt;std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int64_t</span>&gt;&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, now = std::<span class="built_in">max</span>(<span class="number">0</span>, i - K); i &lt;= N; ++i) &#123;</span><br><span class="line">      <span class="comment">// k \in [max(0, i - K), i - 1]</span></span><br><span class="line">      <span class="keyword">while</span> (q.<span class="built_in">size</span>() &amp;&amp; q.<span class="built_in">front</span>().first &lt; i - K)</span><br><span class="line">        q.<span class="built_in">pop_front</span>();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (; now &lt; i; ++now)</span><br><span class="line">        <span class="keyword">if</span> (f[j - <span class="number">1</span>][now] != <span class="number">-1</span>) &#123;</span><br><span class="line">          <span class="keyword">while</span> (q.<span class="built_in">size</span>() &amp;&amp; q.<span class="built_in">back</span>().second &lt;= f[j - <span class="number">1</span>][now])</span><br><span class="line">            q.<span class="built_in">pop_back</span>();</span><br><span class="line">          q.<span class="built_in">push_back</span>(&#123;now, f[j - <span class="number">1</span>][now]&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (q.<span class="built_in">size</span>())</span><br><span class="line">        f[j][i] = std::<span class="built_in">max</span>(f[j][i], q.<span class="built_in">front</span>().second + z[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  std::cout &lt;&lt; *std::<span class="built_in">max_element</span>(f[X] + N - K + <span class="number">1</span>, f[X] + N + <span class="number">1</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="1-10-å°¾å£°ï¼ŒæŠ‘æˆ–å¼€å§‹-amp-2-8-æ®‹é¡µï¼Œå°å­˜å¾€äº‹"><a href="#1-10-å°¾å£°ï¼ŒæŠ‘æˆ–å¼€å§‹-amp-2-8-æ®‹é¡µï¼Œå°å­˜å¾€äº‹" class="headerlink" title="1-10 å°¾å£°ï¼ŒæŠ‘æˆ–å¼€å§‹ &amp; 2-8 æ®‹é¡µï¼Œå°å­˜å¾€äº‹"></a><a href="http://47.102.108.97/contest/6/problem/10">1-10 å°¾å£°ï¼ŒæŠ‘æˆ–å¼€å§‹</a> &amp; <a href="http://47.102.108.97/contest/7/problem/8">2-8 æ®‹é¡µï¼Œå°å­˜å¾€äº‹</a></h3><h4 id="problem-3"><a href="#problem-3" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ªé•¿ä¸º $n \ (1 \le n \le 2 \times 10^5)$ çš„åºåˆ— $\{ a_i \} \ (1 \le a_i \le 2 \times 10^5)$ å’Œä¸€ä¸ªå€¼ $m \ (1 \le m \le 2 \times 10^5)$ã€‚è¯¢é—®åºåˆ—ä¸­æœ‰å¤šå°‘å­åºåˆ—ï¼ˆè¿ç»­ï¼‰çš„<strong>ä¸­ä½æ•°</strong>æ˜¯ $m$ã€‚</p><p>æ­¤å¤„<strong>ä¸­ä½æ•°</strong>çš„å®šä¹‰å’Œæ•°å­¦ä¸Šç•¥æœ‰ä¸åŒã€‚åŒºåˆ«åœ¨äºå¯¹äºé•¿åº¦ä¸ºå¶æ•° $2k$ çš„å­åºåˆ—ï¼Œå®šä¹‰ä¸­ä½æ•°ä¸ºç¬¬ $k$ å°çš„æ•°ã€‚ä¾‹å¦‚åºåˆ— $[1, 1, 4, 5, 1, 4]$ çš„ä¸­ä½æ•°ä¸ºç¬¬ $3$ å°çš„ $1$ï¼Œè€Œéæ•°å­¦ä¸Šçš„ $\dfrac{1 + 4}2 = \dfrac 52$ã€‚</p><p>Extra Constraint for Easy Version: ä¿è¯åºåˆ— $\{ a_i \}$ ä¸ºæ•´æ•° $1 \sim n$ çš„ä¸€ä¸ªæ’åˆ—ã€‚</p><h4 id="solution-for-Easy-Version-1"><a href="#solution-for-Easy-Version-1" class="headerlink" title="solution for Easy Version"></a>solution for Easy Version</h4><p>æ„Ÿæ€§ç†è§£ä¸€ä¸‹å°±ä¼šå‘ç°ï¼Œæˆ‘ä»¬å…¶å®åªéœ€è¦æ¯ä¸ªæ•°ä¹‹é—´çš„ååºå…³ç³»ï¼Œè€Œä¸éœ€è¦å®ƒä»¬å…·ä½“çš„å€¼ã€‚</p><p>Easy Version ä¿è¯äº†åºåˆ—æ˜¯ä¸€ä¸ªæ’åˆ—ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰çš„å€¼éƒ½æ˜¯ä¸¤ä¸¤ä¸åŒçš„ã€‚è¿™æ—¶æˆ‘ä»¬å¯ä»¥å¥—è·¯æ€§åœ°å°†åŸæ’åˆ—ä¸­å°äº $m$ çš„æ•°ã€$m$ã€å¤§äº $m$ çš„æ•°åˆ†åˆ«é‡æ–°æ˜ å°„ä¸º $-1, 0, 1$ã€‚ç„¶åä»åŸæ’åˆ—çš„ $m$ çš„ä½ç½®å¼€å§‹ï¼Œå‘å·¦åšåç¼€å’Œï¼Œå¹¶è®°å½•æ¯ä¸ªåç¼€å’Œ $s$ å‡ºç°çš„æ¬¡æ•° $c_s$ã€‚ç„¶åå†å‘å³åšå‰ç¼€å’Œï¼Œè¿™æ ·ï¼Œå½“æšä¸¾åˆ°ä¸‹æ ‡ $i$ æ—¶ï¼Œå‰ç¼€å’Œä¸º $s$ æ—¶ï¼Œ$c_{-s}$ å’Œ $c_{1 - s}$ å³ä¸ºä»¥ä½ç½® $i$ ä¸ºå³ç«¯ç‚¹çš„ç¬¦åˆæ¡ä»¶çš„åŒºé—´çš„ä¸ªæ•°ï¼Œä¸”ä¸¤è€…åˆ†åˆ«ä¸ºåŒºé—´é•¿åº¦ä¸ºå¥‡æ•°ã€å¶æ•°æ—¶çš„ä¸ªæ•°ã€‚</p><p>è¿™ä¸ªåšæ³•éå¸¸å®¹æ˜“æƒ³ï¼Œä½†æ˜¯åªçœ‹æ–‡å­—æè¿°æ˜¯å¾ˆéš¾ä»¥ç†è§£çš„ã€‚è¿™é‡Œä»¥æ ·ä¾‹ 1 çš„ reverse (maybe it should be called reversal?) ä½œä¸º<strong>ä¾‹å­</strong>ï¼š</p><ul><li>æˆ‘ä»¬æœ‰ $1 \sim 5$ çš„ä¸€ä¸ªæ’åˆ— $[1, 3, 5, 4, 2]$ã€‚</li><li>ä» $m = 4$ æ‰€åœ¨çš„ä¸‹æ ‡ $4$ å‘å·¦åšåç¼€å’Œï¼Œå¾—åˆ° $[-1, 0, 1, 0, \mathrm{NaN}]$ã€‚</li><li>äºæ˜¯æˆ‘ä»¬å¾—åˆ° $c_{-1} = 1, c_0 = 2, c_1 = 1$ï¼Œå¯¹äºå…¶ä½™çš„ $s$ å€¼ï¼Œ$c_s$ å‡ä¸º $0$ã€‚</li><li>æ¥ç€æˆ‘ä»¬ä»ä¸‹æ ‡ $4$ å‘å³åšå‰ç¼€å’Œã€‚åœ¨ä¸‹æ ‡ $4$ å¤„ $s = 0$ï¼Œæ­¤æ—¶ $c_{-s} = c_0= 2, c_{1 - s} = c_1 = 1$ã€‚åœ¨ä¸‹æ ‡ $5$ å¤„ $s = -1$ï¼Œæ­¤æ—¶ $c_{-s} = c_1 = 1, c_{1 - s} = c_2 = 0$ã€‚</li><li>æŠŠä¸Šè¿°æåˆ°çš„å€¼å…¨éƒ¨ç›¸åŠ å¾—åˆ°ç­”æ¡ˆ $4$ã€‚ï¼ˆæ„Ÿæ€§ç†è§£ä¸€ä¸‹æ ·ä¾‹ 1 çš„ reverse å’Œæ ·ä¾‹ 1 çš„ç­”æ¡ˆè‚¯å®šæ˜¯ç›¸åŒçš„ï¼‰</li></ul><p>æ—¶ç©ºå¤æ‚åº¦å‡ä¸º $O(n)$ã€‚</p><h4 id="code-for-Easy-Version-1"><a href="#code-for-Easy-Version-1" class="headerlink" title="code for Easy Version"></a>code for Easy Version</h4><p>å˜é‡åå’Œä¸Šè¿°é™¤å¤§å°å†™å¤–å®Œå…¨ç›¸åŒã€‚</p><p>è¿™é‡Œç”¨äº†å¾ˆéªšçš„å†™æ³•ï¼Œç»™ä¸‹æ ‡ä¼ äº†è´Ÿæ•°ã€‚æ³¨æ„å®é™…ä¸Š <code>c</code> æ˜¯ <code>int *</code> è€Œä¸æ˜¯ <code>int[]</code>ï¼Œ<code>c[-s]</code> ç›¸å½“äº <code>*(c + (-s))</code>ï¼Œåªè¦æ²¡æœ‰å‘ç”Ÿè¶Šç•Œå°±æ²¡æœ‰é—®é¢˜ã€‚<strong>å‘æ•°ç»„åçš„ <code>operator[]</code> ä¸­ä¼ é€’è´Ÿä¸‹æ ‡æ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> z[<span class="number">200003</span>], c_[<span class="number">400007</span>], *c = c_ + <span class="number">200003</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N, M, p = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  std::cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x; i &lt;= N; ++i) &#123;</span><br><span class="line">    std::cin &gt;&gt; x;</span><br><span class="line">    <span class="keyword">if</span> (x == M) p = i;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (x &lt; M) z[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">else</span> z[i] = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = p, s = <span class="number">0</span>; i; --i) &#123;</span><br><span class="line">    s += z[i];</span><br><span class="line">    ++c[s];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int64_t</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = p, s = <span class="number">0</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    s += z[i];</span><br><span class="line">    ans += c[-s];</span><br><span class="line">    ans += c[<span class="number">1</span> - s];</span><br><span class="line">  &#125;</span><br><span class="line">  std::cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="solution-for-Hard-Version-1"><a href="#solution-for-Hard-Version-1" class="headerlink" title="solution for Hard Version"></a>solution for Hard Version</h4><p>å¾ˆä¸å¹¸ï¼Œå¦‚æœæŒ‰ç…§ä¸Šé¢çš„æ€è€ƒæ–¹æ³•ï¼Œé‚£ä¹ˆè¿™é¢˜çš„ Hard Version å°†ä¼šå˜å¾—éå¸¸éš¾æƒ³ã€‚</p><p><em>é¦–å…ˆæä¸€ä¸‹ Easy Version çš„ä¸Šè¿°åšæ³•åœ¨è¿™é‡Œæ˜¯é”™çš„ï¼šå…¶ä¸€ï¼ŒHard version å¯èƒ½å­˜åœ¨ä¸æ­¢ä¸€ä¸ª $m$ï¼Œå› æ­¤ä¸Šè¿°åšæ³•å˜å¾—éš¾ä»¥æ‰©å±•ï¼›å…¶äºŒï¼Œå³ä½¿å¼ºè¡Œæ‰¾åˆ°æ–¹æ³• $O(n)$ åœ°æ‰©å±•ï¼Œå…¶èµ–ä»¥æ­£ç¡®çš„çº¦æŸæ¡ä»¶ã€Œ$\{a_n\}$ ä¸­çš„æ¯ä¸¤ä¸ªæ•°éƒ½å­˜åœ¨ä¸¥æ ¼çš„ååºå…³ç³»ã€ ä¸æˆç«‹ï¼Œå®ƒçš„æ­£ç¡®æ€§ä¼šå‡ºé—®é¢˜ã€‚è¿™é‡Œä¸ä½œæ›´å¤šè¯´æ˜ã€‚</em></p><p>Hard Version ç”¨åˆ°äº†å¦ä¸€ä¸ªæ€æƒ³ï¼šæŠŠæ±‚å€¼è½¬åŒ–ä¸ºæ±‚å‰ç¼€å’Œçš„å·®åˆ†ã€‚è¿™å¥è¯çœ‹èµ·æ¥éå¸¸çš„è ¢ï¼Œä½†æ˜¯æˆ‘ä»¬å°è¯•æŠŠå®ƒåº”ç”¨åˆ°è¿™é“é¢˜ä¸Šã€‚</p><p>æ±‚ä¸­ä½æ•°ç­‰äº $m$ çš„åŒºé—´ä¸ªæ•°ï¼Œå³æ±‚<strong>ä¸­ä½æ•°å¤§äºç­‰äº $m$ çš„åŒºé—´ä¸ªæ•°</strong>ï¼Œå‡å»<strong>ä¸­ä½æ•°å¤§äº $m$ çš„åŒºé—´ä¸ªæ•°</strong>ã€‚ç”±äº $\{ a_n \}$ åŠå…¶æ‰€æœ‰å­åŒºé—´çš„ä¸­ä½æ•°åªæœ‰æ•´æ•°ï¼Œåè€…ç­‰ä»·äºä¸­ä½æ•°å¤§äºç­‰äº $m + 1$ çš„åŒºé—´ä¸ªæ•°ã€‚</p><p>ç°åœ¨é—®é¢˜è½¬åŒ–ä¸ºäº†å¦‚ä½•æ±‚<strong>ä¸­ä½æ•°å¤§äºç­‰äº $m$ çš„åŒºé—´ä¸ªæ•°</strong>ã€‚å¯¹äºä¸€ä¸ªåŒºé—´ï¼Œæˆ‘ä»¬è®¾å…¶ä¸­å°äº $m$ çš„æ•°ã€$m$ã€å¤§äº $m$ çš„æ•°åˆ†åˆ«æœ‰ $x, y, z$ ä¸ªï¼Œåˆ™è¯¥åŒºé—´çš„ä¸­ä½æ•°å¤§äºç­‰äº $m$ ç­‰ä»·äº $x &lt; y + z$ã€‚è¿™ä¸ªå¯ä»¥é€šè¿‡å¤§åŠ›åˆ†ç±»è®¨è®º $x, y, z$ çš„å€¼å…³ç³»å¾—åˆ°ï¼Œæ­¤å¤„ç•¥å»ä¸è¡¨ã€‚</p><p>æˆ‘ä»¬åŒæ ·æŠŠå°äº $m$ çš„æ•°ã€å¤§äºç­‰äº $m$ çš„æ•°åˆ†åˆ«è®°ä½œ $-1, 1$ï¼ŒåŒæ—¶ç»Ÿè®¡æ­¤æ„ä¹‰ä¸‹å‰ $i$ ä¸ªæ•°çš„å‰ç¼€å’Œ $s$ã€æ¯ä¸ªå‰ç¼€å’Œ $s_0$ å‡ºç°çš„æ¬¡æ•° $c_{s_0}$ ä»¥åŠ $c_{[0, s)}$ çš„å‰ç¼€å’Œ $ss$ã€‚æ³¨æ„ $ss$ çš„æ„ä¹‰éšç€ $s$â€‹ å€¼çš„æ”¹å˜è€Œæ”¹å˜ã€‚</p><p>å¯¹äºæšä¸¾è¿‡ç¨‹ä¸­æ¯ä¸€ä¸ª $s$ çš„å–å€¼ï¼Œå¯ä»¥å°†å…¶çœ‹ä½œå‰ä¸€æ®µæåˆ°çš„ $y + z$ çš„å€¼ï¼Œæ­¤æ—¶ $ss$ çš„å€¼å³ä¸ºæ»¡è¶³ $x &lt; y + z$ çš„ $x$ çš„ä¸ªæ•°ã€‚ç±»ä¼¼äº Easy Version é‡Œå¯¹æ¯ä¸ª $c_{-s} + c_{1 - s}$ æ±‚å’Œçš„æƒ³æ³•ï¼Œæˆ‘ä»¬å¯¹æ‰€æœ‰çš„ $ss$ æ±‚å’Œï¼Œå³å¯å¾—åˆ°ç­”æ¡ˆã€‚</p><p>ç»Ÿè®¡ $ss$ æ—¢å¯ä»¥åƒä¸‹è¿°ä»£ç é‡Œä¸€æ ·å•æ¬¡ $O(1)$ åœ°åŠ¨æ€ç»Ÿè®¡ï¼Œä¹Ÿå¯ä»¥å†™ä¸ªæ•°æ®ç»“æ„å•æ¬¡ $O( \log k)$ åœ°ç»Ÿè®¡ã€‚æ€»å¤æ‚åº¦ $O(n)$ æˆ– $O(n \log k)$ã€‚å…¶ä¸­ $k$ ä¸º $a_i$ çš„å€¼åŸŸã€‚</p><h4 id="code-for-Hard-Version-1"><a href="#code-for-Hard-Version-1" class="headerlink" title="code for Hard Version"></a>code for Hard Version</h4><p>å˜é‡åå’Œä¸Šè¿°é™¤å¤§å°å†™å¤–å®Œå…¨ç›¸åŒã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> z[<span class="number">200003</span>], c_[<span class="number">400007</span>], *c = c_ + <span class="number">200003</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int64_t</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> M)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * Returns the number of subsequences(continuous) with a median of ge M</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">bool</span> g = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (g) <span class="built_in">memset</span>(c_, <span class="number">0</span>, <span class="keyword">sizeof</span> c_);</span><br><span class="line">  g = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ss: sum of c[0..s)</span></span><br><span class="line">  <span class="keyword">int64_t</span> ss = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">  ++c[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, s = <span class="number">0</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="comment">// ä¸‹é¢è¿™ä¸¤è¡Œå¤ªæœ‰æ„Ÿè§‰äº†ï¼Œç®€ç›´é’å›ï¼ˆ</span></span><br><span class="line">    <span class="keyword">if</span> (z[i] &lt; M) ss -= c[--s];</span><br><span class="line">    <span class="keyword">else</span> ss += c[s++];</span><br><span class="line">    ans += ss;</span><br><span class="line">    ++c[s];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line">  std::cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    std::cin &gt;&gt; z[i];</span><br><span class="line"></span><br><span class="line">  std::cout &lt;&lt; <span class="built_in">solve</span>(N, M) - <span class="built_in">solve</span>(N, M + <span class="number">1</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="2-9-çŒæ‰‹ï¼ŒæŠ‘æˆ–çŒç‰©"><a href="#2-9-çŒæ‰‹ï¼ŒæŠ‘æˆ–çŒç‰©" class="headerlink" title="2-9 çŒæ‰‹ï¼ŒæŠ‘æˆ–çŒç‰©"></a><a href="http://47.102.108.97/contest/7/problem/9">2-9 çŒæ‰‹ï¼ŒæŠ‘æˆ–çŒç‰©</a></h3><h4 id="problem-4"><a href="#problem-4" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ª $n \times m \ (3 \le n \times m \le 10^6)$ çš„è¿·å®«ï¼Œæœ‰äº›ä½ç½®å¯ä»¥é€šè¿‡ï¼Œæœ‰äº›ä¸èƒ½ã€‚ä½ å¯ä»¥å°†ä¸€äº›å¯ä»¥é€šè¿‡çš„ä½ç½®æ”¹å˜ä¸ºä¸èƒ½é€šè¿‡ã€‚æ±‚æœ€å°‘æ”¹å˜å¤šå°‘ä¸ªä½ç½®çš„æ€§è´¨ï¼Œä½¿å¾—ä¸å­˜åœ¨ä» $(1, 1)$ é€šå‘ $(n, m)$ çš„è·¯å¾„ã€‚ç§»åŠ¨åªèƒ½å‘å³æˆ–å‘ä¸‹ã€‚</p><h4 id="solution-2"><a href="#solution-2" class="headerlink" title="solution"></a>solution</h4><p>å—·è¿™é¢˜æ˜¯éå¸¸çš„é‡é‡çº§ï¼Œä¸€çœ¼çœ‹åˆ°è¿™é¢˜ä»¥ä¸ºè¦å»º $O(nm)$ ä¸ªç‚¹å’Œ $O(nm)$ æ¡è¾¹è·‘ç½‘ç»œæµï¼Œä¸€çœ‹æ•°æ®èŒƒå›´å‚»çœ¼äº†ğŸ¤—</p><p>å‘ç°ç­”æ¡ˆåªå¯èƒ½æœ‰ $0, 1, 2$ ä¸‰ç§å–å€¼ï¼Œå› ä¸ºè‡³å¤šæŠŠèµ·ç‚¹æ—è¾¹çš„ä¿©æ ¼å­å µä¸Šå°±å®Œäº‹äº†ã€‚ç°åœ¨çš„ä»»åŠ¡å°±æ˜¯åˆ†å‡ºè¿™ä¸‰ç§æƒ…å†µæ¥ã€‚</p><p>é¦–å…ˆç­”æ¡ˆæ˜¯ $0$ çš„æƒ…å†µéå¸¸çš„å¥½åˆ¤ï¼Œdfs ä¸€éåˆ°ä¸äº†ç»ˆç‚¹ç­”æ¡ˆå°±æ˜¯ $0$ã€‚</p><p>é‚£ä¹ˆç­”æ¡ˆæ˜¯ $1$ å’Œ $2$ æ€ä¹ˆåŒºåˆ†å‘¢ï¼Œè¿™ä¸ªä¹Ÿå¾ˆç®€å•ï¼Œdfs ç¬¬ä¸€éçš„æ—¶å€™æŠŠç»è¿‡çš„è·¯éƒ½å µä¸Šï¼Œåˆ¤èƒ½ä¸èƒ½ dfs åˆ°ç»ˆç‚¹ç¬¬äºŒéå°±è¡Œäº†ã€‚dfs çš„æ—¶å€™å…ˆæ²¿åŒä¸€ä¸ªæ–¹å‘èµ°ï¼Œç›´åˆ°å‘ç°æ­»è·¯å†è½¬å‘ï¼Œæ­£ç¡®æ€§ä¸ä¼šè¯ï¼Œæ„Ÿæ€§ç†è§£ä¸€ä¸‹ï¼ˆ</p><p>è¿™ä¸ªåšæ³•å’Œä¸€èˆ¬å›¾ä¸Šæ‰¾ä¸¤æ¡è·¯å¾„ç½‘ç»œæµç¬¬ä¸€éä¸é€€æµæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œæ‰€ä»¥è¿™é¢˜è¿˜æ˜¯æ²¡èƒ½å’Œç½‘ç»œæµè„±å¼€å¹²ç³»ï¼ˆç¡®ä¿¡ï¼‰</p><p>å¤æ‚åº¦æ˜¾ç„¶æ˜¯ $O(nm)$ã€‚</p><h4 id="code-2"><a href="#code-2" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, dy[] = &#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x == N &amp;&amp; y == M) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  z[x][y] = <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>, nx, ny; k &lt; <span class="number">2</span>; ++k) &#123;</span><br><span class="line">    nx = x + dx[k], ny = y + dy[k];</span><br><span class="line">    <span class="keyword">if</span> (nx &lt;= N &amp;&amp; ny &lt;= M &amp;&amp; z[nx][ny] == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">dfs</span>(nx, ny))</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line">  std::cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">  <span class="function">std::vector&lt;std::string&gt; <span class="title">z</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    std::cin &gt;&gt; z[i];</span><br><span class="line">    z[i] = <span class="string">&quot; &quot;</span> + z[i];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> ans1 = <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> (!ans1) &#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;0\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  z[<span class="number">1</span>][<span class="number">1</span>] = z[N][M] = <span class="string">&#x27;.&#x27;</span>;</span><br><span class="line">  <span class="keyword">int</span> ans2 = <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  std::cout &lt;&lt; <span class="number">1</span> + ans2 &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><p>Fin.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2022 Jan Records</title>
      <link href="/2022/2022-Jan-Records/"/>
      <url>/2022/2022-Jan-Records/</url>
      
        <content type="html"><![CDATA[<p>èœé¸¡ fa_555 ä¼šæŠŠä¸€äº›åŠ¨æ€ç®€è¦åœ°è®°åœ¨è¿™é‡Œã€‚ä¸»è¦è¿˜æ˜¯ç•™ç»™è‡ªå·±ä»¥åçœ‹çš„ã€‚</p><span id="more"></span><p>è¿™ä¸ªæœˆå¤§æ¦‚æ‰“äº†æ‰“å­¦æ ¡å…¬ç›Šè¯¾çš„å…¥é—¨èµ›ã€‚æŒ‘ä¸€äº›å…¥é—¨èµ›è¿›é˜¶ç»„çš„é¢˜ç›®å†™ä¸€å†™ã€‚</p><p><em>æ‰€æœ‰ä»£ç ä¸ä¿è¯åŒ…æ‹¬æ— å…³ç´§è¦çš„éƒ¨åˆ†</em></p><hr><h3 id="Second-1-I-Queuing-HDU-2604"><a href="#Second-1-I-Queuing-HDU-2604" class="headerlink" title="Second_1 I: Queuing (HDU 2604)"></a>Second_1 I: Queuing (HDU 2604)</h3><h4 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h4><p>æ±‚æ»¡è¶³ä»¥ä¸‹æ€§è´¨çš„é•¿ä¸º $|s| \ (|s| \le 10^6)$ çš„å­—ç¬¦ä¸² $s$ çš„æ•°é‡ï¼š</p><ol><li>$s$ ä¸­ä»…åŒ…å« $\texttt{f} / \texttt{m}$ ä¸¤ç§å­—ç¬¦</li><li>$s$ ä¸å«å­ä¸² $\texttt{fff}, \texttt{fmf}$ã€‚</li></ol><p>ç­”æ¡ˆå¯¹ $m \ (1 \le m \le 30)$ å–æ¨¡ã€‚$T$ ç»„è¯¢é—®ã€‚</p><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>æ²¡æœ‰ä»€ä¹ˆç–‘é—®åœ° dp æ¨ä¸€ä¸‹å¼å­ã€‚ç½‘ä¸Šçš„åšå®¢çš„ dp æ–¹æ³•éƒ½å¤ªç¥ä»™å­¦ä¸ä¼šï¼Œè‡ªå·±åœ¨èµ›æ—¶åªä¼šæœ€å¼±æ™ºçš„ã€‚</p><p>è®¾ $f_{i, 0/1/2/3}$ åˆ†åˆ«è¡¨ç¤ºé•¿ä¸º $i$ çš„å­—ç¬¦ä¸² $s$ çš„æœ€åä¸¤ä½æ˜¯ $\texttt{ff},  \texttt{fm}, \texttt{mf}, \texttt{mm}$ çš„æ–¹æ¡ˆæ•°ã€‚</p><p>ç”±æ­¤å¾—æ˜¾ç„¶çš„é€’æ¨å¼</p><script type="math/tex; mode=display">\begin{aligned}f_{i, 0} & = f_{i - 1, 2} \\f_{i, 1} & = f_{i - 1, 0} + f_{i - 1, 2} \\f_{i, 2} & = f_{i - 1, 3} \\f_{i, 3} & = f_{i - 1, 1} + f_{i - 1, 3} \\\end{aligned}</script><p>ç„¶åå‘ç°è¿™é¢˜æ¨¡æ•°æ˜¯ä¸å›ºå®šçš„ï¼Œæ‰€ä»¥ $O(T |s|)$ çš„æš´åŠ›ä¸€çœ‹å°±è¿‡ä¸å»ï¼ˆ</p><p>åé¢çš„æ“ä½œå°±å¤šå°‘æ²¾ç‚¹é­”æœ¯ï¼š</p><p>ä¸ºäº†è®°å·ä¸Šçš„ç¾è§‚ï¼Œä»¤å››å…ƒç»„ $(a_1, a_2, a_3, a_4)$ è¡¨ç¤º $a_1 f_{j, 0} + a_2 f_{j, 1} + a_3 f_{j, 2} + a_4 f_{j, 3}$ã€‚äºæ˜¯æš´åŠ›å‘åæ¨å‡ é¡¹ï¼š</p><script type="math/tex; mode=display">\begin{array}{ccc}j = i & & j = i - 1 & & j = i - 2 & & j = i - 3 & & j = i - 4 \\(1, 0, 0, 0) & = & (0, 0, 1, 0) & = & (0, 0, 0, 1) & = & (0, 1, 0, 1) & = & (1, 1, 1, 1) \\(0, 1, 0, 0) & = & (1, 0, 1, 0) & = & (0, 0, 1, 1) & = & (0, 1, 0, 2) & = & (1, 2, 1, 2) \\(0, 0, 1, 0) & = & (0, 0, 0, 1) & = & (0, 1, 0, 1) & = & (1, 1, 1, 1) & = & (1, 1, 2, 2) \\(0, 0, 0, 1) & = & (0, 1, 0, 1) & = & (1, 1, 1, 1) & = & (1, 1, 2, 2) & = & (1, 2, 2, 4) \\(1, 1, 1, 1) & = & (1, 1, 2, 2) & = & (1, 2, 2, 4) & = & (2, 4, 3, 6) & = & (4, 6, 6, 9) \\\end{array}</script><p>ï¼ˆç”±äºè¡¨é‡Œå‡ºç°äº†å¾ˆå¤šé‡å¤é¡¹ï¼Œæ‰€ä»¥äººè„‘è®°å¿†åŒ–ä¸€ä¸‹å¾ˆå¿«å°±ç®—å‡ºæ¥äº†ï¼Œä¸èƒ½ç®—éº»çƒ¦ï¼‰</p><p>å‘ç° $(4, 6, 6, 9) = (2, 4, 3, 6) + (1, 1, 2, 2) + (1, 1, 1, 1)$ã€‚äºæ˜¯ä»¤ $f_i = \sum \limits_{j = 0}^3 f_{i, j}$ï¼Œåˆ™æœ‰ $f_i = f_{i - 1} + f_{i - 3} + f_{i - 4}$ã€‚</p><p>åé¢çš„äº‹å¤§æ¦‚å°±å¤§å®¶éƒ½çŸ¥é“äº†ï¼Œæå‡ºä¸ªçŸ©é˜µæ¥å¿«é€Ÿå¹‚å®Œäº‹ã€‚</p><script type="math/tex; mode=display">\begin{bmatrix} f_n \\ f_{n - 1} \\ f_{n - 2} \\ f_{n - 3} \end{bmatrix} = \begin{bmatrix}1 & & 1 & 1 \\1 \\& 1 \\& & 1\end{bmatrix}^{n - 3} \begin{bmatrix} f_{3} \\ f_{2} \\ f_{1} \\ f_{0} \end{bmatrix}</script><p>å…¶ä¸­ $f_0 = 1, f_1 = 2, f_2 = 4, f_3 = 6$ã€‚å¤æ‚åº¦ $O(T \log |s|)$ã€‚</p><h3 id="Second-1-J-Count-HDU-6470"><a href="#Second-1-J-Count-HDU-6470" class="headerlink" title="Second_1 J: Count (HDU 6470)"></a>Second_1 J: Count (HDU 6470)</h3><h4 id="Problem-1"><a href="#Problem-1" class="headerlink" title="Problem"></a>Problem</h4><p>å·²çŸ¥ $f_1 = 1, f_2 = 2, f_n = f_{n - 1} + f_{n - 2} + n^3$ï¼Œæ±‚æ¨¡æ„ä¹‰ä¸‹çš„ $f_n \ (n \le 10^{18})$ã€‚$T \ (T \le 10^4)$ ç»„è¯¢é—®ã€‚</p><h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>çŸ©é˜µå¿«é€Ÿå¹‚å¤„ç†å¸¸æ•°é¡¹çš„æ¿å­é¢˜ã€‚æŠŠæ‰€æœ‰å« $n$ çš„é¡¹ç”¨ $n - 1$ è¡¨ç¤ºï¼Œå¾—åˆ°çŸ©é˜µ</p><script type="math/tex; mode=display">\begin{bmatrix} f_n \\ f_{n - 1} \\ (n + 1)^3 \\ (n + 1)^2 \\ n + 1 \\ 1 \end{bmatrix} = \begin{bmatrix}1 & 2 & 1 \\1 \\& & 1 & 3 & 3 & 1 \\& & & 1 & 2 & 1 \\& & & & 1 & 1 \\& & & & & 1 \\\end{bmatrix} \begin{bmatrix} f_{n - 1} \\ f_{n - 2} \\ n^3 \\ n^2 \\ n \\ 1 \end{bmatrix} = \begin{bmatrix}1 & 2 & 1 \\1 \\& & 1 & 3 & 3 & 1 \\& & & 1 & 2 & 1 \\& & & & 1 & 1 \\& & & & & 1 \\\end{bmatrix}^{n - 2} \begin{bmatrix} f_{2} \\ f_{1} \\ 27 \\ 9 \\ 3 \\ 1 \end{bmatrix}</script><p>æ€»å¤æ‚åº¦ $O(T \log n)$ã€‚</p><h3 id="Second-1-L-Another-kind-of-Fibonacci-HDU-3306"><a href="#Second-1-L-Another-kind-of-Fibonacci-HDU-3306" class="headerlink" title="Second_1 L: Another kind of Fibonacci (HDU 3306)"></a>Second_1 L: Another kind of Fibonacci (HDU 3306)</h3><h4 id="Problem-2"><a href="#Problem-2" class="headerlink" title="Problem"></a>Problem</h4><p>å·²çŸ¥ $A_0 = 1, A_1 = 1, A_n = xA_{n - 1} + yA_{n - 2}$ã€‚ä»¤ $S_n = \sum \limits_{i = 0}^n{ A_i^2 }$ï¼Œæ±‚æ¨¡æ„ä¹‰ä¸‹çš„ $S_n$ã€‚$(2 \le n, x, y &lt; 2^{31})$ã€‚$T$ ç»„è¯¢é—®ã€‚</p><h4 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h4><p>è¿™é¢˜æ›´æ˜¯é‡é‡çº§ã€‚è€ƒè™‘æ¨å¼å­</p><script type="math/tex; mode=display">\begin{aligned}A_n^2 &= x^2 A_{n - 1}^2 + y^2 A_{n - 2}^2 + 2xy A_{n - 1} A_{n - 2} \\S_n & = S_{n - 1} + A_n^2 \\& = S_{n - 1} + x^2 A_{n - 1}^2 + y^2 A_{n - 2}^2 + 2xy A_{n - 1} A_{n - 2} \\A_n A_{n - 1} & = x A_{n - 1}^2 + y A_{n - 1} A_{n - 2}\end{aligned}</script><p>äºæ˜¯</p><script type="math/tex; mode=display">\begin{bmatrix} S_n \\ A_n^2 \\ A_{n - 1}^2 \\ A_n A_{n - 1} \end{bmatrix} = \begin{bmatrix}1 & x^2 & y^2 & 2xy \\& x^2 & y^2 & 2xy \\& 1 \\& x & & y\end{bmatrix} \begin{bmatrix} S_{n - 1} \\ A_{n - 1}^2 \\ A_{n - 2}^2 \\ A_{n - 1} A_{n - 2} \end{bmatrix} = \begin{bmatrix}1 & x^2 & y^2 & 2xy \\& x^2 & y^2 & 2xy \\& 1 \\& x & & y\end{bmatrix}^{n - 1} \begin{bmatrix} 2 \\ 1 \\ 1 \\ 1 \end{bmatrix}</script><p>æ€»å¤æ‚åº¦ $O(T \log n)$ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æš‘å‡æ•°å­¦ä¸€è½®ç¬”è®°</title>
      <link href="/2020/Note-Math/"/>
      <url>/2020/Note-Math/</url>
      
        <content type="html"><![CDATA[<p>è¿™é‡Œæ˜¯æš‘å‡æ•°å­¦ä¸€è½®ç¬”è®°ã€‚</p><p>éšä¾¿å†™å†™çš„ï¼Œä¼šå†™ç‚¹äºŒçº§ç»“è®ºã€ä¾‹é¢˜å’Œè¯æ˜ã€‚</p><p>å¯èƒ½ä¸ºäº†è¿è´¯ä¼šå†™éå¸¸æ°´çš„ï¼Œä¹Ÿä¼šå†™éå¸¸éš¾çš„ã€‚ï¼ˆå†™å®Œåå‘ç°æŒ‰ç…§ç¼–æ’æ°å¥½éš¾åº¦å¤§è‡´é€’å¢ï¼‰</p><p>ä¸ä¸€å®šæ˜¯ä»ä¹¦ä¸ŠæŠ„æ¥çš„ï¼Œæœ‰äº›å¯èƒ½æ˜¯æˆ‘ä¸ªäººæƒ³åˆ°çš„ ideaã€‚</p><p>ä¾‹é¢˜ä¸€èˆ¬åªæœ‰ åšæ³•æå…¶ç»å…¸ æˆ– æˆ‘çš„åšæ³•æ¯”æ ‡å‡†ç­”æ¡ˆç®€å• æˆ– è§£æ³•æå…·å¯å‘æ„ä¹‰ æˆ‘æ‰ä¼šå†™è§£æ³•ã€‚</p><span id="more"></span><p><strong>è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯ä»‹ç»å„ç§å¥½ç”¨çš„æ€æƒ³æ–¹æ³•å’Œéš¾æ¨ä¸”å¥½ç”¨çš„ç»“è®ºï¼ˆä¸»è¦åœ¨è§£æå‡ ä½•éƒ¨åˆ†ã€‚å®é™…ä¸Šï¼Œè¿™éƒ¨ç¬”è®°åŸæœ¬å°±æ˜¯ä¸ºäº†è§£æå‡ ä½•çš„å¤§é‡äºŒçº§ç»“è®ºè€Œå†™çš„ï¼‰ä¸è¦æŠŠæ‰€æœ‰çš„ç»“è®ºéƒ½è®°ä½ï¼Œè¿™ä¸æ˜¯è¿™ç¯‡ç¬”è®°çš„ç›®çš„ã€‚å¯¹äºèƒ½å¿«é€Ÿæ¨å¯¼çš„ç»“è®ºï¼Œåº”è¯¥ä»é˜…è¯»è¿™ç¯‡ç¬”è®°ä¸­é”»ç‚¼æ€ç»´ï¼Œä»è€ŒæŒæ¡æ¨å¯¼è¿‡ç¨‹ï¼Œæ¯æ¬¡ç”¨çš„æ—¶å€™ç°æ¨ã€‚æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½è®°ä½åªä¼šè®©è‡ªå·±å˜å‚»ã€‚åšé¢˜æœ€é‡è¦çš„æ˜¯è„‘å­ï¼Œç»“è®ºåªèƒ½åœ¨æœ‰è„‘å­çš„å‰æä¸‹èµ·è¾…åŠ©ä½œç”¨ï¼Œåƒä¸‡ä¸è¦æ»¡è„‘å­åªæœ‰ç»“è®ºã€‚</strong></p><p>ä¸ä¸€å®šä¼šæŒ‰ç…§é«˜ä¸­æ•°å­¦è¯¾æœ¬çš„è§„èŒƒå†™å…¬å¼å’Œæœ¯è¯­ã€‚</p><p>ä¸è¦å¤–ä¼ ç»™ä»»ä½•äººï¼Œå› ä¸ºæˆ‘è§‰å¾—è¿™ä¸ªæ‹¿å‡ºå»å–é’±èƒ½æŒ£ä¸€å¤§ç¬”ï¼Œå¹¶ä¸”è¿™ä¸ªæ’ç‰ˆå¤ªä¸‘ï¼Œæ‹¿å‡ºå»å¾ˆä¸¢äººã€‚</p><p>æ‰€æœ‰è“è‰²çš„è¶…é“¾æ¥éƒ½æ˜¯èƒ½ç‚¹çš„ï¼ˆ</p><p>[TOC]</p><hr><h2 id="ä¸‰è§’å‡½æ•°"><a href="#ä¸‰è§’å‡½æ•°" class="headerlink" title="ä¸‰è§’å‡½æ•°"></a>ä¸‰è§’å‡½æ•°</h2><p><em>ç”±äºå¤ä¹ çš„æ—¶å€™ä¸åœ¨æš‘å‡æ‰€ä»¥æ²¡æƒ³åˆ°å†™å•¥ï¼Œå®é™…ä¸Šä¸‰è§’å‡½æ•°ä¹Ÿæ²¡å•¥ç»“è®ºï¼Œå…¨æ˜¯å…¬å¼ã€‚</em></p><ul><li><p>å·²çŸ¥æ‰‡å½¢çš„å‘¨é•¿ä¸º $C$ï¼Œåˆ™é¢ç§¯ $S = \frac{C^2}{2( \alpha + \frac 4 \alpha + 4)}$ï¼Œå…¶ä¸­ $\alpha$ ä¸ºåœ†å¿ƒè§’ã€‚å½“ $\alpha = 2 \ \mathrm{rad}$ æ—¶ï¼Œ$S_{\max} = \frac{C^2}{16}$ã€‚</p><hr></li><li><p>$a\sin x + b\cos x = \sqrt{a^2 + b^2} \sin(x + \varphi)$ï¼Œå…¶ä¸­ $\tan \varphi = \frac ba$ã€‚è™½ç„¶è¾…åŠ©è§’å…¬å¼å·²ç»è®°çƒ‚äº†ï¼Œä½†è¿˜æ˜¯å†™ä¸€ä¸‹è¡¨ç¤ºå°Šé‡ã€‚</p><hr></li><li><p>ç”¨ $\tan \alpha$ è¡¨ç¤º $\sin 2\alpha, \ \cos 2\alpha, \ \tan 2\alpha$ çš„å¼å­å¯ä»¥å…ˆé™ä¸€æ¬¡å¹‚ç„¶åé™¤ä»¥ $\sin^2 \alpha + \cos^2 \alpha$ å†çæ¯” $\cos \alpha$ å¾—åˆ°ã€‚è¿™ä¸ªçš„ç”¨å¤„ä¸»è¦æ˜¯æ¨å¯¼è¿‡ç¨‹ï¼Œå…¬å¼å¤ªä¹±å°±ä¸æ‰“äº†ã€‚</p><hr></li><li><p>åœ¨ $\triangle ABC$ ä¸­ï¼Œç”±äº $A + B &lt; \pi$ çš„é™åˆ¶ï¼Œ$A &lt; B \Longleftrightarrow \sin A &lt; \sin B$ã€‚</p><hr></li><li><p><strong>å™”å™”å’š</strong> å’Œå·®åŒ–ç§¯ã€ç§¯åŒ–å’Œå·®</p><script type="math/tex; mode=display">\begin{split}\sin \alpha + \sin \beta &= 2 \sin \frac{ \alpha + \beta}2 \cos \frac{ \alpha - \beta}2 \\\sin \alpha - \sin \beta &= 2 \sin \frac{ \alpha - \beta}2 \cos \frac{ \alpha + \beta}2 \\\cos \alpha + \cos \beta &= 2 \cos \frac{ \alpha + \beta}2 \cos \frac{ \alpha - \beta}2 \\\cos \alpha - \cos \beta &= -2 \sin \frac{ \alpha + \beta}2 \sin \frac{ \alpha - \beta}2 \\\tan \alpha + \tan \beta &= \frac{ \sin( \alpha + \beta)}{ \cos \alpha \cos \beta} \\\tan \alpha - \tan \beta &= \frac{ \sin( \alpha - \beta)}{ \cos \alpha \cos \beta} \\\end{split}</script><script type="math/tex; mode=display">\begin{split}\sin \alpha \cos \beta &= \frac 12( \sin( \alpha + \beta) + \sin( \alpha - \beta)) \\\cos \alpha \cos \beta &= \frac 12( \cos( \alpha + \beta) + \cos( \alpha - \beta)) \\\sin \alpha \sin \beta &= - \frac 12( \cos( \alpha + \beta) - \cos( \alpha - \beta))\end{split}</script></li></ul><hr><h2 id="å¹³é¢å‘é‡"><a href="#å¹³é¢å‘é‡" class="headerlink" title="å¹³é¢å‘é‡"></a>å¹³é¢å‘é‡</h2><p><em>å‘é‡å±å®æ˜¯åˆç®€å•åˆå¥½ç”¨çš„ç©æ„äº†ã€‚</em></p><ul><li><p>å¯¹äºèµ·ç‚¹ç›¸åŒã€ç»ˆç‚¹å…±çº¿çš„ä¸‰ä¸ªå‘é‡ $\vec{ON}, \vec{OP}, \vec{OQ}$ï¼ˆ$O$ ä¸ $PQ$ ä¸å…±çº¿ï¼‰ï¼Œæ€»æœ‰ $\vec{ON} = u \cdot \vec{OP} + v \cdot \vec{OQ}$ï¼Œå…¶ä¸­ $u + v = 1$ã€‚</p><p><strong>ä¾‹</strong> è®¾ä¸¤ä¸ªéé›¶å‘é‡ $\vec a$ ä¸ $\vec b$ ä¸å…±çº¿ï¼Œè‹¥ $\vec a$ ä¸ $\vec b$ çš„èµ·ç‚¹ç›¸åŒï¼Œä¸” $\vec a, t \vec b, \frac 13( \vec a + \vec b)$ çš„ç»ˆç‚¹åœ¨åŒä¸€æ¡ç›´çº¿ä¸Šï¼Œæ±‚å®æ•° $t$ çš„å€¼ã€‚</p><p><strong>è§£</strong> è®¾ $\begin{cases} \frac 13( \vec a + \vec b) = u \vec a + vt \vec b \\ u + v = 1 \end{cases}$ï¼Œè§£å‡ºæ¥å°±å®Œäº‹ğŸŒ¶</p><hr></li><li><p>åœ¨ä¸Šä¸€æ¡çš„åŸºç¡€ä¸Šï¼Œå¦‚æœæœ‰ $\vec{OM} = \lambda \vec{ON}$ï¼Œåˆ™æœ‰ $\vec{OM} = u \cdot \vec{OP} + v \cdot \vec{OQ}$ï¼Œå…¶ä¸­ $u + v = \lambda$ã€‚æœ‰å¾ˆå¤šé¢˜å¯ä»¥ç”¨è¿™ä¸ªç®€åŒ–ã€‚</p><hr></li><li><p>è‹¥ $G$ ä¸º $\triangle ABC$ çš„<strong>é‡å¿ƒ</strong>ï¼ˆä¸­çº¿çš„äº¤ç‚¹ï¼‰ï¼Œåˆ™æœ‰ $\vec{GA} + \vec {GB} + \vec {GC} = 0 $ï¼Œ$\vec{AG} = \frac 13( \vec{AB} + \vec{AC})$ã€‚</p><ul><li>è¿™ä¸ªç»“è®ºåœ¨ç«‹ä½“å‡ ä½•é‚£ç« çš„é¢˜ç›®é‡Œä¼šéå¸¸æœ‰ç”¨ï¼šè®¾æ­£ä¸‰è§’å½¢çš„è¾¹é•¿ä¸º $a$ï¼Œåˆ™æŸä¸ªé¡¶ç‚¹åˆ°é‡å¿ƒçš„è·ç¦»ä¸º $\frac{ \sqrt 3}3 a$ã€‚ç›¸åº”åœ°ï¼Œé‡å¿ƒåˆ°æŸæ¡è¾¹çš„è·ç¦»ä¸º $\frac{ \sqrt 3}6 a$ã€‚</li></ul></li></ul><hr><h2 id="å¤æ•°"><a href="#å¤æ•°" class="headerlink" title="å¤æ•°"></a>å¤æ•°</h2><ul><li><p>å¤æ•°ç›¸ä¹˜ï¼Œæ¨¡ç›¸ä¹˜ï¼Œå¹…è§’ç›¸åŠ ï¼›å¤æ•°ç›¸é™¤ï¼Œæ¨¡ç›¸é™¤ï¼Œå¹…è§’ç›¸å‡ã€‚</p><ul><li>è®°ä½è¿™ä¸ªçœ‹èµ·æ¥éå¸¸ naive çš„ç»“è®ºï¼Œè„‘å­é‡Œå†å¸¦ç€ä¸ªå¤å¹³é¢ï¼Œå¤§éƒ¨åˆ†å¤æ•°é¢˜å¯ä»¥ç§’å‡ºã€‚</li></ul><p><strong>ä¾‹</strong> å¤æ•° $z = \frac {3 + 4i}{12 - 5i}$ï¼ˆ$i$ ä¸ºè™šæ•°å•ä½ï¼‰ï¼Œæ±‚ $|z|$ã€‚</p><p><strong>è§£</strong> åˆ†å­æ¨¡æ˜¯ $5$ï¼Œåˆ†æ¯æ¨¡æ˜¯ $13$ï¼Œå®Œäº‹äº†ã€‚<!-- å…±è½­å¤æ•°å¹³æ–¹å·®çš„æ†¨æ‰¹æé‚£ç®—ä½ ğŸ´å‘¢ï¼Ÿ --><em>[è¿™é‡Œæœ¬æ¥çš„é‚£å¥è¯å·²æ³¨é‡Šæ‰]</em></p></li></ul><hr><h2 id="æ•°åˆ—"><a href="#æ•°åˆ—" class="headerlink" title="æ•°åˆ—"></a>æ•°åˆ—</h2><p><!-- *å‚»é€¼ç©æ„æ€ä¹ˆé«˜ä¸­é¢˜å‡ºå¾—è¿™ä¹ˆéš¾å—* --><em>[è¿™é‡Œæœ¬æ¥çš„é‚£å¥è¯å·²æ³¨é‡Šæ‰]</em></p><p>æ•°åˆ—é¢˜å¤§éƒ¨åˆ†æ˜¯æ¯”è¾ƒéœ€è¦è„‘å­çš„ï¼Œä½†ä¹Ÿæœ‰å°‘éƒ¨åˆ†çƒ‚é¢˜ä¼šä¸ä¼šç»“è®ºå®Œå…¨å°±æ˜¯ä¸¤ç§æ„Ÿå—ã€‚</p><p><strong>æœ¬èŠ‚ä¸­é»˜è®¤ $n \in \N^\ast$ï¼Œä¸å†èµ˜è¿°ã€‚</strong></p><h3 id="æ±‚é€šé¡¹å…¬å¼"><a href="#æ±‚é€šé¡¹å…¬å¼" class="headerlink" title="æ±‚é€šé¡¹å…¬å¼"></a>æ±‚é€šé¡¹å…¬å¼</h3><p><em>è¿™èŠ‚æ²¡æœ‰å€¼å¾—å­¦ä¹ çš„ä¸œè¥¿ã€‚ä¸€è½®ä¹‹åçš„é˜…è¯»è¯·è·³è¿‡è¿™èŠ‚ã€‚</em></p><ul><li><p>$a_n = \begin{cases} S_1 &amp;, n = 1 \\ S_n - S_{n - 1} &amp;, n \ge 2 \end{cases}$ï¼Œå†™è¿™æ¡æ˜¯ä¸ºäº†æé†’ä½ æ±‚å‡ºé€šé¡¹ä¸è¦å¿˜è®°éªŒè¯ $a_1$ æ˜¯å¦æ»¡è¶³ã€‚</p><p><strong>ä¾‹</strong> å·²çŸ¥æ•°åˆ— $\{ a_n \}$ çš„å‰ $n$ é¡¹å’Œå…¬å¼ä¸º $S_n = 2n^2 - n + 1$ï¼Œæ±‚ $a_n$ã€‚</p><p><strong>ç­”æ¡ˆ</strong> $a_n = \begin{cases} 2 &amp;, n = 1 \\ 4n - 3 &amp;, n \ge 2 \end{cases}$</p><hr></li><li><p>å·²çŸ¥ $\frac{a_{n + 1}}{a_n} = f(n)$ï¼Œæ±‚ $a_n$ï¼Œä¸Š<strong>ç´¯ä¹˜</strong>ã€‚</p><p><strong>ä¾‹ 1</strong> å·²çŸ¥åœ¨æ•°åˆ— $\{ a_n \}$ ä¸­ï¼Œå·²çŸ¥ $a_1 = 1, na_{n - 1} = (n + 1)a_n \ (n \ge 2)$ï¼Œæ±‚ $a_n$ã€‚</p><p><strong>è§£</strong></p><script type="math/tex; mode=display">\begin{align}& \begin{split}\frac{a_n}{a_{n - 1}} &= \frac n{n + 1} \ (n \ge 2) \\\Longrightarrow a_n &= \frac{a_n}{a_{n - 1}} \cdot \frac{a_{n - 1}}{a_{n - 2}} \cdot \ldots \cdot \frac{a_2}{a_1} \cdot a_1 \\&= \frac n{n + 1} \cdot \frac{n - 1}n \cdot \ldots \cdot \frac 23 \cdot 1 \\&= \frac{2}{n + 1} \ (n \ge 2)\end{split} \\& a_1 = 1 \text{ satisfies the above formula.} \\&\Longrightarrow a_n = \frac 2{n + 1}\end{align}</script><p><strong>ä¾‹ 2</strong> å·²çŸ¥åœ¨æ•°åˆ— $\{ a_n \}$ ä¸­ï¼Œ$a_1 = 2, (n + 2)a_{n + 1} - (n + 1)a_n = 0$ï¼Œæ±‚ $a_n$ã€‚</p><p><strong>ç­”æ¡ˆ</strong> $a_n = \frac 4{n + 1}$</p><hr></li><li><p>ç±»ä¼¼åœ°ï¼Œå·²çŸ¥ $a_{n + 1} - a_n = f(n)$ï¼Œä¸Š<strong>ç´¯åŠ </strong>ã€‚</p><p><strong>ä¾‹ 1</strong> å·²çŸ¥åœ¨æ•°åˆ— $\{ a_n \}$ ä¸­ï¼Œ$a_1 = 2, a_n - a_{n - 1} = 3n - 1 \ (n \ge 2)$ï¼Œæ±‚ $a_n$ã€‚</p><p><strong>è§£</strong></p><script type="math/tex; mode=display">\begin{align}& \begin{split}a_n - a_{n - 1} &= 3n - 1 \ (n \ge 2) \\\Longrightarrow a_n &= (a_n - a_{n - 1}) + (a_{n - 1} - a_{n - 2}) + \cdots + (a_2 - a_1) + a_1 \\&= (3n - 1) + (3n - 4) + \cdots + 5 + 2 \\&= \frac{n(3n + 1)}2 \ (n \ge 2)\end{split} \\& a_1 = 2 \text{ satisfies the above formula.} \\&\Longrightarrow a_n = \frac{n(3n + 1)}2\end{align}</script><p><strong>ä¾‹ 2</strong> å·²çŸ¥åœ¨æ•°åˆ— $\{ a_n \}$ ä¸­ï¼Œ$a_1 = 2, a_{n + 1} = a_n + \frac 1{n(n + 1)}$ï¼Œæ±‚ $a_n$ã€‚</p><p><strong>ç­”æ¡ˆ</strong> $a_n = 3 - \frac 1n$</p><hr></li><li><p>å·²çŸ¥ $a_{n + 1} = pa_n + q$ï¼Œå¾…å®šç³»æ•°è®¾ $a_{n + 1} + \lambda = p(a_n + \lambda)$ï¼Œæ±‚å‡º $\lambda$ï¼Œ$\{ a_n + \lambda \}$ æ˜¯ç­‰æ¯”æ•°åˆ—ã€‚</p><p><strong>ä¾‹</strong> å·²çŸ¥åœ¨æ•°åˆ— $\{ a_n \}$ ä¸­ï¼Œ$a_1 = 3$ï¼Œä¸”ç‚¹ $P_n(a_n, a_{n + 1})$ åœ¨ç›´çº¿ $4x - y + 1 = 0$ ä¸Šï¼Œæ±‚ $a_n$ã€‚</p><p><strong>è§£</strong> å‘ç° $a_{n + 1} = 4a_n + 1$ã€‚é€šè¿‡ä¸Šé¢æ–¹æ³•å¾—åˆ° $a_{n + 1} + \frac 13 = 4 \left(a_n + \frac 13 \right)$ï¼Œåˆ™ $\left\{ a_n + \frac 13 \right\}$ æ˜¯é¦–é¡¹ä¸º $\frac{10}3$ï¼Œå…¬æ¯”ä¸º $4$ çš„ç­‰æ¯”æ•°åˆ—ã€‚$a_n = \frac 56 \cdot 4^n - \frac 13$ã€‚</p><hr></li><li><p>å‰©ä¸‹çš„æ±‚é€šé¡¹é¢˜å°±æ¯”è¾ƒäººç±»æ™ºæ…§äº†ã€‚æ¯”å¦‚<a href="https://fa555.github.io/2020/counting/#%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0">è¿™ä¸ª</a>ï¼ˆï¼Ÿï¼‰</p></li></ul><hr><h3 id="ç­‰å·®æ•°åˆ—ç›¸å…³"><a href="#ç­‰å·®æ•°åˆ—ç›¸å…³" class="headerlink" title="ç­‰å·®æ•°åˆ—ç›¸å…³"></a>ç­‰å·®æ•°åˆ—ç›¸å…³</h3><p>æœ¬èŠ‚ä¸­é»˜è®¤ $\{ a_n \}$ æ˜¯é¦–é¡¹ä¸º $a_1$ï¼Œå…¬å·®ä¸º $d$ çš„ç­‰å·®æ•°åˆ—ï¼Œ$S_n$ ä¸ºå…¶å‰ç¼€å’Œã€‚</p><ul><li><p>è‹¥ $a, b, c$ æˆç­‰å·®æ•°åˆ—ï¼Œå³ $b$ æ˜¯ $a$ å’Œ $c$ çš„ç­‰å·®ä¸­é¡¹ï¼Œåˆ™ $2b = a + c$ã€‚å…¶å®å°±æ˜¯ç®—æœ¯å¹³å‡æ•°ã€‚</p><hr></li><li><p>$a_n = a_m + (n - m)d$</p></li><li><p>$S_n = \frac{n(a_1 + a_n)}2 = na_1 + \frac{n(n - 1)}2 d$</p><ul><li>$\left \{ \frac{S_n}n \right \}$ ä¹Ÿæ˜¯ç­‰å·®æ•°åˆ—ï¼Œ$\frac{S_n}n = a_1 + \frac{n - 1}2 d$ã€‚</li></ul></li><li><p>$S_n, S_{2n - n}, S_{3n - 2n}, \cdots$ æˆç­‰å·®æ•°åˆ—ï¼Œå…¬å·®ä¸º $n^2d$ã€‚</p><hr></li><li><p>è‹¥é¡¹æ•°ä¸ºå¶æ•° $2n$ï¼Œåˆ™ $S_{2n} = n(a_1 + a_{2n}) = n(a_{n} + a_{n + 1})$ï¼Œ$\frac{S_{ \text{even}}}{S_{ \text{odd}}} = \frac{a_n}{a_{n + 1}}$ã€‚</p></li><li><p>è‹¥é¡¹æ•°ä¸ºå¥‡æ•° $2n - 1$ï¼Œåˆ™ $S_{2n - 1} = (2n - 1)a_n$ï¼Œ$S_{ \text{odd}} - S_{ \text{even}} = a_n$ï¼Œ$\frac{S_{ \text{odd}}}{S_{ \text{even}}} = \frac{n}{n - 1}$ã€‚</p><ul><li>æ ¡å¯¹è¿‡äº†ï¼Œä¸Šä¸¤æ¡ä¸å¯¹ç§°çš„åœ°æ–¹æ²¡æœ‰é”™è¯¯ã€‚è¯æ˜éƒ½ä¸éš¾ï¼Œç›´æ¥å¥—é€šé¡¹å°±è¡Œï¼Œéš¾å°±éš¾åœ¨ç¬¬ä¸€ä¸ªæƒ³å‡ºè¿™äº›ç»“è®ºã€‚</li></ul><hr></li><li><p>è‹¥æ•°åˆ— $\{ a_n \}$ å’Œ $\{ b_n \}$ å‡ä¸ºç­‰å·®æ•°åˆ—ï¼Œä¸”å‰ $n$ é¡¹å’Œåˆ†åˆ«æ˜¯ $S_n$ å’Œ $T_n$ï¼Œåˆ™ $\frac{S_{2m - 1}}{T_{2m - 1}} = \frac{a_m}{b_m}$ã€‚</p></li></ul><hr><h3 id="ç­‰æ¯”æ•°åˆ—ç›¸å…³"><a href="#ç­‰æ¯”æ•°åˆ—ç›¸å…³" class="headerlink" title="ç­‰æ¯”æ•°åˆ—ç›¸å…³"></a>ç­‰æ¯”æ•°åˆ—ç›¸å…³</h3><p>æœ¬èŠ‚ä¸­é»˜è®¤ $\{ a_n \}$ æ˜¯é¦–é¡¹ä¸º $a_1$ï¼Œå…¬æ¯”ä¸º $q \ (q \ne 0)$ çš„ç­‰æ¯”æ•°åˆ—ï¼Œ$S_n$ ä¸ºå…¶å‰ç¼€å’Œï¼Œ$T_n$ ä¸ºå…¶å‰ç¼€ç§¯ã€‚</p><ul><li><p>è‹¥ $a, b, c$ æˆç­‰æ¯”æ•°åˆ—ï¼Œå³ $b$ æ˜¯ $a$ å’Œ $c$ çš„ç­‰æ¯”ä¸­é¡¹ï¼Œåˆ™ $b^2 = ac$ï¼ˆåä¹‹ä¸èƒ½æ¨å‡ºï¼Œå› ä¸ºå¯èƒ½å‡ºç° $0$ï¼‰ã€‚å…¶å®å°±æ˜¯å‡ ä½•å¹³å‡æ•°ã€‚</p><hr></li><li><p>$a_n = a_m q^{n - m}$</p></li><li><p>è‹¥ $q \ne 1$ï¼Œ$S_n = \frac{a_1(1 - q^n)}{1 - q} = \frac{a_1 - a_n q}{1 - q}$ã€‚</p></li><li><p>$T_n = (a_1 a_n)^{ \frac n2} = a_1^n q^{ \frac{n(n - 1)}2}$</p></li><li><p>è‹¥ $q \ne -1$ï¼Œ$S_n, S_{2n} - S_n, S_{3n} - S_{2n}, \cdots$ æˆç­‰æ¯”æ•°åˆ—ï¼Œå…¬æ¯”ä¸º $q^n$ã€‚</p></li><li><p>$T_n, \frac{T_{2n}}{T_n}, \frac{T_{3n}}{T_{2n}}, \cdots$ æˆç­‰æ¯”æ•°åˆ—ï¼Œå…¬æ¯”ä¸º $q^{n^2}$ã€‚</p><hr></li><li><p>è‹¥é¡¹æ•°ä¸ºå¥‡æ•° $2n + 1$ï¼Œåˆ™ $T_{2n + 1} = a_n^{2n + 1}$ã€‚</p><ul><li>ä¸å…‰è¿™ä¸ªï¼Œæ˜¾ç„¶ä¸Šé¢ç­‰å·®æ•°åˆ—å‰ç¼€å’Œå¯¹åŸæ•°åˆ—çš„å‡æ³•æ€§è´¨å’Œåšç­‰æ¯”æ•°åˆ—å¯¹åŸæ•°åˆ—çš„é™¤æ³•æ€§è´¨æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚è™½ç„¶éå¸¸ç®€å•ï¼Œä½†æ˜¯åšé¢˜æƒ³ä¸åˆ°å°±ä¼šåƒåƒå±ä¸€æ ·éš¾å—ã€‚</li></ul><hr></li><li><p>$S_{n + m} = S_n + q^n S_m = S_m + q^m S_n$</p><p><strong>ä¾‹</strong> å·²çŸ¥æ•°åˆ— $\{ a_n \}$ æ˜¯å„é¡¹éƒ½ä¸ºæ­£æ•°çš„ç­‰æ¯”æ•°åˆ—ï¼Œ$S_n$ ä¸ºå…¶å‰ $n$ é¡¹å’Œï¼Œä¸” $S_{10} = 10, S_{30} = 70$ï¼Œæ±‚ $S_{40}$ã€‚</p><p><strong>è§£</strong> $30$ æ˜¯ $10$ çš„æ•´æ•°å€ï¼Œæ‰€ä»¥å¯ä»¥æ‹†æˆ $S_{10}(1 + q^{10} + q^{20}) = S_{30}$ï¼Œè§£å¾— $q^{10} = 2$ï¼ˆå¦ä¸€æ ¹èˆå»ï¼‰ã€‚å°±å¯ä»¥ç”¨è¿™ä¸ªéå¸¸æ˜¾ç„¶çš„ç»“è®ºäº†ã€‚ä¾‹å¦‚ï¼Œ$S_{40} = S_{10} + q^{10} S_{30}$ï¼Œç­‰å·å³é¢çš„ä¸‰é¡¹éƒ½å·²çŸ¥ã€‚</p></li></ul><hr><h3 id="æ•°åˆ—æ±‚å’Œ"><a href="#æ•°åˆ—æ±‚å’Œ" class="headerlink" title="æ•°åˆ—æ±‚å’Œ"></a>æ•°åˆ—æ±‚å’Œ</h3><p><em>è¿™èŠ‚æ²¡æœ‰å€¼å¾—å­¦ä¹ çš„ä¸œè¥¿ã€‚ä¸€è½®ä¹‹åçš„é˜…è¯»è¯·è·³è¿‡è¿™èŠ‚ã€‚</em></p><ul><li><p>ç­‰å·®æ•°åˆ—æ±‚å’Œå…¬å¼ï¼š$S_n = \frac{n(a_1 + a_n)}2 = na_1 + \frac{n(n - 1)}2 d$ã€‚</p></li><li><p>ç­‰æ¯”æ•°åˆ—æ±‚å’Œå…¬å¼ï¼š$S_n = \begin{cases} na_1 &amp;, n = 1 \\ \frac{a_1(1 - q^n)}{1 - q} = \frac{a_1 - a_n q}{1 - q} &amp; , n \ne 1 \end{cases}$ã€‚</p></li><li><p>å€’åºç›¸åŠ </p><p>é€‚ç”¨äºåºåˆ—è‡ªèº«å¾ªç¯å·ç§¯åéå¸¸å¥½ç®—çš„æƒ…å†µã€‚ä¾‹å¦‚ç”¨äºç­‰å·®æ•°åˆ—æ±‚å’Œå…¬å¼çš„æ¨å¯¼ã€‚</p></li><li><p>åˆ†ç»„æ±‚å’Œ</p><p>å…¶å®å°±æ˜¯åŠ æ³•ç»“åˆå¾‹ã€‚ä¾‹å¦‚æ±‚ $a_n = 2^n + n$ çš„å‰ç¼€å’Œã€‚</p></li><li><p>å¹¶é¡¹æ±‚å’Œ</p><p>å…¶å®ä¹Ÿæ˜¯åŠ æ³•ç»“åˆå¾‹ã€‚ä¾‹å¦‚æ±‚ $a_n = (-1) f(n)$ çš„å‰ç¼€å’Œï¼Œå¯ä»¥æŠŠå¥‡å¶é¡¹åˆ†åˆ«æ±‚å’Œå†ç›¸åŠ ã€‚</p></li><li><p>é”™ä½ç›¸å‡</p><p>é€‚ç”¨äºç­‰äºç­‰å·®æ•°åˆ—ä¹˜ä»¥ç­‰æ¯”æ•°åˆ—çš„æ•°åˆ—æ±‚å’Œï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ¨å¯¼ç­‰æ¯”æ•°åˆ—æ±‚å’Œå…¬å¼ã€‚ä¾‹å¦‚æ±‚ $a_n = n \cdot 2^n$ çš„å‰ç¼€å’Œã€‚</p><script type="math/tex; mode=display">\begin{align}& \begin{split}S_n &= 1 \cdot 2^1 + \ &  2 \cdot 2^2 + 3 \cdot 2^3 + \cdots + n \cdot 2^n \\2S_n &= &1 \cdot 2^2 + 2 \cdot 2^3 + \cdots + (n - 1) 2^n + n \cdot 2^{n + 1}\end{split} \\& (1 - 2)S_n = 2 + (2^2 + 2^3 + \cdots + 2^n) - n \cdot 2^{n + 1} \\& -S_n = 2^{n + 1} - 2 - n \cdot 2^{n + 1} \\& S_n = (n - 1)2^{n + 1} + 2\end{align}</script></li><li><p>è£‚é¡¹ç›¸æ¶ˆ</p><p>æŠŠæ•°åˆ—çš„é€šé¡¹æ‹†æˆä¸¤é¡¹ä¹‹å·®ï¼Œåœ¨å’Œå¼ä¸­æŸäº›é¡¹å¯ä»¥ç›¸äº’æŠµæ¶ˆï¼Œä»è€Œæ±‚å¾—å’Œã€‚è§<a href="#è£‚é¡¹å…¬å¼">è£‚é¡¹å…¬å¼</a>ã€‚</p></li></ul><hr><h2 id="ç«‹ä½“å‡ ä½•"><a href="#ç«‹ä½“å‡ ä½•" class="headerlink" title="ç«‹ä½“å‡ ä½•"></a>ç«‹ä½“å‡ ä½•</h2><p>è¿™ä¸€å—å¤ªæ°´çš„ä¸œè¥¿å°±ä¸å†™äº†ã€‚åƒä»€ä¹ˆ<em>é•¿æ–¹ä½“è¾¹é•¿å’Œå†…åˆ‡çƒã€å¤–åˆ‡çƒåŠå¾„çš„å…³ç³»</em>ï¼Œ<em>æ­£å››æ£±é”¥è¾¹é•¿å’Œè¡¨é¢ç§¯ã€ä½“ç§¯ã€å†…åˆ‡çƒå¤–æ¥çƒåŠå¾„çš„å…³ç³»</em>ä¹‹ç±»çš„ï¼Œçæ¨å°±èƒ½å‡ºæ¥ï¼Œéƒ½å†™äº†æ²¡æ„æ€ï¼Œå½“æˆç»“è®ºè®°å¯¹è„‘å­ä¹Ÿä¸å¥½ã€‚</p><p>ååŠæ®µèƒ½ç”¨å‘é‡åšçš„é¢˜ä¹Ÿä¸ä¼šæœ‰å•¥ç»“è®ºå€¼å¾—å­¦ï¼Œæœ‰ç”¨çš„ä¸œè¥¿åº”è¯¥éƒ½ä¼šå†™åœ¨é¢˜ç›®éƒ¨åˆ†ã€‚</p><h3 id="æ£±é”¥å’Œçƒ"><a href="#æ£±é”¥å’Œçƒ" class="headerlink" title="æ£±é”¥å’Œçƒ"></a>æ£±é”¥å’Œçƒ</h3><p>ç»å¸¸ä¼šæœ‰é¢˜ç›®æŠŠæ£±é”¥å’Œçƒï¼ˆå†…åˆ‡çƒã€å¤–æ¥çƒï¼‰è”ç³»èµ·æ¥ï¼ˆæ¯”å¦‚ 2019 å…¨å›½ I å· T12ï¼‰ã€‚</p><ul><li><p>æœ‰äº›æŠŠæ£±é”¥æ”¾è¿›å¤–æ¥çƒçš„é¢˜ç›®ï¼Œå¯ä»¥æŠŠæ£±é”¥æ”¾è¿›é•¿æ–¹ä½“æ¥æ›´æ–¹ä¾¿åœ°æ±‚å‡ºçƒå¤–æ¥çƒçš„åŠå¾„ã€‚</p><ul><li>è¯¦è§<a href="#å°é¢˜é¢˜">å°é¢˜é¢˜</a>ç¬¬äºŒé¢˜ã€‚</li><li>å½“ç„¶æ›´å¤šçš„é¢˜æ£±é”¥è‡ªèº«æ€§è´¨æ”¾ä¸è¿›é•¿æ–¹ä½“é‡Œï¼Œè¿™æ ·å°±åªèƒ½å‹¾è‚¡å®šç†çˆ†ç®—äº†ã€‚</li></ul></li><li><p>å¯¹äºæŠŠå†…åˆ‡çƒæ”¾è¿›æ£±é”¥çš„é¢˜ç›®ï¼Œå¯ä»¥é€šè¿‡å…¶ä½“ç§¯ $V$ å’Œè¡¨é¢ç§¯ $S$ æ¥æ›´æ–¹ä¾¿åœ°æ±‚å‡ºå†…åˆ‡çƒçƒçš„åŠå¾„ $r$ï¼š$\frac 13 Sr = V$ã€‚</p><ul><li>è¿™ä¸ªå¼å­çš„æ„ä¹‰è€ƒè™‘æŠŠæ£±é”¥åˆ†å‰²æˆè‹¥å¹²ä¸ªä»¥å†…åˆ‡çƒåŠå¾„ä¸ºé«˜çš„ä¸‰æ£±é”¥ä¸€å¹¶æ±‚å‡ºä½“ç§¯ã€‚</li></ul><hr></li><li><p>çƒå¿ƒä¸ä»»æ„ä¸€ä¸ªæˆªé¢åœ†åœ†å¿ƒçš„è¿çº¿å‚ç›´äºæˆªé¢åœ†ã€‚ç»å¸¸ç”±æ­¤æ€§è´¨ç¡®å®šçƒå¿ƒçš„ä½ç½®ã€‚</p></li></ul><hr><h3 id="ç‚¹ã€ç›´çº¿å’Œå¹³é¢"><a href="#ç‚¹ã€ç›´çº¿å’Œå¹³é¢" class="headerlink" title="ç‚¹ã€ç›´çº¿å’Œå¹³é¢"></a>ç‚¹ã€ç›´çº¿å’Œå¹³é¢</h3><p><em>å¤šçœ‹å‡ éä¹Ÿä¸é”™</em></p><ul><li>å…¬ç†<ul><li>å¦‚æœä¸€æ¡ç›´çº¿ä¸Šçš„ä¸¤ç‚¹åœ¨åŒä¸€ä¸ªå¹³é¢å†…ï¼Œé‚£ä¹ˆè¿™æ¡ç›´çº¿åœ¨æ­¤å¹³é¢å†…ã€‚<ul><li>$A \in l, B \in l, A \in \alpha, B \in \alpha \Longrightarrow l \in \alpha$</li></ul></li><li>è¿‡ä¸åœ¨åŒä¸€æ¡ç›´çº¿ä¸Šçš„ä¸‰ç‚¹ï¼Œæœ‰ä¸”åªæœ‰ä¸€ä¸ªå¹³é¢ã€‚<ul><li>è¿‡ä¸€æ¡ç›´çº¿å’Œè¿™æ¡ç›´çº¿å¤–ä¸€ç‚¹æœ‰ä¸”åªæœ‰ä¸€ä¸ªå¹³é¢ã€‚</li><li>è¿‡ä¸¤æ¡ç›¸äº¤ç›´çº¿æœ‰ä¸”åªæœ‰ä¸€ä¸ªå¹³é¢ã€‚</li><li>è¿‡ä¸¤æ¡å¹³è¡Œç›´çº¿æœ‰ä¸”åªæœ‰ä¸€ä¸ªå¹³é¢ã€‚</li></ul></li><li>å¦‚æœä¸¤ä¸ªä¸é‡åˆçš„å¹³é¢æœ‰ä¸€ä¸ªå…¬å…±ç‚¹ï¼Œé‚£ä¹ˆå®ƒä»¬æœ‰ä¸”åªæœ‰ä¸€æ¡è¿‡è¯¥ç‚¹çš„å…¬å…±ç›´çº¿ã€‚<ul><li>$P \in \alpha, P \in \beta \Longrightarrow \alpha \cap \beta = l, P \in l$</li></ul></li><li>å¹³è¡ŒäºåŒä¸€æ¡ç›´çº¿çš„ä¸¤æ¡ç›´çº¿äº’ç›¸å¹³è¡Œã€‚<ul><li>$a \parallel b, a \parallel c \Longrightarrow b \parallel c$</li></ul></li></ul></li><li>è¿‡å¹³é¢å¤–ä¸€ç‚¹å’Œå¹³é¢å†…ä¸€ç‚¹çš„ç›´çº¿ä¸å¹³é¢å†…ä¸è¿‡è¯¥ç‚¹çš„ç›´çº¿æ˜¯å¼‚é¢ç›´çº¿ã€‚</li></ul><hr><h2 id="ä¸ç­‰å¼"><a href="#ä¸ç­‰å¼" class="headerlink" title="ä¸ç­‰å¼"></a>ä¸ç­‰å¼</h2><h3 id="å‡å€¼ä¸ç­‰å¼"><a href="#å‡å€¼ä¸ç­‰å¼" class="headerlink" title="å‡å€¼ä¸ç­‰å¼"></a>å‡å€¼ä¸ç­‰å¼</h3><p>è®¾ $x_1, x_2, \cdots, x_n \in \R_+$ï¼Œåˆ™</p><script type="math/tex; mode=display">\frac 1n \sum_{i = 1}^n x_i \ge \sqrt[n]{ \prod_{i = 1}^n{x_i}} \tag{1}</script><p>å½“ä¸”ä»…å½“ $x_1 = x_2 = \cdots = x_n$ æ—¶å–ç­‰å·ã€‚</p><p><strong>è¯æ˜</strong></p><p>$n = 1$ æ—¶æ˜¾ç„¶æˆç«‹ã€‚</p><p>å¼•ç†ï¼š$\forall a, b \in \R_+, \frac 12(a  + b) \ge \sqrt{ab}$ï¼Œå½“ä¸”ä»…å½“ $a = b$ æ—¶å–ç­‰å·ã€‚å¼•ç†çš„è¯æ˜é€šè¿‡åŸºæœ¬ä¸ç­‰å¼ $\forall a, b \in R, a^2 + b^2 \ge 2ab$ã€‚å½“ $a, b \ge 0$ æ—¶ä»¥ $\sqrt a, \sqrt b$ å–ä»£ $a, b$ã€‚è¿™æ ·å°±è¯æ˜äº† $(1)$ å¼å½“ $n = 2$ æ—¶æˆç«‹ã€‚</p><p>è€ƒè™‘æ•°å­¦å½’çº³æ³•ã€‚è‹¥ $n = k \ (k \ge 2)$ çš„æƒ…å†µæˆç«‹ï¼Œå¯¹äº $n = k + 1$  çš„æƒ…å†µï¼Œè€ƒè™‘å°† $(1)$ å¼å·¦å³åˆ†åˆ«æå‡ºå‰ $k$ é¡¹çš„å’Œæˆ–ç§¯ï¼Œæ•…è€Œ $n = k + 1$ çš„æƒ…å†µä¹Ÿæˆç«‹ã€‚$\square$</p><h3 id="æŸ¯è¥¿ä¸ç­‰å¼"><a href="#æŸ¯è¥¿ä¸ç­‰å¼" class="headerlink" title="æŸ¯è¥¿ä¸ç­‰å¼"></a>æŸ¯è¥¿ä¸ç­‰å¼</h3><p>è®¾ $a_1, a_2, \cdots, a_n, b_1, b_2, \cdots, b_n \in \R$ï¼Œåˆ™</p><script type="math/tex; mode=display">\sum_{i = 1}^n{a_i^2} \sum_{i = 1}^n{b_i^2} \ge \left( \sum_{i = 1}^n{a_i b_i} \right)^2</script><p>ç­‰å·æˆç«‹æ¡ä»¶ï¼š$\frac{a_1}{b_1} = \frac{a_2}{b_2} = \cdots = \frac{a_n}{b_n}$ï¼Œæˆ– $b_i = 0$ã€‚</p><p><strong>è¯æ˜</strong></p><p>ä»¤ $f_i(x) = (a_i x + b_i)^2$ï¼Œåˆ™ $f(x) = \sum_{i = 1}^n{f_i(x)} \ge 0$ã€‚å› æ­¤å…¶åˆ¤åˆ«å¼ $\Delta = 4 \left( \sum_{i = 1}^n{x_i y_i} \right)^2 - 4 \left( \sum_{i = 1}^n{x_i^2} \right) \left( \sum_{i = 1}^n{y_i^2} \right) \le 0$ã€‚åŒ–ç®€å³å¾—æŸ¯è¥¿ä¸ç­‰å¼ã€‚$\square$</p><p>å½“ç„¶ä¹Ÿå¯ä»¥ç”¨å‘é‡è¯ã€‚</p><p><strong>äºŒç»´å½¢å¼</strong></p><script type="math/tex; mode=display">(a^2 + b^2)(c^2 + d^2) \ge (ac + bd)^2</script><p><strong>æ¨å¹¿å½¢å¼</strong></p><script type="math/tex; mode=display">\prod_{i = 1}^n{ \sum_{j = 1}^m{ x_{i, j}}} \ge \left( \sum_{j = 1}^m{ \left( \prod_{i = 1}^n{x_{i, j}} \right)^{ \frac 1n}} \right)^n</script><p><strong>æ¨è®º</strong></p><p>å°äºæ–¹å‘</p><script type="math/tex; mode=display">|a_1 b_1 + a_2 b_2 + \cdots + a_n b_n| \le \sqrt{a_1^2 + a_2^2 + \cdots + a_n^2} \cdot \sqrt{b_1^2 + b_2^2 + \cdots + b_n^2} \\\sqrt{a_1 b_1} + \sqrt{a_2 b_2} + \cdots + \sqrt{a_n b_n} \le \sqrt{a_1 + a_2 + \cdots + a_n} \cdot \sqrt{b_1 + b_2 + \cdots + b_n} \\|A \sin x + B \cos x| \le \sqrt{A^2 + B^2}</script><p>å¤§äºæ–¹å‘</p><script type="math/tex; mode=display">(a_1 + a_2 + \cdots + a_n) \left( \frac 1{a_1} + \frac 1{a_2} + \cdots + \frac 1{a_n} \right) \ge n^2</script><p><strong>æ¨è®º - æƒæ–¹å’Œä¸ç­‰å¼</strong></p><script type="math/tex; mode=display">\frac{a_1^2}{b_1} + \frac{a_2^2}{b_2} + \cdots + \frac{a_n^2}{b_n} \ge \frac{(a_1 + a_2 + \cdots + a_n)^2}{b_1 + b_2 + \cdots + b_n} \\\frac{a_1^{m + 1}}{b_1^m} + \frac{a_{m + 1}^{m + 1}}{b_2^m} + \cdots + \frac{a_n^{m + 1}}{b_n^m} \ge \frac{(a_1 + a_2 + \cdots + a_n)^{m + 1}}{(b_1 + b_2 + \cdots + b_n)^m}</script><h3 id="æ’åºä¸ç­‰å¼"><a href="#æ’åºä¸ç­‰å¼" class="headerlink" title="æ’åºä¸ç­‰å¼"></a>æ’åºä¸ç­‰å¼</h3><p>è®¾ $a_1 \le a_2 \le \cdots \le a_n, \ b_1 \le b_2 \le \cdots \le b_n$ï¼Œ$\{c_n\}$ æ˜¯ $\{b_n\}$ çš„ä¸€ä¸ªæ’åˆ—ã€‚è‹¥</p><script type="math/tex; mode=display">\begin{split}S_1 & = a_1 b_n + a_2 b_{n - 1} + \cdots + a_n b_1 \\S_2 & = a_1 b_1 + a_2 b_2 + \cdots + a_n b_n \\S_3 & = a_1 c_1 + a_2 c_2 + \cdots + a_n c_n\end{split}</script><p>åˆ™æœ‰ $S_1 \le S_3 \le S_2$ã€‚</p><h3 id="å…¶ä»–çš„ä¸ç­‰å¼"><a href="#å…¶ä»–çš„ä¸ç­‰å¼" class="headerlink" title="å…¶ä»–çš„ä¸ç­‰å¼"></a>å…¶ä»–çš„ä¸ç­‰å¼</h3><ul><li><p>è®¾ $x_1, x_2, \cdots, x_n \in \R_+$ï¼Œåˆ™</p><script type="math/tex; mode=display">\frac{x_1^2}{x_2} + \frac{x_2^2}{x_3} + \cdots + \frac{x_{n - 1}^2}{x_n} + \frac{x_n^2}{x_1} \ge x_1 + x_2 + \cdots + x_n</script><p>è¯æ˜ï¼šä¸ç­‰å¼ä¸¤è¾¹åŒæ—¶åŠ ä¸Šä¸ç­‰å¼å³è¾¹ï¼ŒåŸå‘½é¢˜è½¬åŒ–ä¸ºè¯ $\frac{x_1^2}{x_2} + x_2 \ge 2x_1$ï¼ˆå½“ä¸”ä»…å½“ $x_1 = x_2$ æ—¶å–ç­‰å·ï¼‰ï¼Œå…¶ä»–å„é¡¹åŒç†ã€‚è€Œè¿™ä¸ªä¸ç­‰å¼çš„æ­£ç¡®æ€§æ˜¯æ˜¾ç„¶çš„ï¼ˆé€šè¿‡åŸºæœ¬ä¸ç­‰å¼ï¼‰ã€‚$\square$</p></li></ul><hr><h2 id="æ‚é¡¹"><a href="#æ‚é¡¹" class="headerlink" title="æ‚é¡¹"></a>æ‚é¡¹</h2><h3 id="è£‚é¡¹å…¬å¼"><a href="#è£‚é¡¹å…¬å¼" class="headerlink" title="è£‚é¡¹å…¬å¼"></a>è£‚é¡¹å…¬å¼</h3><ul><li>$\frac 1{n(n + k)} = \frac 1k \left( \frac 1n - \frac 1{n + k} \right)$</li><li><p>$\frac 1{(2n - 1)(2n + 1)} = \frac 12 \left( \frac 1{2n - 1} - \frac1{2n + 1} \right)$</p><ul><li>ä¸Šä¸¤æ¡å…¶å®æ˜¯ä¸€ä¸ªä¸€èˆ¬å…¬å¼çš„ç‰¹æ®Šæƒ…å†µã€‚</li><li>è‹¥ $\{ a_n \}$ æ˜¯å…¬å·®ä¸º $d$ çš„ç­‰å·®æ•°åˆ—ï¼Œåˆ™ $\frac 1{a_n a_{n + 1}} = \frac 1d \left( \frac 1{a_n} - \frac 1{a_{n + 1}} \right)$ã€‚</li></ul></li><li><p>$\frac{2^n}{(2^n + 1)(2^{n + 1} + 1)} = \frac{1}{2^n + 1} - \frac{1}{2^{n + 1} + 1}$</p><ul><li>$\frac{x^n}{(x^n + k)(x^{n + 1} + k)} = \frac 1{x - 1} \left( \frac{1}{x^n + k} - \frac{1}{x^{n + 1} + k} \right)$</li></ul></li><li><p>$\frac 1{n(n + 1)(n + 1)} = \frac 12 \left( \frac 1{n(n + 1)} - \frac 1{(n + 1)(n + 2)} \right)$</p></li><li>$\frac 1{ \sqrt n - \sqrt{n + k}} = \frac 1k( \sqrt{n + k} - \sqrt n)$</li></ul><h3 id="å’Œå¼"><a href="#å’Œå¼" class="headerlink" title="å’Œå¼"></a>å’Œå¼</h3><ul><li>$\sum_{i = 1}^n{i^2} = \frac{n(n + 1)(2n + 1)}6$</li><li>$\sum_{i = 1}^n{i^3} = \left( \frac{n(n + 1)}2 \right)^2$</li></ul><h3 id="ä¸ç­‰å¼-1"><a href="#ä¸ç­‰å¼-1" class="headerlink" title="ä¸ç­‰å¼"></a>ä¸ç­‰å¼</h3><ul><li>$e^x \ge x + 1$ï¼Œå½“ä¸”ä»…å½“ $x = 0$ æ—¶å–ç­‰å·ã€‚</li><li>$e^x \ge ex$ï¼Œå½“ä¸”ä»…å½“ $x = 1$ æ—¶å–ç­‰å·ã€‚</li><li>$\ln x \le x - 1$ï¼Œå½“ä¸”ä»…å½“ $x = 1$ æ—¶å–ç­‰å·ã€‚</li><li>$\ln x \ge 1 - \frac 1x$ï¼Œå½“ä¸”ä»…å½“ $x = 1$ æ—¶å–ç­‰å·ã€‚</li></ul><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><ul><li>ç«‹æ–¹å’Œå·®å…¬å¼ï¼š$a^3 \pm b^3 = (a \pm b)(a^2 \mp ab + b^2)$</li><li>å·²çŸ¥ $f(x)$ æ˜¯å®šä¹‰åœ¨ $\R$ ä¸Šçš„å‡½æ•°ï¼š<ul><li>è‹¥ $f(a + x) = f(b - x)$ æ’æˆç«‹ï¼Œåˆ™ $y = f(x)$ çš„å›¾åƒå…³äºç›´çº¿ $x = \frac{a + b}2$ å¯¹ç§°ã€‚</li><li>è‹¥ $f(a + x) + f(a - x) = 0$ æ’æˆç«‹ï¼Œåˆ™ $y = f(x)$ çš„å›¾åƒå…³äºç‚¹ $(a, 0)$ ä¸­å¿ƒå¯¹ç§°ã€‚</li><li>è‹¥ $y = f(x)$ æœ‰ä¸¤æ¡å¯¹ç§°è½´ $x = a, \ x = b$ï¼Œåˆ™ $y = f(x)$ ä¸ºå‘¨æœŸå‡½æ•°ï¼Œä¸”ä¸€ä¸ªå‘¨æœŸä¸º $2|b - a|$ã€‚</li></ul></li></ul><hr><h2 id="å°é¢˜é¢˜"><a href="#å°é¢˜é¢˜" class="headerlink" title="å°é¢˜é¢˜"></a>å°é¢˜é¢˜</h2><p>æœ‰ä¸€å †ä¸ç­‰å¼æ‚é¢˜åœ¨éš”å£<a href="Ineq-problems.md">è¿™ä¸ªæ–‡ä»¶</a>ã€‚</p><hr><ul><li><p>ï¼ˆå¤šé€‰ï¼‰å·²çŸ¥æ›²çº¿ $C: y^2 = 2x + a$ åœ¨ç‚¹ $P_n(n, \sqrt{2n + a}) \ (a &gt; 0, n \in \N)$ å¤„çš„åˆ‡çº¿ $l_n$ çš„æ–œç‡ä¸º $k_n$ï¼Œç›´çº¿ $l_n$ äº¤ $x$ è½´ã€$y$ è½´åˆ†åˆ«äºç‚¹ $A_n(x_n, 0)$ã€$B_n(0, y_n)$ï¼Œä¸” $|x_0| = |y_0|$ã€‚ä»¥ä¸‹ç»“è®ºä¸­ï¼Œæ­£ç¡®çš„ç»“è®ºæœ‰ï¼ˆï¼‰ã€‚</p><p>A. $a = 1$</p><p>B. å½“ $n \in \N^\ast$ æ—¶ï¼Œ$y_n$ çš„æœ€å°å€¼ä¸º $\frac{2 \sqrt 3}3$</p><p>C. å½“ $n \in \N^\ast$ æ—¶ï¼Œ$k_n &gt; \sqrt 2 \sin \frac 1{ \sqrt{2n + 1}}$</p><p>D. å½“ $n \in \N^\ast$ æ—¶ï¼Œè®°æ•°åˆ— $k_n$ çš„å‰ $n$ é¡¹å’Œä¸º $S_n$ï¼Œåˆ™ $S_n &lt; \sqrt 2( \sqrt{n + 1} - 1)$</p></li></ul><p>  ç­”æ¡ˆ ABDã€‚è™½ç„¶æ˜¯ä¸ªå¤§æ‚çƒ©ï¼Œä½†æ˜¯é¢˜ç¡®å®æŒºç‰›é€¼çš„ã€‚</p><p>  å› ä¸º $P_n$ çš„çºµåæ ‡ $\sqrt{2n + a} \ge 0$ï¼Œæ‰€ä»¥å¯ä»¥åªè€ƒè™‘ $y \ge 0$ çš„æƒ…å†µï¼Œå³ $y = \sqrt{2x + a}$ã€‚åˆ™ $yâ€™ = \frac 1{ \sqrt{2x + a}}$ï¼Œå³ $k_n = \frac 1{ \sqrt{2n + a}}$ã€‚å¾— $C$ åœ¨ $P_n$ å¤„çš„åˆ‡çº¿ä¸º $y - \sqrt{2n + a} = \frac 1{ \sqrt{2n + a}} (x - n)$ã€‚åˆ™æœ‰ $x_n = -n - a, \ y_n = \frac{n + a}{ \sqrt{2n + a}}$ã€‚</p><p>  Aï¼šæŠŠ $|x_0| = |y_0|$ ä»£å…¥å¾— $|-a| = \left| \frac a{\sqrt a} \right|$ï¼Œå³ $a = 1$ï¼ŒA æ­£ç¡®ã€‚ä¸”æœ‰ $x_n = -n - 1, \ y_n = \frac{n + 1}{ \sqrt{2n + 1}}, \ k_n = \frac 1{ \sqrt{2n + 1}}$ã€‚</p><p>  Bï¼šä»¤ $t = \sqrt{2n + 1} \in [\sqrt 3, +\infty )$ï¼Œä»£å…¥æ¨å¼å­å¾— $y_n = \frac 12(t + \frac 1t)$ã€‚å½“ $t = \sqrt 3$ æ—¶ $y_n$ å–æœ€å°å€¼ $\frac{2 \sqrt 3}3$ï¼ŒB æ­£ç¡®ã€‚</p><p>  Cï¼šä»¤ $u = k_n = \frac 1t \in \left(0, \frac 1{ \sqrt 3} \right], \ v(u) = \sqrt 2 \sin u - u$ï¼Œåˆ™ $vâ€™(u) = \sqrt 2 \cos u - 1$ã€‚ç”± $0 &lt; u \le \frac 1{ \sqrt 3} &lt; \frac \pi 4$ å¾— $vâ€™(u) &gt; 0$ï¼Œå³ $v(u)$ åœ¨ $\left(0, \frac 1{ \sqrt 3} \right]$ ä¸Šå•è°ƒå¢ã€‚$v(u) &gt; v(0) = 0$ï¼Œæ‰€ä»¥ $\sqrt 2 \sin u &gt; u$ æ’æˆç«‹ï¼Œå³ $k_n &lt; \sqrt 2 \sin \frac 1{ \sqrt{2n + 1}}$ï¼ŒC é”™è¯¯ã€‚</p><p>  Dï¼šå› ä¸º $\left( \frac{a + b}2 \right)^2 \le \frac{a^2 + b^2}2$ï¼ˆå½“ä¸”ä»…å½“ $a = b$ æ—¶å–ç­‰å·ï¼‰ï¼Œæ‰€ä»¥ $a + b \le \sqrt{2(a^2 + b^2)}$ã€‚å¾—åˆ° $\sqrt n + \sqrt{n + 1} \le \sqrt 2 \cdot \sqrt{n + n + 1}$ï¼Œä»è€Œ $\frac 1{ \sqrt{2n + 1}} &lt; \frac{ \sqrt 2}{ \sqrt n + \sqrt{n + 1}} = \sqrt 2( \sqrt{n + 1} - \sqrt n)$ã€‚</p><script type="math/tex; mode=display">  \begin{split}  S_n &= \frac 1{ \sqrt 3} + \frac 1{ \sqrt 5} + \cdots + \frac 1{ \sqrt{2n + 1}} \\  &< \sqrt 2(( \sqrt 2 - 1) + (\sqrt 3 - \sqrt 2) + \cdots + (\sqrt{n + 1} - \sqrt n) \\  &= \sqrt 2( \sqrt{n + 1} - 1)  \end{split}</script><p>  D æ­£ç¡®ã€‚</p><hr><ul><li>å·²çŸ¥æ­£å››é¢ä½“ $A-BCD$ çš„å¤–æ¥çƒçš„ä½“ç§¯ä¸º $8 \sqrt 6 \pi$ï¼Œæ±‚è¿™ä¸ªå››é¢ä½“çš„è¡¨é¢ç§¯ã€‚</li></ul><p>  ç­”æ¡ˆ $16 \sqrt 3$ã€‚</p><p>  æ€è·¯å¾ˆæ˜ç¡®ã€‚å¤–æ¥çƒçš„åŠå¾„ $R = \sqrt 6$ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¦æƒ³åŠæ³•æ±‚å‡ºå››é¢ä½“çš„æ£±é•¿ã€‚æœ‰ä¸¤ç§æ–¹æ³•ã€‚</p><ul><li><p>æŠŠè¿™ä¸ªçƒç”»å‡ºæ¥ï¼Œç”¨å‹¾è‚¡å®šç†æš´åŠ›ç®—ã€‚è®¾æ£±é•¿ä¸º $a$ï¼Œæ£é¼“åŠå¤©å¯ä»¥åˆ—å‡ºè¿™æ ·ä¸€ä¸ªå¼å­ï¼š$( \sqrt 6)^2 = \left( \frac{ \sqrt 3}3 a \right)^2 + \left( \frac{ \sqrt 6}3 a - \sqrt 6 \right)^2$ã€‚</p></li><li><p>æŠŠè¿™ä¸ªä¸‰æ£±é”¥æ”¾åœ¨ä¸€ä¸ªæ­£æ–¹ä½“é‡Œï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/files/img/Note/Math-1.png" style="zoom: 50%;" /></p><p>è®¾æ­£æ–¹ä½“çš„è¾¹é•¿ä¸º $a$ï¼Œåˆ™ $\sqrt 3 a = 2R$ã€‚åˆæœ‰æ£±é”¥çš„è¾¹é•¿ç­‰äºæ­£æ–¹ä½“çš„é¢å¯¹è§’çº¿é•¿ $\sqrt 2 a$ã€‚</p><p>ä¸¤ç§æ–¹æ³•éƒ½èƒ½å¾—åˆ°æ£±é”¥çš„è¾¹é•¿ä¸º $4$ï¼Œä»è€Œå…¶è¡¨é¢ç§¯ä¸º $16 \sqrt 3$ã€‚</p><p><strong>è¿™é‡Œæœ‰ä¸€ä¸ªæ€æƒ³ï¼šæŠŠæ£±é”¥æ”¾è¿›é•¿æ–¹ä½“ï¼Œæœ‰æ—¶å€™ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„æ•ˆæœã€‚</strong></p></li></ul><hr><ul><li>åœ¨ä¸‰æ£±é”¥ $P-ABC$ ä¸­ï¼Œ$AB = 5, \ BC = 3, \ CA = 4$ã€‚ä¸‰ä¸ªä¾§é¢ä¸åº•é¢æ‰€æˆçš„è§’å‡ä¸º $60^\circ$ã€‚æ±‚ä¸‰æ£±é”¥çš„å†…åˆ‡çƒçš„è¡¨é¢ç§¯ã€‚</li></ul><p>  ç­”æ¡ˆ $\frac{4 \pi}3$ã€‚</p><p>  é¦–å…ˆåº•é¢æ˜¯ä¸ªç›´è§’ä¸‰è§’å½¢ï¼Œå¯ä»¥æ±‚å‡ºå®ƒçš„å†…åˆ‡åœ†çš„åŠå¾„ã€‚åº•é¢å†…åˆ‡åœ†åŠå¾„ã€ä¾§é¢ä¸‰è§’å½¢çš„é«˜ã€æ£±é”¥çš„é«˜ç»„æˆçš„ä¸‰è§’å½¢å·²çŸ¥ä¸€æ¡è¾¹å’Œä¸¤ä¸ªè§’ï¼Œå¯è§£ã€‚äºæ˜¯å°±å¾—åˆ°äº†æ£±é”¥çš„è¡¨é¢ç§¯ $S$ å’Œä½“ç§¯ $V$ã€‚è®¾ $r$ ä¸ºå†…åˆ‡çƒåŠå¾„ï¼Œæœ‰ $\frac 13 Sr = V$ã€‚</p><hr><ul><li><p>ï¼ˆ2017 å…¨å›½ I ç†æ•° T16ï¼‰å¦‚å›¾ï¼Œåœ†å½¢çº¸ç‰‡çš„åœ†å¿ƒä¸º $O$ï¼ŒåŠå¾„ä¸º $5$ï¼Œè¯¥çº¸ç‰‡ä¸Šçš„ç­‰è¾¹ä¸‰è§’å½¢ $ABC$ çš„ä¸­å¿ƒä¸º $O$ã€‚$D, \ E, \ F$ ä¸ºåœ† $O$ ä¸Šçš„ç‚¹ï¼Œ$\triangle DBC, \ \triangle ECA, \ \triangle FAB$ åˆ†åˆ«æ˜¯ä»¥ $BC, \ CA, \ AB$ ä¸ºåº•è¾¹çš„ç­‰è…°ä¸‰è§’å½¢ï¼Œæ²¿è™šçº¿å‰ªå¼€åï¼Œåˆ†åˆ«ä»¥ $BC, \ CA, \ AB$ ä¸ºæŠ˜ç—•æŠ˜èµ· $\triangle DBC, \ \triangle ECA, \ \triangle FAB$ï¼Œä½¿å¾— $D, \ E, \ F$ é‡åˆï¼Œå¾—åˆ°ä¸‰æ£±é”¥ã€‚å½“ $\triangle ABC$ çš„è¾¹é•¿å˜åŒ–æ—¶ï¼Œæ±‚æ‰€å¾—ä¸‰æ£±é”¥ä½“ç§¯çš„æœ€å¤§å€¼ã€‚</p><p><img src="/files/img/Note/Math-2.png" style="zoom: 50%;" /></p></li></ul><p>  ç­”æ¡ˆ $4 \sqrt{15}$ã€‚å¦‚å›¾ï¼Œè¿æ¥ $OD$ äº¤ $BC$ äºç‚¹ $G$ã€‚</p><p>  <img src="/files/img/Note/Math-3.png" style="zoom: 50%;" /></p><p>  æ˜¾ç„¶æœ‰ $OD \perp BC$ã€‚è®¾ $OG = x$ï¼Œåˆ™ $BC = 2 \sqrt 3 x, \ DG = 5 - x$ã€‚ä¸‰æ£±é”¥çš„é«˜ $h = \sqrt{DG^2 - OG^2} = \sqrt{25 - 10x}$ã€‚$V = \frac 13 Sh = \sqrt 3 \cdot \sqrt{25x^4 - 10x^5}$ã€‚ä»¤ $f(x) = 25x^4 - 10x^5 \ (0 &lt; x &lt; \frac 52)$ï¼Œå¯¼æ•°è®¨è®ºå¯å¾— $f(x)_{ \max} = f(2) = 80$ï¼Œä»è€Œå½“ $x = 2$ æ—¶ $V_{ \max} = 4 \sqrt{15}$ã€‚</p><hr><ul><li>è®¾ $a, b, c &gt; 0$ï¼Œæ±‚è¯ï¼š$\frac{(a + 1)^3}b + \frac{(b + 1)^3}c + \frac{(c + 1)^2}a \ge \frac{81}4$ã€‚</li></ul><p>  è¿™æ˜¯ä¸ªè½®æ¢å¼ï¼Œå–ç­‰å·æ—¶ä¸€å®šæ˜¯ä¸‰é¡¹ç›¸ç­‰ï¼Œéƒ½ç­‰äº $\frac{27}4$ã€‚æ­¤æ—¶ $a = b = c = \frac 12$ã€‚åˆ©ç”¨è¿™ä¸ªå¯ä»¥è¿›è¡Œæ„é€ ã€‚</p><p>  è¯æ˜ï¼šæ ¹æ®å‡å€¼ä¸ç­‰å¼ï¼Œ$\frac{(a + 1)^3}b + \frac{27}2 b + \frac{27}4 \ge 3 \sqrt[3]{ \frac{3^6 (a + 1)^3}{2^3}} = \frac{27(a + 1)}2$ï¼Œå½“ä¸”ä»…å½“ $a = b = \frac 12$ æ—¶å–ç­‰å·ã€‚å…¶ä»–ä¸¤å¼åŒç†ã€‚ä¸‰å¼ç›¸åŠ å¾—åˆ° $\mathrm{L.H.S.} + \frac{27}2(a + b + c) + \frac{81}4 \ge \frac{27}2(a + b + c) + \frac{81}2$ã€‚å½“ä¸”ä»…å½“ $a = b = c = \frac 12$ æ—¶å–ç­‰å·ã€‚$\square$</p><p>  è¿™é‡Œ $\frac{(a + 1)^3}b + \frac{27}2 b + \frac{27}4$ è¿™ä¸‰é¡¹æ˜¯æ€ä¹ˆæ¥çš„å‘¢â€¦ç¬¬ä¸€é¡¹æ˜¯å·²çŸ¥çš„å¯¹å§ï¼Œæˆ‘ä»¬è¦è®©å®ƒå¼€ä¸‰æ¬¡æ ¹å·ï¼Œè‚¯å®šè¦æ„é€ ä¸‰é¡¹ã€‚æˆ‘ä»¬å·²çŸ¥ä¸‰ä¸ªæ•°çš„å€¼ï¼Œå¹¶ä¸”è¦è®©æ„é€ å‡ºçš„ä¸‰é¡¹éƒ½ç­‰äº $\frac{27}4$ã€‚å› ä¸ºè¿™æ ·æœ€åä¸‰å¼ç›¸åŠ ï¼Œä¸¤è¾¹éƒ½æ˜¯ $3 \times \frac{81}4$ã€‚</p><p>  <strong>è¿™é‡Œåˆ©ç”¨äº†å‡å€¼ä¸ç­‰å¼çš„æ·»é¡¹æ–¹æ³•ã€‚</strong></p><hr><ul><li>è®¾ $a, b, c &gt; 0, \ a + b + c = 1$ã€‚æ±‚è¯ï¼š$\left(1 + \frac 1a \right) \left(1 + \frac 1b \right) \left(1 + \frac 1c \right) \ge 64$ã€‚</li></ul><p>  è¿™ä¸ªæ˜¾ç„¶æ˜¯ $a = b = c = \frac 13$ æ—¶å–ç­‰å·ã€‚</p><p>  è¯æ˜ï¼šæ ¹æ®åŸºæœ¬ä¸ç­‰å¼ï¼Œ$1 + \frac 1a = 1 + \frac 1{3a} + \frac 1{3a} + \frac 1{3a} \ge 4 \sqrt[4]{ \frac 1{27a^3}}$ï¼Œå½“ä¸”ä»…å½“ $a = \frac 13$ æ—¶å–ç­‰å·ã€‚å…¶ä»–ä¸¤å¼åŒç†ã€‚ä¸‰å¼ç›¸ä¹˜å¾—åˆ° $\mathrm{L.H.S.} \ge 64 \sqrt[4]{ \frac 1{3^9 a^3 b^3 c^3}}$ï¼Œå½“ä¸”ä»…å½“ $a = b = c = \frac 13$ æ—¶å–ç­‰å·ã€‚åˆæœ‰ $3 \sqrt[3]{abc} \le a + b + c = 1$ï¼Œæ‰€ä»¥ $(abc)^3 \le \frac 1{3^9}$ï¼Œå½“ä¸”ä»…å½“ $a = b = c = \frac 13$ æ—¶å–ç­‰å·ã€‚$\square$</p><p>  <strong>è¿™é‡Œåˆ©ç”¨äº†å‡å€¼ä¸ç­‰å¼çš„æ‹†é¡¹æ–¹æ³•ã€‚</strong></p><hr>]]></content>
      
      
      <categories>
          
          <category> æ–‡åŒ–è¯¾ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2020 June Records</title>
      <link href="/2020/2020-June-Records/"/>
      <url>/2020/2020-June-Records/</url>
      
        <content type="html"><![CDATA[<p>èœé¸¡ fa_555 ä¼šæŠŠä¸€äº›åŠ¨æ€ç®€è¦åœ°è®°åœ¨è¿™é‡Œã€‚ä¸»è¦è¿˜æ˜¯ç•™ç»™è‡ªå·±ä»¥åçœ‹çš„ã€‚</p><span id="more"></span><p><em>æ‰€æœ‰ä»£ç ä¸ä¿è¯åŒ…æ‹¬æ— å…³ç´§è¦çš„éƒ¨åˆ†</em></p><hr><p>ä¸´è¿‘çœé€‰ï¼Œä¸ä¼šè®°å¤ªå¤šçš„ä¸œè¥¿ã€‚</p><hr><h3 id="YYçš„GCD"><a href="#YYçš„GCD" class="headerlink" title="YYçš„GCD"></a><a href="https://www.luogu.com.cn/problem/P2257">YYçš„GCD</a></h3><h4 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®š $n, m \ (1 \le n, m \le 10^7)$ï¼Œæ±‚ $1 \le x \le n, 1 \le y \le m$ ä¸” $\gcd(x, y)$ ä¸ºè´¨æ•°çš„ $(x, y)$ æœ‰å¤šå°‘å¯¹ã€‚$T \ (1 \le T \le 10^4)$ ç»„æ•°æ®ã€‚</p><h4 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h4><p>ä¸å¦¨è®¾ $n \le m$ã€‚è®¾ $t = pd$ã€‚</p><script type="math/tex; mode=display">\begin{aligned}& \sum_{i = 1}^n{ \sum_{j = 1}^n{[ \gcd(i, j) \in \mathbb P]}} \\=& \sum_{p \in \mathbb P}{ \sum_{i = 1}^n{ \sum_{j = 1}^n{[ \gcd(i, j) = p]}}} \\=& \sum_{p \in \mathbb P}{ \sum_{i = 1}{ \lfloor n / p \rfloor}{ \sum_{j = 1}{ \lfloor m / p \rfloor}{[ \gcd(i, j) = 1]}}} \\=& \sum_{p \in \mathbb P}{ \sum_{i = 1}{ \lfloor n / p \rfloor}{ \sum_{j = 1}{ \lfloor m / p \rfloor}{ \sum_{d \mid \gcd(i, j)}{ \mu(d)}}}} \\=& \sum_{p \in \mathbb P}{ \sum_{d = 1}{ \lfloor n / p \rfloor}{ \mu(d) \left \lfloor \frac n{pd} \right \rfloor \left \lfloor \frac m{pd} \right \rfloor}} \\=& \sum_{p \in \mathbb P}{ \sum_{d = 1}{ \lfloor n / p \rfloor}{ \mu(d) \left \lfloor \frac nt \right \rfloor \left \lfloor \frac mt \right \rfloor}} \\=& \sum_{t = 1}^n{ \left \lfloor \frac nt \right \rfloor \left \lfloor \frac mt \right \rfloor \sum_{p \in \mathbb P, p \mid t}{ \mu \left( \frac tp \right)}}\end{aligned}</script><p>è®¾ $f(x) = \sum_{p \in \mathbb P, p \mid t}{ \mu(t / p)}$ï¼Œåˆ™ $f(x)$ å¯ä»¥ç”¨åŸƒç­›åœ¨ $O(n \log \log n)$ çš„æ—¶é—´å†…ç­›å‡ºï¼Œç­”æ¡ˆå¯ä»¥æ•°è®ºåˆ†å—å•æ¬¡ $O( \sqrt n)$ è¯¢é—®ã€‚</p><h4 id="code"><a href="#code" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/34298758">code</a></h4><hr><h3 id="æ— å¹³æ–¹å› å­æ•°"><a href="#æ— å¹³æ–¹å› å­æ•°" class="headerlink" title="æ— å¹³æ–¹å› å­æ•°"></a>æ— å¹³æ–¹å› å­æ•°</h3><h4 id="problem-1"><a href="#problem-1" class="headerlink" title="problem"></a>problem</h4><p>æ±‚å°äºç­‰äº $n$ çš„æ— å¹³æ–¹å› å­æ•°çš„ä¸ªæ•°ï¼Œå³æ±‚ $\sum_{i = 1}^n{ \mu^2(i)}$ã€‚</p><h4 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h4><p>è€ƒè™‘ä¸€ä¸ªç´ æ•° $p$ï¼Œé‚£ä¹ˆ $p^2$ çš„å€æ•°éƒ½æœ‰å¹³æ–¹å› å­ï¼Œä¸ªæ•°æ˜¯ $\lfloor n / p^2 \rfloor$ï¼Œåº”è¯¥ä»ç­”æ¡ˆä¸­å»æ‰ã€‚</p><p>ä½†æ˜¯è¿™æ ·åˆå¤šå»æ‰äº†ä¸€äº›æ•°ã€‚æ¯”å¦‚å¯¹äºä¸åŒçš„ç´ æ•° $p_1, p_2$ï¼Œ$p_1^2 p_2^2$ å°±è¢«å»æ‰äº†ä¸¤æ¬¡ï¼Œä¸ªæ•°æ˜¯ $\lfloor n / (p_1^2 p_2^2) \rfloor$ï¼Œåº”è¯¥åŠ å›æ¥ã€‚æ˜¾ç„¶è¿™å°±æ˜¯å®¹æ–¥åŸç†ã€‚</p><p>å¦‚æœ $d$ æ˜¯ $s$ ä¸ªä¸åŒç´ æ•°çš„ä¹˜ç§¯ï¼Œé‚£ä¹ˆå…¶å¯¹ç­”æ¡ˆçš„è´¡çŒ®æ˜¯ $(-1)^s \lfloor n / d^2 \rfloor$ï¼›å¦‚æœ $d$ ä¸æ˜¯ä¸åŒç´ æ•°çš„ä¹˜ç§¯ï¼Œå³ $d$ æœ‰å¹³æ–¹å› å­ï¼Œé‚£ä¹ˆ $d$ å¯¹ç­”æ¡ˆæ²¡æœ‰è´¡çŒ®ã€‚</p><p>å®¹æ–¥çš„ç³»æ•°æ°å¥½æ˜¯ Mobius å‡½æ•°ã€‚å› æ­¤ç­”æ¡ˆå°±æ˜¯</p><script type="math/tex; mode=display">\sum_{i = 1}^n{ \mu^2(i)} = \sum_{d = 1}^\sqrt n{ \mu(d) \left \lfloor \frac n{d^2} \right \rfloor}</script><p>äº‹å®ä¸Šï¼ŒMobius åæ¼”æœ¬èº«å°±å¯ä»¥çœ‹æˆæ˜¯å¯¹æ•´é™¤å…³ç³»çš„å®¹æ–¥ã€‚</p><hr><h4 id="SDOI2014-æ•°è¡¨"><a href="#SDOI2014-æ•°è¡¨" class="headerlink" title="[SDOI2014]æ•°è¡¨"></a><a href="https://www.luogu.com.cn/problem/P3312">[SDOI2014]æ•°è¡¨</a></h4><h4 id="solution-2"><a href="#solution-2" class="headerlink" title="solution"></a>solution</h4><p>ä¸å¦¨è®¾ $n \le m$ã€‚è®¾ $t = dg$ã€‚</p><script type="math/tex; mode=display">\begin{align}& \sum_{i = 1}^n{ \sum_{j = 1}^m{ \sigma( \gcd(i, j))}} \\=& \sum_{d = 1}^n{ \sigma(d) \sum_{i = 1}^{ \lfloor n / d \rfloor}{ \sum_{j = 1}^{ \lfloor m / d \rfloor}{[ \gcd(i, j) = 1]}}} \\=& \sum_{d = 1}^n{ \sigma(d) \sum_{i = 1}^{ \lfloor n / d \rfloor}{ \sum_{j = 1}^{ \lfloor m / d \rfloor}{ \sum_{g \mid \gcd(i, j)}{ \mu(g)}}}} \\=& \sum_{d = 1}^n{ \sigma(d) \sum_{g = 1}^{ \lfloor n / d \rfloor}{ \mu(g) \left \lfloor \frac n{dg} \right \rfloor \left \lfloor \frac m{dg} \right \rfloor}} \\=& \sum_{t = 1}^n{ \left \lfloor \frac nt \right \rfloor \left \lfloor \frac mt \right \rfloor \sum_{d | T}{ \sigma(d) \mu \left( \frac td \right)}}\end{align}</script><p>å¦‚æœæ²¡æœ‰ $a$ çš„é™åˆ¶è¿™é¢˜å°±åšå®Œäº†ã€‚</p><p>è®¾ $f(t) = \sum_{d | T}{ \sigma(d) \mu(t / d)}$ï¼Œåˆ™å½“ $\sigma(d) \le a$ æ—¶æ‰ä¼šå¯¹ $f$ äº§ç”Ÿè´¡çŒ®ã€‚</p><p>å°†è¯¢é—®ç¦»çº¿ï¼ŒæŒ‰ $a$ å‡åºæ’åºã€‚æ¯æ¬¡åŠ å…¥ä¼šå¯¹ $f$ äº§ç”Ÿå½±å“çš„ $\sigma(d)$ã€‚</p><p>ç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ $f$ï¼Œæ¯æ¬¡æš´åŠ›åŠ å…¥æ‰€æœ‰ $\sigma(d) \le a$ çš„ $d$ï¼Œå³ä»¤æ‰€æœ‰æ»¡è¶³ $kd \le n$ çš„ $f(kd)$ å¢åŠ  $\sigma(d) \mu(k)$ã€‚</p><p>é¢„å¤„ç† $O(n)$ï¼Œä¿®æ”¹ $O(n \log^2 n)$ï¼ŒæŸ¥è¯¢å•æ¬¡ $O( \sqrt n \log n)$ã€‚</p><h4 id="code-1"><a href="#code-1" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/problem/P3312">code</a></h4><hr><h3 id="SDOI2014-é‡å»º"><a href="#SDOI2014-é‡å»º" class="headerlink" title="[SDOI2014]é‡å»º"></a><a href="https://www.luogu.com.cn/problem/P3317">[SDOI2014]é‡å»º</a></h3><h4 id="problem-2"><a href="#problem-2" class="headerlink" title="problem"></a>problem</h4><p>$n \ (1 \le n \le 50)$ ä¸ªç‚¹ï¼Œè‹¥å¹²æ¡è¾¹ï¼Œæ¯æ¡è¾¹æœ‰ä¸€å®šå‡ ç‡ä¿ç•™ï¼Œæ±‚ä¿ç•™ä¸€æ£µæ ‘çš„æ¦‚ç‡ã€‚</p><h4 id="solution-3"><a href="#solution-3" class="headerlink" title="solution"></a>solution</h4><p>è€ƒè™‘ Matrix-Tree å®šç†çš„å®è´¨ï¼š</p><p>æšä¸¾æ‰€æœ‰ç”Ÿæˆæ ‘ $T$ å’Œå…¶ä¸­çš„è¾¹ $e$ï¼Œæ±‚</p><script type="math/tex; mode=display">\sum_T{ \prod_{e \in T}{p_e}}</script><p>å…¶ä¸­ $p$ å¯ä»¥çœ‹åšè¾¹æƒæˆ–å‡ºç°æ¦‚ç‡ï¼Œå› æ­¤ $p_e = 1$ã€‚</p><p>è€Œæœ¬é¢˜è¦æ±‚çš„æ˜¯</p><script type="math/tex; mode=display">\begin{align}& \sum_T{ \left( \prod_{e \in T}{p_e} \prod_{e \not \in T}{(1 - p_e)} \right)} \\=& \sum_T{ \left( \prod_{e \in T}{p_e} \times \frac{ \prod_e{(1 - p_e)}}{ \prod_{e \in T}{(1 - p_e)}} \right)} \\=& \prod_e{(1 - p_e) \left( \sum_T{ \prod_{e \in T}{ \frac{p_e}{1 - p_e}}} \right)}\end{align}</script><p>æŠŠè¾¹æƒè®¾ä¸º $p_e / (1 - p_e)$ å³å¯ã€‚ç‰¹åˆ«åœ°ï¼Œè‹¥ $p_e = 1$ï¼Œä»¤ $p_e = 1 - \epsilon$ æ¥é¿å…é›¶ä½œé™¤æ•°ã€‚</p><h4 id="code-2"><a href="#code-2" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/34371275">code</a></h4>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ•°å…¥é—¨ç¬”è®°</title>
      <link href="/2020/counting/"/>
      <url>/2020/counting/</url>
      
        <content type="html"><![CDATA[<p>æ•°æ•°å¤ªéš¾äº†ï¼Œå­¦ä¸ä¼šæ•°æ•°ã€‚</p><span id="more"></span><p>[TOC]</p><h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><h3 id="ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°"><a href="#ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°" class="headerlink" title="ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°"></a>ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°</h3><p>$S_u(n, m)$ è¡¨ç¤º $n$ ä¸ªä¸åŒå…ƒç´ æ„æˆ $m$ çš„åœ†æ’åˆ—çš„æ–¹æ¡ˆæ•°ã€‚</p><script type="math/tex; mode=display">S_u(n, m) = S_u(n - 1, m - 1) + (n - 1) \times S_u(n - 1, m)</script><p>æœ‰ç¬¦å·ï¼š$S_s(n, m) = (-1)^{n + m} S_u(n, m)$</p><p>æœ‰ç¬¦å·ç”Ÿæˆå‡½æ•°ï¼š$x^{ \underline n}$</p><h3 id="ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°"><a href="#ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°" class="headerlink" title="ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°"></a>ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°</h3><p>$S(n, m)$ è¡¨ç¤ºæŠŠ $n$ ä¸ªä¸åŒå…ƒç´ æ‹†åˆ†æˆ $m$ ä¸ªéç©ºé›†åˆçš„æ–¹æ¡ˆæ•°ã€‚</p><script type="math/tex; mode=display">S(n, m) = S(n - 1, m - 1) + m \times S(n - 1, m) \\S(n, m) = \frac 1{m!} \sum{(-1)^k \binom mk (m - k)^n}</script><p>è´å°”æ•°ä¸ºç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ä¹‹å’Œã€‚</p><h3 id="æ‹†åˆ†æ•°"><a href="#æ‹†åˆ†æ•°" class="headerlink" title="æ‹†åˆ†æ•°"></a>æ‹†åˆ†æ•°</h3><p>$f_n$ ä»£è¡¨å¤§å°ä¸º $n$ çš„æ­£æ•´æ•°æ‹†åˆ†æˆè‹¥å¹²ä¸ªæ— åºçš„æ­£æ•´æ•°çš„å’Œçš„æ–¹æ¡ˆæ•°ã€‚</p><p>ä¸¤ç§ dpï¼Œ$f_{i, j}$ è¡¨ç¤ºæ‹†åˆ†æˆè‹¥å¹²ä¸ªå°äºç­‰äº $j$ çš„æ•°å­—çš„æ–¹æ¡ˆæ•°ï¼Œ$f_{i, j} = f_{i - j, j} + f_{i, j - 1}$ã€‚$g_{i, j}$ è¡¨ç¤ºæ‹†åˆ†æˆ $j$ ä¸ªæ•°å­—çš„æ–¹æ¡ˆæ•°ï¼Œ$g_{i, j} = g_{i - j, j} + g_{i - 1, j - 1}$ã€‚</p><p>å•ç‹¬ç”¨ä»»ä½•ä¸€ä¸ªå¤æ‚åº¦éƒ½æ˜¯ $O(n^2)$ã€‚è€ƒè™‘å¤§äº $\sqrt n$ çš„æ•°å­—åªæœ‰ $\sqrt n$ ä¸ªï¼Œç»“åˆäºŒè€…ï¼Œå¤æ‚åº¦ $O(n \sqrt n)$ã€‚</p><p>ç”Ÿæˆå‡½æ•°ï¼š$\displaystyle \frac 1{ \sum_{n = 0}^\infty{(-1)^k x^{k(3k \pm 1)}}}$</p><h2 id="å½¢å¼å¹‚çº§æ•°"><a href="#å½¢å¼å¹‚çº§æ•°" class="headerlink" title="å½¢å¼å¹‚çº§æ•°"></a>å½¢å¼å¹‚çº§æ•°</h2><p>å½¢å¦‚ $\displaystyle \sum_{n = 0}^\infty{a_n x^n}$ã€‚</p><script type="math/tex; mode=display">\sum_{n = 0}^\infty{a_n x^n} \pm \sum_{n = 0}^\infty{b_n x^n} = \sum_{n = 0}^\infty{(a_n \pm b_n) x^n} \\\sum_{n = 0}^\infty{a_n x^n} \pm \sum_{n = 0}^\infty{b_n x^n} = \sum_{n = 0}^\infty{\left( \sum_{k = 0}^n{a_k b_{n - k}}\right) x^n}</script><h3 id="é—­å½¢å¼"><a href="#é—­å½¢å¼" class="headerlink" title="é—­å½¢å¼"></a>é—­å½¢å¼</h3><p>å½¢å¼å¹‚çº§æ•°çš„è¡¨è¾¾å½¢å¼æ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºæ— ç©·çš„å¤šé¡¹å¼ï¼Œä½†æ˜¯å¯¹äºéƒ¨åˆ†çš„å½¢å¼å¹‚çº§æ•°ï¼Œå­˜åœ¨é•¿åº¦æœ‰é™çš„å‡½æ•°èƒ½å¤Ÿç›´æ¥è¡¨ç¤ºå®ƒï¼Œæˆ‘ä»¬é€šå¸¸ç§°ä¹‹ä¸ºé—­å½¢å¼ã€‚</p><p>è€ƒè™‘ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼š$\displaystyle \sum_{n = 0}^\infty{x^n} = \frac 1{1 - x}$ã€‚</p><p>æ³¨æ„åˆ°é—­å½¢å¼å…¶å®å­˜åœ¨æ”¶æ•›åŸŸçš„é—®é¢˜ã€‚ä½†å½¢å¼å¹‚çº§æ•°ä¸­ï¼Œ$x$ ä»…ä»…æ˜¯ä¸€ä¸ªç¬¦å·ï¼Œæˆ‘ä»¬å¿½ç•¥è®¨è®ºæ”¶æ•›åŸŸã€‚</p><h3 id="ä¸€äº›ä¾‹å­"><a href="#ä¸€äº›ä¾‹å­" class="headerlink" title="ä¸€äº›ä¾‹å­"></a>ä¸€äº›ä¾‹å­</h3><ul><li>$\displaystyle \sum_{n = 0}^\infty{x^n} = \frac 1{1 - x}$ï¼Œè¿™ä¸ªå¯ä»¥ç­‰æ¯”æ•°åˆ—æ±‚å’Œå…¬å¼ï¼ˆå­˜åœ¨æ”¶æ•›åŸŸï¼Œä¸è®¨è®ºï¼‰</li><li>æ˜¾ç„¶èƒ½å¾—åˆ° $\displaystyle \sum_{n = 1}^\infty{x^n} = \frac x{1 - x}$</li><li>è€ƒè™‘ $\displaystyle \sum_{n = 1}^\infty{n x^n}$ï¼Œè¿™ä¸ªæ€ä¹ˆæ±‚å‘¢ï¼Ÿ<ol><li>å¯¹ç¬¬ä¸€ä¸ªå¼å­ä¸¤è¾¹æ±‚å¯¼ï¼š$\displaystyle \left( \sum_{n = 0}^\infty{x^n}\right)â€™ = \left( \dfrac 1{1 - x}\right)â€™ \Rightarrow \sum_{n = 0}^\infty{(n + 1) x^n} = \frac 1{(1 - x)^2}$ã€‚å†ä¸¤è¾¹ä¹˜ $x$ å³å¯å¾—åˆ° $\displaystyle \sum_{n = 1}^\infty{n x^n} = \dfrac x{(1 - x)^2}$ã€‚</li><li>$\displaystyle \left( \sum_{n = 0}^\infty{x^n}\right) \ast \left( \sum_{n = 0}^\infty{x^n}\right) = \sum_{n = 0}^\infty{(n + 1) x^n} = \frac 1{(1 - x)^2}$ï¼Œå’Œä¸Šä¸€ç§æ–¹æ³•æ®Šé€”åŒå½’ã€‚</li></ol></li><li>æˆ‘ä»¬è¿˜çŸ¥é“ $\displaystyle \sum_{n = 0}^\infty{ \frac 1{n!} x^n} = e^x$ã€‚</li><li>å…¶å®ä¸Šé¢çš„å‡ ä¸ªå°±æ˜¯å„ç§ç”Ÿæˆå‡½æ•°ã€‚ä½ å·²ç»ä¸Šè´¼èˆ¹äº†ã€‚</li></ul><h2 id="ç»„åˆå¯¹è±¡"><a href="#ç»„åˆå¯¹è±¡" class="headerlink" title="ç»„åˆå¯¹è±¡"></a>ç»„åˆå¯¹è±¡</h2><p>ç»„åˆè®¡æ•°æ˜¯ä¸€ç±»å¸¸è§é—®é¢˜ï¼Œé€šå¸¸ç»™å®šæˆ‘ä»¬è‹¥å¹²ç»„åˆæ¡ä»¶ï¼Œå¯¹äºæ¯ä¸ªç»„åˆå¯¹è±¡ï¼Œæœ‰æŸä¸ªå‡½æ•° <code>size</code> è¡¡é‡äº†å®ƒçš„å¤§å°ï¼Œå¦‚å›¾çš„èŠ‚ç‚¹æ•°ï¼Œåºåˆ—çš„é•¿åº¦ç­‰ã€‚<code>size</code> ä¸º $n$ çš„æ»¡è¶³ç»„åˆæ¡ä»¶çš„ç»„åˆå¯¹è±¡ä¸ªæ•°ä¸ºæœ‰é™ä¸ªï¼Œè®°ä¸º $A_n$ ï¼Œé¢˜ç›®è¦æ±‚æŸä¸ª $A_n$ã€‚</p><p>ç»„åˆå¯¹è±¡åˆ†ä¸ºæ˜¯å¦æœ‰æ ‡å·çš„ä¸¤ç§ï¼ŒæŒ‡çš„æ˜¯æ˜¯å¦è€ƒè™‘ç»„åˆå¯¹è±¡å†…éƒ¨çš„å…ƒç´ æœ‰ä¸åŒçš„åŒºåˆ«ï¼Œä¾‹å¦‚æ— æ ‡å·çš„ä¸‰ä¸ªç‚¹çš„å›¾åªæœ‰ $4$ ç§ï¼Œè€Œæœ‰æ ‡å·çš„æœ‰ $8$ ç§ã€‚</p><h2 id="ç”Ÿæˆå‡½æ•°å¼•å…¥-äºŒé¡¹å¼å®šç†"><a href="#ç”Ÿæˆå‡½æ•°å¼•å…¥-äºŒé¡¹å¼å®šç†" class="headerlink" title="ç”Ÿæˆå‡½æ•°å¼•å…¥ - äºŒé¡¹å¼å®šç†"></a>ç”Ÿæˆå‡½æ•°å¼•å…¥ - äºŒé¡¹å¼å®šç†</h2><p>æ€ä¹ˆè®©æ–‡åŒ–è¯¾é€‰æ‰‹ä¹Ÿèƒ½ç†è§£ç”Ÿæˆå‡½æ•°å‘¢ï¼Ÿæˆ‘ä»¬ä»å¤§å®¶éƒ½ä¼šçš„äºŒé¡¹å¼å®šç†è¯´èµ·ã€‚</p><p><em>æ­¤å¤„é€‰ç”¨äº†æ‰€æœ‰äº²é«˜ä¸­ç”Ÿçš„å†™æ³•ï¼Œæ¯”å¦‚å°†ç»„åˆæ•° $\displaystyle \binom nm$ æ”¹ç”¨ $C_n^m$ è¡¨ç¤ºã€‚</em></p><p>å¦‚æœä½ å­¦è¿‡äº†é€‰ä¿® 2-3ï¼Œä½ ä¼šçŸ¥é“</p><script type="math/tex; mode=display">(1 + x)^n = C_n^0 + C_n^1 x + C_n^2 x^2 + \cdots + C_n^{n - 1} x^{n - 1} + C_n^n x^n</script><p>ç„¶åå¦‚æœä½ åšäº†ï¼ˆé«˜ä¸­æ•°å­¦è€å¸ˆåå­—éšå»ï¼‰çš„ä½œä¸šï¼Œä½ ä¼šé‡åˆ°è®©ä½ æ±‚ $C_n^0 - C_n^1 + C_n^2 - C_n^3 + \cdots + (-1)^n C_n^n$ çš„é¢˜ç›®ã€‚ä½œä¸ºä¸€åæ–‡åŒ–è¯¾é€‰æ‰‹ï¼Œä½ ç†Ÿç»ƒåœ°å°† $x = -1$ ä»£äº†è¿›å»ï¼Œå¹¶ä¸”å‘ç°ç­‰å¼å·¦è¾¹æ˜¯ $0$ï¼Œäºæ˜¯ä½ åˆåšå‡ºäº†ä¸€é“é¢˜ï¼Œæ‹¿åˆ°äº† 5 åˆ†ã€‚</p><p>ä½ æ²¡æœ‰å±€é™äºæ–‡åŒ–è¯¾å›ºå®šçš„åƒåœ¾å¥—è·¯ï¼Œå‘ç°äº†å…¶ä¸­çš„å¥¥ç§˜ã€‚ä½ å‘ç°ï¼Œè¿™ç§æ“ä½œæŠŠä¸€ä¸ªæ•°åˆ—ï¼ˆ$C_n^i$ï¼‰æ˜ å°„åˆ°äº†ä¸€ä¸ªå‡½æ•°ï¼ˆ$(x + 1)^n$ï¼‰ä¸Šã€‚ä½ å¼€å§‹æ€è€ƒï¼Œæ˜¯ä¸æ˜¯å…¶ä»–çš„æ•°åˆ—ä¹Ÿå¯ä»¥è¿™ä¹ˆæ“ä½œå‘¢ï¼Ÿ</p><p>æ­å–œä½ ï¼Œä½ å‘ç°äº†<strong>ç”Ÿæˆå‡½æ•°</strong>ã€‚é€šè¿‡ç”Ÿæˆå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•°åˆ—çš„è¿ç®—è½¬åŒ–ä¸ºå¯¹å‡½æ•°çš„è¿ç®—<del>ï¼Œå€Ÿç”¨å¤šé¡¹å¼çš„è¿ç®—ï¼Œå¤§é‡çš„æ¯’ç˜¤æ•°æ•°é¢˜å°±æ­¤è¯ç”Ÿäº†</del>ã€‚</p><h2 id="æ™®é€šç”Ÿæˆå‡½æ•°ï¼ˆOGFï¼‰"><a href="#æ™®é€šç”Ÿæˆå‡½æ•°ï¼ˆOGFï¼‰" class="headerlink" title="æ™®é€šç”Ÿæˆå‡½æ•°ï¼ˆOGFï¼‰"></a>æ™®é€šç”Ÿæˆå‡½æ•°ï¼ˆOGFï¼‰</h2><p>æ•°åˆ— $A_0, A_1, \cdots$ çš„æ™®é€šç”Ÿæˆå‡½æ•°ä¸º $\displaystyle \sum_{n = 0}^\infty{A_n x^n}$ã€‚</p><p>æ™®é€šç”Ÿæˆå‡½æ•°é€šå¸¸è€ƒè™‘æ— æ ‡å·é—®é¢˜ï¼ˆç»„åˆé—®é¢˜ï¼‰ï¼Œå®ƒçš„åŠ æ³•æ“ä½œå’Œä¹˜æ³•æ“ä½œåˆ†åˆ«å¯¹åº”äº†å¹¶å’Œæ‹¼æ¥ä¸¤ç§æ“ä½œã€‚</p><ul><li>å¹¶ï¼šæ— æ ‡å· $n$ ä¸ªç‚¹çš„å›¾çš„ä¸ªæ•°ï¼Œå‡å¦‚ $\displaystyle \sum_{n = 0}^\infty{a_n x^n}$ æ˜¯è¿é€šå›¾çš„ OGFï¼Œ$\displaystyle \sum_{n = 0}^\infty{b_n x^n}$ æ˜¯ä¸è¿é€šå›¾çš„ OGFï¼Œ$\displaystyle \sum_{n = 0}^\infty{a_n x^n} + \sum_{n = 0}^\infty{b_n x^n}$ å°±æ˜¯æ‰€æœ‰å›¾çš„ OGFã€‚</li><li>æ‹¼æ¥ï¼šæœ‰ä¸¤ç±»ç‰©å“ï¼Œæ‹¿ $n$ ä¸ªç‰©å“ A çš„æ–¹æ¡ˆæ•°ä¸º $a_n$ï¼ŒOGF ä¸º $\displaystyle \sum_{n = 0}^\infty{a_n x^n}$ï¼›æ‹¿ $n$ ä¸ªç‰©å“ B çš„æ–¹æ¡ˆæ•°ä¸º $b_n$ï¼ŒOGF ä¸º $\displaystyle \sum_{n = 0}^\infty{b_n x^n}$ã€‚é‚£ä¹ˆæ‹¿ $n$ ä¸ªç‰©å“çš„ OGF ä¸º $\displaystyle \sum_{n = 0}^\infty{a_n x^n} \ast \sum_{n = 0}^\infty{b_n x^n}$ã€‚</li></ul><h3 id="å¸¸ç”¨çš„-OGF"><a href="#å¸¸ç”¨çš„-OGF" class="headerlink" title="å¸¸ç”¨çš„ OGF"></a>å¸¸ç”¨çš„ OGF</h3><p><em>â†“è¿™ä¸ªè¡¨æ ¼æŸäº›å•å…ƒæ ¼çš„å¯¹é½æ–¹å¼æ¸²æŸ“æœ‰é—®é¢˜ï¼Œæœ‰ç¥ä»™çŸ¥é“åŸå› æˆ–è§£å†³æ–¹æ¡ˆè¯·åŠ¡å¿…å‘Šè¯‰æˆ‘ï¼Œè°¢è°¢ï¼ˆ</em></p><div class="table-container"><table><thead><tr><th style="text-align:center">æ•°åˆ—</th><th style="text-align:center">å½¢å¼å¹‚çº§æ•°</th><th style="text-align:center">é—­å½¢å¼</th></tr></thead><tbody><tr><td style="text-align:center">$1, 1, 1, \cdots$</td><td style="text-align:center">$\displaystyle \sum_{n = 0}^\infty{x^n}$</td><td style="text-align:center">$\displaystyle \frac 1{1 - x}$</td></tr><tr><td style="text-align:center">$\displaystyle \binom NN, \binom{N + 1}N, \binom{N + 2}N, \cdots$</td><td style="text-align:center">$\displaystyle \sum_{n = 0}^\infty{\binom{N + n}N x^n}$</td><td style="text-align:center">$\displaystyle \frac 1{(1 - x)^{N + 1}}$</td></tr><tr><td style="text-align:center">$1, 1, 1, \cdots, 1$</td><td style="text-align:center">$\displaystyle \sum_{n = 0}^N{x^n}$</td><td style="text-align:center">$\displaystyle \frac{1 - x^{N + 1}}{1 - x}$</td></tr><tr><td style="text-align:center">$1, 0, 0, 1, 0, 0, 1, \cdots \ (a = 3)$</td><td style="text-align:center">$\displaystyle \sum_{n = 0}^\infty{x^{a n}}$</td><td style="text-align:center">$\displaystyle \frac 1{1 - x^a}$</td></tr></tbody></table></div><p>æ­¤å¤–è¿˜æœ‰ä¸€äº›å¾ˆ trivial çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ OGF ä¹˜ä»¥ $x$ ç›¸å½“äºæ•°åˆ—å³ç§»ä¸€ä½ã€‚</p><p>æŠŠä¸€ä¸ªæ•°åˆ—çš„ OGF ä¹˜ä»¥ $\displaystyle \frac 1{1 - x}$ ç›¸å½“äºå¯¹å…¶æ±‚å‰ç¼€å’Œï¼Œä¹˜ä»¥ $1 - x$ ç›¸å½“äºå¯¹å…¶æ±‚å·®åˆ†ã€‚è¯¦è§<a href="https://www.luogu.com.cn/problem/P5488">P5488 å·®åˆ†ä¸å‰ç¼€å’Œ</a>ã€‚</p><h3 id="æ–æ³¢é‚£å¥‘æ•°"><a href="#æ–æ³¢é‚£å¥‘æ•°" class="headerlink" title="æ–æ³¢é‚£å¥‘æ•°"></a>æ–æ³¢é‚£å¥‘æ•°</h3><p>ä»¤ $f_n$ ä¸ºæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œ$f_1 = f_2 = 1$ï¼Œå¦‚ä½•æ±‚å‡º $\displaystyle \sum_{n = 0}^\infty{f_n x^n}$ çš„é—­å½¢å¼ï¼Ÿ</p><p>ä»¤ $\displaystyle F_n = \sum_{n = 0}^\infty{f_n x^n}$ï¼Œç”± $f_n = f_{n - 1} + f_{n - 2}$ å¯ä»¥å¾—åˆ° $F(x) = x F(x) + x^2 F(x) + x$ã€‚è§£æ–¹ç¨‹å¾— $\displaystyle F(x) = \frac x{1 - x - x^2}$ã€‚</p><p>$1 - x - x^2$ æ€ä¹ˆå› å¼åˆ†è§£å‘¢ï¼Ÿ</p><p>å¾…å®šç³»æ•°æ³•ï¼Œè®¾ $(1 + ax)(1 + bx) = (1 - x - x^2)$ï¼Œè§£å¾— $a, b$ åˆ†åˆ«æ˜¯ $\displaystyle \frac{-1 \pm \sqrt 5}2$ã€‚æ­¤æ—¶æœ‰</p><script type="math/tex; mode=display">F(x) = \frac x{ \left(1 - \frac{1 + \sqrt 5}2 x \right) \left(1 - \frac{1 - \sqrt 5}2 x \right)}</script><p>è€ƒè™‘è£‚é¡¹å’Œå¾…å®šç³»æ•°æ³•ï¼Œè®¾ $\displaystyle \frac A{1 + ax} + \frac B{1 + bx} = F(x)$ã€‚å– $\displaystyle a = \frac{-1 + \sqrt 5}2$ï¼Œè§£å¾— $\displaystyle A = \frac 1{ \sqrt 5}, B = - \frac 1{ \sqrt 5}$ã€‚</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†</p><script type="math/tex; mode=display">F(x) = \frac 1{ \sqrt 5} \left( \frac 1{1 - \frac{1 + \sqrt 5}2 x} - \frac 1{1 - \frac{1 - \sqrt 5}2 x} \right)</script><p>å› ä¸º $\displaystyle \sum_{n = 0}^\infty{a x^n} = \frac 1{1 - ax}$ï¼Œä»£å…¥å¾—</p><script type="math/tex; mode=display">f_n = [x^n] F(x) = \frac 1{ \sqrt 5} \left( \left( \frac{1 + \sqrt 5}2 \right)^n - \left( \frac{1 - \sqrt 5}2 \right)^n \right)</script><h3 id="å¡ç‰¹å…°æ•°"><a href="#å¡ç‰¹å…°æ•°" class="headerlink" title="å¡ç‰¹å…°æ•°"></a>å¡ç‰¹å…°æ•°</h3><p>å¦‚ä½•æ±‚èŠ‚ç‚¹æ•°ä¸º $n$ çš„äºŒå‰æ ‘çš„ä¸ªæ•°ï¼Ÿ</p><p>ç›´æ¥å¤§åŠ›æ¨å¼æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¤ªéº»çƒ¦äº†å®Œå…¨çœ‹ä¸æ‡‚ã€‚</p><p>æ³¨æ„åˆ°ç”Ÿæˆå‡½æ•°æœ¬èº«æ˜¯å…·æœ‰ç»„åˆæ€§è´¨çš„ã€‚ä»¤ $F(x)$ è¡¨ç¤ºè¯¥é—®é¢˜çš„ç”Ÿæˆå‡½æ•°ï¼Œè€ƒè™‘ä¸€æ£µäºŒå‰æ ‘å¯ä»¥åˆ’åˆ†æˆæ ¹èŠ‚ç‚¹å’Œå·¦å³ä¸¤ä¸ªå­æ ‘ï¼Œå¾—åˆ° $F(x) = x F^2(x) + 1$ã€‚è§£æ–¹ç¨‹å¾— $\displaystyle F(x) = \frac{1 - \sqrt{1 - 4x}}{2x}$ã€‚</p><p>$\displaystyle F(x) = \sum_{n = 0}^\infty{ \frac{(2n)!}{n! (n + 1)!} x^n}$ï¼Œè¯æ˜ä»ç•¥ã€‚</p><h2 id="æŒ‡æ•°å‹ç”Ÿæˆå‡½æ•°ï¼ˆEGFï¼‰"><a href="#æŒ‡æ•°å‹ç”Ÿæˆå‡½æ•°ï¼ˆEGFï¼‰" class="headerlink" title="æŒ‡æ•°å‹ç”Ÿæˆå‡½æ•°ï¼ˆEGFï¼‰"></a>æŒ‡æ•°å‹ç”Ÿæˆå‡½æ•°ï¼ˆEGFï¼‰</h2><p>æ•°åˆ— $A_0, A_1, \cdots$ çš„æŒ‡æ•°å‹ç”Ÿæˆå‡½æ•°ä¸º $\displaystyle \sum_{n = 0}^\infty{A_n \frac{x^n}{n!}}$ã€‚</p><p>åœ¨å¤„ç†æœ‰æ ‡å·é—®é¢˜ï¼ˆæ’åˆ—é—®é¢˜ï¼‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨æŒ‡æ•°å‹ç”Ÿæˆå‡½æ•°ã€‚åœ¨è¿™æ ·çš„å®šä¹‰ä¸‹ï¼ŒåŠ æ³•å’Œä¹˜æ³•ä¾ç„¶ä¿æŒäº†æ€§è´¨ã€‚</p><h3 id="å¸¸ç”¨çš„-EGF"><a href="#å¸¸ç”¨çš„-EGF" class="headerlink" title="å¸¸ç”¨çš„ EGF"></a>å¸¸ç”¨çš„ EGF</h3><div class="table-container"><table><thead><tr><th style="text-align:center">æ•°åˆ—</th><th style="text-align:center">å½¢å¼å¹‚çº§æ•°</th><th style="text-align:center">é—­å½¢å¼</th></tr></thead><tbody><tr><td style="text-align:center">$1, 1, 1, \cdots$</td><td style="text-align:center">$\displaystyle \sum_{n = 0}^\infty{ \frac{x^n}{n!}}$</td><td style="text-align:center">$e^x$</td></tr><tr><td style="text-align:center">$1, 0, 1, \cdots$</td><td style="text-align:center">$\displaystyle \sum_{n = 0}^\infty{ \frac{x^{2n}}{(2n)!}}$</td><td style="text-align:center">$\displaystyle \frac{e^x + e^{-x}}{2}$</td></tr><tr><td style="text-align:center">$0, 1, 0, \cdots$</td><td style="text-align:center">$\displaystyle \sum_{n = 0}^\infty{ \frac{x^{2n + 1}}{(2n + 1)!}}$</td><td style="text-align:center">$\displaystyle \frac{e^x - e^{-x}}{2}$</td></tr></tbody></table></div><h2 id="ç¾¤è®ºç›¸å…³"><a href="#ç¾¤è®ºç›¸å…³" class="headerlink" title="ç¾¤è®ºç›¸å…³"></a>ç¾¤è®ºç›¸å…³</h2><p>è¿™é‡Œæ¨è<a href="https://blog.csdn.net/liangzhaoyang1/article/details/72639208">ä¸€ç¯‡åšå®¢</a>ï¼Œè®²çš„æ˜¯æ¯”æˆ‘ä¸‹é¢æŠ„çš„è¯¾ä»¶è¦æ¸…æ¥šçš„ã€‚</p><h3 id="ç¾¤çš„å®šä¹‰"><a href="#ç¾¤çš„å®šä¹‰" class="headerlink" title="ç¾¤çš„å®šä¹‰"></a>ç¾¤çš„å®šä¹‰</h3><p>å®šä¹‰é›†åˆ $G$ å’Œä½œç”¨äº $G$ ä¸­çš„å…ƒç´ çš„äºŒå…ƒè¿ç®— $\oplus$ï¼Œè‹¥å…¶æ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼Œåˆ™ç§°å…¶ä¸ºä¸€ä¸ªç¾¤ï¼Œè®°ä½œ $(G, \oplus)$ã€‚</p><ol><li>å°é—­æ€§<br>å¯¹äºä»»æ„ $a \in G, b \in G$ï¼Œéƒ½æœ‰ $a \oplus b \in G$ã€‚</li><li>ç»“åˆå¾‹<br>å¯¹äºä»»æ„ $a, b, c$ï¼Œæœ‰ $(a \oplus b) \oplus c = a \oplus (b \oplus c)$ã€‚</li><li>å•ä½å…ƒ<br>å­˜åœ¨å”¯ä¸€çš„ $e \in G$ï¼Œæ»¡è¶³å¯¹äºä»»æ„ $a \in G$ æœ‰ $a \oplus e = e \oplus a = a$ã€‚</li><li>é€†å…ƒ<br>å¯¹äºä»»æ„ $a \in G$ï¼Œå­˜åœ¨å”¯ä¸€çš„ $aâ€™ \in G$ æ»¡è¶³ $a \oplus aâ€™ = aâ€™ \oplus a = e$ã€‚</li></ol><h3 id="ç½®æ¢ç¾¤"><a href="#ç½®æ¢ç¾¤" class="headerlink" title="ç½®æ¢ç¾¤"></a>ç½®æ¢ç¾¤</h3><p>ç½®æ¢å°±æ˜¯å¯¹å…ƒç´ è¿›è¡Œé‡æ’åˆ—ã€‚</p><p>ç½®æ¢ç¾¤æŒ‡çš„æ˜¯ä¸€ä¸ªç½®æ¢çš„é›†åˆï¼Œæ»¡è¶³ä»»æ„ä¸¤ä¸ªç½®æ¢ä¸èƒ½å¤åˆå‡ºä¸€ä¸ªæ–°çš„ä¸åœ¨é›†åˆå†…çš„ç½®æ¢ã€‚</p><h3 id="Burnside-å¼•ç†"><a href="#Burnside-å¼•ç†" class="headerlink" title="Burnside å¼•ç†"></a>Burnside å¼•ç†</h3><p>ä»¤ $X$ è¡¨ç¤ºæŸä¸ªé›†åˆï¼Œä»¤ $G$ è¡¨ç¤ºä½œç”¨åœ¨ $X$ ä¸Šçš„æŸä¸ªç½®æ¢ç¾¤ã€‚å¯¹äºä»»æ„ $G$ å†…çš„å…ƒç´  $g$ï¼Œå®šä¹‰ $f(g)$ ä¸º $X$ å†…ç»è¿‡ç½®æ¢ $g$ åä¸å˜çš„å…ƒç´ çš„æ•°é‡ã€‚æˆ‘ä»¬è¦æ±‚çš„æ˜¯ $X$ å†…æœ¬è´¨ä¸åŒçš„å…ƒç´ çš„ä¸ªæ•°ï¼Œæœ¬è´¨ä¸åŒæŒ‡ä¸èƒ½é€šè¿‡ $G$ è·å¾—å½¼æ­¤ï¼Œè®°ä¸º $|X / G|$ã€‚</p><script type="math/tex; mode=display">|X / G| = \frac 1{|G|} \sum_{g \in G}{f(g)}</script><h3 id="Polya-å®šç†"><a href="#Polya-å®šç†" class="headerlink" title="Polya å®šç†"></a>Polya å®šç†</h3><p>ä»¤ $G$ æ˜¯ $X$ çš„ä¸€ä¸ªç½®æ¢ç¾¤ï¼Œ$|X| = n$ï¼Œç”¨ $m$ ç§é¢œè‰²æŸ“è‰²ï¼Œæœ¬è´¨ä¸åŒçš„æŸ“è‰²æ–¹æ¡ˆæ˜¯</p><script type="math/tex; mode=display">|X / G| = \frac 1{|G|} \sum_{g \in G}{m^{c(g)}}</script><p>å…¶ä¸­ $c(g)$ è¡¨ç¤º $g$ çš„å¾ªç¯èŠ‚æ•°ã€‚</p><p>é€šå¸¸æˆ‘ä»¬å¹¶ä¸éœ€è¦æšä¸¾æ‰€æœ‰çš„ $g$ è®¡ç®— $c(g)$ï¼Œè€Œæ˜¯æšä¸¾ $c(g)$ å¿«é€Ÿè®¡ç®—å¤šå°‘ $g$ æ»¡è¶³æ¡ä»¶ã€‚</p><h2 id="çº¿æ€§ä»£æ•°ç›¸å…³"><a href="#çº¿æ€§ä»£æ•°ç›¸å…³" class="headerlink" title="çº¿æ€§ä»£æ•°ç›¸å…³"></a>çº¿æ€§ä»£æ•°ç›¸å…³</h2><h3 id="è¡Œåˆ—å¼"><a href="#è¡Œåˆ—å¼" class="headerlink" title="è¡Œåˆ—å¼"></a>è¡Œåˆ—å¼</h3><p>ä¸€ä¸ªæ–¹é˜µ $A$ çš„è¡Œåˆ—å¼è¡¨ç¤ºä¸º $|A|$ æˆ– $\det(A)$ã€‚</p><script type="math/tex; mode=display">\det(A) = \sum_{p}{(-1)^{ \sigma(p)}}{ \prod_{i = 1}^n{a_{i, p_i}}}</script><p>å…¶ä¸­ $p$ è¡¨ç¤ºä¸€ä¸ªæ’åˆ—ï¼Œ$\sigma(p)$ è¡¨ç¤º $p$ çš„é€†åºå¯¹æ•°ã€‚ä½¿ç”¨é«˜æ–¯æ¶ˆå…ƒå¿«é€Ÿè®¡ç®—è¡Œåˆ—å¼çš„å€¼ã€‚</p><h4 id="è¡Œåˆ—å¼çš„æ€§è´¨ï¼š"><a href="#è¡Œåˆ—å¼çš„æ€§è´¨ï¼š" class="headerlink" title="è¡Œåˆ—å¼çš„æ€§è´¨ï¼š"></a>è¡Œåˆ—å¼çš„æ€§è´¨ï¼š</h4><ul><li>å¯¹è§’çŸ©é˜µ / ä¸Šä¸‰è§’çŸ©é˜µ / ä¸‹ä¸‰è§’çŸ©é˜µçš„è¡Œåˆ—å¼æ˜¯ä¸»å¯¹è§’çº¿ä¸Šå…ƒç´ çš„ä¹˜ç§¯ã€‚</li><li>äº¤æ¢çŸ©é˜µçš„ä¸¤è¡Œï¼Œè¡Œåˆ—å¼çš„å€¼å–ç›¸åæ•°ã€‚</li><li>å°†çŸ©é˜µçš„ä¸€è¡Œçš„æ‰€æœ‰å…ƒç´ ä¹˜ä¸Šä¸€ä¸ªç›¸åŒçš„å¸¸æ•° $k$ï¼Œè¡Œåˆ—å¼çš„å€¼ä¹Ÿä¹˜ä¸Š $k$ã€‚</li><li>å°†çŸ©é˜µçš„ä¸€è¡ŒåŠ åˆ°å¦å¤–ä¸€è¡Œä¸Šå»ï¼Œè¡Œåˆ—å¼çš„å€¼ä¸å˜ã€‚</li><li>ç”±äºè½¬ç½®çš„å­˜åœ¨ï¼Œè¡Œåˆ—å¼æ‰€æœ‰å¯¹è¡Œæˆç«‹çš„æ€§è´¨å¯¹åˆ—ä¹Ÿæˆç«‹ã€‚</li></ul><h3 id="Matrix-Tree-å®šç†"><a href="#Matrix-Tree-å®šç†" class="headerlink" title="Matrix-Tree å®šç†"></a>Matrix-Tree å®šç†</h3><p>å¯¹äºæ— å‘å›¾ $G$ï¼Œå®šä¹‰ $G$ çš„åº¦æ•°çŸ©é˜µ $D$ï¼š</p><script type="math/tex; mode=display">D_{i, j} = \begin{cases}\deg_i &, i = j \\0 &, i \ne j\end{cases}</script><p>å®šä¹‰ $G$ çš„åŸºå°”éœå¤«çŸ©é˜µ $L = D - C$ï¼Œå…¶ä¸­ $C$ ä»£è¡¨ $G$ çš„é‚»æ¥çŸ©é˜µï¼Œåˆ™å›¾ $G$ çš„ç”Ÿæˆæ ‘æ•°é‡æ˜¯ $L$ çš„ä»»æ„ä¸€ä¸ªä»£æ•°ä½™å­å¼ã€‚</p><h4 id="ç®€å•æ‹“å±•"><a href="#ç®€å•æ‹“å±•" class="headerlink" title="ç®€å•æ‹“å±•"></a>ç®€å•æ‹“å±•</h4><p>å¸¦æƒå›¾çš„ç”Ÿæˆæ ‘ï¼š</p><p>å®šä¹‰ä¸€æ£µæ ‘çš„æƒå€¼æ˜¯æ ‘ä¸Šæ‰€æœ‰è¾¹çš„æ€»æƒå€¼ã€‚</p><p>æˆ‘ä»¬å°†åº¦æ•°çŸ©é˜µä¸­çš„åº¦æ•°æ”¹ä¸ºä¸å®ƒç›¸è¿çš„æ‰€æœ‰è¾¹çš„è¾¹æƒå’Œï¼Œé‚»æ¥çŸ©é˜µçš„è¿é€šæ€§æ”¹ä¸ºè¾¹æƒï¼Œå°±å¯ä»¥æ±‚å‡ºæ‰€æœ‰ç”Ÿæˆæ ‘çš„æƒå€¼å’Œã€‚</p><p>æœ‰å‘å›¾çš„ç”Ÿæˆæ ‘å½¢å›¾è®¡æ•°ï¼š</p><p>æˆ‘ä»¬å°†åº¦æ•°çŸ©é˜µä¸­çš„åº¦æ•°æ”¹ä¸ºå…¥åº¦ï¼Œé‚»æ¥çŸ©é˜µæ”¹ä¸ºæœ‰å‘å›¾çš„é‚»æ¥çŸ©é˜µï¼Œé‚£ä¹ˆä»¥ $x$ ä¸ºæ ¹çš„æ ‘å½¢å›¾ä¸ªæ•°å³ä¸º $L_{x, x}$ã€‚</p><h4 id="Best-theorem"><a href="#Best-theorem" class="headerlink" title="Best theorem"></a>Best theorem</h4><p>ä¸€ä¸ªæœ‰å‘å›¾ $G$ çš„æ¬§æ‹‰å›è·¯çš„æ•°é‡æ˜¯</p><script type="math/tex; mode=display">t_1(G) \prod_{i = 1}^n{(\deg(i) - 1)!}</script><p>å…¶ä¸­ $t_1(G)$ è¡¨ç¤ºå›¾ $G$ çš„ä»¥ $1$ ä¸ºæ ¹çš„æ ‘å½¢å›¾çš„æ•°é‡ã€‚</p><h2 id="å‡ é“ä¾‹é¢˜"><a href="#å‡ é“ä¾‹é¢˜" class="headerlink" title="å‡ é“ä¾‹é¢˜"></a>å‡ é“ä¾‹é¢˜</h2><h3 id="è¿é€šå›¾è®¡æ•°-é›†è®­é˜Ÿä½œä¸š2013-åŸå¸‚è§„åˆ’"><a href="#è¿é€šå›¾è®¡æ•°-é›†è®­é˜Ÿä½œä¸š2013-åŸå¸‚è§„åˆ’" class="headerlink" title="è¿é€šå›¾è®¡æ•° - [é›†è®­é˜Ÿä½œä¸š2013]åŸå¸‚è§„åˆ’"></a>è¿é€šå›¾è®¡æ•° - <a href="https://fa555.github.io/2020/2020-Apr-Records/#%E9%9B%86%E8%AE%AD%E9%98%9F%E4%BD%9C%E4%B8%9A2013-%E5%9F%8E%E5%B8%82%E8%A7%84%E5%88%92">[é›†è®­é˜Ÿä½œä¸š2013]åŸå¸‚è§„åˆ’</a></h3><p>è¿™ç¯‡é¢˜è§£æ˜¯åˆšå­¦å¤šé¡¹å¼æ±‚é€†çš„æ—¶å€™å†™çš„ï¼Œå­¦å®Œ OGF å’Œ EGF ä¹‹åé‡çœ‹é¢˜è§£å­¦ä¼šäº†å¾ˆå¤šä¸œè¥¿ï¼Œå¹¶ä¸”æœ‰äº†ä¸ªæ–°æ–¹æ³•ï¼ˆå¾…è¡¥ï¼‰</p><h3 id="æ´›è°·æ¨¡æ¿é¢˜"><a href="#æ´›è°·æ¨¡æ¿é¢˜" class="headerlink" title="æ´›è°·æ¨¡æ¿é¢˜"></a><a href="https://www.luogu.com.cn/problem/P4980">æ´›è°·æ¨¡æ¿é¢˜</a></h3><h4 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h4><p>ä¸€ä¸ª $n$ ä¸ªç‚¹ $n$ æ¡è¾¹çš„ç¯ï¼Œç»™ç‚¹ä»»æ„æŸ“è‰²ï¼Œæ±‚æœ‰å¤šå°‘ç§æœ¬è´¨ä¸åŒçš„æŸ“è‰²æ–¹æ¡ˆï¼Œå¯¹ $10^9 + 7$ å–æ¨¡ã€‚</p><p>ä¸¤ç§æŸ“è‰²æ–¹æ¡ˆæœ¬è´¨ä¸åŒï¼Œå½“ä¸”ä»…å½“å…¶ä»»æ„æ—‹è½¬åä¸èƒ½é‡åˆã€‚</p><h4 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h4><p>æœ‰ $n$ ç§ç½®æ¢ï¼Œåˆ†åˆ«ä¸ºé¡ºæ—¶é’ˆæ—‹è½¬ $0 \sim n - 1$ æ ¼ã€‚å…¶ä¸­å¯¹äºé¡ºæ—¶é’ˆæ—‹è½¬ $i$ æ ¼çš„ç½®æ¢ï¼Œæ¯ä¸ªå¾ªç¯èŠ‚çš„é•¿åº¦ä¸º $\displaystyle \frac n{ \gcd(i, n)}$ï¼Œå¾ªç¯èŠ‚ä¸ªæ•°ä¸º $\gcd(i, n)$ã€‚</p><p>è®¾ç­”æ¡ˆä¸º $L$ï¼Œæœ´ç´  Polya å®šç†çš„å¼å­æ˜¯ $\displaystyle L = \frac 1n \sum_{i = 1}^n{n^{ \gcd(i, n)}}$ï¼Œè¿™ä¸ªæ˜¾ç„¶æ˜¯è¦è¶…æ—¶çš„ã€‚</p><p>æšä¸¾ $\gcd$ ç¨å¾®æ¨ä¸€ä¸‹å¼å­å¾—åˆ° $\displaystyle L = \sum_{d | n}{n^{d - 1} \varphi \left(\frac nd\right)}$ã€‚</p><p>è®¾ $n$ çš„å”¯ä¸€åˆ†è§£ $\displaystyle n = \prod_{i = 1}^m{p_i^{c_i}}$ï¼Œå¯¹æ‰€æœ‰ $1 \le i \le m$ é¢„å¤„ç† $\varphi(p_i), \varphi(p_i^2), \cdots, \varphi(p_i^{c_i})$ã€‚é€šè¿‡æšä¸¾ $p_i$ çš„æŒ‡æ•°æšä¸¾ $d$ å³å¯åœ¨ $O(1)$ æ±‚ $\displaystyle \varphi\left(\frac nd\right)$ã€‚</p><h4 id="code"><a href="#code" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/34274059">code</a></h4>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åç¼€æ•°ç»„å­¦ä¹ ç¬”è®°</title>
      <link href="/2020/Suffix-Array/"/>
      <url>/2020/Suffix-Array/</url>
      
        <content type="html"><![CDATA[<blockquote><p> <strong>åç¼€æ•°ç»„æ˜¯è§£å†³å­—ç¬¦ä¸²é—®é¢˜çš„æœ‰åŠ›å·¥å…·ã€‚</strong></p><p>â€œåç¼€æ•°ç»„å“ªé‡Œéš¾ï¼Ÿåç¼€éš¾è¿˜æ˜¯æ•°ç»„éš¾ï¼Ÿâ€</p></blockquote><span id="more"></span><h3 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h3><h4 id="åŸºæ•°æ’åº"><a href="#åŸºæ•°æ’åº" class="headerlink" title="åŸºæ•°æ’åº"></a>åŸºæ•°æ’åº</h4><p>è¿™ç©æ„æŒºå¤šå†™æ³•çš„ï¼Œæˆ‘çš„æ•°å­—æ’åºçš„åŸºæ•°æ’åºæ¿å­ï¼ˆæ´›è°·æ¨¡æ¿é¢˜æ¯” <code>std::sort</code> è¦å¿«ï¼‰å’Œåç¼€æ•°ç»„è¦ç”¨çš„å¹¶ä¸ä¸€æ ·ã€‚ç†è§£ä¸‹åŸç†å°±å¥½ã€‚</p><h3 id="å€å¢æ³•æ±‚åç¼€æ•°ç»„"><a href="#å€å¢æ³•æ±‚åç¼€æ•°ç»„" class="headerlink" title="å€å¢æ³•æ±‚åç¼€æ•°ç»„"></a>å€å¢æ³•æ±‚åç¼€æ•°ç»„</h3><p>å®ç°åç¼€æ•°ç»„çš„æ–¹å¼ä¸»è¦æœ‰ä¸¤ç§ï¼šå€å¢æ³• $O(n \log n)$ å’Œ DC3 æ³• $O(n)$ã€‚ç”±äºæˆ‘å¤ªèœæ‰€ä»¥åªå­¦å€å¢æ³•ã€‚</p><h4 id="å˜é‡å®šä¹‰"><a href="#å˜é‡å®šä¹‰" class="headerlink" title="å˜é‡å®šä¹‰"></a>å˜é‡å®šä¹‰</h4><p>$S$ï¼šåŸä¸²ï¼Œä¸‹æ ‡ä» $1$ åˆ° $n$ã€‚</p><p>$\mathrm{Suf}_i$ï¼š$S_{i \dots n}$ï¼Œå³ä»ä½ç½® $i$ å¼€å§‹çš„åç¼€ï¼›$\mathrm{Suf}_{i, k}$ï¼š$S_{i, i + 2^k - 1}$ã€‚</p><p>$\mathrm{Rank}_i$ï¼š$\mathrm{Suf}_i$ çš„æ’åï¼›$\mathrm{Rank}_{i, k}$ï¼š$\mathrm{Suf}_{i, k}$ çš„æ’åã€‚</p><p><code>sa[i]</code>ï¼šæ’åä¸º $i$ çš„åç¼€çš„ä½ç½®ã€‚</p><p><code>rk[i]</code>ï¼š$\mathrm{Rank}_{i}$ã€‚</p><p><code>t[i]</code>ï¼šåŸºæ•°æ’åºç¬¬äºŒå…³é”®å­—ä¸º $i$ çš„åç¼€çš„ä½ç½®ã€‚</p><p><code>c[i]</code>ï¼šåŸºæ•°æ’åºè¾…åŠ©æ•°ç»„ï¼Œ$i$ å·å…ƒç´ å‡ºç°æ¬¡æ•°ã€‚</p><h4 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h4><p>ç›®æ ‡ï¼šå¯¹äºæ‰€æœ‰ $\mathrm{Suf}_i$ æ’åºã€‚</p><p>ä»¤ç¬¬ $k$ ä¸ªé˜¶æ®µä¸ºæ‰€æœ‰ $\mathrm{Suf}_{i, k}$ å·²æ’åºï¼Œåˆ™ç›®æ ‡ä¸º $k \to O( \log n)$ï¼Œé—®é¢˜è½¬åŒ–ä¸ºå¦‚ä½•å¯¹ $\mathrm{Suf}_{i, k + 1}$ æ’åºã€‚</p><p>æ³¨æ„åˆ° $\mathrm{Suf}_{i, k + 1} = \mathrm{Suf}_{i, k} + \mathrm{Suf}_{i + 2^k, k}$ã€‚è¦æ¯”è¾ƒ $\mathrm{Suf}_{a, k + 1}$ å’Œ $\mathrm{Suf}_{b, k + 1}$ï¼Œå³æ¯”è¾ƒ $\mathrm{Suf}_{a, k} + \mathrm{Suf}_{a + 2^k, k}$ å’Œ $\mathrm{Suf}_{b, k} + \mathrm{Suf}_{b + 2^k, k}$ã€‚å› æ­¤ $\mathrm{Suf}_{i, k + 1}$ å¯ä»¥çœ‹ä½œäºŒå…ƒç»„ $(\mathrm{Rank}_{i, k}, \mathrm{Rank}_{i + 2^k, k})$ è¿›è¡Œæ’åºã€‚</p><p>åˆå§‹æ—¶ $\mathrm{Suf}_{i, 0} \ (S_i)$ ä¸€èˆ¬å¯ä»¥çœ‹ä½œäºŒå…ƒç»„ $(S_i, i)$ã€‚</p><h3 id="Height-æ•°ç»„"><a href="#Height-æ•°ç»„" class="headerlink" title="Height æ•°ç»„"></a>Height æ•°ç»„</h3><p><em>å¦‚æœä½ æ˜¯åœ¨å¤ä¹ çœ‹åˆ°è¿™é‡Œï¼Œä¸€å®šè¦æ‰”ä¸‹ä»»ä½•äº‹æƒ…è®¤çœŸè¯»ã€‚è¿™é‡Œå†™å¾—éå¸¸éå¸¸ç»•ã€‚</em></p><p>å®šä¹‰ Height æ•°ç»„ <code>H[i]</code> è¡¨ç¤ºæ’åä¸º $i$ çš„åç¼€å’Œæ’åä¸º $i - 1$ çš„åç¼€çš„æœ€é•¿å‰ç¼€çš„é•¿åº¦ï¼Œå³ $\operatorname{LCP}(\mathrm{sa}_i, \mathrm{sa}_{i - 1})$ã€‚</p><h4 id="å‰ç½®ç»“è®º"><a href="#å‰ç½®ç»“è®º" class="headerlink" title="å‰ç½®ç»“è®º"></a>å‰ç½®ç»“è®º</h4><ol><li><p>å¯¹äºä¸€ä¸ªä½ç½® $i \ (i &gt; 1)$ï¼Œ$\operatorname{LCP}(i, i - 1) \ge \operatorname{LCP}(i, j) \ (1 \le j &lt; i)$ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç›¸é‚»çš„åç¼€çš„ $\operatorname{LCP}$ æœ€é•¿ã€‚</p><ul><li>è¿™ä¸ªç›´æ¥åè¯æ³•å³å¯ã€‚å¦‚æœå­˜åœ¨ $\operatorname{LCP}$ æ›´é•¿çš„åç¼€ï¼Œé‚£å®ƒçš„æ’ååº”å½“æ›´æ¥è¿‘ã€‚</li></ul></li><li><p><code>H[rk[i]] &gt;= H[rk[i - 1]] - 1</code></p><ul><li>è¯æ˜ï¼šå½“ $H_{\mathrm{Rank}_{i - 1}} \le 1$ æ—¶æ˜¾ç„¶æˆç«‹ã€‚å¦åˆ™ï¼Œè®¾ $\mathrm{Rank}_j = \mathrm{Rank}_{i - 1} - 1$ï¼Œé‚£ä¹ˆå°†æœ‰ $\mathrm{Rank}_{j + 1} &lt; \mathrm{Rank}_i$ ä¸” $\operatorname{LCP}(i, k + 1) = H_{i - 1} - 1$ã€‚ç”±ç»“è®º 1 å¾— $H_i \ge H_{i - 1} - 1$ã€‚</li></ul></li></ol><h4 id="è®¡ç®—"><a href="#è®¡ç®—" class="headerlink" title="è®¡ç®—"></a>è®¡ç®—</h4><p>æœ‰äº†è¿™ä¸ªç»“è®ºï¼Œè®¡ç®—å°±å¾ˆå®¹æ˜“äº†ã€‚ç»´æŠ¤ä¸€ä¸ª $p$ï¼Œ$p$ æœ€å¤šè‡ªå¢ $O(n)$ æ¬¡ï¼Œå¤æ‚åº¦æ˜¯ $O(n)$ çš„ã€‚</p><h3 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> SA &#123;</span><br><span class="line">  arr c, rk, sa, t, H;</span><br><span class="line">  <span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">radixSort</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(c + <span class="number">1</span>, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) * M);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">      ++c[rk[i]];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= M; ++i)</span><br><span class="line">      c[i] += c[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = N; i; --i)</span><br><span class="line">      sa[c[rk[t[i]]]--] = t[i];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">sufSort</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span> </span>&#123;</span><br><span class="line">    M = <span class="string">&#x27;z&#x27;</span> - <span class="string">&#x27;0&#x27;</span> + <span class="number">1</span>; <span class="comment">// the size of charset</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">      rk[i] = s[i] - <span class="string">&#x27;0&#x27;</span> + <span class="number">1</span>, t[i] = i;</span><br><span class="line">    <span class="built_in">radixSort</span>();</span><br><span class="line">    M = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> w = <span class="number">1</span>; M &lt; N; w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">      M = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = N - w + <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        t[++M] = i;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">        <span class="keyword">if</span> (sa[i] &gt; w) t[++M] = sa[i] - w;</span><br><span class="line">      <span class="built_in">radixSort</span>();</span><br><span class="line">      <span class="built_in">memcpy</span>(t + <span class="number">1</span>, rk + <span class="number">1</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) * N);</span><br><span class="line">      rk[sa[<span class="number">1</span>]] = M = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; ++i)</span><br><span class="line">        rk[sa[i]] = (t[sa[i - <span class="number">1</span>]] == t[sa[i]] &amp;&amp; t[sa[i - <span class="number">1</span>] + w] == t[sa[i] + w]) ? M : ++M;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">0</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">      <span class="keyword">if</span> (rk[i] == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">while</span> (s[i + j] == s[sa[rk[i] - <span class="number">1</span>] + j]) ++j;</span><br><span class="line">      H[rk[i]] = j;</span><br><span class="line">      <span class="keyword">if</span> (j) --j;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">// SA</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> SA;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="ä¸¤ä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€"><a href="#ä¸¤ä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€" class="headerlink" title="ä¸¤ä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€"></a>ä¸¤ä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€</h4><p>å¯¹äºä¸¤ä¸ªä½ç½® $x, y \ (x &lt; y)$ï¼Œ$\operatorname{LCP}(x, y) = \min_{i = \mathrm{Rank}_{x + 1}}^{ \mathrm{Rank}_y} H_i$ã€‚</p><p>è¿™ä¸ªå¯ä»¥ç”¨ ST è¡¨å®ç° $O(1)$ æŸ¥è¯¢ã€‚</p><h4 id="å¯é‡å æœ€é•¿é‡å¤å­ä¸²"><a href="#å¯é‡å æœ€é•¿é‡å¤å­ä¸²" class="headerlink" title="å¯é‡å æœ€é•¿é‡å¤å­ä¸²"></a>å¯é‡å æœ€é•¿é‡å¤å­ä¸²</h4><p>æ±‚æœ€é•¿çš„å­ä¸²ä½¿å¾—å…¶è‡³å°‘å‡ºç°äº† $2$ æ¬¡ï¼Œä¸åŒå‡ºç°æ¬¡æ•°ä¹‹é—´å¯ä»¥é‡å ã€‚</p><p>è¿™ä¸ªå°±æ˜¯ $\max_{i = 1}^n \{ H_i \}$ äº†ã€‚</p><h4 id="å¯é‡å -k-æ¬¡æœ€é•¿é‡å¤å­ä¸²"><a href="#å¯é‡å -k-æ¬¡æœ€é•¿é‡å¤å­ä¸²" class="headerlink" title="å¯é‡å  $k$ æ¬¡æœ€é•¿é‡å¤å­ä¸²"></a>å¯é‡å  $k$ æ¬¡æœ€é•¿é‡å¤å­ä¸²</h4><p>æ±‚æœ€é•¿çš„å­ä¸²ä½¿å¾—å…¶è‡³å°‘å‡ºç°äº† $k$ æ¬¡ï¼Œä¸åŒå‡ºç°æ¬¡æ•°ä¹‹é—´å¯ä»¥é‡å ã€‚</p><p>å…ˆè€ƒè™‘äºŒåˆ†è¿™ä¸ªç­”æ¡ˆ $l$ï¼Œå‘ç° Height æ•°ç»„å¤§äºç­‰äº $l$ çš„ä½ç½®å½¢æˆäº†è‹¥å¹²ä¸ªè”é€šå—ï¼Œ$O(n)$ <code>check</code> å³å¯ã€‚</p><p><a href="http://poj.org/showsource?solution_id=21696210">POJ3261 code</a></p><p>wucstdio è¯´è¿äºŒåˆ†éƒ½ä¸éœ€è¦ï¼Œæˆ‘æ˜¯å®Œå…¨ä¸æ‡‚å“¦</p><h4 id="ä¸å¯é‡å æœ€é•¿é‡å¤å­ä¸²"><a href="#ä¸å¯é‡å æœ€é•¿é‡å¤å­ä¸²" class="headerlink" title="ä¸å¯é‡å æœ€é•¿é‡å¤å­ä¸²"></a>ä¸å¯é‡å æœ€é•¿é‡å¤å­ä¸²</h4><p>æ±‚æœ€é•¿çš„å­ä¸²ä½¿å¾—å…¶è‡³å°‘å‡ºç°äº† $2$ æ¬¡ï¼Œä¸åŒå‡ºç°æ¬¡æ•°ä¹‹é—´ä¸èƒ½é‡å ã€‚</p><p>è¿˜æ˜¯äºŒåˆ†ä¸€ä¸ªç­”æ¡ˆ $l$ï¼Œåœ¨ <code>check</code> çš„æ—¶å€™åˆ¤æ–­ä¸€ä¸‹æ¯ä¸ªè¿é€šå—ä¸­çš„ä½ç½®æå·®æ˜¯å¦å¤§äºç­‰äº $l$ å³å¯ã€‚æ³¨æ„ç»†èŠ‚ã€‚</p><p><a href="http://poj.org/showsource?solution_id=21696791">POJ1743 code</a></p><h4 id="ä¸åŒå­ä¸²çš„ä¸ªæ•°"><a href="#ä¸åŒå­ä¸²çš„ä¸ªæ•°" class="headerlink" title="ä¸åŒå­ä¸²çš„ä¸ªæ•°"></a>ä¸åŒå­ä¸²çš„ä¸ªæ•°</h4><p>å¦‚æœ $H_i = l$ï¼Œé‚£ä¹ˆé•¿åº¦ä¸º $1 \sim l$ çš„æ‰€æœ‰å‰ç¼€éƒ½ä¼šè¢«å¤šç®—ä¸€æ¬¡ï¼Œç­”æ¡ˆå‡å» $H_i$ã€‚æ€»ç­”æ¡ˆä¸º $n(n + 1) / 2 - \sum_{i = 1}^n{H_i}$ã€‚</p><h4 id="æœ€é•¿å…¬å…±å­ä¸²"><a href="#æœ€é•¿å…¬å…±å­ä¸²" class="headerlink" title="æœ€é•¿å…¬å…±å­ä¸²"></a>æœ€é•¿å…¬å…±å­ä¸²</h4><p>ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² $S, T, n = |S|, m = |T|$ï¼Œæ±‚å®ƒä»¬çš„æœ€é•¿å…¬å…±å­ä¸²ã€‚</p><p>æŠŠä¸¤ä¸ªä¸²æ‹¼åœ¨ä¸€èµ·ï¼Œä¸­é—´åŠ ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦éš”å¼€ã€‚é‚£ä¹ˆè¦æ±‚çš„å°±æ˜¯</p><script type="math/tex; mode=display">\max_{i \in [1, n], j \in [n + 2, n + m + 1]}{ \operatorname{LCP}(i, j)}</script><p>å–åˆ°è¿™ä¸ªæœ€å¤§å€¼çš„ä¸€å®šæ˜¯ç›¸é‚»çš„åç¼€ï¼Œæšä¸¾ $i$ æ›´æ–°ç­”æ¡ˆã€‚</p><p><a href="http://poj.org/showsource?solution_id=21697442">POJ2217 code</a></p><h4 id="æœ€é•¿å›æ–‡å­ä¸²"><a href="#æœ€é•¿å›æ–‡å­ä¸²" class="headerlink" title="æœ€é•¿å›æ–‡å­ä¸²"></a>æœ€é•¿å›æ–‡å­ä¸²</h4><p><del>è¿™ä¸ª Manacher å°±å¯ä»¥çº¿æ€§åš</del></p><p>æŠŠè¿™ä¸ªä¸²å–åæ¥åˆ°åŸä¸²åé¢ã€‚</p><p>æšä¸¾ä¸­å¿ƒç‚¹ï¼Œä¸€ä¸ªå›æ–‡å­ä¸²å°±æ˜¯ä¸¤ä¸ªä½ç½®çš„ $\operatorname{LCP}$ã€‚</p><p><del>è¿™æ ·ç”¨åç¼€æ•°ç»„ + ST è¡¨å°±å¯ä»¥åšåˆ° $O(n \log n)$ çš„ä¼˜ç§€å¤æ‚åº¦</del></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­—ç¬¦ä¸² </tag>
            
            <tag> åç¼€æ•°ç»„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 May Records</title>
      <link href="/2020/2020-May-Records/"/>
      <url>/2020/2020-May-Records/</url>
      
        <content type="html"><![CDATA[<p>èœé¸¡ fa_555 ä¼šæŠŠä¸€äº›åŠ¨æ€ç®€è¦åœ°è®°åœ¨è¿™é‡Œã€‚ä¸»è¦è¿˜æ˜¯ç•™ç»™è‡ªå·±ä»¥åçœ‹çš„ã€‚</p><span id="more"></span><p><em>æ‰€æœ‰ä»£ç ä¸ä¿è¯åŒ…æ‹¬æ— å…³ç´§è¦çš„éƒ¨åˆ†</em></p><hr><h3 id="TJOI2013-æ¾é¼ èšä¼š"><a href="#TJOI2013-æ¾é¼ èšä¼š" class="headerlink" title="[TJOI2013]æ¾é¼ èšä¼š"></a><a href="https://www.luogu.com.cn/problem/P3964">[TJOI2013]æ¾é¼ èšä¼š</a></h3><h3 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h3><p>ç»™å®šå¹³é¢ä¸Šçš„ $n \ (0 \le n \le 10^5)$ ä¸ªç‚¹ $(x, y) \ (-10^9 \le x, y \le 10^9)$ï¼Œé€‰å‡ºä¸€ä¸ªç‚¹ä½¿å¾—å…¶ä»–æ‰€æœ‰ç‚¹åˆ°è¿™ä¸ªç‚¹çš„<strong>åˆ‡æ¯”é›ªå¤«è·ç¦»</strong>ä¹‹å’Œæœ€å°ï¼Œæ±‚å‡ºè¿™ä¸ªæœ€å°å€¼ã€‚</p><h3 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h3><p>æœ‰ç»“è®ºï¼š</p><ul><li>å°†æ‰€æœ‰ç‚¹ $(x,y)$ ä¿®æ”¹ä¸º $(x + y, x âˆ’ y)$ åï¼ŒåŸåæ ‡ç³»ä¸­çš„æ›¼å“ˆé¡¿è·ç¦»ç­‰äºæ–°åæ ‡ç³»ä¸­çš„åˆ‡æ¯”é›ªå¤«è·ç¦»ï¼›</li><li>å°†æ‰€æœ‰ç‚¹ $(x,y)$ ä¿®æ”¹ä¸º $(\frac{x + y}2, \frac{x - y}2)$ åï¼ŒåŸåæ ‡ç³»ä¸­çš„åˆ‡æ¯”é›ªå¤«è·ç¦»ç­‰äºæ–°åæ ‡ç³»ä¸­çš„æ›¼å“ˆé¡¿è·ç¦»ã€‚</li></ul><p>äºæ˜¯å¯ä»¥æ¨å¼å­ã€‚å‡è®¾å·²ç»å°†æ‰€æœ‰ç‚¹è½¬åŒ–ä¸ºæ›¼å“ˆé¡¿åæ ‡ç³»ä¸­çš„ç‚¹ï¼Œä¸”å·²æŒ‰ç…§ $x$ åæ ‡å‡åºæ’åºï¼Œå¯¹äºä¸€ä¸ªç‚¹ $(x_i, y_i)$ï¼Œæœ‰</p><script type="math/tex; mode=display">\begin{align}\sum_{j = 1}^n{|x_i - x_j|} &= \sum_{j = 1}^i{(x_i - x_j)} + \sum_{j = i + 1}^n{(x_j - x_i)} \\&= i x_i - \sum_{j = 1}^i{x_j} + \sum_{j = i + 1}^n{x_j} - (n - i) x_i \\&= (2i - n) x_i + S_n - 2 S_i\end{align}</script><p>å…¶ä¸­ $S_i = \sum_{j = 1}^i{x_i}$ã€‚$y$ åæ ‡åŒç†ã€‚</p><p>è¿™ç©æ„æ’åºä¹‹å $O(n)$ æ•´å°±è¡Œäº†ï¼Œæ€»å¤æ‚åº¦æ˜¯ $O(n \log n)$ çš„ã€‚</p><hr><h3 id="HNOI2010-å¼¹é£ç»µç¾Š"><a href="#HNOI2010-å¼¹é£ç»µç¾Š" class="headerlink" title="[HNOI2010]å¼¹é£ç»µç¾Š"></a><a href="https://www.luogu.com.cn/problem/P3203">[HNOI2010]å¼¹é£ç»µç¾Š</a></h3><h4 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h4><p>è€ƒè™‘æš´åŠ›ï¼Œç»´æŠ¤æ¯ä¸ªä½ç½®å¼¹åˆ°å“ªä¸ªä½ç½®ã€éœ€è¦å‡ æ­¥å¼¹é£ã€‚è¿™æ ·åšä¿®æ”¹æ˜¯ $O(n)$ çš„ï¼ŒæŸ¥è¯¢æ˜¯ $O(1)$ çš„ã€‚æˆ‘ä»¬è¦æƒ³åŠæ³•å¹³è¡¡ä¸¤è€…çš„å¤æ‚åº¦ã€‚</p><p>è€ƒè™‘åˆ†å—ï¼Œå¯¹äºæ¯ä¸ªä½ç½®ç»´æŠ¤å¼¹åˆ°å—å¤–çš„å“ªä¸ªä½ç½®ã€éœ€è¦å‡ æ­¥å¼¹å‡ºå—ã€‚è¿™æ ·ä¿®æ”¹å’ŒæŸ¥è¯¢éƒ½æ˜¯ $O(\sqrt n)$ çš„ï¼Œæ€»å¤æ‚åº¦ $O(n \sqrt n)$ã€‚</p><h4 id="code"><a href="#code" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/problem/P3203">code</a></h4><hr><h3 id="æ•™ä¸»çš„é­”æ³•"><a href="#æ•™ä¸»çš„é­”æ³•" class="headerlink" title="æ•™ä¸»çš„é­”æ³•"></a><a href="https://www.luogu.com.cn/problem/P2801">æ•™ä¸»çš„é­”æ³•</a></h3><p>åŒºé—´å¸¦ä¿®æ±‚æ’åï¼Œå‚è§æ•°åˆ—åˆ†å—å…¥é—¨ 2ã€‚</p><hr><h3 id="Dynamic-Rankings"><a href="#Dynamic-Rankings" class="headerlink" title="Dynamic Rankings"></a><a href="https://www.luogu.com.cn/problem/P2617">Dynamic Rankings</a></h3><p>åŒºé—´å¸¦ä¿®æ±‚ç¬¬ k å°æ¨¡æ¿é¢˜ã€‚</p><p>åŒºé—´å¯ä»¥çœ‹ä½œ $\log$ æ£µçº¿æ®µæ ‘å’Œ $\log$ æ£µçº¿æ®µæ ‘ä½œå·®ã€‚å¯ä»¥é€šè¿‡æ ‘çŠ¶æ•°ç»„å¥—ä¸»å¸­æ ‘å®ç°ã€‚ç©ºé—´ $O(n \log^2 n)$ï¼Œæ—¶é—´ $O(n \log n)$ã€‚</p><h4 id="code-1"><a href="#code-1" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/33443620">code</a></h4><hr><h3 id="CF1433N-Monopole-Magnet"><a href="#CF1433N-Monopole-Magnet" class="headerlink" title="CF1433N Monopole Magnet"></a><a href="http://codeforces.com/problemset/problem/1344/B">CF1433N Monopole Magnet</a></h3><h4 id="problem-1"><a href="#problem-1" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ª $n$ è¡Œ $m$ åˆ— $(1 \le n, m \le 1000)$ çš„æ£‹ç›˜ï¼Œå…¶ä¸­æ¯ä¸ªæ ¼å­è¢«æŸ“æˆäº†é»‘è‰²æˆ–ç™½è‰²ã€‚ä½ éœ€è¦åœ¨æ£‹ç›˜æ ¼å­é‡Œæ”¾ç½®ä¸€äº›å•æç£é“ã€‚æ¯ä¸ªæ ¼å­å¯ä»¥æ”¾ä»»æ„å¤šä¸ªç£é“ã€‚</p><p>å®šä¹‰å•æç£é“çš„å¸å¼•ï¼šä»»é€‰ä¸€å¯¹ N ç£é“å’Œ S ç£é“ï¼Œå¦‚æœå®ƒä»¬å¤„åœ¨åŒä¸€è¡Œæˆ–åŒä¸€åˆ—ä¸­ä¸”ä¸å¤„åœ¨åŒä¸€æ ¼ä¸­ï¼Œåˆ™ N ç£é“å‘ S ç£é“çš„æ–¹å‘é è¿‘ 1 æ ¼ã€‚</p><p>ç£é“çš„æ”¾ç½®éœ€è¦æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š</p><ul><li><p>æ¯è¡Œæ¯åˆ—éƒ½è‡³å°‘è¦æœ‰ä¸€ä¸ª S ç£é“ã€‚</p></li><li><p>å¯¹äºæ¯ä¸ªé»‘è‰²æ ¼å­ï¼Œå¿…é¡»æœ‰ N ç£é“ç»è¿‡è‹¥å¹²æ¬¡å¸å¼•æ“ä½œå<strong>èƒ½å¤Ÿ</strong>åˆ°è¾¾è¯¥æ ¼ã€‚</p></li><li><p>å¯¹äºæ¯ä¸ªç™½è‰²æ ¼å­ï¼Œå¿…é¡»æœ‰ N ç£é“ç»è¿‡ä»»æ„æ¬¡å¸å¼•æ“ä½œå<strong>ä¸èƒ½</strong>åˆ°è¾¾è¯¥æ ¼ã€‚</p></li></ul><p>æ±‚æœ€å°‘çš„ N ç£é“çš„ä¸ªæ•°æˆ–åˆ¤æ–­æ— åˆæ³•æ–¹æ¡ˆã€‚</p><h4 id="solution-2"><a href="#solution-2" class="headerlink" title="solution"></a>solution</h4><p>è€ƒè™‘é»‘è‰²æ ¼å­ç›´æ¥æ”¾æ»¡ S ç£é“ï¼Œéšä¾¿ä¸€æƒ³å‘ç°æœ‰è§£çš„æƒ…å†µå°±æ˜¯æ±‚è¿é€šå—ä¸ªæ•°ï¼Œé‡ç‚¹åœ¨äºåˆ¤æ–­æœ‰æ— åˆæ³•è§£ã€‚</p><p>å†ä¸€æƒ³å‘ç°æœ‰ä¸”ä»…æœ‰è¿™ä¸¤ç§æƒ…å†µæ— è§£ï¼š</p><ul><li>åŒä¸€è¡Œæˆ–åŒä¸€åˆ—çš„ä¸¤ä¸ªé»‘è‰²æ ¼å­ä¸­é—´æœ‰ç™½è‰²æ ¼å­ã€‚</li><li>æŸè¡Œæ²¡æœ‰é»‘è‰²æ ¼å­<strong>å¼‚æˆ–</strong>æŸåˆ—æ²¡æœ‰é»‘è‰²æ ¼å­ã€‚å¦‚æœæœ‰è¡Œå’Œåˆ—éƒ½æ²¡æœ‰é»‘è‰²æ ¼å­ï¼Œé‚£ä¹ˆ S ç£é“å¯ä»¥æ”¾åœ¨å®ƒä»¬çš„äº¤ç‚¹å¤„ã€‚</li></ul><p><del>ï¼ˆæƒ…å†µ 1 é™åˆ¶ 23ï¼‰å’Œï¼ˆæƒ…å†µ 2 é™åˆ¶ 1ï¼‰æ„Ÿè§‰å°±æ˜¯ä¸¤é“é¢˜å¼ºè¡Œæ‹¼èµ·æ¥çš„</del></p><h4 id="code-2"><a href="#code-2" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/33468115">code</a></h4><hr><h3 id="CF1344D-Resume-Review"><a href="#CF1344D-Resume-Review" class="headerlink" title="CF1344D RÃ©sumÃ© Review"></a><a href="http://codeforces.com/problemset/problem/1344/D">CF1344D RÃ©sumÃ© Review</a></h3><h4 id="problem-2"><a href="#problem-2" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ªé•¿ä¸º $n \ (1 \le n \le 10^5)$ çš„åºåˆ— $a \ (1 \le a_i \le 10^9)$ï¼Œæ„é€ åºåˆ— $b$ æ»¡è¶³</p><ul><li>$\forall 1 \le i \le n, \ 0 \le b_i \le a_i$</li><li>$\sum_{i = 1}^n{b_i} = k$</li></ul><p>å¹¶æœ€å¤§åŒ– $\sum_{i = 1}^n{b_i (a_i - b_i^2)}$ã€‚è¾“å‡ºä»»æ„ä¸€ç»„è§£ã€‚</p><h4 id="solution-3"><a href="#solution-3" class="headerlink" title="solution"></a>solution</h4><p>è¿™é‡Œå¤§éƒ¨åˆ†æŠ„äº† CF å®˜æ–¹é¢˜è§£ã€‚</p><p>å¦‚æœæˆ‘ä»¬å¯¹äºæŸä¸ª $b_i$ ä» $x - 1$ è‡ªå¢åˆ° $x$ï¼Œé‚£ä¹ˆæ€»ä»·å€¼å°†ä¼šå˜åŒ–</p><script type="math/tex; mode=display">\Delta_i(x) = x (a_i - x^2) - (x - 1)(a_i - (x - 1)^2) = a_i - 3x^2 + 3x - 1</script><p>è¿™ä¸ªå‡½æ•°åœ¨ $x \ge 1$ æ—¶å•è°ƒå‡ã€‚</p><p>å¦‚æœåˆå§‹æ—¶ä»¤ $b_i = 0$ï¼Œè´ªå¿ƒåœ°å¢åŠ å½“å‰æœ€ä½³çš„ $b_i$ï¼Œé‚£ä¹ˆå°±èƒ½è·å¾—æœ€ä¼˜è§£ï¼Œç„¶è€Œè‡³å°‘ $O(k \log n)$ çš„å¤æ‚åº¦æ˜¯æˆ‘ä»¬æ‰€ä¸èƒ½æ¥å—çš„ã€‚</p><p>æˆ‘ä»¬å¯ä»¥äºŒåˆ†æŸä¸ª $A$ï¼Œä½¿å¾—ä½¿å¾— $\Delta_i(x_i) \ge A$ çš„ $\sum{x_i}$ æ°å¥½ç­‰äº $k$ã€‚<code>check</code> æ—¶æ±‚ $x_i$ å¯ä»¥é€šè¿‡æ±‚æ ¹å…¬å¼æˆ–å¦ä¸€æ¬¡äºŒåˆ†ç­”æ¡ˆå¾—åˆ°ã€‚æ€»å¤æ‚åº¦æ˜¯ $O(n \log k)$ æˆ– $O(n \log^2 k)$ çš„ã€‚</p><h4 id="code-3"><a href="#code-3" class="headerlink" title="code"></a>code</h4><p><a href="https://www.luogu.com.cn/record/33898144">æ´›è°·</a> / <a href="https://codeforces.com/contest/1344/submission/81432655">Codeforces</a></p><hr><h3 id="æ‰©å±•-KMP-ç®—æ³•ï¼ˆZ-ç®—æ³•ï¼‰"><a href="#æ‰©å±•-KMP-ç®—æ³•ï¼ˆZ-ç®—æ³•ï¼‰" class="headerlink" title="æ‰©å±• KMP ç®—æ³•ï¼ˆZ ç®—æ³•ï¼‰"></a>æ‰©å±• KMP ç®—æ³•ï¼ˆZ ç®—æ³•ï¼‰</h3><p>å’•å’•å’•</p><hr><h3 id="ä¸€èˆ¬å›¾æœ€å¤§åŒ¹é…ï¼ˆå¸¦èŠ±æ ‘ç®—æ³•ï¼‰"><a href="#ä¸€èˆ¬å›¾æœ€å¤§åŒ¹é…ï¼ˆå¸¦èŠ±æ ‘ç®—æ³•ï¼‰" class="headerlink" title="ä¸€èˆ¬å›¾æœ€å¤§åŒ¹é…ï¼ˆå¸¦èŠ±æ ‘ç®—æ³•ï¼‰"></a>ä¸€èˆ¬å›¾æœ€å¤§åŒ¹é…ï¼ˆå¸¦èŠ±æ ‘ç®—æ³•ï¼‰</h3><h4 id="solution-by-Fuyuki"><a href="#solution-by-Fuyuki" class="headerlink" title="solution by Fuyuki"></a><a href="https://www.luogu.com.cn/blog/_post/215158">solution by Fuyuki</a></h4><p>æˆ‘å®Œå…¨æ— æ³•å¤è¿°å¾—æ›´å¥½äº†ã€‚</p><h4 id="code-4"><a href="#code-4" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/33540939">code</a></h4><p><strong>æ´›è°·æ¿é¢˜æ•°æ®éå¸¸æ°´ï¼Œä¸€å®šè¦å» UOJ æµ‹ï¼Œä¸€å®šè¦å» UOJ æµ‹ï¼Œä¸€å®šè¦å» UOJ æµ‹</strong></p><hr><h3 id="WC2016-æŒ‘æˆ˜NPC"><a href="#WC2016-æŒ‘æˆ˜NPC" class="headerlink" title="[WC2016]æŒ‘æˆ˜NPC"></a><a href="https://www.luogu.com.cn/problem/P4258">[WC2016]æŒ‘æˆ˜NPC</a></h3><p>ä¸€èˆ¬å›¾æœ€å¤§åŒ¹é…çš„åº”ç”¨ä¸å¤šï¼Œåªæ‰¾åˆ°äº†è¿™ä¸€ä¸ªé¢˜ã€‚</p><h4 id="problem-3"><a href="#problem-3" class="headerlink" title="problem"></a>problem</h4><p>æœ‰ $n \ (1 \le n \le 3m)$ ä¸ªçƒå’Œ $m \ (1 \le m \le 100)$ ä¸ªç­å­ï¼Œæ¯ä¸ªç­å­æœ€å¤šå¯ä»¥è£…ä¸‰ä¸ªçƒã€‚æœ‰ $e \ (1 \le e \le nm)$ ä¸ªæ¡ä»¶ï¼Œæ¡ä»¶ $(u, v)$ è¡¨ç¤ºç¼–å·ä¸º $v$ çš„çƒå¯ä»¥æ”¾è¿›ç¼–å·ä¸º $u$ çš„ç­å­ä¸­ã€‚</p><p>æ¯ä¸ªçƒéƒ½å¿…é¡»æ”¾è¿›ä¸€ä¸ªç­å­ä¸­ï¼Œç§°æ”¾æœ‰ä¸è¶…è¿‡ $1$ ä¸ªçƒçš„ç­å­ä¸ºåŠç©ºçš„ã€‚æ±‚åŠç©ºçš„ç­å­æœ€å¤šæœ‰å¤šå°‘ä¸ªï¼Œå¹¶è¾“å‡ºä¸€ä¸ªæœ€ä¼˜æ–¹æ¡ˆã€‚</p><h4 id="solution-4"><a href="#solution-4" class="headerlink" title="solution"></a>solution</h4><p>è¿™é¢˜çš„æ€è·¯éå¸¸å¦™ã€‚å»ºå›¾æ–¹å¼æ˜¯è¿™æ ·çš„ï¼šå¯¹æ¯ä¸ªç¯®å­æ‹†æˆ $3$ ä¸ªç‚¹ï¼Œåœ¨è¿™ $3$ ä¸ªç‚¹ä¹‹é—´ä¸¤ä¸¤è¿è¾¹ï¼Œåœ¨å¯¹ $e$ ä¸ªæ¡ä»¶è¿ $3e$ æ¡è¾¹ã€‚ä¸ºä»€ä¹ˆè¿™æ ·æ˜¯å¯¹çš„ï¼Ÿ</p><p>åˆ†åˆ«è€ƒè™‘æ¯ä¸ªç¯®å­æ”¾å…¥ $0, 1, 2, 3$ ä¸ªçƒçš„æƒ…å†µã€‚è¿™æ—¶å®ƒä»¬å¯¹ç­”æ¡ˆçš„è´¡çŒ®åˆ†åˆ«æ˜¯ $1, 2, 2, 3$ï¼Œè€Œæˆ‘ä»¬å¸Œæœ›å®ƒä»¬çš„è´¡çŒ®åˆ†åˆ«æ˜¯ $1, 1, 0, 0$ã€‚ä½œå·®å¾—åˆ° $0, 1, 2, 3$ï¼Œå› æ­¤è¿™æ ·ç»Ÿè®¡åˆ°çš„è´¡çŒ®å‡å»çƒçš„ä¸ªæ•°å°±æ˜¯æ­£ç¡®ç­”æ¡ˆï¼</p><p>æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œæœ€ç»ˆçš„åŒ¹é…ä¸­è¦ä¼˜å…ˆåŒ¹é…çƒå†åŒ¹é…ç­ï¼Œå¦åˆ™ä¼šè¾“å‡ºé”™è¯¯çš„æ–¹æ¡ˆã€‚<del>å› ä¸ºè¿™ä¸ªå¡äº†ä¸€æ™š</del></p><h4 id="code-5"><a href="#code-5" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/33544050">code</a></h4><hr><h3 id="PKUWC2018-Slay-the-Spire"><a href="#PKUWC2018-Slay-the-Spire" class="headerlink" title="[PKUWC2018]Slay the Spire"></a><a href="https://www.luogu.com.cn/problem/P5299">[PKUWC2018]Slay the Spire</a></h3><p>ç”±äº fa_555 éå¸¸å–œæ¬¢ç© Slay the Spireï¼Œä»–è·‘æ¥å†™ï¼ˆæŠ„ï¼‰äº†è¿™é¢˜ã€‚ä½†æ˜¯è¿™é¢˜å’Œæ¸¸æˆä¸€ç‚¹å…³ç³»ä¹Ÿæ²¡æœ‰ã€‚</p><h4 id="problem-4"><a href="#problem-4" class="headerlink" title="problem"></a>problem</h4><p>æœ‰ $n$ å¼ å¼ºåŒ–ç‰Œ $a_i$ å’Œ $n$ å¼ æ”»å‡»ç‰Œ $b_i$ï¼Œæ¯å¼ ç‰Œæœ‰ä¸€ä¸ª $[1, 10^8]$ ä¹‹é—´çš„æƒå€¼ï¼Œæ¯å¼ å¼ºåŒ–ç‰Œèƒ½ä½¿æ‰€æœ‰æ”»å‡»ç‰Œçš„æƒå€¼ä¹˜ä¸Šè¿™å¼ å¼ºåŒ–ç‰Œçš„æƒå€¼ã€‚</p><p>ä»»æ„æ‘¸ $m$ å¼ ç‰Œï¼Œä»¥æœ€ä¼˜ç­–ç•¥å‡º $k$ å¼ ç‰Œï¼Œæ±‚é€ æˆä¼¤å®³çš„æœŸæœ›ä¹˜ä»¥ $\binom {2n}m$ã€‚ç­”æ¡ˆæ¨¡ $998244353$ã€‚</p><h4 id="solution-è½¬åŒ–"><a href="#solution-è½¬åŒ–" class="headerlink" title="solution - è½¬åŒ–"></a>solution - è½¬åŒ–</h4><p>é¦–å…ˆå‘ç°è¦æ±‚çš„è¿™ä¸ªä¸œè¥¿å…¶å®å°±æ˜¯æ‰€æœ‰æƒ…å†µä¸‹é€ æˆçš„ä¼¤å®³æ€»å’Œã€‚</p><p>è€ƒè™‘å¦‚æœç°åœ¨å·²ç»é€‰å®šäº† $m$ å¼ ç‰Œï¼Œæœ€ä¼˜ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li>å¦‚æœå·²ç»ç¡®å®šç”¨ $x$ å¼ å¼ºåŒ–ç‰Œå’Œ $y$ å¼ æ”»å‡»ç‰Œï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯å…ˆç”¨æƒå€¼æœ€å¤§çš„ $x$ å¼ å¼ºåŒ–ç‰Œï¼Œå†ç”¨æƒå€¼æœ€å¤§çš„ $y$ å¼ æ”»å‡»ç‰Œã€‚</li><li>åœ¨ä¿è¯è‡³å°‘å‡ºä¸€å¼ æ”»å‡»ç‰Œçš„æƒ…å†µä¸‹ï¼Œå°½é‡å¤šå‡ºå¼ºåŒ–ç‰Œä¸€å®šä¸ä¼šä½¿ç­”æ¡ˆæ›´åŠ£ã€‚<ul><li>è¿™ä¸ªä¸å¿…ä¸¥è°¨åœ°æ¨å¼å­ï¼Œåªè¦è€ƒè™‘å¼ºåŒ–ç‰Œè‡³å°‘èƒ½ä½¿æƒå€¼æœ€å¤§çš„æ”»å‡»ç‰Œçš„æƒå€¼ç¿»å€ï¼Œä¸åŠ£äºé€‰å…¶ä»–ä»»ä½•æ”»å‡»ç‰Œå³å¯ã€‚</li></ul></li></ul><h4 id="solution-é¢„å¤„ç†"><a href="#solution-é¢„å¤„ç†" class="headerlink" title="solution - é¢„å¤„ç†"></a>solution - é¢„å¤„ç†</h4><p>è®¾ $f_{i, j, 0}$ è¡¨ç¤ºå‰ $i$ å¼ å¼ºåŒ–ç‰Œä¸­é€‰æ‹© $j$ å¼ ä¸”ç¬¬ $i$ å¼ è¢«é€‰ä¸­çš„<strong>æ‰€æœ‰æƒ…å†µ</strong>ä¸‹è¿™ $j$ å¼ ç‰Œçš„ä¹˜ç§¯<strong>ä¹‹å’Œ</strong>ï¼›$g_{i, j, 0}$ è¡¨ç¤ºå‰ $i$ å¼ æ”»å‡»ç‰Œä¸­é€‰æ‹© $j$ å¼ ä¸”ç¬¬ $i$ å¼ è¢«é€‰ä¸­çš„<strong>æ‰€æœ‰æƒ…å†µ</strong>ä¸‹è¿™ $j$ å¼ ç‰Œçš„å’Œ<strong>ä¹‹å’Œ</strong>ã€‚åŒæ—¶è®¾ $f_{i, j, 1} = \sum_{k = j}^i{f_{k, j, 0}}, \ g_{i, j, 1} = \sum_{k = j}^i{g_{k, j, 0}}$ï¼Œé‚£ä¹ˆå¯å¾—</p><script type="math/tex; mode=display">\begin{align}f_{i, j, 0} &= a_i \cdot f_{i - 1, j - 1, 1} \\f_{i, j, 1} &= f_{i, j, 0} + f_{i - 1, j, 1} \\g_{i, j, 0} &= b_i \cdot \binom{i - 1}{j - 1} + g_{i - 1, j - 1, 1} \\g_{i, j, 1} &= g_{i, j, 0} + g_{i - 1, j, 1}\end{align}</script><h4 id="solution-ç»Ÿè®¡ç­”æ¡ˆ"><a href="#solution-ç»Ÿè®¡ç­”æ¡ˆ" class="headerlink" title="solution - ç»Ÿè®¡ç­”æ¡ˆ"></a>solution - ç»Ÿè®¡ç­”æ¡ˆ</h4><p>åˆ†ä¸¤ç§æƒ…å†µï¼š</p><p><strong>å…¶ä¸€ï¼Œ$m$ å¼ ç‰Œä¸­å¼ºåŒ–ç‰Œçš„æ•°é‡å°äº $k - 1$</strong></p><p>æ­¤æ—¶å¿…ç„¶æ˜¯å‡ºæ‰€æœ‰å¼ºåŒ–ç‰Œï¼Œç„¶åå‡ºæƒå€¼æœ€å¤§çš„ä¸€äº›æ”»å‡»ç‰Œã€‚</p><p>æšä¸¾å¼ºåŒ–ç‰Œæœ‰ $i$ å¼ ã€é€‰ä¸­çš„æœ€åä¸€å¼ æ”»å‡»ç‰Œæ˜¯ç¬¬ $j$ å¼ ã€‚</p><p>å¦‚æœè¦ä¿è¯æœ€ä¼˜æ–¹æ¡ˆæ˜¯è¿™ $k$ å¼ ç‰Œï¼Œå‰©ä¸‹çš„ $m - k$ å¼ ç‰Œè¿˜éœ€è¦æ»¡è¶³<strong>å…¨éƒ¨éƒ½æ˜¯æ”»å‡»ç‰Œï¼Œå¹¶ä¸”éƒ½åœ¨ç¬¬ $j$ å¼ ä¹‹å</strong>ã€‚</p><p>æ­¤æ—¶å¯¹ç­”æ¡ˆçš„è´¡çŒ®ä¸º $f_{n, i, 1} \cdot g_{j, k - i, 0} \cdot \binom{n - j}{m - k}$ã€‚</p><p><strong>å…¶äºŒï¼Œ$m$ å¼ ç‰Œä¸­å¼ºåŒ–ç‰Œçš„æ•°é‡å¤§äºç­‰äº $k - 1$</strong></p><p>æ­¤æ—¶å¿…ç„¶æ˜¯å‡ºæƒå€¼æœ€å¤§çš„ $k - 1$ å¼ å¼ºåŒ–ç‰Œï¼Œç„¶åå‡ºæƒå€¼æœ€å¤§çš„ä¸€å¼ æ”»å‡»ç‰Œã€‚</p><p>æšä¸¾é€‰ä¸­çš„æœ€åä¸€å¼ å¼ºåŒ–ç‰Œæ˜¯ç¬¬ $i$ å¼ ï¼Œé€‰ä¸­çš„æ”»å‡»ç‰Œæ˜¯ç¬¬ $j$ å¼ ã€‚</p><p>å¦‚æœè¦ä¿è¯æœ€ä¼˜æ–¹æ¡ˆæ˜¯è¿™ $k$ å¼ ç‰Œï¼Œå‰©ä¸‹çš„ $m - k$ å¼ ç‰Œè¿˜éœ€è¦æ»¡è¶³<strong>æ‰€æœ‰å¼ºåŒ–ç‰Œéƒ½åœ¨ç¬¬ $i$ å¼ ä¹‹åï¼Œæ‰€æœ‰æ”»å‡»ç‰Œéƒ½åœ¨ç¬¬ $j$ å¼ ä¹‹å</strong>ã€‚</p><p>æ­¤æ—¶å¯¹ç­”æ¡ˆçš„è´¡çŒ®ä¸º $f_{i, k - 1, 0} \cdot b_j \cdot \binom{2n - i - j}{m - k}$ã€‚</p><h4 id="code-6"><a href="#code-6" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/33571988">code</a></h4><p>å®ƒè¢«å¡å¸¸äº†ï¼Œå¹¶è¿‡ä¸å»ã€‚</p><hr><h3 id="GSS5-Can-you-answer-these-queries-V"><a href="#GSS5-Can-you-answer-these-queries-V" class="headerlink" title="GSS5 - Can you answer these queries V"></a><a href="https://www.luogu.com.cn/problem/SP2916">GSS5 - Can you answer these queries V</a></h3><h4 id="problem-5"><a href="#problem-5" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ªé•¿ä¸º $n$ çš„åºåˆ— $a$ï¼Œæ¯æ¬¡æŸ¥è¯¢å·¦ç«¯ç‚¹åœ¨ $[l_1, r_1]$ ä¹‹é—´ï¼Œå³ç«¯ç‚¹åœ¨ $[l_2, r_2]$ ä¹‹é—´çš„æœ€å¤§å­æ®µå’Œã€‚ä¸ä¿è¯ä¸¤ä¸ªåŒºé—´ä¸ç›¸äº¤ã€‚</p><h4 id="solution-5"><a href="#solution-5" class="headerlink" title="solution"></a>solution</h4><p>é¦–å…ˆè€ƒè™‘ä¸¤ä¸ªåŒºé—´ $[l_1, r_1], [l_2, r_2]$ ä¸ç›¸äº¤æˆ–åªåœ¨ç«¯ç‚¹å¤„ç›¸äº¤ $(r_1 \le l_2)$ çš„æƒ…å†µï¼Œå‘ç°ç­”æ¡ˆå°±æ˜¯å³è¾¹åŒºé—´çš„æœ€å¤§å‰ç¼€å’Œå‡å»å·¦è¾¹åŒºé—´çš„æœ€å°å‰ç¼€å’Œã€‚è®°è¿™ä¸ªç­”æ¡ˆä¸º $f([l_1, r_1], [l_2, r_2])$ã€‚</p><p>é‚£ä¹ˆå¯¹äºç›¸äº¤ $(l_2 &lt; r_1)$ çš„æƒ…å†µä¹Ÿå°±å¾ˆå®¹æ˜“è®¨è®ºäº†ï¼šç­”æ¡ˆæ˜¯ $[r1, l2]$ çš„æœ€å¤§å­æ®µå’Œã€$f([l_1, r_1], [r_1, r_2])$ã€$f([l_1, l_2], [l_2, r_2])$ ä¸‰è€…å–æœ€å¤§å€¼ã€‚</p><h4 id="code-7"><a href="#code-7" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/33581498">code</a></h4><p>åªåœ¨ç«¯ç‚¹ç›¸äº¤çš„æƒ…å†µä¸¤ç§æƒ…å†µéƒ½å¯ä»¥è®¨è®ºï¼Œä»£ç æ”¾åœ¨äº†ç¬¬äºŒç§æƒ…å†µé‡Œã€‚</p><hr><h3 id="æè¶…æ ‘"><a href="#æè¶…æ ‘" class="headerlink" title="æè¶…æ ‘"></a>æè¶…æ ‘</h3><p><a href="https://fa555.github.io/2020/Li-Chao-Tree/">å­¦ä¹ ç¬”è®°åœ¨è¿™</a></p><hr><h3 id="CEOI2017-Building-Bridges"><a href="#CEOI2017-Building-Bridges" class="headerlink" title="[CEOI2017]Building Bridges"></a><a href="https://www.luogu.com.cn/problem/P4655">[CEOI2017]Building Bridges</a></h3><h4 id="solution-6"><a href="#solution-6" class="headerlink" title="solution"></a>solution</h4><p>è®¾ $f_i$ ä¸ºå°†ç¬¬ $1$ æ ¹æŸ±å­å’Œç¬¬ $i$ æ ¹æŸ±å­ç›¸è¿çš„æœ€å°ä»£ä»·ï¼Œä»¤ $S_i = \sum_{j = 1}^i{w_j}$ï¼Œåˆ™</p><script type="math/tex; mode=display">\begin{align}f_i &= \min_{j = 1}^{i - 1}{ \left \{ f_j + \sum_{k = j + 1}^{i - 1}{w_k} + (h_i - h_j)^2 \right \} } \\ &= \min_{j = 1}^{i - 1}{ \{ f_j + S_{i - 1} - S_j + h_i^2 - 2 h_i h_j + h_j^2 \} } \\&= S_{i - 1} + h_i^2 + \min_{j = 1}^{i - 1}{ \{ f_j - S_j + h_j^2 - 2 h_i h_j \} }\end{align}</script><p>ä»¤ $k = -2h_i, b = f_j - S_j + h_j^2$ï¼Œåˆ™å¯ä»¥ç”¨æè¶…æ ‘ç»´æŠ¤ã€‚</p><p>CDQ åˆ†æ²»å°‘ä¸€ä¸ª $\log$ ä½†æˆ‘ä¸ä¼šï¼Œä¸è¿‡æè¶…æ ‘å°å¸¸æ•°è·‘å¾—å¥½åƒæ›´å¿«ï¼ˆ</p><h4 id="code-8"><a href="#code-8" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/33691534">code</a></h4><hr><h3 id="ä½œè¯—"><a href="#ä½œè¯—" class="headerlink" title="ä½œè¯—"></a><a href="https://www.luogu.com.cn/problem/P4135">ä½œè¯—</a></h3><h4 id="problem-6"><a href="#problem-6" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šé•¿ä¸º $n \ (1 \le n \le 10^5)$ çš„åºåˆ— $a$ å’Œ $m \ (1 \le m \le 10^5)$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—® $a_{l \dots r}$ ä¸­å‡ºç°æ¬¡æ•°ä¸ºæ­£å¶æ•°çš„æ•°å­—ä¸ªæ•°ã€‚</p><h4 id="solution-7"><a href="#solution-7" class="headerlink" title="solution"></a>solution</h4><p>é•¿å¾—è·Ÿè’²å…¬è‹±ä¼¼çš„ï¼ˆï¼Ÿï¼‰</p><p>è€ƒè™‘åˆ†å—ï¼Œè®¾ $s_{i, j}$ è¡¨ç¤ºç¬¬ $i$ å—å¼€å¤´åˆ°åºåˆ—ç»“å°¾æ•°å­— $j$ çš„å‡ºç°æ¬¡æ•°ï¼Œ$f_{i, j}$ è¡¨ç¤ºç¬¬ $i$ å—åˆ°ç¬¬ $j$ å—çš„ç­”æ¡ˆã€‚</p><p>è¿™æ ·æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n \sqrt n) - O(\sqrt n)$ çš„ï¼›ç©ºé—´å¤æ‚åº¦æ˜¯ $O(n \sqrt n)$ çš„ã€‚</p><h4 id="code-9"><a href="#code-9" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/33731933">code</a></h4><hr><h3 id="LCT"><a href="#LCT" class="headerlink" title="LCT"></a>LCT</h3><p>å­¦äº†å­¦ LCTï¼Œä¹Ÿæ²¡å•¥å¥½è¯´çš„ï¼Œæ”¾ä¸ªæ¿å­å§ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> LCT &#123;</span><br><span class="line">  std::bitset&lt;100003&gt; rev;</span><br><span class="line">  <span class="keyword">int</span> z[<span class="number">100003</span>], s[<span class="number">100003</span>], fa[<span class="number">100003</span>], ch[<span class="number">100003</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ch[fa[p]][<span class="number">1</span>] == p;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">notRt</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ch[fa[p]][<span class="number">0</span>] == p || ch[fa[p]][<span class="number">1</span>] == p;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">assign</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!p) <span class="keyword">return</span>;</span><br><span class="line">    std::<span class="built_in">swap</span>(ch[p][<span class="number">0</span>], ch[p][<span class="number">1</span>]);</span><br><span class="line">    rev.<span class="built_in">flip</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    s[p] = s[ch[p][<span class="number">0</span>]] ^ s[ch[p][<span class="number">1</span>]] ^ z[p];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (rev[p]) <span class="built_in">assign</span>(ch[p][<span class="number">0</span>]), <span class="built_in">assign</span>(ch[p][<span class="number">1</span>]), rev.<span class="built_in">reset</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">notRt</span>(p)) <span class="built_in">update</span>(fa[p]);</span><br><span class="line">    <span class="built_in">pushdown</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> f = fa[p], g = fa[f], k = <span class="built_in">get</span>(p), r = ch[p][!k];</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">notRt</span>(f)) ch[g][<span class="built_in">get</span>(f)] = p;</span><br><span class="line">    ch[f][k] = r, ch[p][!k] = f;</span><br><span class="line">    fa[r] = f, fa[f] = p, fa[p] = g;</span><br><span class="line">    <span class="built_in">pushup</span>(f), <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">update</span>(p);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> f; <span class="built_in">notRt</span>(p); <span class="built_in">rotate</span>(p))</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">notRt</span>(f = fa[p])) <span class="built_in">rotate</span>(<span class="built_in">get</span>(f) != <span class="built_in">get</span>(p) ? p : f);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">0</span>; p; p = fa[q = p])</span><br><span class="line">      <span class="built_in">splay</span>(p), ch[p][<span class="number">1</span>] = q, <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">makeRt</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">access</span>(p), <span class="built_in">splay</span>(p), <span class="built_in">assign</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">findRt</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">access</span>(p), <span class="built_in">splay</span>(p);</span><br><span class="line">    <span class="keyword">while</span> (ch[p][<span class="number">0</span>]) <span class="built_in">pushdown</span>(p), p = ch[p][<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">splay</span>(p);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">makeRt</span>(p);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">findRt</span>(q) != p) fa[p] = q;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">cut</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">makeRt</span>(p);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">findRt</span>(q) != p || ch[q][<span class="number">0</span>] || fa[q] != p) <span class="keyword">return</span>;</span><br><span class="line">    fa[q] = ch[p][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">makeRt</span>(p), <span class="built_in">access</span>(q), <span class="built_in">splay</span>(q);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">// LCT</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>update(p)</code> æœ‰éé€’å½’å†™æ³•ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> top, st[<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">  st[top = <span class="number">1</span>] = p;</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">notRt</span>(p)) st[++top] = p = fa[p];</span><br><span class="line">  <span class="keyword">while</span> (top) <span class="built_in">pushdown</span>(st[top--]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="å›½å®¶é›†è®­é˜Ÿ-Tree-II"><a href="#å›½å®¶é›†è®­é˜Ÿ-Tree-II" class="headerlink" title="[å›½å®¶é›†è®­é˜Ÿ]Tree II"></a><a href="https://www.luogu.com.cn/problem/P1501">[å›½å®¶é›†è®­é˜Ÿ]Tree II</a></h3><p>ç¬¬ä¸€é“ LCT çš„é¢˜ç›®ã€‚æ¶‰åŠæ ‘ä¸ŠåŒºé—´åŠ ã€åŒºé—´ä¹˜ã€åŒºé—´å’Œå’Œè¿è¾¹æ–­è¾¹ã€‚</p><p>éœ€è¦åœ¨ Splay ä¸Šæ‰“åŒºé—´åŠ æ³•å’Œä¹˜æ³•æ ‡è®°ï¼Œå…¶ä»–æ²¡å•¥åŒºåˆ«ã€‚</p><h4 id="code-10"><a href="#code-10" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/33831604">code</a></h4><hr><h3 id="SDOI2011-æŸ“è‰²"><a href="#SDOI2011-æŸ“è‰²" class="headerlink" title="[SDOI2011]æŸ“è‰²"></a><a href="https://www.luogu.com.cn/problem/P2486">[SDOI2011]æŸ“è‰²</a></h3><h4 id="problem-7"><a href="#problem-7" class="headerlink" title="problem"></a>problem</h4><p>$n \ (1 \le n \le 10^5)$ ä¸ªç‚¹çš„æ ‘ï¼Œæ¯ä¸ªç»“ç‚¹æœ‰ä¸€ä¸ªé¢œè‰²ã€‚$m \ (1 \le m \le 10^5)$ æ¬¡æ“ä½œï¼Œæ¯æ¬¡ä¿®æ”¹ä¸€ä¸ªç»“ç‚¹çš„é¢œè‰²æˆ–æŸ¥è¯¢æ¯æ¡é“¾ä¸Šçš„é¢œè‰²æ®µæ•°ã€‚ </p><h4 id="solution-8"><a href="#solution-8" class="headerlink" title="solution"></a>solution</h4><p>è¿™é¢˜ç»´æŠ¤ä¿¡æ¯çš„æ–¹å¼æ¯”è¾ƒæ€ªå¼‚ï¼ˆ</p><p>è®°å½•æ¯ä¸ªç‚¹ä»£è¡¨çš„åŒºé—´æœ€å·¦ç«¯çš„é¢œè‰² <code>lc</code>ã€æœ€å³ç«¯çš„é¢œè‰² <code>rc</code>ã€è¯¥ç‚¹çš„é¢œè‰² <code>c</code> å’Œé¢œè‰²åˆ†ç•Œç‚¹çš„ä¸ªæ•° <code>s</code>ã€‚æ³¨æ„ç»Ÿè®¡æŸç‚¹çš„ç­”æ¡ˆæ—¶è¦å…ˆ <code>pushdown</code> ä¸€ä¸‹æ¥æ›´æ–°å„¿å­çš„ä¿¡æ¯ã€‚</p><p><code>assign</code> çš„æ—¶å€™è®°å¾—æŠŠä¸¤è¾¹å„¿å­çš„æœ€å·¦ç«¯å’Œæœ€å³ç«¯åˆ†åˆ«æ¢ä¸€ä¸‹ã€‚</p><h4 id="code-11"><a href="#code-11" class="headerlink" title="code"></a><a href="https://www.luogu.com.cn/record/33861957">code</a></h4><hr><h3 id="å¥¶ç‰›æµ´åœº-çƒåœº-Cricket-Field"><a href="#å¥¶ç‰›æµ´åœº-çƒåœº-Cricket-Field" class="headerlink" title="å¥¶ç‰›æµ´åœº / çƒåœº Cricket Field"></a><a href="https://www.luogu.com.cn/problem/P1578">å¥¶ç‰›æµ´åœº</a> / <a href="https://www.luogu.com.cn/problem/UVA1312">çƒåœº Cricket Field</a></h3><p>æœ€å¤§å­çŸ©å½¢ / æ­£æ–¹å½¢çš„ $O(s^2)$ ç‰ˆæœ¬ï¼Œå…¶ä¸­ $s$ ä¸ºéšœç¢ç‰©æ•°é‡ã€‚</p><h4 id="code-12"><a href="#code-12" class="headerlink" title="code"></a>code</h4><p><a href="https://www.luogu.com.cn/record/33896638">å¥¶ç‰›æµ´åœº</a> / <a href="https://www.luogu.com.cn/record/33925064">çƒåœº Cricket Field</a></p><hr>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>c++ ä¸å®šå‚å‡½æ•°åˆæ¢</title>
      <link href="/2020/cpp%E4%B8%8D%E5%AE%9A%E5%8F%82%E5%87%BD%E6%95%B0%E5%88%9D%E6%8E%A2/"/>
      <url>/2020/cpp%E4%B8%8D%E5%AE%9A%E5%8F%82%E5%87%BD%E6%95%B0%E5%88%9D%E6%8E%A2/</url>
      
        <content type="html"><![CDATA[<p>è¿™é‡Œç”±äºä»£ç éœ€è¦<del>å…¶å®æ˜¯è‡ªå·±æ‡’</del>ï¼Œ<strong>è‡ªè¡Œ</strong>ç ”ç©¶äº†ä¸€ä¸‹ C++ çš„ä¸å®šå‚ç³»ç»Ÿã€‚è¿™ç¯‡æ–‡ç« å¯¹äº OIer æ¥è¯´åº”è¯¥æ˜¯å¤Ÿç”¨äº†ã€‚</p><span id="more"></span><p>ä»£ç å‡ä»¥æ±‚è‹¥å¹²ä¸ªæ•°çš„æ¨¡ <code>mod</code> æ„ä¹‰ä¸‹å’Œä¸ºä¾‹å­ã€‚</p><hr><h3 id="va-list-ç³»-C"><a href="#va-list-ç³»-C" class="headerlink" title="va_list ç³» (C)"></a><code>va_list</code> ç³» (C)</h3><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdarg&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> argc, ...)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  va_list argv;</span><br><span class="line">  <span class="built_in">va_start</span>(argv, argc);</span><br><span class="line">  <span class="keyword">while</span> (argc--)</span><br><span class="line">    ans = (ans + <span class="built_in">va_arg</span>(args, <span class="keyword">int</span>)) % mod;</span><br><span class="line">  <span class="built_in">va_end</span>(argv);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Add</span>(<span class="number">6</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>); <span class="comment">// returns 16 % mod;</span></span><br></pre></td></tr></table></figure><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><p>C è¯­è¨€åªèƒ½ç”¨è¿™ä¸ªï¼Œå°±æ²¡å•¥åˆ«çš„ä¼˜ç‚¹äº†ï¼ˆ</p><p>è¿™ä¸ªåœ¨ C åº“çš„åº”ç”¨æ¯”è¾ƒå¹¿æ³›ï¼Œæ‰€ä»¥åº”è¯¥ç†Ÿç»ƒæŒæ¡å¦‚ä½•è°ƒç”¨ï¼ˆå¤§é›¾</p><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><p>æ‹¥æœ‰ C çš„å„ç§ç¼ºç‚¹ã€‚ä¼ å‚ç›´æ¥é¢å‘å†…å­˜ï¼Œå¯¼è‡´ç±»å‹è½¬æ¢éå¸¸éº»çƒ¦ï¼Œå®¹æ˜“å‡ºé”™å’Œè¶Šç•Œã€‚</p><p>å¿…é¡»ä¼ ä¸€ä¸ªå‚æ•°ä½¿å¾—èƒ½å¤Ÿæ¨æ–­å‡ºå‚æ•°ç±»å‹å’Œä¸ªæ•°ï¼Œéå¸¸éº»çƒ¦ã€‚æ¯”å¦‚ <code>printf</code> å°±è¦ä¼ ä¸€ä¸ª <code>const char*</code>ï¼Œç”¨æ ¼å¼ç¬¦æ¨æ–­ç±»å‹å’Œä¸ªæ•°ã€‚</p><p>æ ¼å¼ååˆ†ä¸¥æ ¼ï¼Œä¸åŠ  <code>va_end</code> ä¼šå¼•å‘å†…å­˜é—®é¢˜ã€‚</p><hr><h3 id="æ¨¡æ¿ç±»-C"><a href="#æ¨¡æ¿ç±»-C" class="headerlink" title="æ¨¡æ¿ç±» (C++)"></a>æ¨¡æ¿ç±» (C++)</h3><h4 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (t % mod + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span>... Ts&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> t, Ts... r)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ((t + <span class="built_in">Add</span>(r...)) % mod + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Add</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>); <span class="comment">// returns 16 % mod</span></span><br></pre></td></tr></table></figure><h4 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><p><del>å†™èµ·æ¥å¸…ã€‚</del>åœ¨ C++98 ä¸­å¯ç”¨ï¼Œå¯è¯»æ€§ä¹Ÿæ¯”è¾ƒé«˜ã€‚</p><p>è°ƒç”¨èµ·æ¥æ¯”è¾ƒçœå¿ƒï¼Œä¸ä¼šåç›´è§‰ï¼Œæ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ä¸å®šå‚ï¼ˆ</p><h4 id="ç¼ºç‚¹-1"><a href="#ç¼ºç‚¹-1" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><p>åªèƒ½é€’å½’è°ƒç”¨ï¼Œä¼šå¸¦æ¥ä¸€å®šçš„å¸¸æ•°ã€‚</p><p>å†™çš„æ—¶å€™è¦æ³¨æ„æ˜¯ä»å³å¾€å·¦æ¨ä¸Šæ¥çš„ï¼Œè¦ç»†å¿ƒå¤„ç†ï¼Œä¸ç„¶å®¹æ˜“é”™ã€‚</p><hr><h3 id="std-initializer-list-C-11"><a href="#std-initializer-list-C-11" class="headerlink" title="std::initializer_list (C++11)"></a><code>std::initializer_list</code> (C++11)</h3><h4 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;initializer_list&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Add</span><span class="params">(<span class="keyword">const</span> std::initializer_list&lt;<span class="keyword">int</span>&gt; &amp;z)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> x : z)</span><br><span class="line">    ans = (ans + x) % mod;</span><br><span class="line">  <span class="keyword">return</span> (ans % mod + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Add</span>(&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>&#125;); <span class="comment">// returns 16 % mod;</span></span><br></pre></td></tr></table></figure><h4 id="ä¼˜ç‚¹-2"><a href="#ä¼˜ç‚¹-2" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><p>å†™èµ·æ¥<strong>è´¼</strong>æ–¹ä¾¿ï¼Œå®Œå…¨ç¬¦åˆ C++ å…·åè§„èŒƒï¼Œå®¹æ˜“æ“ä½œã€‚</p><p>è¿™ä¸€ä¸ªä¼˜ç‚¹å°±å¤Ÿå¼ºäº†ï¼Œè¿˜è¦å•¥è‡ªè¡Œè½¦ï¼ˆ</p><h4 id="ç¼ºç‚¹-2"><a href="#ç¼ºç‚¹-2" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><p>è°ƒç”¨çš„æ—¶å€™é‚£ä¸ªèŠ±æ‹¬å·å¤ªéš¾å—äº†ï¼ˆ</p><p>æ„Ÿè§‰ä¸Š STL å¯èƒ½ä¼šå¸¦ä¸ªå¤§å¸¸æ•°ï¼Œå®é™…ä¸Šè·Ÿæ¨¡æ¿å†™æ³•çš„é€’å½’å·®ä¸å¤šï¼ˆO2ï¼‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœæ•™ç­›å­¦ä¹ ç¬”è®°</title>
      <link href="/2020/%E6%9D%9C%E6%95%99%E7%AD%9B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2020/%E6%9D%9C%E6%95%99%E7%AD%9B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>æœæ•™ç­›èƒ½å¤Ÿåœ¨ä½äºçº¿æ€§å¤æ‚åº¦çš„æ—¶é—´å†…æ±‚å‡ºç§¯æ€§å‡½æ•°å‰ç¼€å’Œã€‚</p><span id="more"></span><hr><p>æœ‰ä¸¤ä¸ªæ•°è®ºå‡½æ•° $f, g$ï¼Œä»¤</p><script type="math/tex; mode=display">h(x) = \sum_{d | x}{f(d) g \left( \frac xd \right)}</script><p>åˆ™ç§° $h$ æ˜¯ $f$ å’Œ $g$ çš„ Dirichlet å·ç§¯ï¼Œå³ $h = f * g$ã€‚</p><p>ä¸¤ä¸ªæ•°è®ºå‡½æ•°çš„ Dirichlet å·ç§¯ä¹Ÿæ˜¯æ•°è®ºå‡½æ•°ã€‚</p><hr><p>å¯¹äºä¸€ä¸ªæ•°è®ºå‡½æ•°ï¼Œè¦æ±‚å‡º $S(n) = \sum_{i = 1}^n{f(i)}$ã€‚</p><p>æ„é€  $g, h$ ä½¿å¾— $h = f * g$ï¼Œåˆ™</p><script type="math/tex; mode=display">\begin{align}\sum_{i = 1}^n{h(i)} &= \sum_{i = 1}^n{\sum_{d | 1}{g(d) f \left(\frac id \right)}} \\&= \sum_{d = 1}^n g(d){\sum_{d | i}^n f \left(\frac id \right)} \\&= \sum_{d = 1}^n{g(d) \sum_{i = 1}^{\lfloor \frac nd \rfloor}{f(i)}} \\&= \sum_{d = 1}^n{g(d) S \left(\left\lfloor \frac nd \right\rfloor \right)} \\&= g(1)S(n) + \sum_{d = 2}^n{g(d) S \left(\left\lfloor \frac nd \right\rfloor \right)} \\S(n) &= \frac{\sum_{i = 1}^n{h(i)} - \sum_{d = 2}^n{g(d) S \left(\left\lfloor \frac nd \right\rfloor \right)}}{g(1)}\end{align}</script><p>ä¸Šé¢çš„å¼å­å®é™…ä¸Šæ˜¯ç»™å‡ºäº†ä¸€ä¸ªå…³äº $S$ çš„é€’æ¨å¼ã€‚ç›´æ¥è¿™æ ·ææ˜¯ $O(n^\frac 34)$ çš„ã€‚å¯ä»¥çº¿æ€§ç­›å‡ºå‰ $n^\frac 23$ ä¸ªç­”æ¡ˆï¼Œè¿™æ ·æ€»å¤æ‚åº¦æ˜¯ $O(n^\frac 23)$ çš„<del>ï¼Œéƒ½ä¸ä¼šè¯</del>ã€‚</p><hr><script type="math/tex; mode=display">\mathrm{Id} = \varphi * \mathbf 1 \\S(n) = \frac{n(n + 1)}{2} - \sum_{d = 2}^n{S \left( \left\lfloor \frac nd \right\rfloor \right)} \\\epsilon = \mu * \mathbf 1 \\S(n) = 1 - \sum_{d = 2}^n{S \left( \left\lfloor \frac nd \right\rfloor \right)} \\\mathrm{Id}^2 = (\varphi \times \mathrm{Id}) * \mathrm{Id} \\\varphi = \mu * \mathrm{Id}</script><hr><p>ç›®å‰ç½‘ç»œä¸Šçš„æœæ•™ç­›ä»£ç å¤§éƒ½å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li><p>ç”¨ <code>std::unordered_map</code> çš„ä»£ç åœ¨åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ—¶ç›´æ¥ touch ä¸€ä¸‹æ¥åˆ¤ç­‰è€Œä¸æ˜¯ <code>::count</code>ã€‚<del>è¿èƒŒäº† STL çš„ç¾å­¦</del>ï¼ˆå½“ç„¶ï¼Œç”±äºè¿™ä¸ªå€¼æœ€åæ€»æ˜¯è¦æ’å…¥çš„ï¼ŒåŠ äº†ä¸ªå°å¸¸æ•°ä¸ç®—å•¥äº‹ï¼‰</p></li><li><p>åˆ¤æ–­ $S_\mu$ æ˜¯å¦è®¡ç®—è¿‡æ—¶ç›´æ¥å’Œ 0 åˆ¤ç­‰ã€‚$S_\mu$ çš„å–å€¼åœ¨æŸäº›æƒ…å†µä¸‹æœ¬æ¥å°±æ˜¯ 0ï¼Œæ¯æ¬¡éƒ½è¦é‡æ–°è®¡ç®—ä¸€éç›¸å½“äºå‡­ç©ºäº§ç”Ÿå¸¸æ•°ã€‚ï¼ˆå¯¹ç†è®ºå¤æ‚åº¦æœ‰æ— å½±å“ä¸ä¼šç®—ï¼‰</p></li></ol><p>ä¸¤ä¸ªé—®é¢˜å¾ˆå¥½è§£å†³ï¼Œå¯¹äºç”¨ <code>std::unordered_map</code> çš„æ—¶å€™è¿™ä¸¤ä¸ªé—®é¢˜å¯ä»¥ç”¨ <code>::count</code> ä¸€èµ·æ”¹æ‰ï¼›å¦‚æœç”¨äº†æ•°ç»„ä¼˜åŒ–ï¼Œç¬¬äºŒä¸ªé—®é¢˜éœ€è¦ç”¨å…¶ä»–æ‰‹æ®µè®°å½•ä¸€ä¸‹ã€‚</p><hr><p>ç»™ä¸€ä¸‹<a href="https://www.luogu.com.cn/problemnew/show/P4213">æ´›è°·æ¨¡æ¿é¢˜</a>çš„ä»£ç ã€‚</p><p>å¦‚æœ æ—¶ç©ºè¦æ±‚éƒ½ä¸ä¸¥æ ¼ æˆ–æ˜¯åƒè¿™é¢˜ä¸€æ ·å¤šç»„è¯¢é—® å¯ä»¥ç”¨ <code>std::unordered_map</code> è¿›è¡Œè®°å¿†åŒ–ã€‚</p><p>ä¸‹é¢çš„ä»£ç å¯ä»¥ 320msï¼ˆè¯„æµ‹é¸­ï¼‰é€šè¿‡æé™æ•°æ®ï¼ˆ10 ç»„è¯¢é—®ï¼Œ2147483638 ~ 2147483647ï¼‰ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unordered_map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> ll = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">unsigned</span> base = <span class="number">1664510</span>;</span><br><span class="line"></span><br><span class="line">std::bitset&lt;1664513&gt; v;</span><br><span class="line"><span class="keyword">int</span> p[<span class="number">125641</span>], mu[<span class="number">1664513</span>];</span><br><span class="line">phi[<span class="number">1664513</span>];</span><br><span class="line">std::unordered_map&lt;<span class="keyword">unsigned</span>, ll&gt; mu_, phi_;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">unsigned</span> N)</span></span>; <span class="comment">// æ™®é€šåœ°çº¿ç­›å‡º 1~N çš„ mu å’Œ phi å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">getMu</span><span class="params">(<span class="keyword">unsigned</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (N &lt;= base) <span class="keyword">return</span> mu[N];</span><br><span class="line">  <span class="keyword">if</span> (mu_.<span class="built_in">count</span>(N)) <span class="keyword">return</span> mu_[N];</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">unsigned</span> l = <span class="number">2</span>, r, L; l &lt;= N; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">    L = N / l, r = N / L;</span><br><span class="line">    ans += (r - l + <span class="number">1</span>) * <span class="built_in">getMu</span>(L);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> mu_[N] = <span class="number">1ll</span> - ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">getPhi</span><span class="params">(<span class="keyword">unsigned</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (N &lt;= base) <span class="keyword">return</span> phi[N];</span><br><span class="line">  <span class="keyword">if</span> (phi_.<span class="built_in">count</span>(N)) <span class="keyword">return</span> phi_[N];</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">unsigned</span> l = <span class="number">2</span>, r, L; l &lt;= N; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">    L = N / l, r = N / L;</span><br><span class="line">    ans += (r - l + <span class="number">1</span>) * <span class="built_in">getPhi</span>(L);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> phi_[N] = (<span class="number">1ull</span> * N * (N + <span class="number">1ull</span>) &gt;&gt; <span class="number">1</span>) - ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> T, N;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">sieve</span>(base);</span><br><span class="line">  <span class="keyword">for</span> (std::cin &gt;&gt; T; T; --T) &#123;</span><br><span class="line">    std::cin &gt;&gt; N;</span><br><span class="line">    std::cout &lt;&lt; <span class="built_in">getPhi</span>(N) &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="built_in">getMu</span>(N) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><p>ä½†æ˜¯ï¼Œ<code>std::unordered_map</code> çš„å¤§å¸¸æ•°æœ‰æ—¶ä»¤äººéš¾ä»¥æ¥å—ã€‚å‘ç°å¯¹äºæ¯æ¬¡è¯¢é—®ï¼Œéœ€è¦çš„ $S$ å€¼éƒ½æ˜¯å½¢å¦‚ $S \left(\frac nd \right)$ çš„ï¼Œå› æ­¤ä¸ä¼šè¶…è¿‡ $\sqrt n$ ä¸ªã€‚</p><p>å¯ä»¥å†å¼€ä¸€ä¸ªå¤§å°ä¸º $\sqrt n$ çš„æ•°ç»„è¿›è¡Œè®°å¿†åŒ–ã€‚ï¼ˆæˆ‘çš„å®ç°ä¸­ç”¨çš„æ˜¯ $n^\frac 23$ï¼‰</p><p>æ³¨æ„å¯¹äºæ¯ä¸ª $n$ï¼Œ$f \left(\frac nd \right)$ çš„å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤æ¯æ¬¡è¯¢é—®éœ€è¦æ¸…ç©ºé‡æ–°è®¡ç®—ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å•æ¬¡è¯¢é—®æ›´ä¼˜ï¼Œä½†å¤šæ¬¡è¯¢é—®åœ¨æé™æ•°æ®ä¸‹åªèƒ½é€šè¿‡ T = 5</span></span><br><span class="line"><span class="comment">// ä¸è¿‡è°·çš„æ¿é¢˜æ•°æ®å¾ˆæ°´æ‰€ä»¥å¯ä»¥è¿‡ï¼ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> ll = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">unsigned</span> base = <span class="number">1664510</span>;</span><br><span class="line"></span><br><span class="line">std::bitset&lt;1664513&gt; v, vm, vp;</span><br><span class="line"><span class="keyword">int</span> MX, p[<span class="number">125641</span>]ï¼Œ mu[<span class="number">1664510</span>], mu_[<span class="number">1664510</span>];</span><br><span class="line">ll phi[<span class="number">1664510</span>], phi_[<span class="number">1664510</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">to</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> MX / x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">unsigned</span> N)</span></span>; <span class="comment">// åŒä¸Š</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getMu</span><span class="params">(<span class="keyword">unsigned</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (N &lt;= base) <span class="keyword">return</span> mu[N];</span><br><span class="line">  <span class="keyword">if</span> (vm[<span class="built_in">to</span>(N)]) <span class="keyword">return</span> mu_[<span class="built_in">to</span>(N)];</span><br><span class="line">  <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">unsigned</span> l = <span class="number">2</span>, r, L; l &lt;= N; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">    L = N / l, r = N / L;</span><br><span class="line">    ans += (r - l + <span class="number">1</span>) * <span class="built_in">getMu</span>(L);</span><br><span class="line">  &#125;</span><br><span class="line">  vm.<span class="built_in">set</span>(<span class="built_in">to</span>(N));</span><br><span class="line">  <span class="keyword">return</span> mu_[<span class="built_in">to</span>(N)] = <span class="number">1</span> - ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">getPhi</span><span class="params">(<span class="keyword">unsigned</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (N &lt;= base) <span class="keyword">return</span> phi[N];</span><br><span class="line">  <span class="keyword">if</span> (vp[<span class="built_in">to</span>(N)]) <span class="keyword">return</span> phi_[<span class="built_in">to</span>(N)];</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">unsigned</span> l = <span class="number">2</span>, r, L; l &lt;= N; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">    L = N / l, r = N / L;</span><br><span class="line">    ans += (r - l + <span class="number">1</span>) * <span class="built_in">getPhi</span>(L);</span><br><span class="line">  &#125;</span><br><span class="line">  vp.<span class="built_in">set</span>(<span class="built_in">to</span>(N));</span><br><span class="line">  <span class="keyword">return</span> phi_[<span class="built_in">to</span>(N)] = (<span class="number">1ull</span> * N * (N + <span class="number">1ull</span>) &gt;&gt; <span class="number">1</span>) - ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> T, N;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">sieve</span>(base);</span><br><span class="line">  <span class="keyword">for</span> (std::cin &gt;&gt; T; T; --T) &#123;</span><br><span class="line">    vm.<span class="built_in">reset</span>(), vp.<span class="built_in">reset</span>();</span><br><span class="line"></span><br><span class="line">    std::cin &gt;&gt; N;</span><br><span class="line">    MX = N;</span><br><span class="line">    std::cout &lt;&lt; <span class="built_in">getPhi</span>(N) &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="built_in">getMu</span>(N) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 Apr Records</title>
      <link href="/2020/2020-Apr-Records/"/>
      <url>/2020/2020-Apr-Records/</url>
      
        <content type="html"><![CDATA[<p>èœé¸¡ fa_555 ä¼šæŠŠä¸€äº›åŠ¨æ€ç®€è¦åœ°è®°åœ¨è¿™é‡Œã€‚ä¸»è¦è¿˜æ˜¯ç•™ç»™è‡ªå·±ä»¥åçœ‹çš„ã€‚</p><span id="more"></span><p><em>æ‰€æœ‰ä»£ç ä¸ä¿è¯åŒ…æ‹¬æ— å…³ç´§è¦çš„éƒ¨åˆ†</em></p><hr><h3 id="SCOI2007-kçŸ­è·¯"><a href="#SCOI2007-kçŸ­è·¯" class="headerlink" title="[SCOI2007]kçŸ­è·¯"></a><a href="https://www.luogu.com.cn/problem/P4467">[SCOI2007]kçŸ­è·¯</a></h3><h4 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h4><p><del>è¿™æ˜¯ä¸€é“å¡ A* çš„ A* æ¨¡æ¿é¢˜</del></p><p>ç®€å•è¯´ä¸€ä¸‹ A* ç®—æ³•ã€‚å¯¹äºä¸€ä¸ªæœç´¢çŠ¶æ€ï¼Œè®¾è®¡å‡½æ•° $f, g, h, h^\ast$ã€‚å…¶ä¸­ $g$ ä¸ºæœç´¢åˆ°å½“å‰çŠ¶æ€çš„ä»£ä»·ï¼›$h$ ä¸ºä¼°è®¡å‰©ä½™çš„ä»£ä»·ï¼›$h^\ast$ ä¸ºå®é™…å‰©ä½™çš„ä»£ä»·ï¼Œ$h &lt; h^\ast$ï¼Œä¸”å·®è·è¶Šå°æ•ˆç‡è¶Šé«˜ï¼›$f = g + h$ï¼Œå¯¹ $f$ ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—å³å¯ã€‚</p><h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> N, K;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span> &#123; <span class="type">int</span> nxt, to, w; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> G1 &#123;</span><br><span class="line">  std::bitset&lt;51&gt; vis;</span><br><span class="line">  <span class="type">int</span> head[<span class="number">51</span>], dis[<span class="number">51</span>];</span><br><span class="line">  Edge e[<span class="number">2451</span>];</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s)</span></span>;</span><br><span class="line">&#125; <span class="comment">// G1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> G2 &#123;</span><br><span class="line">  <span class="type">int</span> *h = G1::dis, head[<span class="number">51</span>];</span><br><span class="line">  Edge e[<span class="number">2451</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    std::bitset&lt;51&gt; vis;</span><br><span class="line">    <span class="type">int</span> s, u, len, f;</span><br><span class="line">    std::vector&lt;<span class="type">int</span>&gt; z;</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> Node &amp;rhs) <span class="type">const</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (f != rhs.f) <span class="keyword">return</span> f &gt; rhs.f;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, mx = std::<span class="built_in">min</span>(z.<span class="built_in">size</span>(), rhs.z.<span class="built_in">size</span>()); i &lt; mx; ++i)</span><br><span class="line">        <span class="keyword">if</span> (z[i] != rhs.z[i]) <span class="keyword">return</span> z[i] &gt; rhs.z[i];</span><br><span class="line">      <span class="keyword">return</span> z.<span class="built_in">size</span>() &gt; rhs.z.<span class="built_in">size</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">Astar</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">    std::priority_queue&lt;Node&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(&#123;std::<span class="built_in">bitset</span>&lt;<span class="number">51</span>&gt;(<span class="number">1ll</span> &lt;&lt; s), s, s, <span class="number">0</span>, h[s], std::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;()&#125;);</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (Node now, nxt; q.<span class="built_in">size</span>(); ) &#123;</span><br><span class="line">      now = q.<span class="built_in">top</span>(), q.<span class="built_in">pop</span>();</span><br><span class="line">      <span class="keyword">if</span> (now.u == t &amp;&amp; ++cnt == K) &#123;</span><br><span class="line">        cout &lt;&lt; now.s;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> u : now.z)</span><br><span class="line">          cout &lt;&lt; -u;</span><br><span class="line">        cout.<span class="built_in">flush</span>();</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> i = head[now.u], v; i; i = e[i].nxt) &#123;</span><br><span class="line">        <span class="keyword">if</span> (now.vis[v = e[i].to]) <span class="keyword">continue</span>;</span><br><span class="line">        nxt = &#123;now.vis, now.s, v, now.len + e[i].w, h[v], now.z&#125;;</span><br><span class="line">        nxt.vis.<span class="built_in">set</span>(v), nxt.z.<span class="built_in">push_back</span>(v), nxt.f += nxt.len;</span><br><span class="line">        q.<span class="built_in">push</span>(nxt);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">// G2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> M, S, T;</span><br><span class="line"></span><br><span class="line">  cin &gt;&gt; N &gt;&gt; M &gt;&gt; K &gt;&gt; S &gt;&gt; T;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> u, v, w; M; --M) &#123;</span><br><span class="line">    cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">    G1::<span class="built_in">addEdge</span>(v, u, w), G2::<span class="built_in">addEdge</span>(u, v, w);</span><br><span class="line">  &#125;</span><br><span class="line">  G1::<span class="built_in">spfa</span>(T), G2::<span class="built_in">Astar</span>(S, T);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;No&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="NOI2005-æ™ºæ…§ç æ¸¸æˆ"><a href="#NOI2005-æ™ºæ…§ç æ¸¸æˆ" class="headerlink" title="[NOI2005]æ™ºæ…§ç æ¸¸æˆ"></a><a href="https://www.luogu.com.cn/problem/P4205">[NOI2005]æ™ºæ…§ç æ¸¸æˆ</a></h3><p>DLX æ˜¯ä¹‹å‰å­¦çš„ï¼Œè¿™é‡Œè®°ä¸€è®°æ€ä¹ˆå»ºå‡ºä¸€ä¸ªç²¾ç¡®è¦†ç›–æ¨¡å‹ã€‚</p><ol><li><p>å¯¹æ•´ä¸ªæ‹¼ç›˜æŒ‰ç…§ä¸€å®šçš„æ–¹æ³•ç¼–å·ï¼Œæ¯ä¸ªæ ¼å­å¯¹åº”ä¸€ä¸ªå·ç ï¼ˆä¸‹é¢çš„ä»£ç é‡‡ç”¨å…ˆä»å·¦åˆ°å³ï¼Œå†ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡ç¼–å·ï¼‰ã€‚</p></li><li><p>æŠŠæ‰€æœ‰é›¶ä»¶çš„å½¢çŠ¶å­˜ä¸‹æ¥ã€‚è¿™é‡Œé‡‡å–çš„æ˜¯ç¡®å®šä¸€ä¸ªå…³é”®ç‚¹ï¼Œå…¶ä½™ç‚¹ç”¨ç›¸å¯¹åæ ‡è¡¨ç¤ºçš„æ–¹æ³•ã€‚</p></li><li><p>è®¾ä¸€ä¸ªæœ‰è‹¥å¹²è¡Œã€æ¯è¡Œ 67 åˆ—çš„ 01 çŸ©é˜µï¼Œæ¯è¡Œè¡¨ç¤ºæŸä¸ªé›¶ä»¶çš„ä¸€ç§æ‘†æ³•ã€‚å…¶ä¸­å·¦ 12 åˆ—è¡¨ç¤º 12 ä¸ªé›¶ä»¶ç§ç±»ï¼ˆç¬¬ $i$ åˆ—ä¸º $1$ è¡¨ç¤ºè¯¥è¡Œä»£è¡¨ç¬¬ $i$ ç§é›¶ä»¶çš„æŸç§æ‘†æ³•ï¼‰ï¼›å³ 55 åˆ—è¡¨ç¤ºæ‹¼ç›˜ä¸Šçš„ 55 ä¸ªç©ºä½ï¼Œç¬¬ $i$ åˆ—ä¸º $1$ è¡¨ç¤ºè¿™ç§æ‘†æ³•å æ®äº†ç¬¬ $i$ ä¸ªæ ¼å­ã€‚</p></li><li><p>å¯¹äº <strong>12 ç§</strong>é›¶ä»¶åˆ†åˆ«æšä¸¾æ‘†æ³•ã€‚</p><ul><li><p>é¦–å…ˆæšä¸¾ä¸Šæ–‡æåˆ°çš„â€œå…³é”®ç‚¹â€çš„åæ ‡ï¼Œä¸€å…± <strong>55â€‹ ç§</strong>æƒ…å†µã€‚</p></li><li><p>ç„¶åè¦æšä¸¾å®ƒçš„æ—‹è½¬ã€ç¿»è½¬å˜æ¢ã€‚ç„¶è€Œæ—‹è½¬æ“ä½œå¹¶ä¸æ–¹ä¾¿ç¼–ç¨‹ç›´æ¥å®ç°ï¼Œè¦è€ƒè™‘æ€ä¹ˆå®ç°ã€‚ç”»ä¸€ç”»å›¾å‘ç°ä¸€å…±æœ‰ <strong>8 ç§</strong>ä¸åŒæ‘†æ³•ï¼ˆå¦‚å›¾ï¼‰</p></li><li><p><img src="/files/img/P4205_1.png" alt="æˆ‘æ˜¯å›¾"></p></li><li><p>å‘ç°å¯ä»¥é€šè¿‡ä¸‰ç§ç®€å•çš„å˜æ¢å¾—åˆ°ï¼šäº¤æ¢æ¨ªçºµåæ ‡ã€æ¨ªåæ ‡å–ç›¸åæ•°ã€çºµåæ ‡å–ç›¸åæ•°ã€‚</p></li></ul></li><li><p>æŠŠæšä¸¾å‡ºæ¥çš„æ‰€æœ‰çŠ¶æ€å…¨æ‰”è¿›ä¸€ä¸ªçŸ©é˜µï¼ŒDLX è·‘ä¸ªç²¾ç¡®è¦†ç›–ï¼Œå®Œäº‹äº†ã€‚ç»Ÿè®¡ç­”æ¡ˆæœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œå¯ä»¥å„è·¯ç¥ä»™å…«ä»™è¿‡æµ·ä¸€ä¸‹ï¼ˆ</p></li><li><p>å¯¹äºå…¨ç©ºæ‹¼ç›˜ï¼Œç†è®ºä¸ŠçŸ©é˜µæœ€å¤§è¡Œæ•° $12 \times 55 \times 8 = 5280$ï¼Œå®é™…ä¸Šç”±äºé›¶ä»¶å½¢çŠ¶çš„åˆ¶çº¦åªæœ‰ <strong>2730 ç§</strong>ï¼ŒçŸ©é˜µä¸­çš„ $1$ æœ€å¤š <strong>15083â€‹ ä¸ª</strong>ã€‚</p></li></ol><h4 id="code-1"><a href="#code-1" class="headerlink" title="code"></a>code</h4><p>å¯¹äºä¸Šé¢çš„ä¸‰ç§å˜æ¢ï¼Œè¿™é‡Œé€šè¿‡çŠ¶æ€ $S \in [0, 8)$ æ¥æšä¸¾ï¼Œ$S$ çš„æœ€ä½ä¸‰ä½ä»é«˜åˆ°ä½ä¾æ¬¡è¡¨ç¤ºæ˜¯å¦äº¤æ¢æ¨ªçºµåæ ‡ã€æ¨ªåæ ‡æ˜¯å¦ç›¸åæ•°ã€çºµåæ ‡æ˜¯å¦å–ç›¸åæ•°ã€‚</p><p>éƒ¨åˆ†å˜é‡è§£é‡Šï¼š</p><ul><li><p><code>siz[i]</code> è¡¨ç¤ºç¬¬ $i$ ç§é›¶ä»¶çš„ç å­ä¸ªæ•°</p></li><li><p><code>sh[i][][]</code> è¡¨ç¤ºç¬¬ $i$ ç§é›¶ä»¶çš„å½¢çŠ¶ï¼ˆè§ä¸Šæ–‡ï¼‰</p></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> siz[] = &#123;</span><br><span class="line">  <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span></span><br><span class="line">&#125;, sh[<span class="number">13</span>][<span class="number">5</span>][<span class="number">2</span>] = &#123;&#123;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">2</span>&#125;, &#123;<span class="number">0</span>, <span class="number">3</span>&#125;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">2</span>&#125;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">1</span>&#125;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">2</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">2</span>&#125;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">2</span>, <span class="number">0</span>&#125;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">2</span>, <span class="number">0</span>&#125;, &#123;<span class="number">2</span>, <span class="number">1</span>&#125;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">2</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">1</span>&#125;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">2</span>, <span class="number">0</span>&#125;, &#123;<span class="number">2</span>, <span class="number">1</span>&#125;, &#123;<span class="number">3</span>, <span class="number">1</span>&#125;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">2</span>&#125;, &#123;<span class="number">2</span>, <span class="number">2</span>&#125;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">2</span>, <span class="number">0</span>&#125;, &#123;<span class="number">3</span>, <span class="number">0</span>&#125;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> Data = std::vector&lt;std::pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt;;</span><br><span class="line"></span><br><span class="line">std::bitset&lt;13&gt; used;</span><br><span class="line"><span class="type">char</span> z[<span class="number">13</span>][<span class="number">13</span>];</span><br><span class="line">Data v[<span class="number">13</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> DLX &#123;</span><br><span class="line">  <span class="keyword">using</span> iarr = <span class="type">int</span>[<span class="number">15085</span>];</span><br><span class="line"></span><br><span class="line">  std::bitset&lt;69&gt; mp[<span class="number">2733</span>];</span><br><span class="line">  <span class="type">int</span> tot, ans[<span class="number">15</span>], cnt[<span class="number">69</span>], h[<span class="number">2733</span>];</span><br><span class="line">  iarr l, r, u, d, x, y;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> M)</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">link</span><span class="params">(<span class="type">int</span> R, <span class="type">int</span> C)</span></span>;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">remove</span><span class="params">(<span class="type">int</span> C)</span></span>;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">resume</span><span class="params">(<span class="type">int</span> C)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dance</span><span class="params">(<span class="type">int</span> dep)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!r[<span class="number">0</span>]) &#123;</span><br><span class="line">      <span class="comment">/* output */</span></span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* ... */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">// DLX</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pos</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> </span>&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">int</span> to[] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">28</span>, <span class="number">36</span>, <span class="number">45</span>, <span class="number">55</span>&#125;;</span><br><span class="line">  <span class="keyword">return</span> to[i - <span class="number">1</span>] + j;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> c, <span class="type">const</span> Data &amp;v)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// v ä¸­çš„å…ƒç´ ä¸ºé¢œè‰² c æŸç§çŠ¶æ€å æ®çš„åæ ‡</span></span><br><span class="line">  <span class="type">static</span> <span class="type">int</span> M = <span class="number">0</span>;</span><br><span class="line">  DLX::<span class="built_in">link</span>(++M, c);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;x : v)</span><br><span class="line">    DLX::<span class="built_in">link</span>(M, <span class="number">12</span> + <span class="built_in">pos</span>(x.first, x.second));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">valid</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span> &lt;= x &amp;&amp; x &lt;= <span class="number">10</span> &amp;&amp; <span class="number">1</span> &lt;= y &amp;&amp; y &lt;= x &amp;&amp; z[x][y] == <span class="string">&#x27;.&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; ++i)</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= i; ++j) &#123;</span><br><span class="line">      std::cin &gt;&gt; z[i][j];</span><br><span class="line">      <span class="keyword">if</span> (z[i][j] != <span class="string">&#x27;.&#x27;</span>) &#123;</span><br><span class="line">        used.<span class="built_in">set</span>(z[i][j] &amp; <span class="number">31</span>);</span><br><span class="line">        v[z[i][j] &amp; <span class="number">31</span>].<span class="built_in">push_back</span>(&#123;i, j&#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  DLX::<span class="built_in">init</span>(<span class="number">67</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">12</span>; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (used[i]) &#123;</span><br><span class="line">      <span class="built_in">insert</span>(i, v[i]);</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v[i].<span class="built_in">resize</span>(siz[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> pi = <span class="number">1</span>; pi &lt;= <span class="number">10</span>; ++pi)</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> pj = <span class="number">1</span>; pj &lt;= pi; ++pj)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> S = <span class="number">0</span>; S &lt; <span class="number">8</span>; ++S) &#123;</span><br><span class="line">          <span class="type">bool</span> g = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>, nx, ny; j &lt; siz[i]; ++j) &#123;</span><br><span class="line">            nx = sh[i][j][<span class="number">0</span>], ny = sh[i][j][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (S &amp; <span class="number">4</span>) std::<span class="built_in">swap</span>(nx, ny);</span><br><span class="line">            <span class="keyword">if</span> (S &amp; <span class="number">2</span>) nx = -nx;</span><br><span class="line">            <span class="keyword">if</span> (S &amp; <span class="number">1</span>) ny = -ny;</span><br><span class="line">            nx += pi, ny += pj;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">valid</span>(nx, ny)) &#123; g = <span class="number">1</span>; <span class="keyword">break</span>; &#125;</span><br><span class="line">            v[i][j] = &#123;nx, ny&#125;;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (!g) <span class="built_in">insert</span>(i, v[i]);</span><br><span class="line">        &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  DLX::<span class="built_in">dance</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;No solution&quot;</span>); <span class="comment">// æœ‰è§£çš„æƒ…å†µåœ¨ DLX ä¸­ç›´æ¥é€€å‡º</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="æ•°å­¦"><a href="#æ•°å­¦" class="headerlink" title="æ•°å­¦"></a>æ•°å­¦</h3><p>åœ¨ CSG é‚£é‡Œå­¦ä¹ äº†ä¸€ä¸ªã€‚</p><p>æœ¬æ¥æƒ³æå¤šé¡¹å¼ï¼Œç»“æœè¢«æ•°è®ºæ°´å¹³é™åˆ¶äº†ï¼Œå»ä»é›¶é‡å­¦æ•°è®ºï¼Œæ²¡æƒ³åˆ°ä¸€å­¦å°±æ˜¯å¥½é•¿å¥½é•¿å¥½é•¿æ—¶é—´ /kk</p><p><a href="https://fa555.github.io/2020/%E6%9D%9C%E6%95%99%E7%AD%9B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">å­¦ä¹ æœæ•™ç­›</a></p><p><a href="https://www.luogu.com.cn/problem/P4450">åŒäº²æ•°</a>å‘ç°äº†è‡ªå·±ä»¥å‰é¢˜è§£çš„é”™è¯¯å¹¶<a href="https://fa555.github.io/2019/%E9%A2%98%E8%A7%A3-P4450-%E3%80%90%E5%8F%8C%E4%BA%B2%E6%95%B0%E3%80%91/">é‡å†™</a></p><p><a href="https://www.luogu.com.cn/problem/P5170">ç±»æ¬§å‡ é‡Œå¾—ç®—æ³•</a>èŠ±ä¸¤å¤©è¾¹é¢“è¾¹<a href="https://fa555.github.io/2020/%E7%B1%BB%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95%E6%8A%84%E5%BC%8F%E5%AD%90%E7%AC%94%E8%AE%B0/">æŠ„äº†ä¸€éå¼å­</a>åˆèŠ±ä¸€å¤©å†™å‡ºæ¥ä»£ç ï¼Œ<del>å› ä¸ºæ‡’</del><a href="https://fa555.github.io/2020/cpp%E4%B8%8D%E5%AE%9A%E5%8F%82%E5%87%BD%E6%95%B0%E5%88%9D%E6%8E%A2//">ç ”ç©¶äº†å„ç§ä¸å®šå‚çš„å†™æ³•</a>ã€‚</p><hr><h3 id="BSGS"><a href="#BSGS" class="headerlink" title="BSGS"></a>BSGS</h3><p>å­¦äº† BSGS å’Œ exBSGSã€‚<del>å¥½éš¾å•Šç›´æ¥èƒŒå§</del></p><p>å†…é™„ä¸€ä¸ª Hash è¡¨æ¿å­ï¼Œæœºåˆ¶ç±»ä¼¼äº <code>std::unordered_map</code> ä½†æ˜¯è·‘å¾—å¿«ï¼ˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> Hmod = <span class="number">1000003</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Hash</span> &#123;</span><br><span class="line">  std::bitset&lt;Hmod&gt; vis;</span><br><span class="line">  <span class="type">int</span> tv[Hmod], tp[Hmod];</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    vis.<span class="built_in">reset</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> k = p % Hmod;</span><br><span class="line">    <span class="keyword">for</span> (; vis[k]; ++k %= Hmod)</span><br><span class="line">      <span class="keyword">if</span> (tp[k] == p) &#123;</span><br><span class="line">        tv[k] = v;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    vis.<span class="built_in">set</span>(k), tv[k] = v, tp[k] = p;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = p % Hmod; vis[k]; ++k %= Hmod)</span><br><span class="line">      <span class="keyword">if</span> (tp[k] == p) <span class="keyword">return</span> tv[k];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; z;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">BSGS</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> p, <span class="type">int</span> sd)</span> </span>&#123;</span><br><span class="line">  z.<span class="built_in">clear</span>();</span><br><span class="line">  <span class="type">int</span> v = <span class="number">1</span>, t = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; t; ++i, v = <span class="number">1ll</span> * v * a % p)</span><br><span class="line">    z.<span class="built_in">insert</span>(<span class="number">1ll</span> * v * b % p, i);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, j, v_ = v, v = sd; i &lt;= t; ++i, v = <span class="number">1ll</span> * v * v_ % p)</span><br><span class="line">    <span class="keyword">if</span> ((j = z.<span class="built_in">query</span>(v)) != <span class="number">-1</span> &amp;&amp; i * t &gt;= j) <span class="keyword">return</span> i * t - j;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">exBSGS</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">  a %= p, b %= p;</span><br><span class="line">  <span class="keyword">if</span> (b == <span class="number">1</span> || p == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>, sd = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> d; (d = std::__gcd(a, p)) != <span class="number">1</span>; ) &#123;</span><br><span class="line">    <span class="keyword">if</span> (b % d) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    ++cnt, b /= d, p /= d;</span><br><span class="line">    sd = <span class="number">1ll</span> * sd * a / d % p;</span><br><span class="line">    <span class="keyword">if</span> (sd == b) <span class="keyword">return</span> cnt;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> ans = <span class="built_in">BSGS</span>(a, b, p, sd);</span><br><span class="line">  <span class="keyword">if</span> (ans != <span class="number">-1</span>) ans += cnt;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="åŸæ ¹"><a href="#åŸæ ¹" class="headerlink" title="åŸæ ¹"></a>åŸæ ¹</h3><p>å…³äºåŸæ ¹çš„ç¬”è®°<a href="https://fa555.github.io/2020/%E5%8E%9F%E6%A0%B9%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">åœ¨è¿™é‡Œ</a></p><hr><h3 id="SDOI2010-å¤ä»£çŒªæ–‡"><a href="#SDOI2010-å¤ä»£çŒªæ–‡" class="headerlink" title="[SDOI2010]å¤ä»£çŒªæ–‡"></a><a href="https://www.luogu.com.cn/problemnew/solution/P2480">[SDOI2010]å¤ä»£çŒªæ–‡</a></h3><h4 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šæ­£æ•´æ•° $n, g \ (n, g \le 10^9)$ï¼Œæ±‚ $g^{ \sum_{d \mid n}{ \binom nd}} \bmod 999911659$ã€‚</p><h4 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h4><p>æœ¬èƒ½è€ƒè™‘æ¬§æ‹‰å®šç†ï¼Œåˆ™ç­”æ¡ˆç­‰äº $g^{ \sum_{d \mid n}{ \binom nd} \bmod 999911658} \bmod 999911659$ã€‚</p><p>è®¾ $x = \sum_{d \mid n}{ \binom nd} \bmod 999911658$ï¼Œé‡ç‚¹åœ¨äºæ±‚å‡º $x$ã€‚æ€ä¹ˆæ±‚å‘¢ï¼Ÿ</p><h5 id="Extended-Lucas"><a href="#Extended-Lucas" class="headerlink" title="Extended Lucas"></a>Extended Lucas</h5><p>è¿™ä¸ªæŒ‡æ•°å¯ä»¥ç›´æ¥æ— è„‘ä¸Š Extended Lucas å˜›å¯¹ä¸å¯¹ï¼ˆ</p><p>è¿™ä¸ªå¤æ‚åº¦ä¸Šå¤©çš„åšæ³•åœ¨ LOJ æ˜¯æœ€åŠ£è§£ç¬¬ä¸€ï¼Œåœ¨è°·ç›´æ¥ TLE æˆäº† 70 åˆ†ï¼ˆ</p><h5 id="Lucas-CRT"><a href="#Lucas-CRT" class="headerlink" title="Lucas + CRT"></a>Lucas + CRT</h5><p>è€ƒè™‘å¯¹æ¨¡æ•°è¿›è¡Œè´¨å› æ•°åˆ†è§£ï¼Œ$999911658 = 2 \times 3 \times 4679 \times 35617$ã€‚å‘ç°å››ä¸ªå› å­éƒ½æ˜¯è´¨æ•°è€Œä¸æ˜¯è´¨æ•°çš„å¹‚ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ Lucas è®¡ç®—å‡º</p><script type="math/tex; mode=display">\begin{cases}x \equiv r_1 \pmod 2 \\x \equiv r_2 \pmod 3 \\x \equiv r_3 \pmod{4679} \\x \equiv r_4 \pmod{35617}\end{cases}</script><p>ä¸­çš„ $r_1, r_2, r_3, r_4$ï¼Œå†ä½¿ç”¨ CRT åˆå¹¶å¾—åˆ° $x$ã€‚</p><h4 id="code-2"><a href="#code-2" class="headerlink" title="code"></a>code</h4><p>è¿™ä¸ªåšæ³•æˆ‘çš„å®ç°åœ¨ LOJ å¾—åˆ°äº†æœ€ä¼˜è§£ç¬¬äºŒã€‚<del>å¦‚æœæˆ‘æ—©äº¤ 11 ä¸ªå°æ—¶å°±èƒ½å½“ç¬¬ä¸€</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> m[<span class="number">5</span>] = &#123;<span class="number">999911659</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4679</span>, <span class="number">35617</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> r[<span class="number">5</span>], fac[<span class="number">5</span>][<span class="number">35619</span>], invF[<span class="number">5</span>][<span class="number">35619</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Pow</span><span class="params">(ll b, ll p, ll m)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">prework</span><span class="params">()</span></span>; <span class="comment">// åœ¨ fac[k][i] å’Œ invF[k][i] ä¸­æ±‚å‡ºæ¨¡ m[k] æ„ä¹‰ä¸‹ i çš„é˜¶ä¹˜åŠå…¶é€†å…ƒ</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">C</span><span class="params">(<span class="type">int</span> N, <span class="type">int</span> M, <span class="type">int</span> k)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Lucas</span><span class="params">(<span class="type">int</span> N, <span class="type">int</span> M, <span class="type">int</span> k)</span></span>; <span class="comment">// æ±‚ C(N, M) % m[k]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> N, <span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= <span class="number">4</span>; ++k)</span><br><span class="line">    r[k] = (r[k] + <span class="built_in">Lucas</span>(N, i, k)) % m[k];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">CRT</span><span class="params">(<span class="type">int</span> N, <span class="type">int</span> *r, <span class="type">const</span> <span class="type">int</span> *m)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constexpr</span> <span class="type">int</span> p = *m - <span class="number">1</span>;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= N; ++k)</span><br><span class="line">    ans = (ans + <span class="number">1ll</span> * r[k] * (p / m[k]) % p * <span class="built_in">Pow</span>(p / m[k], m[k] - <span class="number">2</span>, m[k]) % p) % p;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> N, <span class="type">int</span> g)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (g % *m == <span class="number">0</span>) &#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">prework</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i * i &lt;= N; ++i)</span><br><span class="line">    <span class="keyword">if</span> (N % i == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">calc</span>(N, i);</span><br><span class="line">      <span class="keyword">if</span> (i * i != N) <span class="built_in">calc</span>(N, N / i);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Pow</span>(g, <span class="built_in">CRT</span>(<span class="number">4</span>, r, m), *m);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="HAOI2011-Problem-b"><a href="#HAOI2011-Problem-b" class="headerlink" title="[HAOI2011]Problem b"></a><a href="https://www.luogu.com.cn/problem/P2522">[HAOI2011]Problem b</a></h3><h4 id="problem-1"><a href="#problem-1" class="headerlink" title="problem"></a>problem</h4><p>$T \ (1 \le T \le 5 \times 10^4)$ ç»„æ•°æ®ï¼Œç»™å®š $a, b, c, d, k \ (1 \le a, b, c, d, k \le 5 \times 10^4)$ï¼Œæ±‚ $\sum<em>{i = a}^b{ \sum</em>{j = c}^d{[\gcd(i, j) = k]}}$ã€‚</p><h4 id="solution-2"><a href="#solution-2" class="headerlink" title="solution"></a>solution</h4><p>æˆ‘ä»¥å‰å†™è¿‡<a href="https://www.luogu.org/problem/P4450">è¿™é“é¢˜</a>çš„<a href="https://fa555.github.io/2019/%E9%A2%98%E8%A7%A3-P4450-%E3%80%90%E5%8F%8C%E4%BA%B2%E6%95%B0%E3%80%91/">é¢˜è§£</a>å¯¹å§ï¼ˆ</p><p>ä¸€æ¨¡ä¸€æ ·ï¼Œå¥—ä¸ªå‚»é€¼å®¹æ–¥å°±å®Œäº†ï¼Œæ€»å¤æ‚åº¦ $O(n + T \sqrt n)$ï¼Œå¸¦ä¸€ä¸ªä¸å°çš„å¸¸æ•°ã€‚</p><hr><h3 id="LCMSUM"><a href="#LCMSUM" class="headerlink" title="LCMSUM"></a><a href="https://www.luogu.com.cn/problem/SP5971">LCMSUM</a></h3><h4 id="problem-2"><a href="#problem-2" class="headerlink" title="problem"></a>problem</h4><p>$T \ (1 \le T \le 3 \times 10^5)$ ç»„æ•°æ®ï¼Œç»™å®š $n \ (1 \le n \le 10^6)$ï¼Œæ±‚ $\sum_{i = 0}^n{ \mathrm{lcm}(i, n)}$ã€‚</p><h4 id="solution-3"><a href="#solution-3" class="headerlink" title="solution"></a>solution</h4><p>è®¾ $dâ€™ = n / d$ï¼Œåˆ™</p><script type="math/tex; mode=display">\begin{align}\sum_{i = 0}^n{ \mathrm{lcm}(i, n)} &= \sum_{i = 1}^n \frac{in}{ \gcd(i, n)} \\&= \frac 12 \left( \sum_{i = 1}^{n - 1}{ \frac{in}{ \gcd(i, n)} + \sum_{i = n - 1}^1{ \frac{in}{ \gcd(i, n)}}} \right) + n \\&= \frac 12 \left( \sum_{i = 1}^{n - 1}{ \frac{in}{ \gcd(i, n)} + \sum_{i = n - 1}^1{ \frac{in}{ \gcd(n - i, n)}}} \right) + n \\&= \frac 12 \sum_{i = 1}^{n - 1}{ \frac{n^2}{ \gcd(i, n)}} + n \\&= \frac 12 \sum_{i = 1}^n{ \frac{n^2}{ \gcd(i, n)}} + \frac n2 \\&= \frac 12 \sum_{d \mid n}{\frac{n^2 \varphi(d')}d} + \frac n2 \\&= \frac n2 \left( \sum_{d \mid n}{d' \varphi(d') + 1} \right)\end{align}</script><p>è®¾ $f(n) = \sum_{d \mid n} d \ \varphi(d)$ã€‚</p><p>$f$ æ˜¯ç§¯æ€§å‡½æ•°ï¼Œå¯ä»¥ $O(n) - O(1)$ï¼Œæ€»å¤æ‚åº¦ $O(n + T)$ã€‚$O(n)$ ç­›è¿™ä¸ªå‡½æ•°çš„æ“ä½œå¥½åƒå¾ˆéªšçš„æ ·å­ï¼Œä¸è¿‡ä¹Ÿæœ‰ $O(n \log n)$ çš„ç”¨ $\varphi$ é—´æ¥æ±‚çš„ç®—æ³•ã€‚</p><h4 id="code-3"><a href="#code-3" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">std::bitset&lt;1000003&gt; v;</span><br><span class="line"><span class="type">int</span> p[<span class="number">78501</span>];</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> f[<span class="number">1000003</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> sieve = ([]() &#123;</span><br><span class="line">  <span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1000000</span>;</span><br><span class="line">  <span class="type">int</span> M = <span class="number">0</span>;</span><br><span class="line">  v.<span class="built_in">set</span>(<span class="number">1</span>), f[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!v[i]) p[++M] = i, f[i] = <span class="number">1ll</span> * i * (i - <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= M &amp;&amp; i * p[j] &lt;= N; ++j) &#123;</span><br><span class="line">      v.<span class="built_in">set</span>(i * p[j]);</span><br><span class="line">      <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i / p[j] % p[j] == <span class="number">0</span>)</span><br><span class="line">          f[i * p[j]] = f[i] + (f[i] - f[i / p[j]]) * p[j] * p[j];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          f[i * p[j]] = f[i] + f[i / p[j]] * (p[j] - <span class="number">1</span>) * p[j] * p[j] * p[j];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      f[i * p[j]] = f[i] * f[p[j]];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (f[N] * N + N) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="Crashçš„æ•°å­—è¡¨æ ¼"><a href="#Crashçš„æ•°å­—è¡¨æ ¼" class="headerlink" title="Crashçš„æ•°å­—è¡¨æ ¼"></a><a href="https://www.luogu.org/problem/P1829">Crashçš„æ•°å­—è¡¨æ ¼</a></h3><h4 id="problem-3"><a href="#problem-3" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®š $n, m \ (1 \le n, m, \le 10^7)$ï¼Œæ±‚ $\sum<em>{i = 1}^n{ \sum</em>{j = 1}^m{ \mathrm{lcm}(i, j)}}$ åœ¨æ¨¡æ„ä¹‰ä¸‹çš„å€¼ã€‚</p><h4 id="solution-4"><a href="#solution-4" class="headerlink" title="solution"></a>solution</h4><p>ä¸å¦¨è®¾ $n \le m$ã€‚</p><script type="math/tex; mode=display">\begin{align}\sum_{i = 1}^n{ \sum_{j = 1}^m{ \mathrm{lcm}(i, j)}} &= \sum_{i = 1}^n{ \sum_{j = 1}^m{ \frac{ij}{ \gcd(i, j)}}} \\&= \sum_{i = 1}^n{ \sum_{j = 1}^m{ \sum_{d \mid \gcd(i, j), \left[ \frac id \perp \frac jd \right]}{ \frac{ij}d}}} \\&= \sum_{d = 1}^n{d \sum_{i = 1}^{ \lfloor n / d \rfloor}{ \sum_{j = 1}^{ \lfloor m / d \rfloor}{[i \perp j] \ ij}}}\end{align}</script><p>ä»¤ $S(n, m) = \sum<em>{i = 1}^n{ \sum</em>{j = 1}^m{[i \perp j] \ ij}}$ï¼Œåˆ™</p><script type="math/tex; mode=display">\begin{align}S(n, m) &= \sum_{i = 1}^n{ \sum_{j = 1}^m{ \epsilon( \gcd(i, j)) ij}} \\&= \sum_{d = 1}^n{ \sum_{d \mid i}^n{ \sum_{d \mid j}^m{ \mu(d)ij}}} \\&= \sum_{d = 1}^n{ \mu(d)d^2 \sum_{i = 1}^{n / d}{ \sum_{j = 1}^{m / d}{ij}}}\end{align}</script><p>ä»¤ $f(n, m) = \sum<em>{i = 1}^n{ \sum</em>{j = 1}^m ij} = \frac{n(n + 1)}2 \times \frac{m(m + 1)}2$ï¼Œåˆ™</p><script type="math/tex; mode=display">S(n, m) = \sum_{d = 1}^n{ \mu(d) Â· d^2 Â· f \left( \left\lfloor \frac nd \right\rfloor, \left\lfloor \frac md \right\rfloor \right)}</script><p>å¯ä»¥æ•°è®ºåˆ†å— $O \left( \left\lfloor \frac{n}{ \lfloor n / d \rfloor} \right\rfloor \right)$ æ±‚ $S(n, m)$ã€‚åˆ™åŸç­”æ¡ˆä¸º</p><script type="math/tex; mode=display">\sum_{d = 1}^n{d Â· S \left( \left\lfloor \frac nd \right\rfloor, \left\lfloor \frac md \right\rfloor \right)}</script><hr><h4 id="code-4"><a href="#code-4" class="headerlink" title="code"></a>code</h4><p>æ³¨æ„ä»£ç ä¸­æœ‰ä¸¤å¤„ <code>assert</code>ï¼Œæ”¹å˜å…¶æ•°é‡ï¼Œåœ¨è¯„æµ‹é¸­å®æµ‹é€Ÿåº¦ 2 &gt; 0 &gt; 1ï¼Œä¸çŸ¥ä¸ºä½•ã€‚<del>å¯èƒ½æ˜¯ç„å­¦</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">20101009</span>;</span><br><span class="line"></span><br><span class="line">std::bitset&lt;10000003&gt; v;</span><br><span class="line"><span class="type">int</span> p[<span class="number">664581</span>], mu[<span class="number">10000003</span>], g[<span class="number">10000003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sieve</span><span class="params">(<span class="type">int</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* ç­›å‡º mu[1..N] */</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    g[i] = (g[i - <span class="number">1</span>] + <span class="number">1ll</span> * i * i % mod * (mu[i] + mod) % mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(<span class="type">int</span> N, <span class="type">int</span> M)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="number">1ll</span> * N * (N + <span class="number">1</span>) / <span class="number">2</span> % mod) * (<span class="number">1ll</span> * M * (M + <span class="number">1</span>) / <span class="number">2</span> % mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">S</span><span class="params">(<span class="type">int</span> N, <span class="type">int</span> M)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">assert</span>(N &lt;= M);</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r, n, m; l &lt;= N; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">    n = N / l, m = M / l;</span><br><span class="line">    r = std::<span class="built_in">min</span>(N / n, M / m);</span><br><span class="line">    ans = (ans + <span class="number">1ll</span> * (g[r] - g[l - <span class="number">1</span>] + mod) * <span class="built_in">f</span>(n, m) % mod) % mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> N, <span class="type">int</span> M)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">assert</span>(N &lt;= M);</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r, n, m; l &lt;= N; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">    n = N / l, m = M / l;</span><br><span class="line">    r = std::<span class="built_in">min</span>(N / n, M / m);</span><br><span class="line">    ans = (ans + <span class="number">1ll</span> * (r - l + <span class="number">1</span>) * (l + r) / <span class="number">2</span> % mod * <span class="built_in">S</span>(n, m) % mod) % mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> N, M;</span><br><span class="line"></span><br><span class="line">  std::cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">  <span class="keyword">if</span> (N &gt; M) std::<span class="built_in">swap</span>(N, M);</span><br><span class="line">  <span class="built_in">sieve</span>(N);</span><br><span class="line">  std::cout &lt;&lt; <span class="built_in">solve</span>(N, M);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="SDOI2015çº¦æ•°ä¸ªæ•°å’Œ"><a href="#SDOI2015çº¦æ•°ä¸ªæ•°å’Œ" class="headerlink" title="[SDOI2015çº¦æ•°ä¸ªæ•°å’Œ]"></a><a href="https://www.luogu.com.cn/problem/P3327">[SDOI2015çº¦æ•°ä¸ªæ•°å’Œ]</a></h3><h4 id="problem-4"><a href="#problem-4" class="headerlink" title="problem"></a>problem</h4><p>$T \ (1 \le T \le 50000)$ ç»„æ•°æ®ï¼Œç»™å®š $n, m \ (1 \le n, m \le 50000)$ï¼Œæ±‚ $\sum<em>{i = 1}^n{ \sum</em>{j = 1}^m{ \mathrm d(ij)}}$ã€‚å…¶ä¸­ $\mathrm d$ ä¸ºçº¦æ•°ä¸ªæ•°å‡½æ•°ã€‚</p><h4 id="solution-5"><a href="#solution-5" class="headerlink" title="solution"></a>solution</h4><p>é¦–å…ˆæœ‰ä¸ªå¾ˆå°‘äººä¼šè¯çš„ç»“è®º</p><script type="math/tex; mode=display">\mathrm d(ij) = \sum_{x \mid i}{ \sum_{y \mid j}{[x \perp y]}}</script><p>ç„¶åå¯ä»¥é€šè¿‡ä¸€ç³»åˆ—ç®€å•çš„æ“ä½œå¾—åˆ°ç­”æ¡ˆä¸ºï¼ˆè®¾ $n \le m$ï¼‰</p><script type="math/tex; mode=display">\sum_{d = 1}^n{ \mu(d) Â· S_\mathrm d \left( \left\lfloor \frac nd \right\rfloor \right) Â· S_\mathrm d \left( \left\lfloor \frac md \right\rfloor \right)}</script><p>å…¶ä¸­ $S_\mathrm d$ ä¸º $\mathrm d$ çš„å‰ç¼€å’Œå‡½æ•°ã€‚å¤–å±‚æ˜¾ç„¶æ•°è®ºåˆ†å—ï¼Œæ€»å¤æ‚åº¦æ˜¯ $O(n + T \sqrt n)$ã€‚</p><hr><h3 id="ZJOI2014-åŠ›"><a href="#ZJOI2014-åŠ›" class="headerlink" title="[ZJOI2014]åŠ›"></a><a href="https://www.luogu.com.cn/problem/P3338">[ZJOI2014]åŠ›</a></h3><h4 id="problem-5"><a href="#problem-5" class="headerlink" title="problem"></a>problem</h4><p>ç»™å‡º $n \ (1 \le n \le 10^5)$ ä¸ªæ•° $q_i \ (1 \le q_i &lt; 10^9)$ï¼Œå®šä¹‰</p><script type="math/tex; mode=display">F_i = \sum_{j = 1}^{i - 1}{\frac{q_i q_j}{(i - j)^2}} - \sum_{j = i + 1}^n \frac{q_i q_j}{(i - j)^2} \\E_i = \frac{F_i}{q_i}</script><p>æ±‚ $E_{1 \dots n}$ã€‚</p><h4 id="solution-6"><a href="#solution-6" class="headerlink" title="solution"></a>solution</h4><script type="math/tex; mode=display">E_i = \frac{F_i}{q_i} = \sum_{j = 1}^{i - 1}{\frac{q_j}{(i - j)^2}} - \sum_{j = i + 1}^n \frac{q_j}{(i - j)^2}</script><p>ä»¤</p><script type="math/tex; mode=display">f_i = \begin{cases}0 & , i = 0 \\q_i & , i > 0\end{cases}, \quad g_i = \begin{cases}0 & , i = 0 \\\frac 1{i^2} & , i > 0\end{cases}</script><p>åˆ™</p><script type="math/tex; mode=display">\begin{align}E_i &= \sum_{j = 0}^{i}{f_j g_{i - j}} - \sum_{j = i}^n{f_j g_{j - i}} \\&= \sum_{j = 0}^{i}{f_j g_{i - j}} - \sum_{j = 0}^{n - i}{f_{i + j} g_{j}}\end{align}</script><p>ä»¤ $fâ€™<em>i = f</em>{n - i}, t = n - i$ï¼Œåˆ™</p><script type="math/tex; mode=display">E_i = \sum_{j = 0}^{i}{f_j g_{i - j}} - \sum_{j = 0}^t{f'_{t - j} g_{j}}</script><p>å¼å­æ¨å®Œäº†ï¼Œå¼€å§‹æ•´å¤šé¡¹å¼ã€‚ä»¤ï¼ˆæ³¨æ„æ­¤å¤„ $F$ ä¸é¢˜ç›®ç»™å‡ºçš„ $F$ ä¸åŒï¼‰</p><script type="math/tex; mode=display">\begin{align}A(x) &= \sum_{i = 0}^n{f_i x^i} \\B(x) &= \sum_{i = 0}^n{f'_i x^i} \\C(x) &= \sum_{i = 0}^n{g_i x^i} \\F(x) &= A(x) \ast C(x) \\G(x) &= B(x) \ast C(x) \\E_i &= F_i - G_{n - i}\end{align}</script><h4 id="code-5"><a href="#code-5" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> ans[<span class="number">50003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span>* <span class="title">solve</span><span class="params">(<span class="type">int</span> N, <span class="type">double</span> *p)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> lim, l;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (lim = <span class="number">1</span>, l = <span class="number">-1</span>; lim &lt;= N &lt;&lt; <span class="number">1</span>; lim &lt;&lt;= <span class="number">1</span>, ++l);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    to[i] = (to[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; l);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    A[i].x = B[N - i].x = p[i];</span><br><span class="line">    C[i].x = <span class="number">1.</span> / (<span class="number">1.</span> * i * i);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">FFT</span>(lim, A, <span class="number">1</span>), <span class="built_in">FFT</span>(lim, B, <span class="number">1</span>), <span class="built_in">FFT</span>(lim, C, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    A[i] = A[i] * C[i], B[i] = B[i] * C[i];</span><br><span class="line">  <span class="built_in">FFT</span>(lim, A, <span class="number">-1</span>), <span class="built_in">FFT</span>(lim, B, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    ans[i] = A[i].x - B[N - i].x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="AHOI2017-HNOI2017-ç¤¼ç‰©"><a href="#AHOI2017-HNOI2017-ç¤¼ç‰©" class="headerlink" title="[AHOI2017/HNOI2017]ç¤¼ç‰©"></a><a href="https://www.luogu.com.cn/problem/P3723">[AHOI2017/HNOI2017]ç¤¼ç‰©</a></h3><h4 id="solution-7"><a href="#solution-7" class="headerlink" title="solution"></a>solution</h4><p>æšä¸¾å¯¹ç¬¬ä¸€ä¸ªæ‰‹ç¯æ•´ä½“åŠ  $c \ (-m &lt; c &lt; m)$ï¼Œé‚£ä¹ˆä¸¤ä¸ªæ‰‹ç¯ä¹‹é—´çš„å·®å¼‚å€¼ä¸º</p><script type="math/tex; mode=display">\begin{align}& \sum_{i = 1}^n{(a_i + c - b_i)^2} \\=& \sum_{i = 1}^n{(a_i^2 + b_i^2 + c^2 + 2 a_i c - 2 b_i c - 2 a_i b_i)} \\=& \sum_{i = 1}^n{(a_i^2 + b_i^2)} + 2 c \sum_{i = 1}^n{(a_i - b_i)} - 2 \sum_{i = 1}^n{a_i b_i} + nc^2\end{align}</script><p>å‘ç°é™¤äº†æœ€åä¸€é¡¹ä»¥å¤–éƒ½æ˜¯ç¡®å®šçš„ã€‚é‚£ä¹ˆåªè¦ä»¤ $\sum_{i = 1}^n{a_i b_i}$ æœ€å¤§å°±å¯ä»¥å¾—åˆ°æœ€å°å€¼äº†ã€‚</p><p>é¦–å…ˆæŠŠ $a$ åºåˆ—åå‘ä¸€ä¸‹ï¼Œå¾—åˆ° $\sum<em>{i = 1}^n{a</em>{n - i + 1}^n b_i}$ï¼Œç„¶ååœ¨åå‘åçš„ $a$ å€é•¿ç ´ç¯æˆé“¾ï¼Œä¸ $b$ å·èµ·æ¥å¾—åˆ°çš„æ–°å¤šé¡¹å¼çš„ç¬¬ $n + 1\sim 2n$ é¡¹ä¸­æ‰¾æœ€å¤§å€¼å³å¯ã€‚</p><h4 id="code-6"><a href="#code-6" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> N, <span class="type">int</span> *a, <span class="type">int</span> M, <span class="type">int</span> *b)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> lim, l, ans = <span class="number">0x3f3f3f3f</span>, ans1 = <span class="number">0</span>, ans2 = <span class="number">0</span>, ans3 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (lim = <span class="number">1</span>, l = <span class="number">-1</span>; lim &lt;= N * <span class="number">3</span>; lim &lt;&lt;= <span class="number">1</span>, ++l);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    to[i] = (to[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; l);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, t; i &lt; N; ++i) &#123;</span><br><span class="line">    t = a[i + <span class="number">1</span>];</span><br><span class="line">    A[N - i].x = A[(N &lt;&lt; <span class="number">1</span>) - i].x = t;</span><br><span class="line">    ans1 += t * t, ans2 += t &lt;&lt; <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, t; i &lt;= N; ++i) &#123;</span><br><span class="line">    t = b[i];</span><br><span class="line">    B[i].x = t;</span><br><span class="line">    ans1 += t * t, ans2 -= t &lt;&lt; <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">FFT</span>(lim, A, <span class="number">1</span>), <span class="built_in">FFT</span>(lim, B, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    A[i] = A[i] * B[i];</span><br><span class="line">  <span class="built_in">FFT</span>(lim, A, <span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = N + <span class="number">1</span>; i &lt;= N &lt;&lt; <span class="number">1</span>; ++i)</span><br><span class="line">    ans3 = std::<span class="built_in">max</span>(ans3, <span class="built_in">int</span>(A[i].x + <span class="number">0.5</span>));</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = -M; i &lt;= M; ++i)</span><br><span class="line">    ans = std::<span class="built_in">min</span>(ans, i * ans2 + N * i * i);</span><br><span class="line">  ans += ans1 - (ans3 &lt;&lt; <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="SP4882-DAGCNT2-Counting-in-a-DAG"><a href="#SP4882-DAGCNT2-Counting-in-a-DAG" class="headerlink" title="SP4882 DAGCNT2 - Counting in a DAG"></a><a href="https://www.luogu.com.cn/jump/spoj/4882">SP4882 DAGCNT2 - Counting in a DAG</a></h3><h4 id="problem-6"><a href="#problem-6" class="headerlink" title="problem"></a>problem</h4><p>$T \ (1 \le T \le 2)$ ç»„æ•°æ®ï¼Œç»™å®š $n \ (1 \le n \le 2 \times 10^4)$ ä¸ªç‚¹ $m \ (1 \le m \le 5 \times 10^5)$ æ¡è¾¹çš„ DAGï¼Œç‚¹å¸¦æƒï¼Œæ±‚æ¯ä¸ªç‚¹å‡ºå‘æ‰€èƒ½åˆ°è¾¾çš„ç‚¹çš„ç‚¹æƒå’Œã€‚</p><h4 id="solution-8"><a href="#solution-8" class="headerlink" title="solution"></a>solution</h4><p>å•Šï¼Œè¿™ä¸ªé—®é¢˜çš„å¤æ‚åº¦å·²ç»è¢«è¯æ˜ä¸‹ç•Œæ˜¯ $O(n^2)$ çš„äº†ï¼ˆ</p><p>æˆ‘éå¸¸å¥½å¥‡æ€ä¹ˆè¿‡è¿™ä¸ªæ•°æ®èŒƒå›´ï¼Œäºæ˜¯åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸€ç¯‡ç¥ä»™çŠ¶å‹çš„ä»£ç å¹¶æŠ„äº†ä¸€éï¼ˆ</p><h4 id="code-7"><a href="#code-7" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> iarrN = <span class="type">int</span>[<span class="number">20003</span>];</span><br><span class="line"></span><br><span class="line">std::bitset&lt;20003&gt; vis;</span><br><span class="line"><span class="type">int</span> top, f[<span class="number">20003</span>][<span class="number">627</span>];</span><br><span class="line">iarrN mp, rmp, s, w, outd, ans;</span><br><span class="line">std::vector&lt;<span class="type">int</span>&gt; G[<span class="number">20003</span>], R[<span class="number">20003</span>], D[<span class="number">20003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> N)</span> </span>&#123;</span><br><span class="line">  vis.<span class="built_in">reset</span>();</span><br><span class="line">  <span class="built_in">memset</span>(outd + <span class="number">1</span>, <span class="number">0</span>, <span class="built_in">sizeof</span>(<span class="type">int</span>) * N);</span><br><span class="line">  <span class="built_in">memset</span>(ans + <span class="number">1</span>, <span class="number">0</span>, <span class="built_in">sizeof</span>(<span class="type">int</span>) * N);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    G[i].<span class="built_in">clear</span>(), R[i].<span class="built_in">clear</span>(), D[i].<span class="built_in">clear</span>();</span><br><span class="line">    <span class="built_in">memset</span>(f[i], <span class="number">0</span>, <span class="built_in">sizeof</span>(<span class="type">int</span>) * ((i &gt;&gt; <span class="number">5</span>) + <span class="number">1</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">  vis.<span class="built_in">set</span>(u);</span><br><span class="line">  f[u][u &gt;&gt; <span class="number">5</span>] |= <span class="number">1</span> &lt;&lt; (u &amp; <span class="number">31</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> v : D[u])</span><br><span class="line">    <span class="keyword">if</span> (!(f[u][v &gt;&gt; <span class="number">5</span>] &amp; (<span class="number">1</span> &lt;&lt; (v &amp; <span class="number">31</span>)))) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!vis[v]) <span class="built_in">dfs</span>(v);</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= v &gt;&gt; <span class="number">5</span>; ++j)</span><br><span class="line">        f[u][j] |= f[v][j];</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= u &gt;&gt; <span class="number">5</span>; ++j)</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)</span><br><span class="line">      <span class="keyword">if</span> (f[u][j] &amp; (<span class="number">1</span> &lt;&lt; i))</span><br><span class="line">        ans[rmp[u]] += w[rmp[(j &lt;&lt; <span class="number">5</span>) + i]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> T, N, M;</span><br><span class="line"></span><br><span class="line">  cin &gt;&gt; T;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> _T = <span class="number">0</span>; _T &lt; T; ++_T) &#123;</span><br><span class="line">    cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">    <span class="keyword">if</span> (_T) <span class="built_in">init</span>(N);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">      cin &gt;&gt; w[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, u, v; i &lt;= M; ++i) &#123;</span><br><span class="line">      cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">      G[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">      R[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">      ++outd[u];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">      <span class="keyword">if</span> (!outd[i]) s[++top] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, u; top; ) &#123;</span><br><span class="line">      u = s[top--], mp[u] = i, rmp[i] = u, ++i;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> v : R[u])</span><br><span class="line">        <span class="keyword">if</span> (!--outd[v]) s[++top] = v;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> u = <span class="number">1</span>; u &lt;= N; ++u)</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> v : G[u])</span><br><span class="line">        D[mp[u]].<span class="built_in">push_back</span>(mp[v]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">      std::<span class="built_in">sort</span>(D[i].<span class="built_in">rbegin</span>(), D[i].<span class="built_in">rend</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = N; i; --i)</span><br><span class="line">      <span class="keyword">if</span> (!vis[i]) <span class="built_in">dfs</span>(i);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">      cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="æ®‹ç¼ºçš„å­—ç¬¦ä¸²"><a href="#æ®‹ç¼ºçš„å­—ç¬¦ä¸²" class="headerlink" title="æ®‹ç¼ºçš„å­—ç¬¦ä¸²"></a><a href="https://www.luogu.com.cn/problem/P4173">æ®‹ç¼ºçš„å­—ç¬¦ä¸²</a></h3><h4 id="problem-7"><a href="#problem-7" class="headerlink" title="problem"></a>problem</h4><p>åº”è¯¥å«<strong>ã€æ¨¡æ¿ã€‘å¸¦é€šé…ç¬¦çš„å•æ¨¡å¼ä¸²åŒ¹é…</strong>ï¼ˆ</p><p>ç»™å®šé•¿ä¸º $m$ çš„æ¨¡å¼ä¸² $A$ å’Œé•¿ä¸º $n$ çš„æ¨¡å¼ä¸² $B \ (1 \le m, n \le 3 \times 10^5)$ã€‚å­—ç¬¦é›†å°å†™å­—æ¯å’Œ*ï¼Œ*å¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦ã€‚</p><p>æ±‚ $B$ ä¸²æ¯ä¸ªå¯ä»¥å®Œå…¨åŒ¹é… $A$ ä¸²çš„ä½ç½®ã€‚</p><h4 id="solution-å•æ¨¡å¼ä¸²åŒ¹é…"><a href="#solution-å•æ¨¡å¼ä¸²åŒ¹é…" class="headerlink" title="solution - å•æ¨¡å¼ä¸²åŒ¹é…"></a>solution - å•æ¨¡å¼ä¸²åŒ¹é…</h4><p>å¦‚æœä¸å¸¦é€šé…ç¬¦ï¼Œkmp ç®—æ³•å¯ä»¥åœ¨ $O(n + m)$ çš„æ—¶é—´å†…è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¯¹äºå¸¦é€šé…ç¬¦çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨å¤šé¡¹å¼å·ç§¯æ¥è§£å†³ã€‚</p><p>é¦–å…ˆä»ä¸å¸¦é€šé…ç¬¦å¼€å§‹è€ƒè™‘ã€‚æ–¹ä¾¿èµ·è§ï¼Œå­—ç¬¦ä¸²çš„ä¸‹æ ‡å‡ä» $0$ å¼€å§‹ã€‚</p><p>å®šä¹‰å®Œå…¨åŒ¹é…å‡½æ•° $P(x) = \sum<em>{i = 0}^{m - 1}{(A_i - B</em>{x - m + i + 1})^2}$ï¼Œå…¶ä¸­å¹³æ–¹æ˜¯ä¸ºäº†ä¿è¯æ¯ä¸€ä½çš„å–å€¼éè´Ÿï¼›é‚£ä¹ˆè‹¥ $P(x) = 0$ï¼Œåˆ™ $B_{x - m + 1 \dots x}$ ä¸ $A$ å®Œå…¨åŒ¹é…ã€‚ä¸ºäº†åˆ¶é€ å·ç§¯å½¢å¼ï¼ŒæŠŠ $A$ ä¸²ç¿»è½¬å¾—åˆ°ä¸² $S$ï¼Œé‚£ä¹ˆåŒ¹é…å‡½æ•°</p><script type="math/tex; mode=display">\begin{align}P(x) &= \sum_{i = 0}^{m - 1}{(S_{m - i - 1} - B_{x - m + i + 1})^2} \\&= \sum_{i = 0}^{m - 1}{S_{m - i - 1}^2} + \sum_{i = 0}^{m - 1}{B_{x - m + i + 1}^2} - 2 \sum_{i = 0}^{m - 1}{S_{m - i - 1} B_{x - m + i + 1}}\end{align}</script><p>ç¬¬ä¸€é¡¹å¯ä»¥ $O(m)$ æ±‚å¾—ï¼Œç¬¬äºŒé¡¹å¯ä»¥ $O(n)$ é¢„å¤„ç†å‰ç¼€å’Œï¼Œéœ€è¦æ±‚çš„åªæœ‰ç¬¬ä¸‰é¡¹ã€‚å‘ç°ç¬¬ä¸‰é¡¹ä¸¤ä¸ªä¸‹æ ‡çš„å’Œæ°å¥½ç­‰äº $x$ï¼Œå› æ­¤å¯ä»¥å†™æˆ $- 2 \sum_{i + j = x}{S_i B_j}$ï¼ˆæƒ³ä¸€æƒ³ï¼Œä¸ºä»€ä¹ˆï¼Ÿï¼‰</p><p>è®¾ $T = \sum<em>{i = 0}^{m - 1} S_i^2, f(x) = \sum</em>{i = 0}^x{B<em>i^2}, g(x) = \sum</em>{i + j = x}{S_i B_j}$ï¼Œåˆ™æœ‰ $P(x) = T + f(x) - f(x - m) - 2 g(x)$ã€‚è¿™ä¸ªç›´æ¥ FFT ä¸€ä¸‹å°±å¥½äº†ã€‚</p><h4 id="solution-å¸¦é€šé…ç¬¦çš„å•æ¨¡å¼ä¸²åŒ¹é…"><a href="#solution-å¸¦é€šé…ç¬¦çš„å•æ¨¡å¼ä¸²åŒ¹é…" class="headerlink" title="solution - å¸¦é€šé…ç¬¦çš„å•æ¨¡å¼ä¸²åŒ¹é…"></a>solution - å¸¦é€šé…ç¬¦çš„å•æ¨¡å¼ä¸²åŒ¹é…</h4><p>ç”±äºå‡ºç°äº†é€šé…ç¬¦ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªæ–°çš„åŒ¹é…å‡½æ•°ã€‚è®¾é€šé…ç¬¦çš„æ•°å€¼ä¸º 0ï¼Œå®šä¹‰å®Œå…¨åŒ¹é…å‡½æ•° $P(x) = \sum<em>{i = 0}^{m - 1}(A_i - B</em>{x - m + i + 1})^2 A<em>i B</em>{x - m + i + 1}$ã€‚æŠŠ $A$ ä¸²ç¿»è½¬å¾—åˆ°ä¸² $S$ï¼Œé‚£ä¹ˆåŒ¹é…å‡½æ•°</p><script type="math/tex; mode=display">\begin{align}P(x) &= \sum_{i = 0}^{m - 1}{(S_{m - i - 1} - B_{x - m + i + 1})^2 S_{m - i - 1} B_{x - m + i + 1}} \\&= \sum_{i = 0}^{m - 1}{S_{m - i - 1}^3 B_{x - m + i + 1}} + \sum_{i = 0}^{m - 1}{S_{m - i - 1} B_{x - m + i + 1}^3} - 2 \sum_{i = 0}^{m - 1}{S_{m - i - 1}^2 B_{x - m + i + 1}^2}\end{align}</script><p>å‘ç°æ‰€æœ‰çš„é¡¹çš„ä¸¤ä¸ªä¸‹æ ‡çš„å’Œéƒ½ä¸º $x$ï¼Œåˆ™æœ‰</p><script type="math/tex; mode=display">P(x) = \sum_{i + j = x}{S_i^3 B_j} + \sum_{i + j = x}{S_i B_j^3} - 2 \sum_{i + j = x}{S_i^2 B_j^2}</script><p>6 æ¬¡ DFT å’Œ 1 æ¬¡ IDFT å³åˆ»æ±‚å‡ºã€‚</p><h4 id="code-8"><a href="#code-8" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Complex F[<span class="number">1</span>&lt;&lt;<span class="number">20</span>|<span class="number">1</span>], G[<span class="number">1</span>&lt;&lt;<span class="number">20</span>|<span class="number">1</span>], P[<span class="number">1</span>&lt;&lt;<span class="number">20</span>|<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> A[<span class="number">1</span>&lt;&lt;<span class="number">20</span>|<span class="number">1</span>], B[<span class="number">1</span>&lt;&lt;<span class="number">20</span>|<span class="number">1</span>], to[<span class="number">1</span>&lt;&lt;<span class="number">20</span>|<span class="number">1</span>];</span><br><span class="line">std::vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line"></span><br><span class="line"><span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">solve</span><span class="params">(<span class="type">int</span> M, <span class="type">char</span> *s1, <span class="type">int</span> N, <span class="type">char</span> *s2)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> lim, l, tot = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (lim = <span class="number">1</span>, l = <span class="number">-1</span>; lim &lt;= M + N; lim &lt;&lt;= <span class="number">1</span>, ++l);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    to[i] = (to[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; l);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; M; ++i)</span><br><span class="line">    A[M - i - <span class="number">1</span>] = s1[i] == <span class="string">&#x27;*&#x27;</span> ? <span class="number">0</span> : s1[i] &amp; <span class="number">31</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">    B[i] = s2[i] == <span class="string">&#x27;*&#x27;</span> ? <span class="number">0</span> : s2[i] &amp; <span class="number">31</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    F[i] = <span class="built_in">Complex</span>(A[i] * A[i] * A[i], <span class="number">0</span>), G[i] = <span class="built_in">Complex</span>(B[i], <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">FFT</span>(lim, F, <span class="number">1</span>), <span class="built_in">FFT</span>(lim, G, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    P[i] = P[i] + F[i] * G[i];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    F[i] = <span class="built_in">Complex</span>(A[i], <span class="number">0</span>), G[i] = <span class="built_in">Complex</span>(B[i] * B[i] * B[i], <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">FFT</span>(lim, F, <span class="number">1</span>), <span class="built_in">FFT</span>(lim, G, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    P[i] = P[i] + F[i] * G[i];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    F[i] = <span class="built_in">Complex</span>(A[i] * A[i], <span class="number">0</span>), G[i] = <span class="built_in">Complex</span>(B[i] * B[i], <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">FFT</span>(lim, F, <span class="number">1</span>), <span class="built_in">FFT</span>(lim, G, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    P[i] = P[i] - <span class="built_in">Complex</span>(<span class="number">2</span>, <span class="number">0</span>) * F[i] * G[i];</span><br><span class="line"></span><br><span class="line">  <span class="built_in">FFT</span>(lim, P, <span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = M - <span class="number">1</span>; i &lt; N; ++i)</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(P[i].x) &lt; eps) <span class="comment">// æœ¬é¢˜ eps å– 1e-1 å¯è¿‡</span></span><br><span class="line">      ans.<span class="built_in">push_back</span>(i - M + <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="é›†è®­é˜Ÿä½œä¸š2013-åŸå¸‚è§„åˆ’"><a href="#é›†è®­é˜Ÿä½œä¸š2013-åŸå¸‚è§„åˆ’" class="headerlink" title="[é›†è®­é˜Ÿä½œä¸š2013]åŸå¸‚è§„åˆ’"></a><a href="https://www.luogu.com.cn/problem/P4841">[é›†è®­é˜Ÿä½œä¸š2013]åŸå¸‚è§„åˆ’</a></h3><h4 id="problem-8"><a href="#problem-8" class="headerlink" title="problem"></a>problem</h4><p>æ±‚ $n \ (1 \le n \le 130000)$ ä¸ªç‚¹çš„æœ‰æ ‡å·ç®€å•æ— å‘è¿é€šå›¾çš„ä¸ªæ•°ï¼Œç­”æ¡ˆå¯¹ $1004535809$ å–æ¨¡ã€‚</p><h4 id="solution-9"><a href="#solution-9" class="headerlink" title="solution"></a>solution</h4><p>è®¾ $f(n)$ è¡¨ç¤ºæœ‰ $n$ ä¸ªç‚¹çš„æœ‰æ ‡å·ç®€å•æ— å‘è¿é€šå›¾çš„ä¸ªæ•°ï¼Œ$g(n)$ è¡¨ç¤º $n$ ä¸ªç‚¹çš„æœ‰æ ‡å·ç®€å•æ— å‘å›¾çš„ä¸ªæ•°ï¼Œæ˜¾ç„¶æœ‰ $g(n) = 2^{\binom n2}$ã€‚</p><p>ä¸€ä¸ªæœ‰æ ‡å·ç®€å•æ— å‘å›¾æ˜¯ç”±è‹¥å¹²ä¸ªè¿é€šåˆ†é‡æ„æˆçš„ï¼Œä¸ºäº†é¿å…é‡å¤è®¡æ•°ï¼Œæˆ‘ä»¬æšä¸¾ $1$ å·ç‚¹æ‰€åœ¨çš„è¿é€šå—çš„å¤§å°ï¼ˆå…¶ä»–ç‚¹ä»»æ„è¿è¾¹ï¼Œä¸ä¼šé‡å¤ï¼‰</p><script type="math/tex; mode=display">\begin{align}g(n) &= \sum_{i = 1}^n{\binom{n - 1}{i - 1} f(i) g(n - i)} \\2^{\binom n2} &= \sum_{i = 1}^n{\binom{n - 1}{i - 1} f(i) 2^{\binom{n - i}2}} \\\frac{2^{\binom n2}}{(n - 1)!} &= \sum_{i = 1}^n{\frac{f(i)}{(i - 1)!} \times \frac{2^{ \binom{n - i}2}}{(n - i)!}}\end{align}</script><p>å®šä¹‰å½¢å¼å¹‚çº§æ•°</p><script type="math/tex; mode=display">\begin{align}F(x) &= \sum_{n = 0}^\infty \frac{f(n)}{(n - 1)!} x^n \\G(x) &= \sum_{n = 0}^\infty \frac{2^{ \binom n2}}{n!} x^n \\H(x) &= \sum_{n = 0}^\infty \frac{2^{ \binom n2}}{(n - 1)!} x^n\end{align}</script><p>é‚£ä¹ˆæœ‰</p><script type="math/tex; mode=display">\begin{align}H(x) & \equiv F(x) G(x) \pmod{x^{n + 1}} \\F(x) & \equiv H(x) G^{-1}(x) \pmod{x^{n + 1}}\end{align}</script><p>æŠŠ $H(x)$ å’Œ $G(x)$ çš„é€†å·ä¸€å—å°±å¾—åˆ°äº† $F(x)$ï¼Œå†ä¹˜ä¸Šä¸€ä¸ª $(n - 1)!$ å°±å®Œäº‹äº†ã€‚æ€»å¤æ‚åº¦ $O(n \log n)$ã€‚</p><h4 id="code-9"><a href="#code-9" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> Poly_t = <span class="type">int</span>[<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1004535809</span>, g = <span class="number">3</span>, invG = <span class="number">334845270</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Pow</span><span class="params">(ll b, ll p = mod - <span class="number">2</span>, ll m = mod)</span></span>;</span><br><span class="line"></span><br><span class="line">Poly_t F, G, G_, to;</span><br><span class="line"><span class="type">int</span> *H = F, fac[<span class="number">130003</span>], invF[<span class="number">130003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">prework</span><span class="params">(<span class="type">int</span> N)</span> </span>&#123;</span><br><span class="line">  fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    fac[i] = <span class="number">1ll</span> * fac[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">  invF[N] = <span class="built_in">Pow</span>(fac[N]);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = N; i; --i)</span><br><span class="line">    invF[i - <span class="number">1</span>] = <span class="number">1ll</span> * invF[i] * i % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">NTT</span><span class="params">(<span class="type">int</span> N, <span class="type">int</span> *a, <span class="type">int</span> type)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PolyInv</span><span class="params">(<span class="type">int</span> N, <span class="type">int</span> *a, <span class="type">int</span> *b)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> lim, l;</span><br><span class="line"></span><br><span class="line">  std::cin &gt;&gt; N;</span><br><span class="line">  <span class="built_in">prework</span>(N);</span><br><span class="line">  G[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    G[i] = <span class="number">1ll</span> * <span class="built_in">Pow</span>(<span class="number">2</span>, <span class="number">1ll</span> * i * (i - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) * invF[i] % mod;</span><br><span class="line">    H[i] = <span class="number">1ll</span> * <span class="built_in">Pow</span>(<span class="number">2</span>, <span class="number">1ll</span> * i * (i - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) * invF[i - <span class="number">1</span>] % mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">PolyInv</span>(N + <span class="number">1</span>, G, G_);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (lim = <span class="number">1</span>, l = <span class="number">-1</span>; lim &lt;= N &lt;&lt; <span class="number">1</span>; lim &lt;&lt;= <span class="number">1</span>, ++l);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    to[i] = (to[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; l);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">NTT</span>(lim, H, <span class="number">1</span>), <span class="built_in">NTT</span>(lim, G_, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)</span><br><span class="line">    F[i] = <span class="number">1ll</span> * G_[i] * H[i] % mod;</span><br><span class="line">  <span class="built_in">NTT</span>(lim, F, <span class="number">-1</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> <span class="number">1ll</span> * F[N] * fac[N - <span class="number">1</span>] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="CF662C-Binary-Table"><a href="#CF662C-Binary-Table" class="headerlink" title="CF662C Binary Table"></a><a href="http://codeforces.com/problemset/problem/662/C">CF662C Binary Table</a></h3><h4 id="problem-9"><a href="#problem-9" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ª $n \ (1 \le n \le 20)$ è¡Œ $m \ (1 \le m \le 10^6)$ åˆ—çš„ 01 çŸ©é˜µï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥é€‰å®šä¸€è¡Œæˆ–ä¸€åˆ—å¹¶å°†å…¶ä¸­æ‰€æœ‰å…ƒç´ å–åï¼Œæ±‚è‹¥å¹²æ¬¡æ“ä½œåå¯èƒ½çš„æœ€å°‘çš„ 1 çš„ä¸ªæ•°ã€‚</p><h4 id="solution-10"><a href="#solution-10" class="headerlink" title="solution"></a>solution</h4><p>æš´åŠ›æ˜¯è¿™æ ·å­çš„ï¼š$2^n$ æšä¸¾æ¯ä¸€è¡Œæ˜¯å¦ç¿»è½¬ï¼Œæ¯ç§çŠ¶æ€çš„ç­”æ¡ˆæ˜¯æ¯ä¸€åˆ— 0/1 ä¸ªæ•°çš„è¾ƒå°å€¼ä¹‹å’Œã€‚æ€»å¤æ‚åº¦ $O(m 2^n)$ã€‚</p><p>æšä¸¾çŠ¶æ€ $S$ è¡¨ç¤ºæ¯ä¸€è¡Œæ˜¯å¦ç¿»è½¬ï¼Œè®¾ $a_i$ è¡¨ç¤ºåˆå§‹çŸ©é˜µä¸­æœ‰å¤šå°‘åˆ—çŠ¶æ€ä¸º $i$ï¼Œ$b_i$ è¡¨ç¤ºçŠ¶æ€ $i$ çš„ 0/1 çš„ä¸ªæ•°çš„è¾ƒå°å€¼ï¼Œ$f_i$ è¡¨ç¤ºæšä¸¾åˆ°çŠ¶æ€ $i$ æ—¶çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆ</p><script type="math/tex; mode=display">f_S = \sum_{i = 0}^{2^n - 1}{a_i b_{i \oplus S}}</script><p>ä¹Ÿå³</p><script type="math/tex; mode=display">f_S = \sum_{i \oplus j = S}{a_i b_j}</script><p>å‘ç°è¿™æ˜¯å¼‚æˆ–å·ç§¯çš„å½¢å¼ï¼Œå¯ä»¥ç”¨ FWT åœ¨ $O(n \log n)$ çš„æ—¶é—´å†…æ±‚å‡º $f_{1 \cdots 2^n}$ï¼Œå–æœ€å°å€¼å°±æ˜¯ç­”æ¡ˆã€‚</p><h4 id="code-10"><a href="#code-10" class="headerlink" title="code"></a>code</h4><p>FWT å®ç°çœ‹å¤šé¡¹å¼ç¬”è®°ã€‚æœ¬é¢˜ä¸éœ€è¦ä¹Ÿä¸åº”è¯¥å–æ¨¡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> Poly_t = ll[<span class="number">1</span>&lt;&lt;<span class="number">20</span>|<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> z[<span class="number">100003</span>];</span><br><span class="line">Poly_t a, b;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> N, N_, M;</span><br><span class="line">  ll* f = a;</span><br><span class="line"></span><br><span class="line">  cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; M; ++j)</span><br><span class="line">      <span class="keyword">if</span> (cin.<span class="built_in">get</span>())</span><br><span class="line">        z[j] |= <span class="number">1</span> &lt;&lt; i;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; M; ++i)</span><br><span class="line">    ++a[z[i]];</span><br><span class="line">  N_ = N, N = <span class="number">1</span> &lt;&lt; N;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">    b[i] = b[i &gt;&gt; <span class="number">1</span>] + (i &amp; <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">    b[i] = std::<span class="built_in">min</span>(b[i], N_ - b[i]);</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">XOR</span>(N, a, <span class="number">1</span>), <span class="built_in">XOR</span>(N, b, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">    f[i] = a[i] * b[i];</span><br><span class="line">  <span class="built_in">XOR</span>(N, f, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  std::cout &lt;&lt; *std::<span class="built_in">min_element</span>(f, f + N);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="CF850E-Random-Elections"><a href="#CF850E-Random-Elections" class="headerlink" title="CF850E Random Elections"></a><a href="https://www.luogu.com.cn/problem/CF850E">CF850E Random Elections</a></h3><h4 id="problem-10"><a href="#problem-10" class="headerlink" title="problem"></a>problem</h4><p>A, B, C ä¸‰äººæ¯”èµ›ï¼Œ$2^n \ (1 \le n \le 20)$ ä¸ªäººæŠ•ç¥¨ã€‚<strong>æ¯ä¸ªäººæœ‰ä¸€ä¸ªç¡®å®šçš„é¡ºåº</strong>ï¼Œä»–ä»¬æŠŠç¥¨æŠ•ç»™é¡ºåºé å‰çš„äººã€‚</p><p>æœ‰ä¸€ä¸ªå‡½æ•° $f(S)$ï¼Œæ¥å—ä¸€ä¸ªé•¿åº¦ $n = 2^k$ çš„äºŒè¿›åˆ¶ä¸² $S$ å¹¶è¿”å› true/falseã€‚ä¿è¯ $f(\neg S_1, \neg S_2, \cdots, \neg S_n) = \neg f(S_1, S_2, \cdots, S_n)$ã€‚</p><p>æ¯”èµ›ç»“æœç”± $n$ ä¸ªäººæŠ•ç¥¨å†³å®šï¼Œç»™å®š $S$ï¼Œ$S_i$ è¡¨ç¤º $f(i)$ çš„å–å€¼ã€‚è¯¢é—®å•å¾ªç¯çš„ä¸‰åœºæ¯”èµ›æ»¡è¶³æœ‰åŒä¸€ä¸ªäººè¿èƒœä¸¤åœºçš„æ–¹æ¡ˆæ•°ã€‚</p><h4 id="solution-11"><a href="#solution-11" class="headerlink" title="solution"></a>solution</h4><p>å‡è®¾ A è¿èƒœä¸¤åœºï¼Œç­”æ¡ˆä¹˜ä»¥ $3$ å³å¯ã€‚</p><p>è®¾æŸäººä¸¤åœºæ¯”èµ›çš„å†³ç­–æ˜¯ $(x_1, x_2)$ï¼Œé‚£ä¹ˆå¯ä»¥å¾—åˆ°ä»–çš„å†³ç­–åºåˆ—ï¼š</p><ul><li>$(0, 0) \to \text{BCA, CBA}$</li><li>$(0, 1) \to \text{BAC}$</li><li>$(1, 0) \to \text{CAB}$</li><li>$(1, 1) \to \text{ABC, ACB}$</li></ul><p>å‘ç°å¦‚æœ $x_1 \oplus x_2 = 0$ å°±å¯ä»¥å¯¹æ–¹æ¡ˆæ•°é€ æˆ $2$ çš„è´¡çŒ®ã€‚æ‰€æœ‰ä½å‹åœ¨ä¸€èµ·é‚£ä¹ˆæ–¹æ¡ˆå°±æ˜¯ $2^{n - \operatorname{popcount}(S_1 \oplus S_2)}$ã€‚</p><p>ç›´æ¥æšä¸¾æ˜¯ $O(4^n)$ çš„ï¼Œå¯ä»¥ FWT é¢„å¤„ç†å‡ºå¼‚æˆ–å€¼ç­‰äº $1 \cdots 2^n$ çš„æ•°å¯¹ä¸ªæ•°å†ç»Ÿè®¡è´¡çŒ®ã€‚</p><h4 id="code-11"><a href="#code-11" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1&#x27;000&#x27;000&#x27;007</span>, inv2 = <span class="number">500&#x27;000&#x27;004</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> N_, <span class="type">int</span>* F)</span> </span>&#123; <span class="comment">// F[0...2^N_)</span></span><br><span class="line">  <span class="type">int</span> N = <span class="number">1</span> &lt;&lt; N_, ans = <span class="number">0</span>, *popcnt = <span class="keyword">new</span> <span class="type">int</span>[N];</span><br><span class="line"></span><br><span class="line">  <span class="built_in">XOR</span>(N, F, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">    F[i] = <span class="number">1ll</span> * F[i] * F[i] % mod;</span><br><span class="line">  <span class="built_in">XOR</span>(N, F, inv2);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">    popcnt[i] = popcnt[i &gt;&gt; <span class="number">1</span>] + (i &amp; <span class="number">1</span>);</span><br><span class="line">    ans = (ans + <span class="number">1ll</span> * F[i] * (<span class="number">1</span> &lt;&lt; (N_ - popcnt[i]))) % mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">3ll</span> * ans % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h4 id="P5816-CQOI2010-å†…éƒ¨ç™½ç‚¹"><a href="#P5816-CQOI2010-å†…éƒ¨ç™½ç‚¹" class="headerlink" title="P5816 [CQOI2010]å†…éƒ¨ç™½ç‚¹"></a><a href="https://www.luogu.com.cn/problem/P5816">P5816 [CQOI2010]å†…éƒ¨ç™½ç‚¹</a></h4><h4 id="problem-11"><a href="#problem-11" class="headerlink" title="problem"></a>problem</h4><p>åˆå§‹æ—¶ç½‘æ ¼å›¾é‡Œæœ‰ $n \ (1 \le n \le 10^5)$ ä¸ªé»‘ç‚¹ï¼Œæ‰€æœ‰å…¶ä»–æ•´æ•°ç‚¹éƒ½æ˜¯ç™½è‰²çš„ã€‚æ¯ç§’é’Ÿæ‰€æœ‰<strong>å†…éƒ¨ç™½ç‚¹</strong>åŒæ—¶å˜é»‘ï¼Œç›´åˆ°ä¸å­˜åœ¨å†…éƒ¨ç™½ç‚¹ä¸ºæ­¢ã€‚è®¡ç®—æœ€ç»ˆç½‘æ ¼å›¾ä¸­çš„é»‘ç‚¹ä¸ªæ•°æˆ–åˆ¤æ–­å˜åŒ–ä¸ä¼šç»“æŸã€‚</p><p><strong>å†…éƒ¨ç™½ç‚¹çš„å®šä¹‰</strong>ï¼šä¸€ä¸ªç™½è‰²çš„æ•´ç‚¹æ˜¯å†…éƒ¨ç™½ç‚¹å½“ä¸”ä»…å½“å…¶æ‰€åœ¨çš„æ°´å¹³çº¿çš„å·¦è¾¹å’Œå³è¾¹å„è‡³å°‘æœ‰ä¸€ä¸ªé»‘ç‚¹ï¼Œä¸”æ‰€åœ¨ç«–ç›´çº¿çš„ä¸Šè¾¹å’Œä¸‹è¾¹å„è‡³å°‘æœ‰ä¸€ä¸ªé»‘ç‚¹ã€‚å½¢å¼åŒ–åœ°ï¼Œç‚¹ $P(x, y)$ æ˜¯é»‘ç‚¹å½“ä¸”ä»…å½“å­˜åœ¨é»‘ç‚¹ $(x_1, y), (x_2, y), (x, y_1), (x, y_2)$ æ»¡è¶³ $x_1 &lt; x &lt; x_2, y_1 &lt; x &lt; y_2$ã€‚</p><h4 id="solution-12"><a href="#solution-12" class="headerlink" title="solution"></a>solution</h4><p>ğŸ‘´åˆå›æ¥æ•´ DS ğŸŒ¶ï¼</p><p>é¦–å…ˆè¿™é¢˜å˜åŒ–æ˜¯ä¸€å®šä¼šç»“æŸçš„ï¼Œå¹¶ä¸”ä¼šåœ¨ä¸€æ¬¡å˜åŒ–å†…ç»“æŸ<del>ï¼ˆå¥½åƒå¾ˆæ˜¾ç„¶çš„æ ·å­ï¼‰</del>ï¼Œå› ä¸º æ–°äº§ç”Ÿçš„é»‘ç‚¹èƒ½å¤Ÿäº§ç”Ÿçš„é»‘ç‚¹ ä¸€å®šæ˜¯ åŸæœ‰é»‘ç‚¹èƒ½äº§ç”Ÿçš„é»‘ç‚¹ çš„å­é›†ã€‚</p><p>æˆ‘ä»¬å¯¹äºæ¯ä¸ª $x$ åæ ‡ï¼Œè®°å½• $y$ åæ ‡æœ€å°å’Œæœ€å¤§çš„ç‚¹ï¼Œå¯¹äº $y$ æœ€å°/æœ€å¤§çš„ç‚¹æ‰“æ ‡è®° $1 / -1$ï¼Œå†å¯¹æ¯å¯¹ $x$ åæ ‡ç›¸åŒçš„ç‚¹è¿ä¸€æ¡æ°´å¹³çº¿æ®µã€‚</p><p>è¿™æ ·ä»ä¸‹å‘ä¸Šæ‰«æï¼Œå¯¹äºæ¯ä¸ªæ ‡è®°ä¿®æ”¹ç›¸åº”ä½ç½®çš„ç‚¹å€¼ï¼›å¯¹äºæ¯æ¡çº¿æ®µç»Ÿè®¡åŒºé—´å’Œï¼Œå³å¯å¾—åˆ°ç­”æ¡ˆã€‚</p><h4 id="code-12"><a href="#code-12" class="headerlink" title="code"></a>code</h4><p>è¿™ä¸ªåšæ³•é™¤å» ds å¤–æ—¶é—´å¸¸æ•°å¹¶ä¸å¥½ï¼›ç©ºé—´å¸¸æ•°ä¼šå¥½ä¸€äº›ï¼›åœ¨ç¢°åˆ°é‡å¤ç‚¹æ—¶ä¼šæš´æ¯™ï¼Œå¥½åœ¨è¿™é¢˜ä¿è¯äº†æ²¡æœ‰é‡å¤ç‚¹ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">  <span class="type">int</span> x, y;</span><br><span class="line">&#125; z[<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmpx</span><span class="params">(Point lhs, Point rhs)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> std::<span class="built_in">tie</span>(lhs.x, lhs.y) &lt; std::<span class="built_in">tie</span>(rhs.x, rhs.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmpy</span><span class="params">(Point lhs, Point rhs)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> std::<span class="built_in">tie</span>(lhs.y, lhs.x) &lt; std::<span class="built_in">tie</span>(rhs.y, rhs.x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Line</span> &#123;</span><br><span class="line">  <span class="type">int</span> l, r, y, k;</span><br><span class="line"></span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span>&lt;(Line rhs) &#123;</span><br><span class="line">    <span class="keyword">return</span> std::<span class="built_in">tie</span>(y, k) &lt; std::<span class="built_in">tie</span>(rhs.y, rhs.k);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; e[<span class="number">300003</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> N_, z_[<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> BIT &#123;</span><br><span class="line">  <span class="type">int</span> t[<span class="number">100003</span>];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">Modify</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span></span>;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">Query</span><span class="params">(<span class="type">int</span> p)</span></span>;</span><br><span class="line">&#125; <span class="comment">// BIT</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> N, M = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  cin &gt;&gt; N;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    cin &gt;&gt; z[i].x &gt;&gt; z[i].y;</span><br><span class="line">    z_[i] = z[i].x;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  std::<span class="built_in">sort</span>(z_ + <span class="number">1</span>, z_ + N + <span class="number">1</span>);</span><br><span class="line">  N_ = std::<span class="built_in">unique</span>(z_ + <span class="number">1</span>, z_ + N + <span class="number">1</span>) - z_ - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    z[i].x = std::<span class="built_in">lower_bound</span>(z_ + <span class="number">1</span>, z_ + N_ + <span class="number">1</span>, z[i].x) - z_;</span><br><span class="line"></span><br><span class="line">  std::<span class="built_in">sort</span>(z + <span class="number">1</span>, z + N + <span class="number">1</span>, cmpx);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; ++i)</span><br><span class="line">    <span class="keyword">if</span> (z[i].x == z[i + <span class="number">1</span>].x) &#123;</span><br><span class="line">      e[++M] = &#123;z[i].x, <span class="number">0</span>, z[i].y, <span class="number">1</span>&#125;;</span><br><span class="line">      e[++M] = &#123;z[i + <span class="number">1</span>].x, <span class="number">0</span>, z[i + <span class="number">1</span>].y, <span class="number">-1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  std::<span class="built_in">sort</span>(z + <span class="number">1</span>, z + N + <span class="number">1</span>, cmpy);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; ++i)</span><br><span class="line">    <span class="keyword">if</span> (z[i].y == z[i + <span class="number">1</span>].y)</span><br><span class="line">      e[++M] = &#123;z[i].x, z[i + <span class="number">1</span>].x, z[i].y, <span class="number">0</span>&#125;;</span><br><span class="line">  std::<span class="built_in">sort</span>(e + <span class="number">1</span>, e + M + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= M; ++i)</span><br><span class="line">    <span class="keyword">if</span> (e[i].k) BIT::<span class="built_in">Modify</span>(e[i].l, e[i].k);</span><br><span class="line">    <span class="keyword">else</span> ans += BIT::<span class="built_in">Query</span>(e[i].r - <span class="number">1</span>) - BIT::<span class="built_in">Query</span>(e[i].l);</span><br><span class="line"></span><br><span class="line">  std::cout &lt;&lt; ans + N &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å†™äº 2020/4/30 22:46</p><p>è¿™ä¸ªæœˆç»“æŸäº†ï¼Œå¯ä»¥è¯´æ˜¯æ”¾å‡æ¥æœ€ä¸é¢“çš„ä¸€ä¸ªæœˆï¼ˆå…¶å®é¢“å¾—ä¹Ÿè›®å¤šçš„ï¼‰</p><p>å…ˆæ•´äº†å‡ é“é¢˜ï¼Œåˆé‡å­¦äº†æ•°è®ºã€ä»é›¶å¼€å§‹å­¦äº†å¤šé¡¹å¼ï¼Œç»Ÿå…±ç äº† 2w+ å­—çš„åšæ–‡ã€‚</p><p>åŸºç¡€ç®—æ³•å’Œæ€ç»´æ¯”è¾ƒè–„å¼±ï¼Œå¸Œæœ›ä¸‹ä¸ªæœˆèƒ½åŠ å¼ºä¸‹ã€‚</p><p>ä¸‹ä¸ªæœˆè¿™æ—¶å€™è¯´ä¸å®šå°±è¦é€€å½¹äº†ã€‚</p><p>å¸Œæœ›èƒ½å¤Ÿä¸è¾œè´Ÿè‡ªå·±å§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æŸ AtCoder çš„ dp åœº</title>
      <link href="/2020/%E6%9F%90At%E7%9A%84dp%E5%9C%BA/"/>
      <url>/2020/%E6%9F%90At%E7%9A%84dp%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<p><del>Typical DP Contestï¼Œ13 å¹´çš„è¿œå¤æ¯”èµ›äº†</del></p><p><a href="https://tdpc.contest.atcoder.jp/">æ¯”èµ›åœ°å€</a></p><p>æœ¬æ–‡ä¸ºéƒ¨åˆ†ç¿»è¯‘+é¢˜è§£</p><p>è°·çš„ç¿»è¯‘å¤§éƒ¨åˆ†ï¼ˆæ‰€æœ‰æ­£ç¡®ä½¿ç”¨äº† $\LaTeX$ çš„ï¼‰æ˜¯æˆ‘æçš„ã€‚å¾ˆæƒ­æ„§ï¼Œå°±åšäº†ä¸€ç‚¹å¾®å°çš„è´¡çŒ®ã€‚</p><span id="more"></span><hr><h3 id="A-ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ"><a href="#A-ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ" class="headerlink" title="A - ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ"></a>A - ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ</h3><h4 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h4><p>æœ‰ä¸€åœºæœ‰ $n \ (1 \le n \le 100)$ ä¸ªé—®é¢˜çš„æ¯”èµ›ï¼Œå…¶ä¸­ç¬¬ $i$ ä¸ªé—®é¢˜çš„åˆ†æ•°ä¸º $p_i \ (1 \le p_i \le 100)$ã€‚æŸä¸ªå‚èµ›è€…çš„åˆ†æ•°ä¸ºä»–åšå‡ºçš„é¢˜ç›®çš„åˆ†æ•°ä¹‹å’Œã€‚æœ‰å¤šå°‘ç§å¯èƒ½çš„å¾—åˆ†ï¼Ÿ</p><h4 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h4><p>å‚»é€¼èƒŒåŒ…ï¼Œè¿ä¼˜åŒ–éƒ½ä¸ç”¨çš„é‚£ç§ï¼ˆ</p><hr><h3 id="B-ã‚²ãƒ¼ãƒ "><a href="#B-ã‚²ãƒ¼ãƒ " class="headerlink" title="B - ã‚²ãƒ¼ãƒ "></a>B - ã‚²ãƒ¼ãƒ </h3><h4 id="problem-1"><a href="#problem-1" class="headerlink" title="problem"></a>problem</h4><p>Alice å’Œ Bob åœ¨ç©æ¸¸æˆã€‚åˆå§‹æ—¶æœ‰ä¸¤åº§å±±ï¼Œå·¦è¾¹çš„å±±ä¸Šæœ‰ $A$ ä¸ªç‰©å“ï¼Œä»ä¸Šåˆ°ä¸‹çš„ç¬¬ $i$ ä¸ªä»·å€¼ä¸º $a_i$ï¼›å³è¾¹çš„å±±ä¸Šæœ‰ $B$ ä¸ªç‰©å“ï¼Œä»ä¸Šåˆ°ä¸‹çš„ç¬¬ $i$ ä¸ªä»·å€¼ä¸º $b_i$ã€‚Alice å…ˆæ‰‹ï¼ŒAlice å’Œ Bob äº¤æ›¿è¿›è¡Œæ“ä½œï¼Œå¯è¡Œçš„æ“ä½œå¦‚ä¸‹ï¼š</p><ul><li>å¦‚æœä¸¤åº§å±±éƒ½ç©ºäº†ï¼Œæ¸¸æˆç»“æŸã€‚</li><li>å¦‚æœåªæœ‰æŸä¸€åº§å±±ç©ºäº†ï¼Œå–èµ°å¦ä¸€åº§å±±ä¸Šçš„æœ€ä¸Šé¢çš„ç‰©å“ã€‚</li><li>å¦‚æœä¸¤åº§å±±éƒ½æ²¡æœ‰ç©ºï¼Œé€‰æ‹©ä»»æ„ä¸€åº§å±±ï¼Œå¹¶å–èµ°å…¶æœ€ä¸Šé¢çš„ç‰©å“ã€‚</li></ul><p>ä¸¤äººéƒ½æƒ³å–å¾—æ›´å¤§çš„ä»·å€¼ã€‚å‡è®¾ä¸¤äººéƒ½é‡‡å–æœ€ä¼˜ç­–ç•¥ï¼Œè¯·æ±‚å‡º Alice èƒ½å–å¾—çš„ç‰©å“çš„ä»·å€¼æ€»å’Œã€‚</p><p>è¾“å…¥çš„æ‰€æœ‰æ•°å­—éƒ½æ˜¯ $[1, 1000]$ ä¸­çš„æ•´æ•°ã€‚</p><h4 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h4><p>è€ƒè™‘ä»ç»ˆå±€å‘å‰é€†æ¨ã€‚è®¾ $f_{i, j}$ è¡¨ç¤º $A$ è¢«å–èµ°ç¬¬ $i \sim A$ ä¸ªç‰©å“ï¼Œ $B$ è¢«å–èµ°ç¬¬ $j \sim B$ ä¸ªç‰©å“æ—¶çš„ä»·å€¼ã€‚</p><p>å¯¹ $i + j$ ä¸ºå¶æ•°/å¥‡æ•°ï¼Œå³ Alice/Bob æ“ä½œæ—¶åˆ†ç±»è½¬ç§»ï¼š</p><script type="math/tex; mode=display">f_{i, j} = \begin{cases}\max(f_{i + 1, j} + a_i, f_{i, j + 1} + b_j) & , (i + j) \equiv 0 \pmod 2 \\\min(f_{i + 1, j}, f_{i, j + 1}) & , (i + j) \equiv 1 \pmod 2\end{cases}</script><p>è¾¹ç•Œæ¡ä»¶ $f_{i, B + 1} = f_{A + 1, j} = 0$ã€‚</p><p>ç­”æ¡ˆå³ä¸º $f_{1, 1}$ã€‚æ€»å¤æ‚åº¦ $O(AB)$ã€‚</p><h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><p>å®ç°æ—¶è¦å°¤å…¶æ³¨æ„è¾¹ç•Œæƒ…å†µã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> f[<span class="number">1003</span>][<span class="number">1003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> A, <span class="keyword">int</span>* a, <span class="keyword">int</span> B, <span class="keyword">int</span>* b)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// a, b ä¸‹æ ‡å‡ä» 1 å¼€å§‹</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = A + <span class="number">1</span>; i; --i)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = B + <span class="number">1</span>; j; --j) &#123;</span><br><span class="line">      <span class="keyword">if</span> (i &gt; A &amp;&amp; j &gt; B) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">if</span> ((i + j) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; A)</span><br><span class="line">          f[i][j] = f[i][j + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (j &gt; B)</span><br><span class="line">          f[i][j] = f[i + <span class="number">1</span>][j];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          f[i][j] = std::<span class="built_in">min</span>(f[i + <span class="number">1</span>][j], f[i][j + <span class="number">1</span>]);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; A)</span><br><span class="line">          f[i][j] = f[i][j + <span class="number">1</span>] + b[j];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (j &gt; B)</span><br><span class="line">          f[i][j] = f[i + <span class="number">1</span>][j] + a[i];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          f[i][j] = std::<span class="built_in">max</span>(f[i + <span class="number">1</span>][j] + a[i], f[i][j + <span class="number">1</span>] + b[j]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">return</span> f[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="C-ãƒˆãƒ¼ãƒŠãƒ¡ãƒ³ãƒˆ"><a href="#C-ãƒˆãƒ¼ãƒŠãƒ¡ãƒ³ãƒˆ" class="headerlink" title="C - ãƒˆãƒ¼ãƒŠãƒ¡ãƒ³ãƒˆ"></a>C - ãƒˆãƒ¼ãƒŠãƒ¡ãƒ³ãƒˆ</h3><h4 id="problem-2"><a href="#problem-2" class="headerlink" title="problem"></a>problem</h4><p>æœ‰ $2^k \ (1 \le k \le 10)$ äººå‚åŠ ä¸€åœºé”¦æ ‡èµ›ï¼Œè¿™åœºé”¦æ ‡èµ›æŒ‰ä»¥ä¸‹çš„å½¢å¼è¿›è¡Œã€‚</p><p><em>è¯‘è€…æ³¨ï¼šæˆ‘çŸ¥é“å¯è¯»æ€§å¾ˆå·®ï¼Œä½†æ˜¯å¾ˆå¥½ç†è§£ï¼Œæ—¥è¯­åŸé¢˜é¢å°±æ˜¯è¿™æ ·çš„</em></p><ul><li>ç¬¬ 1 è½®ï¼Œ1 å’Œ 2ï¼Œ3 å’Œ 4ï¼Œâ€¦ è¿›è¡Œæ¯”èµ›ã€‚</li><li>ç¬¬ 2 è½®ï¼Œ(1 å’Œ 2 çš„èƒœè€…)å’Œ(3 å’Œ 4 çš„èƒœè€…)ï¼Œ(5 å’Œ 6 çš„èƒœè€…)å’Œ(7 å’Œ 8 çš„èƒœè€…)ï¼Œâ€¦ è¿›è¡Œæ¯”èµ›ã€‚</li><li>ç¬¬ 3 è½®ï¼Œ((1 å’Œ 2 çš„èƒœè€…)å’Œ(3 å’Œ 4 çš„èƒœè€…)çš„èƒœè€…)å’Œ((5 å’Œ 6 çš„èƒœè€…)å’Œ(7 å’Œ 8 çš„èƒœè€…)çš„èƒœè€…)ï¼Œ((9 å’Œ 10 çš„èƒœè€…)å’Œ(11 å’Œ 12 çš„èƒœè€…)çš„èƒœè€…)å’Œ((13 å’Œ 14 çš„èƒœè€…)å’Œ(15 å’Œ 16 çš„èƒœè€…)çš„èƒœè€…)ï¼Œâ€¦ è¿›è¡Œæ¯”èµ›ã€‚</li><li>é‡å¤ç›¸åŒçš„è¿‡ç¨‹ï¼Œç›´åˆ°ç¬¬ $K$ è½®ã€‚</li></ul><p>ç¬¬ $K$ è½®ç»“æŸåå°†ä¼šå†³å‡ºä¼˜èƒœè€…ã€‚å¦‚æœç¬¬ $i$ ä¸ªäººçš„ Elo Rating ä¸º $R_i \ (1 \le R_i \le 4000)$ï¼Œæ±‚å‡ºæ¯ä¸ªäººæˆä¸ºä¼˜èƒœè€…çš„æ¦‚ç‡ã€‚</p><p>è§„å®šï¼šå¦‚æœ Elo Rating ä¸º $R_P$ çš„äºº $P$ å’Œ Elo Rating ä¸º $R_Q$ çš„äºº $Q$ å¯¹æˆ˜ï¼Œäºº $P$ çš„è·èƒœæ¦‚ç‡ä¸º $1 / (1 + 10^{(R_Q - R_P) / 400})$ã€‚å‡è®¾ä¸åŒçš„æ¯”èµ›çš„èƒœè´Ÿæ˜¯äº’ç›¸ç‹¬ç«‹çš„ã€‚</p><h4 id="solution-2"><a href="#solution-2" class="headerlink" title="solution"></a>solution</h4><p>æ˜¾ç„¶æ˜¯é“æ¦‚ç‡ dpï¼ˆ</p><p>è®¾ $f_{k, i}$ è¡¨ç¤ºç¬¬ $k$ è½®æ¯”èµ›ä¸­ç¬¬ $i$ ä¸ªäººè·èƒœçš„æ¦‚ç‡ã€‚ä¸éš¾å¾—åˆ°è¿™æ ·çš„è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f_{k, i} = f_{k - 1, i} \times \sum_{j \in S}{(f_{k - 1, j} \times P)}</script><p>å…¶ä¸­ $S$ è¡¨ç¤ºç¬¬ $k$ è½®ä¸­å¯èƒ½ä¸ $i$ æ¯”èµ›çš„äººï¼›$P$ è¡¨ç¤ºç¬¬ $j$ ä¸ªäººæ­¤æ—¶è·èƒœçš„æ¦‚ç‡ã€‚</p><p>è¾¹ç•Œæ¡ä»¶ $f_{i, 0} = 1$ã€‚</p><p>ç­”æ¡ˆå³ä¸º $f_{K, i} \ (1 \le i \le 2^K)$ã€‚æ€»å¤æ‚åº¦ $O(K \times 2^K)$ã€‚</p><h4 id="code-1"><a href="#code-1" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> db = <span class="keyword">double</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> R[<span class="number">1</span>&lt;&lt;<span class="number">10</span>|<span class="number">1</span>];</span><br><span class="line">db f[<span class="number">11</span>][<span class="number">1</span>&lt;&lt;<span class="number">10</span>|<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> db <span class="title">calc</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + <span class="built_in">pow</span>(<span class="number">10.</span>, (R[q] - R[p]) / <span class="number">400.</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> K, N;</span><br><span class="line"></span><br><span class="line">  cin &gt;&gt; K;</span><br><span class="line">  N = <span class="number">1</span> &lt;&lt; K;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    cin &gt;&gt; R[i];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    f[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>, len; k &lt;= K; ++k) &#123;</span><br><span class="line">    len = <span class="number">1</span> &lt;&lt; k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, mn, mx, mid, l, r; i &lt;= N; ++i) &#123;</span><br><span class="line">      db now = <span class="number">0</span>;</span><br><span class="line">      mx = (i - <span class="number">1</span>) / len * len + len, mn = mx - len + <span class="number">1</span>;</span><br><span class="line">      mid = ((mn + mx) &gt;&gt; <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (i &lt; mid) l = mid, r = mx;</span><br><span class="line">      <span class="keyword">else</span> l = mn, r = mid - <span class="number">1</span>;</span><br><span class="line">      <span class="comment">// æ­¤å¤„çš„ l ~ r ä¸ºå¯èƒ½æ­¤æ—¶å’Œç¬¬ j ä¸ªäººæ¯”èµ›çš„ç¼–å·åŒºé—´</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> j = l; j &lt;= r; ++j)</span><br><span class="line">        now += f[k - <span class="number">1</span>][j] * <span class="built_in">calc</span>(i, j);</span><br><span class="line">      f[k][i] = now * f[k - <span class="number">1</span>][i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.9lf\n&quot;</span>, f[K][i]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="D-ã‚µã‚¤ã‚³ãƒ­"><a href="#D-ã‚µã‚¤ã‚³ãƒ­" class="headerlink" title="D - ã‚µã‚¤ã‚³ãƒ­"></a>D - ã‚µã‚¤ã‚³ãƒ­</h3><h4 id="problem-3"><a href="#problem-3" class="headerlink" title="problem"></a>problem</h4><p>å°†å…­ä¸ªé¢çš„éª°å­æ· $N \ (1 \le N \le 100)$ æ¬¡ï¼Œæ±‚æ¯ä¸€æ¬¡æ·å¾—çš„ç‚¹æ•°çš„ä¹˜ç§¯æ˜¯ $D \ (1 \le D \le 10^{18})$ çš„å€æ•°çš„æ¦‚ç‡ã€‚</p><h4 id="solution-3"><a href="#solution-3" class="headerlink" title="solution"></a>solution</h4><p>è€ƒè™‘éª°å­æ·å‡ºç‚¹æ•°çš„ä¹˜ç§¯çš„è´¨å› å­åªå¯èƒ½æœ‰ $2, 3, 5$ã€‚è€ƒè™‘ç›´æ¥ä»è¿™ä¸‰ä¸ªå› æ•°è¿›è¡Œè½¬ç§»ã€‚</p><p>è®¾ $f_{i, a, b, c}$ è¡¨ç¤ºç¬¬ $i$ æ¬¡æ·éª°å­åç‚¹æ•°çš„ä¹˜ç§¯ä¸­å› å­ $2$ æœ‰ $a$ ä¸ªï¼Œ$3$ æœ‰ $b$ ä¸ªï¼Œ$5$ æœ‰ $c$ ä¸ªçš„å¯èƒ½æ€§ã€‚</p><p>ç›´æ¥æšä¸¾æ¯æ¬¡æ·éª°å­çš„è¿‡ç¨‹è½¬ç§»å³å¯ã€‚</p><p>è¾¹ç•Œæ¡ä»¶ $f_{0, 0, 0, 0} = 1$ã€‚</p><p>ç­”æ¡ˆå³ä¸º $f_{N, a, b, c}$ã€‚æ€»å¤æ‚åº¦ $O(Nabc)$ã€‚</p><h4 id="code-2"><a href="#code-2" class="headerlink" title="code"></a>code</h4><p>å®ç°çœ‹äº†çœ‹éœ“è™¹å›½ç¥ä»™ Suikaba çš„ï¼ˆå°å£°</p><p>è¿™ä¸ª dp æ•°ç»„ç”šè‡³å¯ä»¥æ»šåŠ¨æ•°ç»„å‹æ‰ä¸€ç»´ï¼Œä¸è¿‡è¿™é‡Œæ²¡å†™ã€‚</p><p>å˜é‡åå’Œä¸Šæ–‡ç•¥æœ‰ä¸åŒã€‚æ•°ç»„å¤§å°å¥‡æ€ªæ˜¯å› ä¸ºæ˜¯å‹ç€ä¸Šç•Œå¼€çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> s2[] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> s3[] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> s5[] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> f[<span class="number">101</span>][<span class="number">61</span>][<span class="number">39</span>][<span class="number">27</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">long</span> <span class="keyword">long</span> D)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> d2 = <span class="number">0</span>, d3 = <span class="number">0</span>, d5 = <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">while</span> (D % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">    D /= <span class="number">2</span>, ++d2;</span><br><span class="line">  <span class="keyword">while</span> (D % <span class="number">3</span> == <span class="number">0</span>)</span><br><span class="line">    D /= <span class="number">3</span>, ++d3;</span><br><span class="line">  <span class="keyword">while</span> (D % <span class="number">5</span> == <span class="number">0</span>)</span><br><span class="line">    D /= <span class="number">5</span>, ++d5;</span><br><span class="line">  <span class="keyword">if</span> (D != <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i2 = <span class="number">0</span>; i2 &lt;= d2; ++i2)</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i3 = <span class="number">0</span>; i3 &lt;= d3; ++i3)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i5 = <span class="number">0</span>; i5 &lt;= d5; ++i5)</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>, t2, t3, t5; j &lt;= <span class="number">6</span>; ++j) &#123;</span><br><span class="line">            t2 = <span class="built_in">min</span>(d2, i2 + s2[j]);</span><br><span class="line">            t3 = <span class="built_in">min</span>(d3, i3 + s3[j]);</span><br><span class="line">            t5 = <span class="built_in">min</span>(d5, i5 + s5[j]);</span><br><span class="line">            f[i + <span class="number">1</span>][t2][t3][t5] += f[i][i2][i3][i5] / <span class="number">6</span>;</span><br><span class="line">          &#125;</span><br><span class="line">  <span class="keyword">return</span> f[N][d2][d3][d5];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="E-æ•°"><a href="#E-æ•°" class="headerlink" title="E - æ•°"></a>E - æ•°</h3><h4 id="problem-4"><a href="#problem-4" class="headerlink" title="problem"></a>problem</h4><p>æ±‚å‡ºåœ¨ $1 \sim N$ ä¸­æœ‰å¤šå°‘ä¸ªæ•´æ•°çš„æ•°ç å’Œæ˜¯ $D$ çš„å€æ•°ã€‚ç­”æ¡ˆå¯¹ $10^9 + 7$ å–æ¨¡ã€‚</p><h4 id="solution-4"><a href="#solution-4" class="headerlink" title="solution"></a>solution</h4><p>è¿™é‡Œæ˜¯ä¸€ç¯‡è®°å¿†åŒ–æœç´¢å®ç°æ•°ä½ dp çš„é¢˜è§£ã€‚</p><p>è®¾ $f_{i, j}$ ä¸ºæœ€ä½ä½åˆ°ä»ä½åˆ°é«˜ç¬¬ $i$ï¼Œæ¨¡ $D$ ä½™æ•°ä¸º $j$ æ—¶çš„åˆæ³•æ–¹æ¡ˆæ•°ã€‚</p><p>è€ƒè™‘æœç´¢è½¬ç§»ï¼Œæ·±æœå‡½æ•°åŸå‹ <code>int dfs(int pos, int rem, bool lim)</code>ï¼Œå…¶ä¸­ <code>pos</code> è¡¨ç¤ºå½“å‰åœ¨ä»ä½åˆ°é«˜ç¬¬ <code>pos</code> ä½ï¼Œè¦æœç´¢çš„ä½™æ•°ä¸º <code>rem</code>ï¼Œæ˜¯å¦è´´ç´§åŸæ•°ä¸Šç•Œï¼ˆ<code>lim == 1/0</code>ï¼‰ã€‚è½¬ç§»æ—¶æŒ‰ç…§å«ä¹‰å³å¯ã€‚</p><p>æ³¨æ„æœ‰äº›é¢˜ç›®éœ€è¦ç‰¹åˆ¤å‰å¯¼é›¶ã€è€ƒè™‘è¿ç»­çš„å‡ ä½æ•°ç­‰ç‰¹æ®Šæƒ…å†µï¼ˆæœ¬é¢˜ä¸éœ€è¦ï¼‰ã€‚</p><p>dp æ•°ç»„åˆå§‹å€¼è¦ä¸ºä¸€ä¸ªå°äºé›¶çš„æ•°ï¼ˆæƒ³ä¸€æƒ³ï¼Œä¸ºä»€ä¹ˆï¼Ÿï¼‰</p><h4 id="code-3"><a href="#code-3" class="headerlink" title="code"></a>code</h4><p>ç†è®ºä¸Šè®°å¿†åŒ–æœç´¢å®ç°è¦æ¯”é€’æ¨è½¬ç§»å¸¸æ•°å¤§ä¸€ç‚¹ï¼Œä½†å°±è¿™é¢˜æ¥çœ‹è¿™ä»½ä»£ç è·‘å¾—æ¯”å¤§å¤šæ•°é€’æ¨è¿˜è¦å¿«ï¼ˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> mod = <span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, D, num[<span class="number">10003</span>], f[<span class="number">10003</span>][<span class="number">101</span>];</span><br><span class="line">std::string s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> rem, <span class="keyword">bool</span> lim)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!pos) <span class="keyword">return</span> !rem;</span><br><span class="line">  <span class="keyword">if</span> (!lim &amp;&amp; f[pos][rem] != <span class="number">-1</span>) <span class="keyword">return</span> f[pos][rem];</span><br><span class="line">  <span class="keyword">int</span> mx = lim ? num[pos] : <span class="number">9</span>, ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= mx; ++i)</span><br><span class="line">    ans = (ans + <span class="built_in">dfs</span>(pos - <span class="number">1</span>, (rem + i) % D, lim &amp;&amp; i == mx)) % mod;</span><br><span class="line">  <span class="keyword">if</span> (!lim) f[pos][rem] = ans;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  std::cin &gt;&gt; D &gt;&gt; s;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> it = s.<span class="built_in">rbegin</span>(); it != s.<span class="built_in">rend</span>(); ++it)</span><br><span class="line">    num[++N] = *it &amp; <span class="number">15</span>;</span><br><span class="line">  <span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="keyword">sizeof</span> f);</span><br><span class="line">  std::cout &lt;&lt; <span class="built_in">dfs</span>(N, <span class="number">0</span>, <span class="number">1</span>) - <span class="number">1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="F-æº–æ€¥"><a href="#F-æº–æ€¥" class="headerlink" title="F - æº–æ€¥"></a>F - æº–æ€¥</h3><h4 id="problem-5"><a href="#problem-5" class="headerlink" title="problem"></a>problem</h4><p>æœ‰ä¸€æ¡æœ‰ $N$ ä¸ªç«™çš„ç”µè½¦çº¿è·¯ã€‚ä½ è¦åœ¨è¿™æ¡çº¿è·¯ä¸Šé€å¤–å–ã€‚</p><ul><li>ä½ éœ€è¦åœ¨ $1$ å·ç«™åœé ï¼Œåœ¨ {$2$ å·ç«™ï¼Œâ€¦ï¼Œ$N - 1$ å·ç«™} çš„å­é›†åœé ï¼Œåœ¨ $N$ å·ç«™åœé ã€‚</li><li>ä½ ä¸ä¼šåœ¨è¿ç»­è¶…è¿‡ $K$ ä¸ªè½¦ç«™åœé ã€‚</li></ul><p>æ±‚æœ‰å¤šå°‘ç§å¯èƒ½çš„åœé æ–¹æ¡ˆæ•°ã€‚ç­”æ¡ˆå¯¹ $10^9 + 7$ å–æ¨¡ã€‚</p><h4 id="solution-5"><a href="#solution-5" class="headerlink" title="solution"></a>solution</h4><p>è®¾ $f_{i, 0/1}$ è¡¨ç¤ºå‰ $i$ ä¸ªè½¦ç«™ä¸åœé /åœé çš„æ–¹æ¡ˆæ•°ã€‚æ˜¾ç„¶æœ‰ $f_{i, 0} = f_{i - 1, 0} + f_{i - 1, 1}$ã€‚</p><p>å¯¹äº $f_{i, 1}$ï¼Œéœ€è¦å‡å»ä¸åˆæ³•çš„æ–¹æ¡ˆæ•°ï¼Œå³å‰ $K - 1$ ä¸ªè½¦ç«™éƒ½åœé çš„æ–¹æ¡ˆæ•°ã€‚<del>æ˜¾ç„¶</del>è¿™ä¸ªç­‰äº $f_{i - K, 0}$ã€‚</p><p>è¾¹ç•Œæ¡ä»¶ $f_{0, 0} = f_{0, 1} = f_{1, 1} = 1, f_{1, 0} = 0$ã€‚</p><p>ç­”æ¡ˆå³ä¸º $f_{N, 1}$ã€‚æ€»å¤æ‚åº¦ $O(N)$ã€‚</p><h4 id="code-4"><a href="#code-4" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> mod = <span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[<span class="number">1000003</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">  f[<span class="number">0</span>][<span class="number">0</span>] = f[<span class="number">0</span>][<span class="number">1</span>] = f[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; K; ++i)</span><br><span class="line">    f[i][<span class="number">0</span>] = f[i][<span class="number">1</span>] = (f[i - <span class="number">1</span>][<span class="number">0</span>] + f[i - <span class="number">1</span>][<span class="number">1</span>]) % mod;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = K; i &lt;= N; ++i) &#123;</span><br><span class="line">    f[i][<span class="number">0</span>] = f[i][<span class="number">1</span>] = (f[i - <span class="number">1</span>][<span class="number">0</span>] + f[i - <span class="number">1</span>][<span class="number">1</span>]) % mod;</span><br><span class="line">    f[i][<span class="number">1</span>] = (f[i][<span class="number">1</span>] - f[i - K][<span class="number">0</span>] + mod) % mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> f[N][<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="G-è¾æ›¸é †"><a href="#G-è¾æ›¸é †" class="headerlink" title="G - è¾æ›¸é †"></a>G - è¾æ›¸é †</h3><h4 id="problem-6"><a href="#problem-6" class="headerlink" title="problem"></a>problem</h4><p>æ±‚å­—ç¬¦ä¸² $s \ (1 \le |s| \le 10^6)$ çš„å­—å…¸åºç¬¬ $K \ (1 \le K \le 10^{18})$ å°çš„éç©º<strong>å­åºåˆ—</strong>æˆ–åˆ¤æ–­ä¸å­˜åœ¨ã€‚ç›¸åŒçš„å­åºåˆ—åªè®¡ç®—ä¸€æ¬¡ã€‚å­—ç¬¦é›†å°å†™æ‹‰ä¸å­—æ¯ã€‚</p><h4 id="solution-6"><a href="#solution-6" class="headerlink" title="solution"></a>solution</h4><blockquote><p>ã¨ï¼Œè‰²ã€…æ›¸ã„ãŸã‘ã©ã‚ã‹ã‚Šã«ãã„è§£èª¬ã ãªâ€¦ï¼<br>è‡ªåˆ†ã‚‚ã‹ãªã‚Šè‹¦æ‰‹ãªå•é¡Œãªã®ã§â€¦ï¼<br>â€”â€” Suikaba çš„åŸè¯</p></blockquote><p>çœ‹äº† Suikaba ç¥ä»™çš„é¢˜è§£ï¼Œå°è¯•æ¥è‡ªå·±èƒ¡ä¸€èƒ¡ï¼ˆ</p><p>è®¾ $\mathrm{nxt}_{i, c}$ ä¸º $s$ ä¸­ç¬¬ $i$ ä¸ªä½ç½®ä¹‹åç¬¬ä¸€ä¸ªå‡ºç° $c$ çš„ä½ç½®ï¼›$f_i$ ä¸ºä½¿ç”¨ç¬¬ $i$ ä¸ªä½ç½®çš„å­—ç¬¦ï¼Œå…¶åå­åºåˆ—çš„ä¸ªæ•°ã€‚é‚£ä¹ˆæœ‰</p><script type="math/tex; mode=display">f_i = 1 + \sum_{c \in |T|} f_{\mathrm{nxt}_{i, c}}</script><p>å…¶ä¸­ $T$ è¡¨ç¤ºå­—ç¬¦é›†ã€‚åŠ ä¸Šçš„ $1$ è¡¨ç¤ºå½“å‰å­—ç¬¦å•ç‹¬æˆä¸²ã€‚</p><p>è€ƒè™‘å¦‚ä½•æ‰¾åˆ°å­—å…¸åºç¬¬ $K$ å°çš„é›†åˆã€‚è®¾ä¸€ä¸ªå‘åè·³çš„æŒ‡é’ˆï¼Œåˆå§‹æŒ‡å‘å­—ç¬¦ä¸²èµ·å§‹ä½ç½®ã€‚ä»å°åˆ°å¤§æšä¸¾ $T$ ä¸­çš„å­—ç¬¦ï¼Œå‘åè¾¹è·³æŒ‡é’ˆè¾¹ç»Ÿè®¡ç­”æ¡ˆå³å¯ã€‚å®ç°ç»†èŠ‚è§ä»£ç ã€‚</p><h4 id="code-5"><a href="#code-5" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> s[<span class="number">1000003</span>];</span><br><span class="line"><span class="keyword">int</span> nxt[<span class="number">1000003</span>][<span class="number">27</span>];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> K, f[<span class="number">1000003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s%lld&quot;</span>, s + <span class="number">1</span>, &amp;K);</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span> N = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">  std::<span class="built_in">fill</span>(nxt[N + <span class="number">1</span>] + <span class="number">1</span>, nxt[N + <span class="number">1</span>] + <span class="number">27</span>, N + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = N; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">    <span class="built_in">memcpy</span>(nxt[i] + <span class="number">1</span>, nxt[i + <span class="number">1</span>] + <span class="number">1</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) * <span class="number">26</span>);</span><br><span class="line">    f[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">26</span>; ++j) &#123;</span><br><span class="line">      f[i] += f[nxt[i][j]];</span><br><span class="line">      f[i] = std::<span class="built_in">min</span>(f[i], K + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    nxt[i][s[i] &amp; <span class="number">31</span>] = i;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">bool</span> g = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i, p = <span class="number">1</span>; K &gt; <span class="number">0</span>; ) &#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">26</span>; ++i)</span><br><span class="line">      <span class="keyword">if</span> (f[nxt[p][i]] &lt; K)</span><br><span class="line">        K -= f[nxt[p][i]];</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        --K;</span><br><span class="line">        p = nxt[p][i] + <span class="number">1</span>;</span><br><span class="line">        g = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">putchar</span>(i - <span class="number">1</span> + <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">if</span> (i &gt; <span class="number">26</span>) <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(g ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;Eel&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="H-ãƒŠãƒƒãƒ—ã‚¶ãƒƒã‚¯"><a href="#H-ãƒŠãƒƒãƒ—ã‚¶ãƒƒã‚¯" class="headerlink" title="H - ãƒŠãƒƒãƒ—ã‚¶ãƒƒã‚¯"></a>H - ãƒŠãƒƒãƒ—ã‚¶ãƒƒã‚¯</h3><h4 id="problem-7"><a href="#problem-7" class="headerlink" title="problem"></a>problem</h4><p>æœ‰ $U \ (1 \le U \le 100)$ ä¸ªç‰©å“ï¼Œç¬¬ $i$ ä¸ªçš„è´¨é‡ã€ä»·å€¼ã€é¢œè‰²åˆ†åˆ«ä¸º $w_i, v_i, c_i \ (1 \le w_i, v_i \le 10000, 1 \le c_i \le 50)$ã€‚æœ‰ä¸€ä¸ªèƒŒåŒ…ï¼Œèƒ½å®¹çº³æ€»è´¨é‡ä¸º $W \ (1 \le W \le 10000)$ï¼Œé¢œè‰²ç§ç±»æ•°ä¸º $C \ (1 \le C \le 50)$ çš„ç‰©å“ã€‚æ±‚èƒ½å®¹çº³çš„ç‰©å“çš„æœ€å¤§æ€»ä»·å€¼ã€‚</p><h4 id="solution-7"><a href="#solution-7" class="headerlink" title="solution"></a>solution</h4><p>è®¾ $f_{i, j}$ è¡¨ç¤ºä½¿ç”¨ä¸è¶…è¿‡ $i$ ç§é¢œè‰²ï¼Œæ€»è´¨é‡ä¸º $j$ æ—¶çš„æœ€å¤§ä»·å€¼ã€‚</p><p>éœ€è¦æšä¸¾é¢œè‰²ä¸ªæ•°å’Œæ‰€æœ‰é¢œè‰²ï¼Œä»¥æ¯ä¸ªé¢œè‰²ä¸ºæ•´ä½“è¿›è¡Œè½¬ç§»ã€‚</p><p>è½¬ç§»æ—¶ç›´æ¥å¥—ç”¨ 01 èƒŒåŒ…è½¬ç§»æ–¹ç¨‹ $F_i = max{\{F_{i - w_j} + v_j\}}$ å³å¯ã€‚å…¶ä¸­ $F$ ä»£è¡¨ $f$ çš„ç¬¬ä¸€ç»´ã€‚</p><p>åˆå§‹çŠ¶æ€ $f_{i, j} = - \infty, f_{0, 0} = 0$ã€‚</p><p>ç­”æ¡ˆå³ä¸º $\max{\{f_{C, i}\}}$ã€‚æ€»å¤æ‚åº¦ $O(UCW)$ï¼Œä¸è¿‡å¸¸æ•°å¾ˆå°ã€‚</p><h4 id="code-6"><a href="#code-6" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> w, v;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> t[<span class="number">10003</span>], f[<span class="number">53</span>][<span class="number">10003</span>];</span><br><span class="line">vector&lt;Node&gt; z[<span class="number">53</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N, W, C;</span><br><span class="line"></span><br><span class="line">  cin &gt;&gt; N &gt;&gt; W &gt;&gt; C;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, w, v, c; i &lt;= N; ++i) &#123;</span><br><span class="line">    cin &gt;&gt; w &gt;&gt; v &gt;&gt; c;</span><br><span class="line">    z[c].<span class="built_in">push_back</span>(&#123;w, v&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(f, <span class="number">0xc0</span>, <span class="keyword">sizeof</span> f);</span><br><span class="line">  f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">1</span>; c &lt;= <span class="number">50</span>; ++c)</span><br><span class="line">    <span class="keyword">if</span> (z[c].<span class="built_in">size</span>()) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = C; i; --i) &#123;</span><br><span class="line">        <span class="built_in">memcpy</span>(t, f[i - <span class="number">1</span>], <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) * (W + <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (Node x : z[c])</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> j = W; j &gt;= x.w; --j)</span><br><span class="line">            t[j] = <span class="built_in">max</span>(t[j], t[j - x.w] + x.v);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= W; ++j)</span><br><span class="line">          f[i][j] = <span class="built_in">max</span>(f[i][j], t[j]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  cout &lt;&lt; *<span class="built_in">max_element</span>(f[C], f[C] + W + <span class="number">1</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="I-ã‚¤ã‚¦ã‚£"><a href="#I-ã‚¤ã‚¦ã‚£" class="headerlink" title="I - ã‚¤ã‚¦ã‚£"></a>I - ã‚¤ã‚¦ã‚£</h3><h4 id="problem-8"><a href="#problem-8" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ªä»…ç”±å­—ç¬¦ $\texttt{i}$ å’Œ $\texttt{w}$ æ„æˆçš„å­—ç¬¦ä¸² $s \ (1 \le |s| \le 300)$ã€‚ä½ å¯ä»¥è¿›è¡Œè‹¥å¹²æ¬¡æ“ä½œï¼Œæ¯æ¬¡ä»ä¸²ä¸­é€‰å–è¿ç»­çš„ä¸‰ä¸ªå­—ç¬¦ $\texttt{iwi}$ å¹¶åˆ é™¤ã€‚åˆ é™¤åè¿™ä¸‰ä¸ªå­—ç¬¦çš„å·¦ä¾§å’Œå³ä¾§ä¼šè¿æ¥åœ¨ä¸€èµ·ï¼Œå¾—åˆ°ä¸€ä¸ªé•¿åº¦æ¯”åŸæ¥å° $3$ çš„æ–°ä¸²ã€‚æ±‚å¯èƒ½çš„æœ€å¤§æ“ä½œæ¬¡æ•°ã€‚</p><h4 id="solution-amp-code-1"><a href="#solution-amp-code-1" class="headerlink" title="solution &amp; code 1"></a>solution &amp; code 1</h4><p>è®¾ $f_{l, r}$ è¡¨ç¤º $s$ çš„å­ä¸² $s_{l..r}$ çš„ç­”æ¡ˆã€‚è¿™ä¸ªå¯ä»¥ç›´æ¥æšä¸¾åˆ†ç•Œç‚¹ $m \in [l, r)$ åˆ†æ²»è½¬ç§»ã€‚</p><p>å¥—ä¸Šè®°å¿†åŒ–ï¼Œæ€»å¤æ‚åº¦æ˜¯ $O(n^2)$ çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> f[<span class="number">303</span>][<span class="number">303</span>];</span><br><span class="line">std::string s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123; <span class="comment">// [l, r]</span></span><br><span class="line">  <span class="keyword">if</span> (r - l &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (f[l][r] != <span class="number">-1</span>) <span class="keyword">return</span> f[l][r];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> m = l; m &lt; r; ++m) &#123;</span><br><span class="line">    ans = std::<span class="built_in">max</span>(ans, <span class="built_in">dfs</span>(l, m) + <span class="built_in">dfs</span>(m + <span class="number">1</span>, r));</span><br><span class="line">    <span class="keyword">if</span> (s[l] == <span class="string">&#x27;i&#x27;</span> &amp;&amp; s[m] == <span class="string">&#x27;w&#x27;</span> &amp;&amp; s[r] == <span class="string">&#x27;i&#x27;</span>)</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">dfs</span>(l + <span class="number">1</span>, m - <span class="number">1</span>) == m - l - <span class="number">1</span> &amp;&amp; <span class="built_in">dfs</span>(m + <span class="number">1</span>, r - <span class="number">1</span>) == r - m - <span class="number">1</span>)</span><br><span class="line">        ans = r - l + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> f[l][r] = ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="keyword">sizeof</span> f);</span><br><span class="line">  std::cin &gt;&gt; s;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">dfs</span>(<span class="number">0</span>, s.<span class="built_in">size</span>() - <span class="number">1</span>) / <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="solution-amp-code-2"><a href="#solution-amp-code-2" class="headerlink" title="solution &amp; code 2"></a>solution &amp; code 2</h4><p>å…¶å®è¿™é¢˜å¤§å¯ä¸å¿… dpã€‚è€ƒè™‘åˆ å»ä¸€ä¸ªä¸² $\texttt{iwi}$ åå½“ä¸”ä»…å½“å®ƒçš„å·¦ä¾§æˆ–å³ä¾§æ˜¯ $\texttt{i}$ æ‰æœ‰å¯èƒ½å‡ºç°ä¸€ä¸ªæ–°çš„ä¸² $\texttt{iwi}$ã€‚</p><p>å¯ä»¥é¦–å…ˆåˆ å»æ‰€æœ‰çš„ $\texttt{iwii}$ å’Œ $\texttt{iiwi}$ çš„å­ä¸² $\texttt{iwi}$ã€‚</p><p>æ€»å¤æ‚åº¦ä¹Ÿæ˜¯ $O(n^2)$ï¼Œå¸¦ä¸€ä¸ªå¾ˆå°çš„å¸¸æ•°<del>ï¼Œå…·ä½“å¤šå°å–å†³äºæ•°æ®å¼ºåº¦</del>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">std::string s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  std::cin &gt;&gt; s;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span> N = s.<span class="built_in">size</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (std::string::size_type p = <span class="number">0</span>; ; )</span><br><span class="line">    <span class="keyword">if</span> ((p = s.<span class="built_in">find</span>(<span class="string">&quot;iiwi&quot;</span>)) != std::string::npos)</span><br><span class="line">      s.<span class="built_in">erase</span>(p + <span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ((p = s.<span class="built_in">find</span>(<span class="string">&quot;iwii&quot;</span>)) != std::string::npos)</span><br><span class="line">      s.<span class="built_in">erase</span>(p, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (std::string::size_type p = <span class="number">0</span>; (p = s.<span class="built_in">find</span>(<span class="string">&quot;iwi&quot;</span>, p)) != std::string::npos; )</span><br><span class="line">    s.<span class="built_in">erase</span>(p, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (N - s.<span class="built_in">size</span>()) / <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="J-ãƒœãƒ¼ãƒ«"><a href="#J-ãƒœãƒ¼ãƒ«" class="headerlink" title="J - ãƒœãƒ¼ãƒ«"></a>J - ãƒœãƒ¼ãƒ«</h3><h4 id="problem-9"><a href="#problem-9" class="headerlink" title="problem"></a>problem</h4><p>æœ‰ $N \ (1 \le N \le 16)$ ä¸ªç‰©å“ï¼Œå…¶ä¸­ç¬¬ $i$ ä¸ªåœ¨ $x_i \ (0 \le x_i \le 15)$ åæ ‡å¤„ã€‚å‘åæ ‡ $x$ æ‰”çƒæ—¶ï¼Œåˆ†åˆ«æœ‰ $\frac{1}{3}$ çš„æ¦‚ç‡å‡»ä¸­åæ ‡ $x - 1, x, x + 1$ ä¸­çš„ä¸€ä¸ªï¼›å¦‚æœæ‰“ä¸­çš„åæ ‡ä¸Šæœ‰ç‰©å“ï¼Œå°†å…¶æ‰“å€’ã€‚æ±‚å‡ºåœ¨æœ€ä¼˜ç­–ç•¥ä¸‹æœŸæœ›æ‰”çƒå¤šå°‘æ¬¡å°†æ‰€æœ‰ç‰©å“æ‰“å€’ã€‚ä¿è¯ $x_i$ ä¸¤ä¸¤ä¸åŒã€‚</p><p>èµ›æ—¶è¡¥å……ï¼š<strong>æ¯æ¬¡æ‰”çƒæ—¶å¯ä»¥å…ˆçœ‹åˆ°ä¸Šä¸€æ¬¡æ‰”çƒå‡»ä¸­çš„ä½ç½®å†å†³å®šå‘å“ªé‡Œæ‰”çƒã€‚</strong></p><h4 id="problem-10"><a href="#problem-10" class="headerlink" title="problem"></a>problem</h4><p>çœ‹åˆ°è¿™ä¸ªæ•°æ®èŒƒå›´ï¼Œç›²çŒœçŠ¶å‹ã€‚</p><p>è®¾ $E(S)$ ä¸ºçŠ¶æ€ $S$ æ—¶çš„æœŸæœ›æ¬¡æ•°ã€‚è€ƒè™‘å¦‚ä½•è½¬ç§»ã€‚ä¸€èˆ¬è¿™ç§é¢˜éœ€è¦åˆ—å‡ºä¸€ä¸ªå…³äº $E(S)$ çš„æ–¹ç¨‹ï¼ŒæŠŠå®ƒåè§£å‡ºæ¥ã€‚</p><p>è€ƒè™‘å‘ $x$ æ‰”çƒçš„æƒ…å†µï¼Œèƒ½åˆ—å‡ºè¿™æ ·çš„ä¸€ä¸ªæ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">E(S) = 1 + \sum{(P(u) \times E(T))} + (1 - \sum{P(u)}) \times E(S)</script><p>å…¶ä¸­ $P(x) = \frac{1}{3}$ è¡¨ç¤ºå‡»ä¸­åæ ‡ $x$ çš„æ¦‚ç‡ï¼Œ$u \in \{x - 1, x, x + 1 \}$ï¼Œ<code>T = S &amp; ~u</code>ã€‚åŒ–ç®€å¯å¾—</p><script type="math/tex; mode=display">E(S) = \frac{1 + \sum{(P(u) \times E(T))}}{\sum P(u)}</script><p>å°±å¯ä»¥æšä¸¾ $x$ è¿›è¡Œè½¬ç§»äº†ã€‚</p><p>æ˜¾ç„¶å¯ä»¥è®°å¿†åŒ–ä¸€ä¸‹ã€‚è®¾ $f_S = E(S)$ï¼Œåˆå§‹çŠ¶æ€ $f_0 = 0$ã€‚</p><p>ç­”æ¡ˆå³ä¸º $E(S)$ã€‚æ€»å¤æ‚åº¦ $O(N \times 2^N)$ã€‚</p><h4 id="code-7"><a href="#code-7" class="headerlink" title="code"></a>code</h4><p>ä»£ç å¯èƒ½æ¢äº†ä¸€äº›å¥‡æ€ªçš„å†™æ³•ï¼Œä½†æ˜¯è·Ÿä¸Šé¢å¼å­æ˜¯ç­‰ä»·çš„ï¼ˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> f[<span class="number">1</span>&lt;&lt;<span class="number">16</span>|<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> S)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (f[S] &gt;= <span class="number">0.</span>) <span class="keyword">return</span> f[S];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">double</span> ans = <span class="number">1</span> &lt;&lt; <span class="number">16</span>, E;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>, c; x &lt; <span class="number">16</span>; ++x) &#123;</span><br><span class="line">    <span class="keyword">int</span> T[] = &#123;</span><br><span class="line">      S &amp; ~((<span class="number">1</span> &lt;&lt; x) &lt;&lt; <span class="number">1</span>),</span><br><span class="line">      S &amp; ~(<span class="number">1</span> &lt;&lt; x),</span><br><span class="line">      S &amp; ~((<span class="number">1</span> &lt;&lt; x) &gt;&gt; <span class="number">1</span>)</span><br><span class="line">    &#125;;</span><br><span class="line">    c = <span class="number">0</span>, E = <span class="number">1.</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i)</span><br><span class="line">      <span class="keyword">if</span> (S != T[i])</span><br><span class="line">        E += <span class="built_in">dfs</span>(T[i]) / <span class="number">3.</span>, ++c;</span><br><span class="line">    ans = std::<span class="built_in">min</span>(ans, <span class="number">3</span> * E / c);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> f[S] = ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N, S = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;N);</span><br><span class="line">  std::<span class="built_in">fill</span>(f + <span class="number">1</span>, f + (<span class="number">1</span> &lt;&lt; <span class="number">16</span>), <span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> t; N; --N) &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t);</span><br><span class="line">    S |= <span class="number">1</span> &lt;&lt; t;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">dfs</span>(S);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="K-ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ"><a href="#K-ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ" class="headerlink" title="K - ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ"></a>K - ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ</h3><h4 id="problem-11"><a href="#problem-11" class="headerlink" title="problem"></a>problem</h4><p>å¯¹äºä¸€ä¸ªå« $K$ ä¸ªåœ†çš„åºåˆ— $C_1, C_2, \cdots, C_K$ï¼Œå¦‚æœå¯¹äºæ¯ä¸ª $i$ éƒ½æœ‰åœ† $C_{i + 1}$ <strong>ä¸¥æ ¼</strong>ä½äºåœ† $C_i$ çš„å†…éƒ¨ï¼Œé‚£ä¹ˆå®ƒä»¬å¯ä»¥æˆä¸ºä¸€ä¸ªå¤§å°ä¸º $K$ çš„é¶å­ã€‚</p><p>å¹³é¢ç›´è§’åæ ‡ç³»é‡Œæœ‰ $N \ (1 \le N \le 10^6)$ ä¸ªåœ†ï¼Œç¬¬ $i$ ä¸ªçš„åœ†å¿ƒä¸º $(x_i, 0) \ (1 \le x_i \le 10^9)$ï¼ŒåŠå¾„ä¸º $r_i \ (1 \le r_i \le 10^9)$ã€‚é€‰å‡ºè‹¥å¹²ä¸ªåœ†å¹¶é‡æ–°æ’åˆ—æ„æˆé¶å­ï¼Œæ±‚å‡ºå¯èƒ½æ„æˆçš„é¶å­çš„æœ€å¤§å¤§å°ã€‚</p><h4 id="solution-8"><a href="#solution-8" class="headerlink" title="solution"></a>solution</h4><p>å¯¹äºæ¯ä¸ªåœ† $i$ æ„é€ ä¸€ä¸ªäºŒå…ƒç»„ $(x_i + r_i, x_i - r_i)$ï¼ŒæŒ‰å‡åºæ’åºï¼Œå†å¯¹ç¬¬äºŒå…³é”®å­—æ±‚å‡ºæœ€é•¿ä¸‹é™å­åºåˆ—çš„é•¿åº¦å°±æ˜¯ç­”æ¡ˆã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ä¸€å †åœ†ç”»åœ¨è¿™é‡Œæ˜¯ä»€ä¹ˆæ ·å­çš„ã€å–å‡ºåˆæ³•çš„éƒ¨åˆ†æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œè¿™ä¸ªå°±å¾ˆæ˜¾ç„¶äº†ï¼ˆ</p><h4 id="code-8"><a href="#code-8" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[<span class="number">100003</span>];</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; p[<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N, N_ = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  cin &gt;&gt; N;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x, r; i &lt;= N; ++i) &#123;</span><br><span class="line">    cin &gt;&gt; x &gt;&gt; r;</span><br><span class="line">    p[i] = &#123;x + r, x - r&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(p + <span class="number">1</span>, p + N + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  f[<span class="number">1</span>] = -p[<span class="number">1</span>].second;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; ++i)</span><br><span class="line">    <span class="keyword">if</span> (f[N_] &lt; -p[i].second) f[++N_] = -p[i].second;</span><br><span class="line">    <span class="keyword">else</span> *<span class="built_in">lower_bound</span>(f + <span class="number">1</span>, f + N_ + <span class="number">1</span>, -p[i].second) = -p[i].second;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, N_);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="L-çŒ«"><a href="#L-çŒ«" class="headerlink" title="L - çŒ«"></a>L - çŒ«</h3><h4 id="problem-12"><a href="#problem-12" class="headerlink" title="problem"></a>problem</h4><p>æœ‰ $N \ (1 \le N \le 1000)$ åªçŒ«ï¼ŒçŒ« $i$ å’ŒçŒ« $j$ çš„å‹å¥½å€¼ä¸º $z_{i, j} \ (1 \le z_{i, j} \le 1000)$ã€‚çŒ«çš„å¹¸ç¦åº¦æ˜¯ä¸è·ç¦»ä¸è¶…è¿‡ $1$ çš„æ‰€æœ‰çŒ«çš„å‹å¥½å€¼ä¹‹å’Œã€‚æŠŠçŒ«æŒ‰ç…§ $1 \sim N$ çš„é¡ºåºç½®äºä¸€æ¡çº¿ä¸Šï¼ˆè®¾çŒ« $i$ çš„åæ ‡ä¸º $x_i$ï¼Œåˆ™ $\forall i \in [1, N), x_i &lt; x_{i + 1}$ï¼‰ã€‚$x_i$ å¯ä»¥ä¸ºä»»æ„å®æ•°ã€‚æ±‚çŒ«çš„å¹¸ç¦åº¦ä¹‹å’Œçš„æœ€å¤§å€¼ã€‚</p><p>ä¿è¯ $z_{i, i} = 0, z_{i, j} = z_{j, i}$ã€‚</p><h4 id="solution-9"><a href="#solution-9" class="headerlink" title="solution"></a>solution</h4><p>è®¾ $f_{i, j} \ (j \le i)$ è¡¨ç¤ºçŒ« $j$ å’ŒçŒ« $i$ åœ¨ $1$ è·ç¦»ä»¥å†…æ—¶å‰ $i$ åªçŒ«çš„æœ€å¤§å¹¸ç¦åº¦ï¼ˆä¸¤ä¸¤ä¹‹é—´è®¡ç®—ä¸€æ¬¡ï¼‰ã€‚åˆ™</p><script type="math/tex; mode=display">f_{i, j} = \max_{k = 1}^j{\{f_{i - 1, k}\}} + \sum_{l = j}^i z_{i, l}</script><p>è¿™ä¸ªè½¬ç§»æ˜¯ $O(N)$ çš„ï¼Œå¤ªæ…¢äº†ï¼Œè¦æƒ³åŠæ³•ä¼˜åŒ–æ‰ã€‚</p><p>ä»¤ $\mathrm{mx}_{i, k} = \max_{k = 1}^j{\{f_{i - 1, k}\}}, s_{i, j} = \sum_{k = j}^i z_{i, k}$ï¼Œåˆ™ $f_{i, j} = \mathrm{mx}_{i, j} + s_{i, i} - s_{i, j - 1}$ï¼Œè½¬ç§»æˆäº† $O(1)$ çš„ã€‚</p><p>ç­”æ¡ˆå³ä¸º $2 \times \max{\{f_{N, i}\}}$ã€‚æ€»å¤æ‚åº¦ $O(N^2)$ã€‚</p><h4 id="code-9"><a href="#code-9" class="headerlink" title="code"></a>code</h4><p>è¿™é‡ŒæŠŠä¸‰ä¸ªæ•°ç»„éƒ½å‹äº†ä¸€ç»´ã€‚å…¶ä¸­ $\mathrm{mx}$ å…ˆä½¿ç”¨ $\mathrm{mx}_{i}$ è€Œåç»Ÿè®¡ $\mathrm{mx}_{i + 1}$ã€‚</p><p>æ³¨æ„è¿™ä¸ªå†™æ³•ä¸‹ $\mathrm{mx}_{i, 0}$ è¦åˆå§‹åŒ–æˆè´Ÿæ— ç©·å¤§ã€‚</p><p>è¿™ä»½ä»£ç ç›®å‰åœ¨ AtC æ˜¯æ—¶é—´å¹¶åˆ—ç¬¬ä¸€ã€‚ç©ºé—´æœ‰ç¥ä»™ç”¨ <code>std::vector</code> å¡åˆ° 256KB çš„ï¼Œå®åœ¨å¡ä¸è¿‡ï¼ˆ</p><p>å¬è¯´æœ‰å†™æ³•è¿˜èƒ½çœæ‰ä¸€ä¸ªæ•°ç»„ï¼Œä¸ç®¡äº†ä¸ç®¡äº†.jpg</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> s[<span class="number">1003</span>], mx[<span class="number">1003</span>], f[<span class="number">1003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line">  cin &gt;&gt; N;</span><br><span class="line">  mx[<span class="number">0</span>] = <span class="number">-0x3f3f3f3f</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; ++j)</span><br><span class="line">      cin &gt;&gt; s[j], s[j] += s[j - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; ++j) &#123;</span><br><span class="line">      f[j] = mx[j] + s[i] - s[j - <span class="number">1</span>];</span><br><span class="line">      mx[j] = std::<span class="built_in">max</span>(mx[j - <span class="number">1</span>], f[j]);</span><br><span class="line">    &#125;</span><br><span class="line">    mx[i + <span class="number">1</span>] = mx[i];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> *std::<span class="built_in">max_element</span>((f + <span class="number">1</span>, f + N + <span class="number">1</span>) &lt;&lt; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="M-å®¶"><a href="#M-å®¶" class="headerlink" title="M - å®¶"></a>M - å®¶</h3><h4 id="problem-13"><a href="#problem-13" class="headerlink" title="problem"></a>problem</h4><p>ä¸€æ ‹æˆ¿å­æœ‰ $H \ (2 \le H \le 10^9)$ å±‚ï¼Œæ¯å±‚çš„ç»“æ„ç›¸åŒï¼Œéƒ½æœ‰ $R \ (1 \le R \le 16)$ ä¸ªæˆ¿é—´ã€‚æ¯å±‚çš„æ„é€ ç”¨çŸ©é˜µ $g$ è¡¨ç¤ºã€‚å¦‚æœ $g_{i, j} = 1$ï¼Œåˆ™æˆ¿é—´ $i$ å’Œæˆ¿é—´ $j$ ä¹‹é—´æœ‰ä¸€æ¡åŒå‘é€šè·¯ã€‚å¯¹äºä»»æ„çš„ $h \ (1 &lt; h \le H)$ å’Œ $r \ (1 \le r \le R)$ï¼Œå¯ä»¥é€šè¿‡ $h$ å±‚æˆ¿é—´ $r$ ä¸‹æ¥¼åˆ° $h - 1$ å±‚æˆ¿é—´ $r$ï¼Œä¸èƒ½ä¸Šæ¥¼ã€‚æ±‚ä» $H$ å±‚æˆ¿é—´ $1$ åˆ° $1$ å±‚æˆ¿é—´ $1$ çš„ä¸è‡ªäº¤çš„è·¯å¾„æ¡æ•°ã€‚</p><p>ä¿è¯ $g_{i, j} \in \{0, 1\}, g_{i, i} = 0, g_{i, j} = g_{j, i}$ã€‚ç­”æ¡ˆå¯¹ $10^9 + 7$ å–æ¨¡ã€‚</p><h4 id="solution-10"><a href="#solution-10" class="headerlink" title="solution"></a>solution</h4><p><del>çœ‹åˆ°å¤§å¾—ç¦»è°±çš„ $H$ ç›´æ¥æ¨æµ‹çŸ©é˜µ+å¿«é€Ÿå¹‚ç›¸å…³ï¼Œçœ‹åˆ°å°å¾—ç¦»è°±çš„ $R$ ç›´æ¥æ¨æµ‹çŠ¶å‹ç›¸å…³</del></p><p>è®¾çŸ©é˜µ $M_{i, j}$ è¡¨ç¤ºåœ¨åŒä¸€å±‚ä¸­æˆ¿é—´ $i$ åˆ°æˆ¿é—´ $j$ çš„ä¸è‡ªäº¤çš„è·¯å¾„æ•°ã€‚</p><p>è¿™ä¸ªå¯ä»¥çŠ¶å‹æ±‚ï¼Œè®¾ $f_{s, i, S}$ ä¸ºä»æˆ¿é—´ $s$ å‡ºå‘ï¼Œç»è¿‡æ€»ç‚¹é›†ä¸º $S$ åˆ°è¾¾ $i$ çš„ä¸è‡ªäº¤çš„è·¯å¾„æ•°ã€‚ç›´æ¥æšä¸¾è½¬ç§»æ²¡å•¥é—®é¢˜ã€‚é‚£ä¹ˆ $M_{s, i} = \sum{f_{s, i, T}}$ã€‚</p><p>åˆå§‹çŠ¶æ€ $f_{i, s, 2^s} = 1$ã€‚</p><p>ç­”æ¡ˆå³ä¸º $(M^H)_{0, 0}$ã€‚æ€»å¤æ‚åº¦ $O((2^R + \log H)R^3)$ï¼Œæ—¶é™ 8s è¶³å¤Ÿäº†ã€‚</p><h4 id="code-10"><a href="#code-10" class="headerlink" title="code"></a>code</h4><p>å¯¹äºæ¯ä¸ª $s$ï¼Œ$f$ åä¸¤ç»´çš„å€¼äº’ç›¸ç‹¬ç«‹ï¼Œå¯ä»¥ç›´æ¥å»æ‰ç¬¬ä¸€ç»´ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> mod = <span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">int</span> _Add(<span class="keyword">int</span> m, <span class="keyword">int</span> n) &#123;</span><br><span class="line">  <span class="keyword">return</span> (m + n) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> &amp;m, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">  m = _Add(m, n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> S, z[<span class="number">17</span>][<span class="number">17</span>];</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Matrix</span>(<span class="keyword">int</span> _S, <span class="keyword">bool</span> e=<span class="number">0</span>); <span class="comment">// e=1 æ—¶æ„é€ å•ä½çŸ©é˜µ</span></span><br><span class="line">  Matrix <span class="keyword">operator</span>*(Matrix rhs);</span><br><span class="line">  <span class="keyword">friend</span> Matrix <span class="keyword">operator</span>^(Matrix b, <span class="keyword">int</span> p);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> H, R, z[<span class="number">17</span>][<span class="number">17</span>], f[<span class="number">16</span>][<span class="number">1</span>&lt;&lt;<span class="number">16</span>|<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  std::cin &gt;&gt; H &gt;&gt; R;</span><br><span class="line">  <span class="function">Matrix <span class="title">M</span><span class="params">(R)</span></span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; R; ++i)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; R; ++j)</span><br><span class="line">      std::cin &gt;&gt; z[i][j];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">0</span>; s &lt; R; ++s) &#123;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span> f);</span><br><span class="line">    f[s][<span class="number">1</span> &lt;&lt; s] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> S = <span class="number">0</span>; S &lt; <span class="number">1</span> &lt;&lt; R; ++S)</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; R; ++i)</span><br><span class="line">        <span class="keyword">if</span> (f[i][S]) <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; R; ++j)</span><br><span class="line">          <span class="keyword">if</span> (!((S &gt;&gt; j) &amp; <span class="number">1</span>) &amp;&amp; z[i][j])</span><br><span class="line">            <span class="built_in">Add</span>(f[j][S | (<span class="number">1</span> &lt;&lt; j)], f[i][S]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; R; ++i)</span><br><span class="line">      M.z[s][i] = std::<span class="built_in">accumulate</span>(f[i], f[i] + (<span class="number">1</span> &lt;&lt; R), <span class="number">0</span>, _Add);</span><br><span class="line">  &#125;</span><br><span class="line">  std::cout &lt;&lt; (M ^ H).z[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="N-æœ¨"><a href="#N-æœ¨" class="headerlink" title="N - æœ¨"></a>N - æœ¨</h3><h4 id="problem-14"><a href="#problem-14" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€æ£µ $N \ (1 \le N \le 1000)$ ä¸ªç‚¹çš„æ ‘ã€‚ç°åœ¨ä½ æœ‰ $N$ ä¸ªç‚¹ï¼Œéœ€è¦é‡æ–°ç”»å‡ºè¿™æ£µæ ‘ã€‚è¦æ±‚åœ¨è¿è¾¹è¿‡ç¨‹ä¸­ä»ç„¶æ˜¯ä¸€æ£µæ ‘ã€‚æ±‚åŠ è¾¹çš„æ–¹æ¡ˆæ•°ã€‚</p><h4 id="solution-11"><a href="#solution-11" class="headerlink" title="solution"></a>solution</h4><p>æ˜¯çœ‹çš„<a href="https://www.luogu.com.cn/blog/ylxmf2005/solution-at690">è¿™ä¸ªç¥ä»™</a>çš„é¢˜è§£ã€‚</p><p>æ˜¾ç„¶å¯ä»¥æšä¸¾æ¯ä¸ªç‚¹æ ‘å½¢ dp ä¸€éã€‚å‡è®¾ç°åœ¨ dfs åˆ°äº†ç‚¹ $u$ï¼Œè€ƒè™‘æ€ä¹ˆè½¬ç§»ã€‚</p><p>è®¾ $f_u$ ä¸ºä»¥ $u$ ä¸ºæ ¹çš„å­æ ‘çš„æ–¹æ¡ˆæ•°ï¼Œ$s_u$ ä¸ºè¿™æ£µå­æ ‘ä¸­æœ‰å¤šå°‘æ¡è¾¹ã€‚</p><p>ä» $u$ çš„å„¿å­å‘ä¸Šè½¬ç§»ã€‚å‡è®¾ç°åœ¨å¤„ç†åˆ° $v$ï¼Œéœ€è¦åœ¨å½“å‰çš„åŠ è¾¹åºåˆ—ä¸­<strong>ç›¸å¯¹é¡ºåºä¸å˜åœ°</strong>åŠ å…¥ $v$ å­æ ‘ä¸­çš„è¾¹ã€‚ä¹Ÿå³ <code>s[u] += s[v], f[u] = f[u] * f[v] * C(s[u], s[v])</code>ã€‚</p><p>æœ€ç»ˆç­”æ¡ˆæ˜¯ä»¥æ¯ä¸ªç‚¹ä¸ºæ ¹æ—¶çš„ç­”æ¡ˆæ€»å’Œçš„ä¸€åŠï¼Œå› ä¸ºæ¯æ¡è¾¹ä¼šè¢«ä¸¤ä¸ªç«¯ç‚¹è®¡ç®—ä¸€æ¬¡ï¼Œå¯¼è‡´æ–¹æ¡ˆä¸¤ä¸¤æœ¬è´¨ç›¸åŒã€‚</p><p>é¢„å¤„ç†å‡ºç»„åˆæ•°ï¼Œæ€»å¤æ‚åº¦ $O(n^2)$ã€‚</p><h4 id="code-11"><a href="#code-11" class="headerlink" title="code"></a>code</h4><p>ä»£ç ä¸­ <code>siz[]</code> å³ä¸ºä¸Šæ–‡çš„ $s$ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> mod = <span class="number">1000000007</span>, inv2 = <span class="number">500000004</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[<span class="number">1003</span>], siz[<span class="number">1003</span>], head[<span class="number">1003</span>], C[<span class="number">1003</span>][<span class="number">1003</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span> <span class="keyword">int</span> nxt, to; &#125; e[<span class="number">2003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">  f[u] = <span class="number">1</span>, siz[u] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u], v; i; i = e[i].nxt) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((v = e[i].to) == t) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(v, u);</span><br><span class="line">    siz[u] += siz[v];</span><br><span class="line">    f[u] = <span class="number">1ll</span> * f[u] * f[v] % mod * C[siz[u]][siz[v]] % mod;</span><br><span class="line">  &#125;</span><br><span class="line">  ++siz[u];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N, ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  cin &gt;&gt; N;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt; N; ++i) &#123;</span><br><span class="line">    cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">    <span class="built_in">addEdge</span>(u, v), <span class="built_in">addEdge</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    C[i][<span class="number">0</span>] = C[i][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; ++j)</span><br><span class="line">      C[i][j] = (C[i - <span class="number">1</span>][j - <span class="number">1</span>] + C[i - <span class="number">1</span>][j]) % mod;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="built_in">dfs</span>(i, <span class="number">0</span>);</span><br><span class="line">    ans = (ans + f[i]) % mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1ll</span> * ans * inv2 % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="O-æ–‡å­—åˆ—"><a href="#O-æ–‡å­—åˆ—" class="headerlink" title="O - æ–‡å­—åˆ—"></a>O - æ–‡å­—åˆ—</h3><h4 id="problem-15"><a href="#problem-15" class="headerlink" title="problem"></a>problem</h4><p>æ„é€ ä¸€ä¸ªå°å†™å­—æ¯æ„æˆçš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­å­—æ¯ $\alpha$ å‡ºç°äº† $z_\alpha \ (0 \le z_\alpha \le 10)$ æ¬¡ï¼Œä¸”ç›¸åŒå­—æ¯ä¸ç›¸é‚»ã€‚æ±‚æ„é€ æ–¹æ¡ˆæ•°ã€‚ç­”æ¡ˆå¯¹ $10^9 + 7$ å–æ¨¡ã€‚</p><h4 id="solution-12"><a href="#solution-12" class="headerlink" title="solution"></a>solution</h4><p>æŠ„äº†<a href="https://www.luogu.com.cn/blog/ylxmf2005/solution-at693">è¿™é‡Œ</a>ã€‚</p><h4 id="code-12"><a href="#code-12" class="headerlink" title="code"></a>code</h4><p>c++14ã€‚å’Œé¢˜è§£çš„ç•¥æœ‰ä¸åŒã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> mod = <span class="number">1&#x27;000&#x27;000&#x27;007</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">int</span> _Add(<span class="keyword">int</span> m, <span class="keyword">int</span> n);</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> &amp;m, <span class="keyword">int</span> n)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> z[<span class="number">27</span>], f[<span class="number">27</span>][<span class="number">263</span>], C[<span class="number">263</span>][<span class="number">263</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">26</span>, t; i; --i) &#123;</span><br><span class="line">    std::cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">if</span> (t) z[++N] = t;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">260</span>; ++i) &#123;</span><br><span class="line">    C[i][<span class="number">0</span>] = C[i][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; ++j)</span><br><span class="line">      C[i][j] = _Add(C[i - <span class="number">1</span>][j - <span class="number">1</span>], C[i - <span class="number">1</span>][j]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> l = z[<span class="number">1</span>];</span><br><span class="line">  f[<span class="number">1</span>][z[<span class="number">1</span>] - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; l; ++k)</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> b = <span class="number">0</span>; b &lt;= std::<span class="built_in">min</span>(z[i], k); ++b)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> a = <span class="number">0</span>, j; a + b &lt;= z[i] &amp;&amp; a &lt;= l + <span class="number">1</span> - k; ++a) &#123;</span><br><span class="line">          j = k - b + z[i] - a - b;</span><br><span class="line">          <span class="built_in">Add</span>(f[i][j], <span class="number">1ll</span> * f[i - <span class="number">1</span>][k] * C[k][b] % mod * C[l + <span class="number">1</span> - k][a] % mod * C[z[i] - <span class="number">1</span>][a + b - <span class="number">1</span>] % mod);</span><br><span class="line">        &#125;</span><br><span class="line">    l += z[i];</span><br><span class="line">  &#125;</span><br><span class="line">  std::cout &lt;&lt; f[N][<span class="number">0</span>] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="P-ã†ãªã"><a href="#P-ã†ãªã" class="headerlink" title="P - ã†ãªã"></a>P - ã†ãªã</h3><h4 id="problem-16"><a href="#problem-16" class="headerlink" title="problem"></a>problem</h4><p>æœ‰ä¸€æ£µ $N \ (1 \le N \le 1000)$ ä¸ªç‚¹çš„æ ‘ï¼Œç¬¬ $i$ æ¡è¾¹è¿æ¥ $a_i$ å’Œ $b_i$ã€‚æ±‚å‡ºæœ‰å¤šå°‘ç§æ–¹æ¡ˆèƒ½å¤Ÿé€‰å‡ºåŒ…å« $K \ (1 \le K \le 50)$ æ¡äº’ä¸ç›¸äº¤çš„è·¯å¾„çš„é›†åˆã€‚æ³¨æ„é›†åˆæ˜¯æ— åºçš„ã€‚</p><p>æ­¤å¤„ä¸¤æ¡è·¯å¾„ä¸ç›¸äº¤å®šä¹‰ä¸ºä¸¤æ¡è·¯å¾„çš„ç‚¹é›†çš„äº¤é›†ä¸ºç«¯ç‚¹çš„å¹¶é›†çš„å­é›†ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2020 Mar Records</title>
      <link href="/2020/2020-Mar-Records/"/>
      <url>/2020/2020-Mar-Records/</url>
      
        <content type="html"><![CDATA[<p>èœé¸¡ fa_555 ä¼šæŠŠä¸€äº›åŠ¨æ€ç®€è¦åœ°è®°åœ¨è¿™é‡Œã€‚ä¸»è¦è¿˜æ˜¯ç•™ç»™è‡ªå·±ä»¥åçœ‹çš„ã€‚</p><span id="more"></span><p><em>æ‰€æœ‰ä»£ç ä¸ä¿è¯åŒ…æ‹¬æ— å…³ç´§è¦çš„éƒ¨åˆ†</em></p><hr><p>è¿™ä¸ªå‚»é€¼ç°åœ¨ç²¾ç¥çŠ¶æ€å’Œèº«ä½“çŠ¶æ€éƒ½ä¸å¥½ã€‚è„‘å­é‡Œå•¥ä¸œè¥¿éƒ½æ²¡æœ‰ï¼Œè¿ç»­çˆ†é›¶äº†å¥½å‡ åœºæ¯”èµ›ã€‚</p><p>å’•å’•å’•ã€‚</p><!-- 0xf5fc0c --><hr><h3 id="æ¨¡æ¿-å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…"><a href="#æ¨¡æ¿-å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…" class="headerlink" title="[æ¨¡æ¿]å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…"></a><a href="https://www.luogu.com.cn/problem/P1776">[æ¨¡æ¿]å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…</a></h3><h4 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h4><p>ä¸€ä¸ªèƒŒåŒ…ï¼Œå®¹ç§¯ä¸º $C$ã€‚$n$ ç§ç‰©å“ï¼Œç¬¬ $i$ ç§çš„ä»·å€¼ã€ä½“ç§¯ã€æ•°é‡åˆ†åˆ«ä¸º $v_i, c_i, s_i$ã€‚</p><p>é€‰å‡ºè‹¥å¹²ä¸ªç‰©å“ï¼Œä½¿å¾—å®ƒä»¬çš„ä½“ç§¯ä¹‹å’Œä¸è¶…è¿‡èƒŒåŒ…å®¹ç§¯ï¼Œä¸”æœ€å¤§åŒ–å®ƒä»¬çš„ä»·å€¼ä¹‹å’Œã€‚æ±‚å‡ºè¿™ä¸ªæœ€å¤§ä»·å€¼ã€‚</p><h4 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h4><p>é¦–å…ˆå¯ä»¥æŠŠç¬¬ $i$ ç§ç‰©å“æ‹†æˆ $s_i$ï¼Œå½“æˆ 01 èƒŒåŒ…æ¥åšã€‚å¤æ‚åº¦æ˜¯ $O(nC^2)$ çš„ã€‚</p><p>è€ƒè™‘ä¼˜åŒ–ã€‚ä¸€ç§ç®€å•çš„ä¼˜åŒ–æ˜¯äºŒè¿›åˆ¶æ‹†åˆ†ï¼Œå³å¯¹äºä¸€ä¸ª $s_i$ï¼Œä¸€å®šèƒ½æ‹†åˆ†æˆ $2^0, 2^1, 2^2, \cdots, 2^k, s_i - \sum_{j = 1}^k {2^j}$ çš„ $O(\log s_i)$ ä¸ªæ•°ã€‚å¯ä»¥è¯æ˜ $\forall i \in [1, s_i]$ éƒ½å¯ä»¥ç”±è¿™äº›æ•°ä¸­çš„è‹¥å¹²ä¸ªç›¸åŠ å¾—åˆ°ã€‚å¤æ‚åº¦æ˜¯ $O(nC \log C)$ çš„ã€‚</p><p>äºŒè¿›åˆ¶ä¼˜åŒ–ä¸æ˜¯æœ€ä¼˜ç§€çš„ã€‚åˆ©ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ï¼Œå¯ä»¥å°†å¤æ‚åº¦ä¼˜åŒ–åˆ° $O(nC)$ã€‚ä»¤ $f_{i, j}$ ä¸ºå‰ $i$ ç§ç‰©å“å ç”¨ä½“ç§¯ä¸º $j$ æ—¶çš„æœ€å¤§ä»·å€¼ï¼Œè€ƒè™‘çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f(i, j) = \max{ \{f(i - 1, j - kc_i) + kv_i\}} \ (0 \le k \le s_i)</script><p>æ¢ä¸€ä¸‹ä¸‹æ ‡ï¼Œå‡è®¾å·²ç»æ±‚å‡º $f_{s - 1}$ï¼Œç°åœ¨è¦æ±‚ $f_s$ã€‚<br>$f_s(i) = f_{s - 1}(i - kv) + kw \ (0 \le k \le a)$<br>$f_{s - 1}(0), f_{s - 1}(v), f_{s - 1}(2v), \cdots$ å¯ä»¥æ›´æ–° $f_s(0), f_s(v), f_s(2v), \cdots$<br>$f_{s - 1}(1), f_{s - 1}(v + 1), f_{s - 1}(2v + 1), \cdots$ å¯ä»¥æ›´æ–° $f_s(1), f_s(v + 1), f_s(2v + 1), \cdots$<br>ä»»æ„ä¸¤ç»„ä¹‹é—´ä¸ä¼šå½±å“ã€‚æˆ‘ä»¬æŠŠç¬¬ä¸€ç»„é‡ç¼–å·ï¼Œå¾—åˆ°å¦‚ä¸‹çš„æ–°è½¬ç§»ï¼š<br>$f_s(i) = f_{s - 1}(i - k) + kw \ (0 \le k \le a)$<br>ç°åœ¨å†³ç­–åŒºé—´å˜æˆè¿ç»­çš„äº†ï¼Œå¯ä»¥ä½¿ç”¨ å•è°ƒé˜Ÿåˆ—æ±‚å‡ºç­”æ¡ˆã€‚</p><h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* struct Deque &#123; ... &#125; q, w; */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[<span class="number">40003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N, C, ans = <span class="number">0</span>, tmp = <span class="number">0</span>;</span><br><span class="line">  cin &gt;&gt; N &gt;&gt; C;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> v, c, s; N; --N) &#123;</span><br><span class="line">    cin &gt;&gt; v &gt;&gt; c &gt;&gt; s;</span><br><span class="line">    <span class="keyword">if</span> (!c) &#123; tmp += s * v; <span class="keyword">continue</span>; &#125;</span><br><span class="line">    <span class="built_in">dmin</span>(s, C / c);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>, K; j &lt; c; ++j) &#123;</span><br><span class="line">      K = (C - j) / c;</span><br><span class="line">      q.<span class="built_in">clear</span>(), w.<span class="built_in">clear</span>();</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>, now; k &lt;= K; ++k) &#123;</span><br><span class="line">        now = f[j + k * c] - k * v;</span><br><span class="line">        <span class="keyword">while</span> (q.<span class="built_in">size</span>() &amp;&amp; now &gt;= q.<span class="built_in">back</span>())</span><br><span class="line">          q.<span class="built_in">pop_back</span>(), w.<span class="built_in">pop_back</span>();</span><br><span class="line">        q.<span class="built_in">push_back</span>(now), w.<span class="built_in">push_back</span>(k);</span><br><span class="line">        <span class="keyword">while</span> (k - w.<span class="built_in">front</span>() &gt; s)</span><br><span class="line">          q.<span class="built_in">pop_front</span>(), w.<span class="built_in">pop_front</span>();</span><br><span class="line">        <span class="built_in">dmax</span>(f[j + k * c], q.<span class="built_in">front</span>() + k * v);</span><br><span class="line">        <span class="built_in">dmax</span>(ans, f[j + k * c]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans + tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="AGC034E-Complete-Compress"><a href="#AGC034E-Complete-Compress" class="headerlink" title="AGC034E Complete Compress"></a><a href="https://agc034.contest.atcoder.jp/tasks/agc034_e">AGC034E Complete Compress</a></h3><h4 id="problem-1"><a href="#problem-1" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€é¢— $n$ ä¸ªç»“ç‚¹çš„æ ‘ï¼ŒæŸäº›ç»“ç‚¹ä¸Šæœ‰æ£‹å­ï¼ˆæ°å¥½ä¸€é¢—ï¼‰ã€‚</p><p>å¯ä»¥è¿›è¡Œè‹¥å¹²æ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œå°†ä¸¤é¢—ä¸ç›¸é‚»çš„æ£‹å­å‡å‘ä¸­é—´ç§»åŠ¨ä¸€æ­¥ã€‚</p><p>åˆ¤æ–­èƒ½å¦é€šè¿‡è‹¥å¹²æ¬¡æ“ä½œä½¿å¾—æ‰€æœ‰çš„æ£‹å­éƒ½åœ¨ä¸€ä¸ªç‚¹ä¸Šã€‚å¦‚æœèƒ½ï¼Œæ±‚æœ€å°æ“ä½œæ¬¡æ•°ã€‚</p><h4 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h4><p>å£å¤å£å¤å£å¤</p><h4 id="code-1"><a href="#code-1" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> iarrN = <span class="keyword">int</span>[<span class="number">2003</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> c[<span class="number">2003</span>];</span><br><span class="line"><span class="keyword">int</span> tot, ans = inf;</span><br><span class="line">iarrN mn, mx, siz, head;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">  mx[u] = mn[u] = <span class="number">0</span>, siz[u] = c[u] == <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">  <span class="keyword">int</span> son = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u], v; i; i = e[i].nxt) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((v = e[i].to) == f) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(v, u);</span><br><span class="line">    siz[u] += siz[v], mx[u] += mx[v];</span><br><span class="line">    <span class="keyword">if</span> (mx[v] &gt; mx[son]) son = v;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (mn[son] &gt; mx[u] - mx[son])</span><br><span class="line">    mn[u] = mn[son] + mx[son] - mx[u] + siz[u];</span><br><span class="line">  <span class="keyword">else</span> mn[u] = siz[u] + (mx[u] &amp; <span class="number">1</span>);</span><br><span class="line">  mx[u] += siz[u];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%s&quot;</span>, &amp;N, c + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt; N; ++i) &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    <span class="built_in">addEdge</span>(u, v), <span class="built_in">addEdge</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="built_in">dfs</span>(i, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (mn[i] - siz[i] == <span class="number">0</span>)</span><br><span class="line">      ans = std::<span class="built_in">min</span>(ans, (mx[i] - siz[i]) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, ans == inf ? <span class="number">-1</span> : ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="POI2011-Lightning-Conductor"><a href="#POI2011-Lightning-Conductor" class="headerlink" title="[POI2011]Lightning Conductor"></a><a href="https://www.luogu.com.cn/problem/P3515">[POI2011]Lightning Conductor</a></h3><h4 id="problem-2"><a href="#problem-2" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šé•¿åº¦ä¸º $n$ çš„åºåˆ— $a$ï¼Œå¯¹äºæ¯ä¸ª $i \in [1, n]$ï¼Œæ±‚å‡ºä¸€ä¸ªæœ€å°çš„éè´Ÿæ•´æ•° $p$ ä½¿å¾— $\forall j \in [1, n], a_j \le a_i + p - \sqrt{|i - j|}$ã€‚</p><h4 id="solution-2"><a href="#solution-2" class="headerlink" title="solution"></a>solution</h4><p><del>è‚‰çœ¼å¯è§å†³ç­–å•è°ƒæ€§ã€‚ç„¶è€Œè¿˜æ˜¯ä¸ä¼šç»´æŠ¤ï¼ŒæŠ„äº†é¢˜è§£ã€‚</del></p><h4 id="code-2"><a href="#code-2" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span> <span class="keyword">int</span> l, r, x; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, z[<span class="number">500003</span>];</span><br><span class="line"><span class="keyword">double</span> f[<span class="number">500003</span>], _sqrt[<span class="number">500003</span>];</span><br><span class="line">std::deque&lt;Node&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> z[x] + _sqrt[k - x] &gt; z[y] + _sqrt[k - y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  q.<span class="built_in">clear</span>();</span><br><span class="line">  Node now&#123;<span class="number">1</span>, N, <span class="number">1</span>&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>, l, r, mid; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (z[i] &lt; z[now.x]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">for</span> (l = i, r = N; l &lt;= r; ) &#123;</span><br><span class="line">      mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">check</span>(now.x, i, mid)) l = mid + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; N) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (l &lt; now.l) &#123;</span><br><span class="line">      now = q.<span class="built_in">front</span>();</span><br><span class="line">      q.<span class="built_in">pop_front</span>();</span><br><span class="line">      --i;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    now.r = r;</span><br><span class="line">    q.<span class="built_in">push_front</span>(now);</span><br><span class="line">    now = &#123;l, N, i&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  q.<span class="built_in">push_front</span>(now);</span><br><span class="line">  now = q.<span class="built_in">back</span>();</span><br><span class="line">  q.<span class="built_in">pop_back</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (now.r &lt; i) now = q.<span class="built_in">back</span>(), q.<span class="built_in">pop_back</span>();</span><br><span class="line">    f[i] = std::<span class="built_in">max</span>(f[i], z[now.x] + _sqrt[i - now.x]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin &gt;&gt; N;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    cin &gt;&gt; z[i], f[i] = z[i];</span><br><span class="line">    _sqrt[i] = <span class="built_in">sqrt</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">process</span>();</span><br><span class="line">  std::<span class="built_in">reverse</span>(z + <span class="number">1</span>, z + N + <span class="number">1</span>);</span><br><span class="line">  std::<span class="built_in">reverse</span>(f + <span class="number">1</span>, f + N + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">process</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = N; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">    cout &lt;&lt; std::<span class="built_in">max</span>((<span class="keyword">int</span>)<span class="built_in">ceil</span>(f[i]) - z[i], <span class="number">0</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  cout.<span class="built_in">flush</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="AGC035D-Add-and-Remove"><a href="#AGC035D-Add-and-Remove" class="headerlink" title="AGC035D Add and Remove"></a><a href="https://agc035.contest.atcoder.jp/tasks/agc035_d">AGC035D Add and Remove</a></h3><h4 id="solution-3"><a href="#solution-3" class="headerlink" title="solution"></a>solution</h4><p>çˆ†æœå°±å®Œäº‹äº†å—·</p><hr><h3 id="P3978-TJOI2015-æ¦‚ç‡è®º"><a href="#P3978-TJOI2015-æ¦‚ç‡è®º" class="headerlink" title="P3978 [TJOI2015]æ¦‚ç‡è®º"></a><a href="https://www.luogu.com.cn/problem/P3978">P3978 [TJOI2015]æ¦‚ç‡è®º</a></h3><h4 id="problem-3"><a href="#problem-3" class="headerlink" title="problem"></a>problem</h4><p>æ±‚ $n$ ä¸ªç»“ç‚¹çš„æœ‰æ ¹äºŒå‰æ ‘çš„å¶å­ä¸ªæ•°çš„æœŸæœ›ã€‚</p><h4 id="solution-4"><a href="#solution-4" class="headerlink" title="solution"></a>solution</h4><p>è‡ªå·±å¹¶ä¸ä¼šåš<del>ï¼Œè€ƒè™‘æŠ„ä»“é¼ çš„é¢˜è§£</del>ã€‚</p><p>å¯¹äºä¸€ä¸ªå¶å­ï¼Œå¯ä»¥ç”¨ä¸€ä¸ª pair æè¿°ï¼šå»æ‰è¯¥å¶å­çš„äºŒå‰æ ‘ï¼Œåœ¨è¯¥äºŒå‰æ ‘çš„å“ªä¸ªä½ç½®æ·»åŠ è¿™ä¸ªå¶å­ã€‚</p><p>æ¯ä¸ªå¶å­å’Œæ¯ä¸ª pair ä¸€ä¸€å¯¹åº”ï¼Œè€ƒè™‘è®¡æ•°è¿™ä¸ª pairã€‚</p><p>å»æ‰è¯¥å¶å­çš„äºŒå‰æ ‘æœ‰ $N - 1$ ä¸ªç‚¹ï¼Œæ•°ç›®ä¸º $\mathrm{Cat}_{N - 1}$ã€‚</p><p>å¯¹äºä¸€ä¸ª $N - 1$ ä¸ªç‚¹çš„äºŒå‰æ ‘ï¼Œè€ƒè™‘åˆå¤šå°‘ä¸ªç©ºä½å¯ä»¥æ”¾ã€‚æ€»å…±æœ‰ $2(N - 1)$ ä¸ªç©ºä½ï¼Œä½†æ˜¯æœ‰ $N - 2$ ä¸ªç‚¹å·²ç»å æ®äº†ä¸€ä¸ªç©ºä½ã€‚æ‰€ä»¥æœ‰ $N$ ä¸ªç©ºä½å¯ä»¥æ·»åŠ å¶å­ã€‚</p><p>ä¸¤ä¸ªæ–¹æ¡ˆæ•°ç›¸ä¹˜ï¼Œå†é™¤ä»¥ $\mathrm{Cat}_N$ï¼ŒåŒ–ç®€ä¸€ä¸‹å‘ç°ç­”æ¡ˆæ˜¯ $N(N + 1) / (4N - 2)$ã€‚</p><hr><h3 id="P2900-USACO08MAR-Land-Acquisition-G"><a href="#P2900-USACO08MAR-Land-Acquisition-G" class="headerlink" title="P2900 [USACO08MAR]Land Acquisition G"></a><a href="https://www.luogu.com.cn/problem/P2900">P2900 [USACO08MAR]Land Acquisition G</a></h3><h4 id="problem-4"><a href="#problem-4" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®š $n$ ä¸ªäºŒå…ƒç»„ï¼Œç¬¬ $i$ ä¸ªä¸º $(a_i, b_i)$ï¼Œå°†è¿™äº›äºŒå…ƒç»„åˆ†æˆè‹¥å¹²ç»„ï¼Œæ¯ç»„çš„è´¹ç”¨æ˜¯å…¶ä¸­ $\max{ \{a_i b_i\}}$ã€‚æ±‚æœ€å°æ€»è´¹ç”¨ã€‚</p><h4 id="solution-5"><a href="#solution-5" class="headerlink" title="solution"></a>solution</h4><p>å¯ä»¥å‘ç°ï¼Œè‹¥ä¸¤ä¸ªäºŒå…ƒç»„ $i, j$ æ»¡è¶³ $a_i \ge a_j \wedge b_i \ge b_j$ï¼Œåˆ™ $j$ ä¸ä¼šå¯¹ç­”æ¡ˆæœ‰è´¡çŒ®ã€‚å¯ä»¥å°†æ•°æ®å¤„ç†æˆ $a$ é€’å¢ $b$ é€’å‡çš„å½¢å¼ï¼Œåˆ™æœ€ä¼˜è§£æ¯ä¸€ç»„ä¸€å®šæ˜¯è¿ç»­çš„ä¸€æ®µã€‚</p><p>å¯ä»¥å¾—åˆ°ä¸€ä¸ª $O(n^2)$ çš„è½¬ç§»æ–¹ç¨‹</p><script type="math/tex; mode=display">f_i = \min{ \{f_j + a_{j + 1}b_i\}} \ (0 \le j < i)</script><p>è¿™ä¸ªæ–¹ç¨‹æ˜¯æœ‰å†³ç­–å•è°ƒæ€§çš„ï¼Œè€ƒè™‘æ–œç‡ä¼˜åŒ–ã€‚å‡è®¾ $j, k$ æ»¡è¶³ $0 \le k &lt; j &lt; i$ï¼Œè‹¥ $j$ æ¯” $k$ æ›´ä¼˜ï¼Œé‚£ä¹ˆæœ‰</p><script type="math/tex; mode=display">f_j + a_{j + 1}b_i < f_k + a_{k + 1}b_i \\f_j - f_k < b_i(a_{k + 1} - a_{j + 1}) \\b_i > \frac{f_j - f_k}{a_{k + 1} - a_{j + 1}}</script><p>ç»´æŠ¤ä¸€ä¸ªä¸‹å‡¸å£³å°±å¯ä»¥æ–œç‡ä¼˜åŒ–äº†ã€‚æ€»å¤æ‚åº¦ $O(n \log n)$ã€‚</p><h4 id="code-3"><a href="#code-3" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> top, q[<span class="number">50003</span>];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> f[<span class="number">50003</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> a, b;</span><br><span class="line">&#125; z[<span class="number">50003</span>]; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">slope</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1.0</span> * (f[i] - f[j]) / (z[j + <span class="number">1</span>].a - z[i + <span class="number">1</span>].a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N, N_ = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  cin &gt;&gt; N;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    cin &gt;&gt; z[i].a &gt;&gt; z[i].b;</span><br><span class="line">  std::<span class="built_in">sort</span>(z + <span class="number">1</span>, z + N + <span class="number">1</span>, [](Node lhs, Node rhs) &#123;</span><br><span class="line">    <span class="keyword">if</span> (lhs.a != rhs.a) <span class="keyword">return</span> lhs.a &gt; rhs.a;</span><br><span class="line">    <span class="keyword">return</span> lhs.b &gt; rhs.b;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    <span class="keyword">if</span> (z[i].b &gt; z[N_].b) z[++N_] = z[i];</span><br><span class="line">  N = N_;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, h = <span class="number">1</span>, t = <span class="number">1</span>; i &lt;= N; ++i) &#123; <span class="comment">// q: []</span></span><br><span class="line">    <span class="keyword">while</span> (h &lt; t &amp;&amp; <span class="built_in">slope</span>(q[h], q[h + <span class="number">1</span>]) &lt;= z[i].b) ++h;</span><br><span class="line">    f[i] = f[q[h]] + <span class="number">1ll</span> * z[q[h] + <span class="number">1</span>].a * z[i].b;</span><br><span class="line">    <span class="keyword">while</span> (h &lt; t &amp;&amp; <span class="built_in">slope</span>(q[t - <span class="number">1</span>], q[t]) &gt;= <span class="built_in">slope</span>(q[t], i)) --t;</span><br><span class="line">    q[++t] = i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, f[N]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="P3195-HNOI2008-ç©å…·è£…ç®±"><a href="#P3195-HNOI2008-ç©å…·è£…ç®±" class="headerlink" title="P3195 [HNOI2008]ç©å…·è£…ç®±"></a><a href="https://www.luogu.com.cn/problem/P3195">P3195 [HNOI2008]ç©å…·è£…ç®±</a></h3><h4 id="problem-5"><a href="#problem-5" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šé•¿ä¸º $n$ çš„åºåˆ— $a$ï¼Œå°†åºåˆ—åˆ†æˆè‹¥å¹²æ®µï¼Œè‹¥ $i \sim j$ ä¸ºä¸€æ®µï¼ŒèŠ±è´¹ä¸º $(j - i + \sum_{k = i}^j{a_k} - L)^2$ã€‚</p><h4 id="solution-6"><a href="#solution-6" class="headerlink" title="solution"></a>solution</h4><p>å®¹æ˜“å†™å‡ºè¿™æ ·çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f_i = \min{ \{f_j + (s_i - s_j + i - j - 1 - L)^2\}}</script><p>å…¶ä¸­ $s_i = \sum_{j = 1}^i{a_i}$ã€‚è¿™ä¸ªæ–¹ç¨‹ç›´æ¥ç»´æŠ¤æ˜¯ $O(n^2)$ çš„ã€‚</p><p>ä»¤ $S_i = s_i + i, Lâ€™ = L + 1$ å¾—</p><script type="math/tex; mode=display">f_i = f_j + (S_i - S_j - L')^2 \\2S_i(S_j + L') + f_i = f_j + S_i^2+(S_j + L')^2</script><p>ä»¤ $f_i = b, 2S_i = k$ï¼Œå°±å‡ºç°äº†è‹¥å¹²æ¡ç›´çº¿</p><script type="math/tex; mode=display">y = kx + b</script><p>å…¶ä¸­ $x_j = S_j + Lâ€™, y_j = f_j + x_i^2$ï¼Œ$S_i$ å¯¹äºæ¯ä¸ª $i$ æ˜¯ç¡®å®šçš„ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯æœ€å°åŒ–æˆªè· $b$ï¼Œå³è¦ç»´æŠ¤ä¸€ä¸ªä¸‹å‡¸å£³ã€‚å¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ— $O(n)$ åœ°ç»´æŠ¤ã€‚</p><h4 id="code-4"><a href="#code-4" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> db = <span class="keyword">double</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> L, q[<span class="number">50003</span>];</span><br><span class="line">db f[<span class="number">50003</span>], S[<span class="number">50003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> db <span class="title">sqr</span><span class="params">(db x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> db <span class="title">X</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> S[i] + L;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> db <span class="title">Y</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> f[i] + <span class="built_in">sqr</span>(S[i] + L);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> db <span class="title">slope</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="built_in">Y</span>(i) - <span class="built_in">Y</span>(j)) / (<span class="built_in">X</span>(i) - <span class="built_in">X</span>(j));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line">  cin &gt;&gt; N &gt;&gt; L;</span><br><span class="line">  ++L;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, t; i &lt;= N; ++i) &#123;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    S[i] = t + S[i - <span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    S[i] += i;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, h = <span class="number">1</span>, t = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="keyword">while</span> (h &lt; t &amp;&amp; <span class="built_in">slope</span>(q[h], q[h + <span class="number">1</span>]) &lt;= <span class="number">2</span> * S[i]) ++h;</span><br><span class="line">    f[i] = f[q[h]] + <span class="built_in">sqr</span>(S[i] - <span class="built_in">X</span>(q[h]));</span><br><span class="line">    <span class="keyword">while</span> (h &lt; t &amp;&amp; <span class="built_in">slope</span>(q[t - <span class="number">1</span>], q[t]) &gt;= <span class="built_in">slope</span>(q[t], i)) --t;</span><br><span class="line">    q[++t] = i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> f[N];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="AGC002E-Candy-Piles"><a href="#AGC002E-Candy-Piles" class="headerlink" title="AGC002E Candy Piles"></a><a href="https://www.luogu.com.cn/problem/AT1999">AGC002E Candy Piles</a></h3><h4 id="problem-6"><a href="#problem-6" class="headerlink" title="problem"></a>problem</h4><p>æ¡Œä¸Šæœ‰ $n \ (1 \le n \le 10^5)$ å †ç³–æœï¼Œç¬¬ $i$ å †æœ‰ $a_i \ (1 \le a_i \le 10^9)$ ä¸ªã€‚</p><p>ä¸¤äººè½®æµè¿›è¡Œæ“ä½œï¼š</p><ol><li>å°†å½“å‰æœ€å¤§çš„ä¸€å †å…¨éƒ¨åƒå®Œï¼›</li><li>å°†æ¯å †åƒæ‰ä¸€ä¸ªã€‚</li></ol><p>åƒå®Œçš„äººè¾“ã€‚åˆ¤æ–­å…ˆæ‰‹æˆ–åæ‰‹å¿…èƒœã€‚</p><h4 id="solution-7"><a href="#solution-7" class="headerlink" title="solution"></a>solution</h4><p>å°†åºåˆ—é™åºæ’åºï¼ˆå›¾ 1ï¼‰ã€‚ä¸¤ä¸ªæ“ä½œåˆ†åˆ«ä»£è¡¨å»æ‰æœ€å·¦è¾¹ä¸€è¡Œæˆ–æœ€ä¸‹é¢ä¸€åˆ—ã€‚</p><p><img src="/files/img/AGC002E_1.png" alt="å›¾ 1"></p><p>æˆ‘ä»¬å°†åŸå›¾è½¬åŒ–ä¸ºç½‘æ ¼å›¾ã€‚è¿™æ ·ï¼Œæ“ä½œå°±è½¬åŒ–ä¸ºäº†ä¸¤ä¸ªç©å®¶å‘å³/ä¸Šç§»åŠ¨ä¸€æ­¥ï¼ˆå›¾ 2ï¼‰ï¼Œæ¥è§¦åˆ°è¾¹ç•Œçš„äººè¾“ã€‚</p><p><img src="/files/img/AGC002E_2.png" alt="å›¾ 2"></p><p>æ ¹æ®åšå¼ˆè®ºçš„ä¸€èˆ¬è§„å¾‹å¯ä»¥æ•´ä¸€ä¸ª $O(\sum a_i)$ çš„ dp å‡ºæ¯ä¸ªç‚¹çš„ç»“æœï¼ˆå›¾ 3ï¼Œâ€™xâ€™ ä»£è¯¥ç‚¹è¡¨å…ˆæ‰‹å¿…è´¥ï¼Œâ€™oâ€™ è¡¨ç¤ºè¯¥ç‚¹å…ˆæ‰‹å¿…èƒœï¼‰ï¼Œä½†è¿™æ˜¾ç„¶è¿‡ä¸å»ã€‚</p><p><img src="/files/img/AGC002E_3.png" alt="å›¾ 3"></p><p>æœ‰ä¸€ä¸ª $O(n)$ çš„åšæ³•ï¼šä»åŸç‚¹å‘å³ä¸Šæ‰©å¼ å‡ºä¸€ä¸ªå¯è¡Œçš„æœ€å¤§çš„æ­£æ–¹å½¢ï¼Œç„¶ååˆ†åˆ«å‘å³/ä¸Šç§»åŠ¨ã€‚å¦‚æœæœ€å¤§æ­¥æ•°å‡ä¸ºå¶æ•°ï¼Œåˆ™å…ˆæ‰‹å¿…è´¥ï¼›å¦åˆ™å…ˆæ‰‹å¿…èƒœã€‚</p><h4 id="code-5"><a href="#code-5" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> *z)</span> </span>&#123;</span><br><span class="line">  std::<span class="built_in">sort</span>(z + <span class="number">1</span>, z + N + <span class="number">1</span>, std::greater&lt;<span class="keyword">int</span>&gt;());</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    <span class="keyword">if</span> (z[i + <span class="number">1</span>] &lt; i + <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">int</span> j = i;</span><br><span class="line">      <span class="keyword">while</span> (z[j + <span class="number">1</span>] &gt;= i) ++j;</span><br><span class="line">      <span class="keyword">return</span> ((z[i] - i) | (j - i)) &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><p><a href="https://www.luogu.com.cn/problem/SP11414">SP11414 COT3 - Combat on a tree</a></p><hr><p><a href="https://www.luogu.com.cn/problem/UVA1697">UVA1697 Baggage</a></p><p>è¿™æ˜¯ä¸€é“ ACM WF çš„ A é¢˜ã€‚</p><hr><p><a href="http://codeforces.com/problemset/problem/611/H">CF611H New Year and Forgotten Tree</a></p><hr><h3 id="P2860-USACO06JAN-Redundant-Paths-G"><a href="#P2860-USACO06JAN-Redundant-Paths-G" class="headerlink" title="P2860 [USACO06JAN]Redundant Paths G"></a><a href="https://www.luogu.com.cn/problem/P2860">P2860 [USACO06JAN]Redundant Paths G</a></h3><h4 id="problem-7"><a href="#problem-7" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ª $n$ ä¸ªç»“ç‚¹ $m$ æ¡è¾¹çš„æ— å‘è¿é€šå›¾ã€‚è¦æ±‚åœ¨è¿™å¼ å›¾ä¸ŠåŠ å…¥ä¸€äº›è¾¹ï¼Œä½¿å¾—ä»»æ„ä¸¤ä¸ªç»“ç‚¹é—´éƒ½æœ‰è‡³å°‘ä¸¤æ¡æ²¡æœ‰å…¬å…±è¾¹çš„è·¯å¾„ï¼Œæ±‚æ‰€æœ‰åˆæ³•æ–¹æ¡ˆä¸­åŠ å…¥è¾¹æ•°çš„æœ€å°å€¼ã€‚</p><h4 id="solution-8"><a href="#solution-8" class="headerlink" title="solution"></a>solution</h4><p>è€ƒè™‘é’¦å®šä¸€ä¸ªç‚¹ä¸ºæ ¹å‘å¤– dfsï¼Œè½¬åŒ–ä¸ºæœ‰å‘å›¾ï¼Œå¹¶å°†è¾¹åŒè¿é€šåˆ†é‡è¿›è¡Œç¼©ç‚¹ï¼Œå½¢æˆä¸€æ£µ dfs æ ‘ã€‚ç­”æ¡ˆæ˜¾ç„¶ä¸ºè¿™æ£µæ ‘çš„å¶å­ä¸ªæ•°çš„ä¸€åŠä¸Šå–æ•´ã€‚</p><h4 id="code-6"><a href="#code-6" class="headerlink" title="code"></a>code</h4><p>å®ç°æ—¶æ³¨æ„ä¸€äº›ç»†èŠ‚ï¼Œæ¯”å¦‚åŒå‘è¾¹å¯ä»¥æŒ‰ç…§ç¼–å·å¥‡å¶æ€§åˆ’ä¸ºä¸€ç»„åŒæ—¶æ ‡è®°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> iarrN = <span class="keyword">int</span>[<span class="number">5003</span>];</span><br><span class="line"></span><br><span class="line">std::bitset&lt;20013&gt; vis;</span><br><span class="line"><span class="keyword">int</span> N, M, top, tot = <span class="number">1</span>, dft, cntDCC;</span><br><span class="line">iarrN U, V, s, bel, dfn, low, deg, head;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> nxt, to;</span><br><span class="line">&#125; e[<span class="number">20013</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">  s[++top] = u;</span><br><span class="line">  dfn[u] = low[u] = ++dft;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u], v; i; i = e[i].nxt) &#123;</span><br><span class="line">    <span class="keyword">if</span> (vis[i]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (!dfn[v = e[i].to]) &#123;</span><br><span class="line">      vis.<span class="built_in">set</span>(i), vis.<span class="built_in">set</span>(i ^ <span class="number">1</span>);</span><br><span class="line">      <span class="built_in">tarjan</span>(v);</span><br><span class="line">      vis.<span class="built_in">reset</span>(i ^ <span class="number">1</span>), vis.<span class="built_in">reset</span>(i ^ <span class="number">1</span>);</span><br><span class="line">      <span class="built_in">dmin</span>(low[u], low[v]);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="built_in">dmin</span>(low[u], dfn[v]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (dfn[u] == low[u]) &#123;</span><br><span class="line">    ++cntDCC;</span><br><span class="line">    <span class="keyword">do</span> bel[s[top]] = cntDCC; <span class="keyword">while</span> (s[top--] != u);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">    cin &gt;&gt; U[i] &gt;&gt; V[i];</span><br><span class="line">    <span class="built_in">addEdge</span>(U[i], V[i]), <span class="built_in">addEdge</span>(V[i], U[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">tarjan</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i)</span><br><span class="line">    <span class="keyword">if</span> (bel[U[i]] != bel[V[i]])</span><br><span class="line">      ++deg[bel[U[i]]], ++deg[bel[V[i]]];</span><br><span class="line">  <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cntDCC; ++i)</span><br><span class="line">    <span class="keyword">if</span> (deg[i] == <span class="number">1</span>) ++ans;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, (ans + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å¦™å¦™é—®é¢˜åˆé›†</title>
      <link href="/2020/intriguing-problems/"/>
      <url>/2020/intriguing-problems/</url>
      
        <content type="html"><![CDATA[<p>Last update: Oct 1, 2023</p><span id="more"></span><h2 id="1"><a href="#1" class="headerlink" title="#1"></a>#1</h2><p>è¿™æ˜¯ä¸€é“æ¥è‡ªå­¦å¼Ÿå­¦å¦¹ç»„åˆæ•°å­¦è¯¾é¸½å·¢åŸç†éƒ¨åˆ†çš„ä½œä¸šé¢˜ã€‚</p><h3 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h3><blockquote><p>â€œéšæ„åœ°ç»™æ­£ n è¾¹å½¢çš„ n ä¸ªé¡¶ç‚¹ç¼–ä¸Šå· 1,2,â€¦,n, æ±‚è¯ï¼šå¿…æœ‰ä¸€ä¸ªé¡¶ç‚¹åŠä¸ä¹‹ç›¸é‚»çš„ä¸¤é¡¶ç‚¹ä¹‹å’Œä¸å°äº f(n)ï¼Œå¹¶ä¸” f(n) æ˜¯ä¸å¯æ”¹è¿›çš„ã€‚ç»™å‡º f(n) è¡¨è¾¾å¼å†è¿›è¡Œè¯æ˜ã€‚â€</p></blockquote><h3 id="Problem-Abstract"><a href="#Problem-Abstract" class="headerlink" title="Problem Abstract"></a>Problem Abstract</h3><p>åŸé¢˜çš„è¡¨è¿°å¾ˆå¥‡æ€ªï¼Œæˆ‘ä»¬æŠŠå®ƒæŠ½è±¡ä¸€ä¸‹ï¼ŒåŒæ—¶åŠ ä¸€ç‚¹å½¢å¼åŒ–çš„è¡¨è¿°ï¼š</p><blockquote>å¯¹äºæ‰€æœ‰å‰ $n \ (n \ge 3)$ ä¸ªè‡ªç„¶æ•°çš„æ’åˆ— $P_{n}$ï¼Œæ±‚æœ€å°å¯èƒ½çš„ $\displaystyle \max_{i = 1}^n(P_{i - 1} + P_i + P_{i + 1})$ï¼Œè®°ä¸º $f(n)$ã€‚è¡¥å……å®šä¹‰ $P_0 = P_n$ï¼Œ$P_{n+1} = P_1$ã€‚</blockquote><p>å¥½æ‡‚å¤šäº†ã€‚</p><h3 id="Solution-Probably-Desired"><a href="#Solution-Probably-Desired" class="headerlink" title="Solution Probably Desired"></a>Solution Probably Desired</h3><p>åˆ©ç”¨é¸½å·¢åŸç†å¾ˆå®¹æ˜“æ±‚å‡º $f(n) \ge \left\lceil \dfrac{3n}2 + \dfrac32 \right\rceil$ï¼š</p>è€ƒè™‘ $\displaystyle \sum_{i = 1}^n(P_{i - 1} + P_i + P_{i + 1})$ï¼Œæ’åˆ—é‡Œçš„æ¯ä¸ªå€¼éƒ½ä¼šè¢«è®¡ç®—ä¸‰æ¬¡ï¼Œå› æ­¤å®ƒå°±ç­‰äº $3\displaystyle \sum_{i = 1}^n P_i = \dfrac{3n(n + 1)}2$ã€‚æ˜¾ç„¶ $f(n) \ge \dfrac{3n(n + 1)}{2n} = \dfrac{3(n + 1)}2$ã€‚<p>è¿™ä¸ªå€¼å¯èƒ½ä¸æ˜¯æ•´æ•°ï¼Œè¿èƒŒç°å®æ„ä¹‰ï¼Œæ‰€ä»¥å¥—ä¸€å±‚ä¸Šå–æ•´å¾—åˆ° $f(n) \ge \left\lceil \dfrac{3n}2 + \dfrac32 \right\rceil$ã€‚</p><h3 id="De-Facto-Solution"><a href="#De-Facto-Solution" class="headerlink" title="De Facto Solution"></a>De Facto Solution</h3><!-- ä¸Šé¢çš„è§£ç­”åªèƒ½ç²—ç•¥ä¼°è®¡ä¸€ä¸ªä¸‹ç•Œï¼Œä½†æ²¡åŠæ³•è¯æ˜è¿™æ˜¯ä¸‹ç¡®ç•Œã€‚å®é™…ä¸Šè¿™ä¹Ÿçš„ç¡®ä¸æ˜¯ã€‚æ ¹æ® OEIS A066385ï¼Œç­”æ¡ˆå¦‚ä¸‹ï¼šğ‘“(ğ‘›)=â§â©â¨âªâªâªâª6âŒˆ3ğ‘›2âŒ‰+2âŒˆ3ğ‘›2âŒ‰+3,ğ‘›=3,ğ‘›=5,6,9,15,otherwiseå®¹æ˜“ç¼–ç¨‹éªŒè¯ ğ‘›æ¯”è¾ƒå°æ—¶è¿™ä¸ªé€šé¡¹æ˜¯æ­£ç¡®çš„ã€‚ğ‘›>15åæ˜¯çŒœæƒ³ï¼Œç›®å‰æ²¡æœ‰äººèƒ½ç»™å‡ºè¿‡æ•°å­¦è¯æ˜ã€‚åŸé¢˜é‡Œé‚£å¥â€œå¹¶ä¸” ğ‘“(ğ‘›)æ˜¯ä¸å¯æ”¹è¿›çš„â€æå…¶è¯¡å¼‚ï¼Œæ„Ÿè§‰æ˜¯è€å¸ˆä¸€æ‹å¤§è…¿åŠ ä¸Šçš„ï¼ŒæŠŠè¿™é¢˜å˜æˆäº†ä¸å¯åšé¢˜ã€‚ --><p>ä¸Šé¢çš„è§£ç­”åªèƒ½ç²—ç•¥ä¼°è®¡ä¸€ä¸ªä¸‹ç•Œï¼Œä½†æ²¡åŠæ³•è¯æ˜è¿™æ˜¯ä¸‹ç¡®ç•Œã€‚å®é™…ä¸Šè¿™ä¹Ÿçš„ç¡®ä¸æ˜¯ã€‚æ ¹æ® <a href="https://oeis.org/A066385">OEIS A066385</a>ï¼Œç­”æ¡ˆå¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">f(n) = \begin{cases}6 & , n = 3 \\\left\lceil \dfrac{3n}2 \right\rceil + 2 & , n = 5, 6, 9, 15 \\\left\lceil \dfrac{3n}2 \right\rceil + 3 & , \text{otherwise}\end{cases}</script><p>å®¹æ˜“ç¼–ç¨‹éªŒè¯ $n$ æ¯”è¾ƒå°æ—¶è¿™ä¸ªé€šé¡¹æ˜¯æ­£ç¡®çš„ã€‚$n &gt; 15$ æ—¶æ˜¯çŒœæƒ³ï¼Œç›®å‰æ²¡æœ‰äººèƒ½ç»™å‡ºè¿‡æ•°å­¦è¯æ˜ã€‚</p><p>åŸé¢˜é‡Œé‚£å¥â€œå¹¶ä¸” $f(n)$ æ˜¯ä¸å¯æ”¹è¿›çš„â€æå…¶è¯¡å¼‚ï¼Œæ„Ÿè§‰æ˜¯è€å¸ˆä¸€æ‹å¤§è…¿åŠ ä¸Šçš„ï¼ŒæŠŠè¿™é¢˜å˜æˆäº†ä¸å¯åšé¢˜ã€‚</p><h2 id="2-PE-306"><a href="#2-PE-306" class="headerlink" title="#2 - PE 306"></a>#2 - PE 306</h2><h3 id="Problem-1"><a href="#Problem-1" class="headerlink" title="Problem"></a>Problem</h3><blockquote><p>åŸé¢˜é“¾æ¥ <a href="https://projecteuler.net/problem=306">Project Euler Problem 306 - Paper-strip Game</a></p></blockquote><p>Alice å’Œ Bob åœ¨ä¸€ç»„æ’åˆ—æˆé•¿æ¡å‹çš„ $n$ ä¸ªæ ¼å­ä¸Šç©æ¸¸æˆï¼Œä¸¤äººäº¤æ›¿è¿›è¡Œæ“ä½œã€‚</p><p>æ¯å›åˆä¸­ä¸€ä¸ªç©å®¶é€‰æ‹©ä¸¤ä¸ªè¿ç»­çš„ç©ºç™½æ ¼å­æ¶‚é»‘ï¼Œæœ€å…ˆä¸èƒ½è¿›è¡Œæ“ä½œçš„ç©å®¶è¾“ã€‚</p><p>Alice å…ˆæ‰‹ã€‚</p><ul><li><p>$n = 1$ æ—¶ Alice æ²¡æœ‰åˆæ³•æ“ä½œï¼Œç›´æ¥è¾“æ‰ã€‚</p></li><li><p>$n = 2$ æ—¶ï¼ŒAlice åªæœ‰ä¸€ç§åˆæ³•æ“ä½œï¼Œæ“ä½œå Bob è¾“ã€‚</p></li><li><p>$n = 3$ æ—¶ï¼ŒAlice æœ‰ä¸¤ç§åˆæ³•æ“ä½œï¼Œä½†ä¸è®ºå“ªç§æ“ä½œè¿‡å Bob éƒ½ä¼šè¾“ã€‚</p></li><li><p>$n = 4$ æ—¶ï¼ŒAlice æœ‰ä¸‰ç§åˆæ³•æ“ä½œï¼Œå¥¹å¯ä»¥æ¶‚é»‘æœ€ä¸­é—´çš„ä¸¤ä¸ªæ ¼å­ä½¿ Bob æ— æ³•æ“ä½œã€‚</p></li><li><p>$n = 5$ æ—¶å¦‚å›¾ 2.1ï¼ŒAlice æœ‰å››ç§åˆæ³•æ“ä½œï¼ˆçº¢è‰²ï¼‰ï¼›ä½†æ— è®ºä»–æ€ä¹ˆæ“ä½œï¼ŒBobï¼ˆè“è‰²ï¼‰éƒ½ä¼šèµ¢ã€‚</p></li></ul><p><img src="https://projecteuler.net/project/images/p306_pstrip.gif" alt="img"></p><p>å› æ­¤ï¼Œå¯¹äº $1 \le n \le 5$ çš„æƒ…å†µï¼Œæœ‰ $3$ ç§ $n$ çš„å–å€¼ä½¿å¾— Alice å¿…èƒœã€‚</p><p>ç±»ä¼¼åœ°ï¼Œå¯¹äº $1 \le n \le 50$ çš„æƒ…å†µï¼Œæœ‰ $40$ ç§ $n$ çš„å–å€¼ä½¿å¾— Alice å¿…èƒœã€‚</p><p>å‡è®¾ Bob å’Œ Alice éƒ½ç»å¯¹èªæ˜ï¼Œæ°¸è¿œä¼šé‡‡å–æœ€ä¼˜ç­–ç•¥ã€‚</p><p>Bob éå¸¸æƒ³è®© Alice èµ¢ï¼Œä½†ä»–ä¸æƒ³æ”¾æ°´ã€‚ä»–æƒ³çŸ¥é“ï¼šå¯¹äº $1 \le n \le 1000000$ çš„æƒ…å†µï¼Œæœ‰å¤šå°‘ç§ $n$ çš„å–å€¼ä½¿å¾— Alice å¿…èƒœï¼Ÿ</p><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>è¿™æ˜¯ä¸€ä¸ªæ‰¾è§„å¾‹åšæ³•ã€‚</p><p>åšå¼ˆè®ºé—®é¢˜ï¼Œç›´æ¥è€ƒè™‘è¦æ±‚å‡ºæ¯ä¸ª $n$ çš„ sg å‡½æ•°ã€‚</p><p>æšä¸¾æ‰€æœ‰å¯èƒ½çš„æ“ä½œï¼ˆå°†åŸæ¸¸æˆåˆ†ä¸ºå¤§å°ä¸º $j$ å’Œ $i - j - 2$ çš„ä¸¤ä¸ªæ¸¸æˆï¼‰ï¼Œå®¹æ˜“å¾—åˆ°è¿™æ ·ä¸€ä¸ªå¼å­ï¼š</p><script type="math/tex; mode=display">\mathrm{sg}(i) = \mathrm{mex}_{j = 0}^{i - 2}{\{ \mathrm{sg}(j) \oplus \mathrm{sg}(i - j - 2) \}} (i \ge 2)</script><p>$n \in {0, 1}$ æ—¶å…ˆæ‰‹å¿…è´¥ï¼Œ$\mathrm{sg}(0) = \mathrm{sg}(1) = 0$ã€‚</p><p>æ‰“è¡¨å¾—åˆ° $1 \le n \le 204$ æ—¶çš„ $\mathrm{sg}$ å‡½æ•°å€¼ï¼ˆæ¯è¡Œ $34$ ä¸ªï¼‰ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0 1 1 2 0 3 1 1 0 3 3 2 2 4 0 5 2 2 3 3 0 1 1 3 0 2 1 1 0 4 5 2 7 4</span><br><span class="line">0 1 1 2 0 3 1 1 0 3 3 2 2 4 4 5 5 2 3 3 0 1 1 3 0 2 1 1 0 4 5 3 7 4</span><br><span class="line">8 1 1 2 0 3 1 1 0 3 3 2 2 4 4 5 5 9 3 3 0 1 1 3 0 2 1 1 0 4 5 3 7 4</span><br><span class="line">8 1 1 2 0 3 1 1 0 3 3 2 2 4 4 5 5 9 3 3 0 1 1 3 0 2 1 1 0 4 5 3 7 4</span><br><span class="line">8 1 1 2 0 3 1 1 0 3 3 2 2 4 4 5 5 9 3 3 0 1 1 3 0 2 1 1 0 4 5 3 7 4</span><br><span class="line">8 1 1 2 0 3 1 1 0 3 3 2 2 4 4 5 5 9 3 3 0 1 1 3 0 2 1 1 0 4 5 3 7 4</span><br></pre></td></tr></table></figure><p>å®¹æ˜“å‘ç°é™¤å‰ä¸¤è¡Œç‰¹æ®Šï¼ˆå…± $13$ ä¸ª $0$ï¼‰ä»¥å¤–ï¼Œä»¥åçš„æ¯ä¸€è¡Œéƒ½æœ‰æ°å¥½ $5$ ä¸ª $0$ã€‚</p><p>ä¹‹åå¹¼å„¿å›­çº§åˆ«æ‰¾è§„å¾‹ï¼Œç­”æ¡ˆæ˜¯ $852938$ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>é¢˜è§£ SP10395 ABA12D - Sum of divisors!</title>
      <link href="/2020/%E9%A2%98%E8%A7%A3-SP10395-ABA12D-Sum-of-divisors/"/>
      <url>/2020/%E9%A2%98%E8%A7%A3-SP10395-ABA12D-Sum-of-divisors/</url>
      
        <content type="html"><![CDATA[<p>under é¢˜è§£ <a href="https://www.luogu.com.cn/problem/SP10395">SP10395</a></p><p>æœ¬æ–‡ç« åŒæ­¥å‘è¡¨äº<a href="https://www.luogu.com.cn/blog/fa555/solution-sp10395">æ´›è°·åšå®¢</a></p><span id="more"></span><hr><h4 id="solution-1"><a href="#solution-1" class="headerlink" title="solution 1"></a>solution 1</h4><p>é¦–å…ˆæˆ‘ä»¬æœ‰çº¦æ•°å’Œå‡½æ•° $\sigma$ï¼Œå®ƒæ˜¯<strong>ç§¯æ€§å‡½æ•°</strong>ï¼Œå¯ä»¥ç”¨çº¿ç­›åœ¨çº¿æ€§æ—¶é—´å†…æ±‚å‡ºï¼ŒåŠ ä¸ªå‰ç¼€å’Œå°±åšå®Œäº†ï¼Œæ€»å¤æ‚åº¦ $O(\max{B} + T)$ï¼Œå³ $O(n + q)$ã€‚</p><p>å…¶å®è¿™é¢˜å°±æ˜¯ä¸ªçº¿ç­›æ±‚ $\sigma$ çš„æ¿å­ã€‚</p><hr><h4 id="solution-2"><a href="#solution-2" class="headerlink" title="solution 2"></a>solution 2</h4><p>ä¸è¿‡ï¼ŒæŠ›å¼€è¿™ç§åšæ³•ï¼Œæˆ‘ä»¬ä¼šå‘ç°æ»¡è¶³è¦æ±‚çš„æ•°å­—çš„ä¸€äº›æ€§è´¨ï¼š<strong>æ»¡è¶³è¦æ±‚çš„æ•°éƒ½æ˜¯è´¨æ•°çš„å¹‚ï¼Œä¸”é™¤ $2$ å¤–éƒ½æ˜¯å¹³æ–¹æ•°ã€‚</strong><a href="http://oeis.org/A000203">è¯æ˜åœ¨è¿™é‡Œ</a></p><p>ç”¨è¿™ä¸¤æ¡æ€§è´¨åšèƒ½åšåˆ°æ›´å°çš„å¸¸æ•°ï¼Œä¸è¿‡ç”±äºä¸Šä¸€ç§åšæ³•è¶³å¤Ÿä¼˜ç§€ï¼Œåœ¨æ­¤å°±ä¸è®¨è®ºäº†ã€‚<del>å…¶å®æ˜¯æˆ‘çœ‹ä¸æ‡‚è¯æ˜</del></p><hr><h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><p>ä»£ç ä¸­ <code>s[i]</code> è¡¨ç¤º $\sigma(i)$ï¼Œ<code>ans[i]</code> è¡¨ç¤ºç­”æ¡ˆçš„å‰ç¼€å’Œã€‚</p><p><del>å…³äºä»£ç ä¸­æ•°ç»„çš„å¤§å°è¿™ä¹ˆå¥‡æ€ªçš„åŸå› å°±ç•™ä½œä¹ é¢˜å§</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4390848</span>;</span><br><span class="line"></span><br><span class="line">std::bitset&lt;4390849&gt; v;</span><br><span class="line"><span class="keyword">int</span> T, p[<span class="number">308755</span>], s[<span class="number">4390849</span>], ans[<span class="number">1000003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve_sigma</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> M = <span class="number">0</span>;</span><br><span class="line">  v.<span class="built_in">set</span>(<span class="number">1</span>), s[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!v[i]) p[++M] = i, s[i] = i + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M &amp;&amp; i * p[j] &lt;= N; ++j) &#123;</span><br><span class="line">      v.<span class="built_in">set</span>(i * p[j]);</span><br><span class="line">      <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>) &#123;</span><br><span class="line">        s[i * p[j]] = s[i] + p[j] * (s[i] - s[i / p[j]]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      s[i * p[j]] = s[i] * s[p[j]];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">1000000</span>; ++i)</span><br><span class="line">    ans[i] = ans[i - <span class="number">1</span>] + !v[s[i]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">sieve_sigma</span>();</span><br><span class="line">  cin &gt;&gt; T;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> l, r; T; --T) &#123;</span><br><span class="line">    cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">    cout &lt;&lt; ans[r] - ans[l - <span class="number">1</span>] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  cout.<span class="built_in">flush</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h4 id="èŠ±çµ®"><a href="#èŠ±çµ®" class="headerlink" title="èŠ±çµ®"></a>èŠ±çµ®</h4><p>è¿™é¢˜è¿˜æ˜¯æˆ‘ åŠå¹´å·®ä¸€å¤©å‰ï¼ˆ19-08-12ï¼‰äº¤çš„ç¿»è¯‘æ¥ç€www</p><p>åŸé¢˜ä¸­æœ‰è¿™ä¹ˆä¸€å¥è¯ï¼šâ€œå¦‚æœä½ çœŸçš„æƒ³é€šè¿‡è¿™é“é¢˜æ¥å­¦äº›ä¸œè¥¿ï¼Œä¸è¦æ‰“è¡¨ï¼â€</p><p>ä½†å”¯ä¸€çš„ä¸€ç¯‡é¢˜è§£è¿˜æ˜¯è£¸æ‰“è¡¨ï¼ˆæ‘Šæ‰‹ï¼‰ï¼Œæ‰€ä»¥æˆ‘å°±å†™äº†è¿™ç¯‡é¢˜è§£ã€‚</p><p>ä½†æ˜¯å†™è¿™ç¯‡é¢˜è§£çœŸæ˜¯å¤ªæ£’äº†ï¼Œå­¦åˆ°è®¸å¤š /cy</p>]]></content>
      
      
      <categories>
          
          <category> é¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 Feb Records</title>
      <link href="/2020/2020-Feb-Records/"/>
      <url>/2020/2020-Feb-Records/</url>
      
        <content type="html"><![CDATA[<p>èœé¸¡ fa_555 ä¼šæŠŠä¸€äº›åŠ¨æ€ç®€è¦åœ°è®°åœ¨è¿™é‡Œã€‚ä¸»è¦è¿˜æ˜¯ç•™ç»™è‡ªå·±ä»¥åçœ‹çš„ã€‚</p><span id="more"></span><p><em>æ‰€æœ‰ä»£ç ä¸ä¿è¯åŒ…æ‹¬æ— å…³ç´§è¦çš„éƒ¨åˆ†</em></p><hr><h3 id="ã€æ¨¡æ¿ã€‘ä¸‰ç»´ååº"><a href="#ã€æ¨¡æ¿ã€‘ä¸‰ç»´ååº" class="headerlink" title="ã€æ¨¡æ¿ã€‘ä¸‰ç»´ååº"></a><a href="https://www.luogu.com.cn/problem/P3810">ã€æ¨¡æ¿ã€‘ä¸‰ç»´ååº</a></h3><p>CDQ åˆ†æ²»æ¨¡æ¿ã€‚</p><h4 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h4><p>æœ‰ $n$ ä¸ªä¸‰å…ƒç»„ $(a_i, b_i, c_i)$ï¼Œè®¾ $f(i) = \sum \limits_{j \ne i} [a_j \le a_i \land b_j \le b_i \land c_j \le c_i]$ã€‚</p><p>å¯¹äºæ¯ä¸ª $d \in [0, n)$ï¼Œæ±‚ $f(i) = d$ çš„æ•°é‡ã€‚</p><h4 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h4><p>æ±‚åºåˆ—é€†åºå¯¹è¿˜ä¼šå§ï¼Ÿæˆ‘ä»¬ç”¨å½’å¹¶æ’åºè¿›è¡Œåˆ†æ²»ï¼Œæ¯æ¬¡æŠŠåŒºé—´ $[l, r]$ åˆ†æˆ $[l, mid], (mid, r]$ è¿›è¡Œé€’å½’ï¼Œåœ¨é€’å½’æ—¶è®¡ç®— $[l, mid]$ ä¸­å¯¹ $(mid, r]$ çš„è´¡çŒ®ã€‚æŠŠä¸‹æ ‡å’Œæƒå€¼åˆ†åˆ«çœ‹ä½œä¸¤ä¸ªå…³é”®å­—ï¼Œè¿™å°±æ˜¯äºŒç»´ååºé—®é¢˜ã€‚</p><p>é¦–å…ˆå°†åºåˆ—æŒ‰ $a$ æ’åºã€‚åˆ†æ²»æ—¶æ¯æ¬¡å°†å·¦ã€å³ä¸¤åŒºé—´åˆ†åˆ«æŒ‰ $b$ æ’åºã€‚æ­¤æ—¶å·¦åŠè¾¹çš„ $a$ å‡å°äºç­‰äºå³åŠè¾¹ã€‚ç±»ä¼¼äºŒç»´ååºï¼Œéšä¾¿æ‰¾ä¸ªæ•°æ®ç»“æ„ç»´æŠ¤ä¸€ä¸‹ $c$ å³å¯ã€‚</p><p>å‡ºç°äº†æ–°çš„é—®é¢˜ï¼šå®Œå…¨ç›¸åŒçš„å…ƒç´ ï¼ŒåŸæœ¬åº”å½“äº’ç›¸æœ‰è´¡çŒ®ï¼Œä½† cdq åˆ†æ²»åªä¼šè®¡ç®—å·¦ä¾§å¯¹å³ä¾§çš„è´¡çŒ®ã€‚ç»™æ¯ä¸ªå…ƒç´ ä¸€ä¸ªæƒå€¼ $w$ï¼ˆåŒæ—¶ç»´æŠ¤è¿™ä¸ªå€¼ï¼‰ã€‚è‡³äºæœ€åç»Ÿè®¡ç­”æ¡ˆï¼Œæƒ³æ¸…æ¥šç»Ÿè®¡çš„æ˜¯ä»€ä¹ˆã€‚</p><h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> N, M, K, ans[<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> a, b, c, w, cnt;</span><br><span class="line">&#125; s[<span class="number">100003</span>], z[<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp1</span><span class="params">(<span class="keyword">const</span> Node &amp;l, <span class="keyword">const</span> Node &amp;r)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (l.a != r.a) <span class="keyword">return</span> l.a &lt; r.a;</span><br><span class="line">  <span class="keyword">if</span> (l.b != r.b) <span class="keyword">return</span> l.b &lt; r.b;</span><br><span class="line">  <span class="keyword">return</span> l.c &lt; r.c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp2</span><span class="params">(<span class="keyword">const</span> Node &amp;l, <span class="keyword">const</span> Node &amp;r)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (l.b != r.b) <span class="keyword">return</span> l.b &lt; r.b;</span><br><span class="line">  <span class="keyword">return</span> l.c &lt; r.c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> BIT &#123;</span><br><span class="line"><span class="keyword">int</span> t[<span class="number">200003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> v)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> p)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> BIT;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CDQ</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">int</span> m = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">CDQ</span>(l, m), <span class="built_in">CDQ</span>(m + <span class="number">1</span>, r);</span><br><span class="line">  std::<span class="built_in">sort</span>(s + l, s + m + <span class="number">1</span>, cmp2);</span><br><span class="line">  std::<span class="built_in">sort</span>(s + m + <span class="number">1</span>, s + r + <span class="number">1</span>, cmp2);</span><br><span class="line">  <span class="keyword">int</span> i = l;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = m + <span class="number">1</span>; j &lt;= r; ++j) &#123;</span><br><span class="line">    <span class="keyword">for</span> (; s[i].b &lt;= s[j].b &amp;&amp; i &lt;= m; ++i)</span><br><span class="line">      <span class="built_in">add</span>(s[i].c, s[i].w);</span><br><span class="line">    s[j].cnt += <span class="built_in">query</span>(s[j].c);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = l; j &lt; i; ++j)</span><br><span class="line">    <span class="built_in">add</span>(s[j].c, -s[j].w);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin &gt;&gt; M &gt;&gt; K;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i)</span><br><span class="line">    cin &gt;&gt; z[i].a &gt;&gt; z[i].b &gt;&gt; z[i].c;</span><br><span class="line">  std::<span class="built_in">sort</span>(z + <span class="number">1</span>, z + M + <span class="number">1</span>, cmp1);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">1</span>; i &lt;= M; ++i, ++j)</span><br><span class="line">    <span class="keyword">if</span> (z[i].a != z[i + <span class="number">1</span>].a || z[i].b != z[i + <span class="number">1</span>].b</span><br><span class="line">     || z[i].c != z[i + <span class="number">1</span>].c)</span><br><span class="line">      s[++N] = z[i], s[N].w = j, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">CDQ</span>(<span class="number">1</span>, N);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    ans[s[i].cnt + s[i].w - <span class="number">1</span>] += s[i].w;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; ++i)</span><br><span class="line">    cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  cout.<span class="built_in">flush</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="ã€æ¨¡æ¿ã€‘åŸºæ•°æ’åº"><a href="#ã€æ¨¡æ¿ã€‘åŸºæ•°æ’åº" class="headerlink" title="ã€æ¨¡æ¿ã€‘åŸºæ•°æ’åº"></a>ã€æ¨¡æ¿ã€‘åŸºæ•°æ’åº</h3><p>æ²¡å•¥å¥½è¯´çš„ã€‚ä¸è¿‡æˆ‘è·Ÿåˆ«äººå†™å¾—éƒ½ä¸ä¸€æ ·\dkã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> N, l[<span class="number">11</span>], z[<span class="number">100003</span>], c[<span class="number">10</span>][<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxbit</span><span class="params">(<span class="keyword">int</span> *z, <span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> ans = <span class="number">0</span>, mx = *std::<span class="built_in">max_element</span>(z + <span class="number">1</span>, z + N + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">do</span> ++ans; <span class="keyword">while</span> (mx /= <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rsort</span><span class="params">(<span class="keyword">int</span>* z, <span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> d = <span class="built_in">maxbit</span>(z, N);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">1</span>, n; d; --d, r *= <span class="number">10</span>) &#123;</span><br><span class="line">    n = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(l, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) * <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, t; i &lt;= N; ++i) &#123;</span><br><span class="line">      t = z[i] / r % <span class="number">10</span>;</span><br><span class="line">      c[t][++l[t]] = z[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i)</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= l[i]; ++j)</span><br><span class="line">        z[++n] = c[i][j], c[i][j] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="ã€æ¨¡æ¿ã€‘åç¼€æ’åº"><a href="#ã€æ¨¡æ¿ã€‘åç¼€æ’åº" class="headerlink" title="ã€æ¨¡æ¿ã€‘åç¼€æ’åº"></a><a href="https://www.luogu.com.cn/problem/P3809">ã€æ¨¡æ¿ã€‘åç¼€æ’åº</a></h3><p><del>æ²¡çœ‹æ‡‚ï¼ŒèƒŒä»£ç </del></p><p>å’•å’•å’• // <strong>TODO</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> iarrN = <span class="keyword">int</span>[<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[<span class="number">100003</span>];</span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line">iarrN c, rnk, sa, t, H;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rSort</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(c + <span class="number">1</span>, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) * M);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    ++c[rnk[i]];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= M; ++i)</span><br><span class="line">    c[i] += c[i - <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = N; i; --i)</span><br><span class="line">    sa[c[rnk[t[i]]]--] = t[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sufSort</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  M = <span class="string">&#x27;z&#x27;</span> - <span class="string">&#x27;0&#x27;</span> + <span class="number">1</span>; <span class="comment">// 75</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    rnk[i] = s[i] - <span class="string">&#x27;0&#x27;</span> + <span class="number">1</span>, t[i] = i;</span><br><span class="line">  <span class="built_in">rSort</span>();</span><br><span class="line">  M = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> w = <span class="number">1</span>; M &lt; N; w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">    M = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = N - w + <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">      t[++M] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">      <span class="keyword">if</span> (sa[i] &gt; w) t[++M] = sa[i] - w;</span><br><span class="line">    <span class="built_in">rSort</span>();</span><br><span class="line">    <span class="built_in">memcpy</span>(t + <span class="number">1</span>, rnk + <span class="number">1</span>, N &lt;&lt; <span class="number">2</span>);</span><br><span class="line">    rnk[sa[<span class="number">1</span>]] = M = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; ++i)</span><br><span class="line">      rnk[sa[i]] = (t[sa[i - <span class="number">1</span>]] == t[sa[i]]</span><br><span class="line">        &amp;&amp; t[sa[i - <span class="number">1</span>] + w] == t[sa[i] + w]) ? M : ++M;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">0</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (rnk[i] == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">while</span> (s[i + j] == s[sa[rnk[i] - <span class="number">1</span>] + j])</span><br><span class="line">      ++j;</span><br><span class="line">    H[rnk[i]] = j;</span><br><span class="line">    <span class="keyword">if</span> (j) --j;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">fread</span>(s + <span class="number">1</span>, <span class="number">1</span>, <span class="number">100000</span>, stdin);</span><br><span class="line">  N = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">while</span> (s[N] &lt; <span class="number">48</span>) --N;</span><br><span class="line">  <span class="built_in">sufSort</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    std::cout &lt;&lt; sa[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">  std::cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; ++i)</span><br><span class="line">    std::cout &lt;&lt; H[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="NOI2015-å“é…’å¤§ä¼š"><a href="#NOI2015-å“é…’å¤§ä¼š" class="headerlink" title="[NOI2015]å“é…’å¤§ä¼š"></a><a href="https://www.luogu.com.cn/problem/P2178">[NOI2015]å“é…’å¤§ä¼š</a></h3><p>å’•å’•å’• // <strong>TODO</strong></p><h4 id="code-1"><a href="#code-1" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* struct IO &#123; ... &#125; cout; */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> iarrN = <span class="keyword">int</span>[<span class="number">300003</span>];</span><br><span class="line"><span class="keyword">using</span> ll = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> ll inf = <span class="number">1e18</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[<span class="number">300003</span>];</span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">std::vector&lt;<span class="keyword">int</span>&gt; v[<span class="number">300003</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> SA &#123;</span><br><span class="line"><span class="keyword">int</span> M;</span><br><span class="line">iarrN H, sa, rnk, c, t, z;</span><br><span class="line">ll now, sum = -inf, ans1[<span class="number">300003</span>], ans2[<span class="number">300003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rSort</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sufSort</span><span class="params">()</span></span>;</span><br><span class="line">&#125; <span class="comment">// SA</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> SA;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> DSU &#123;</span><br><span class="line">iarrN fa, siz, mx, mn;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> u)</span></span>; <span class="comment">// è·¯å¾„å‹ç¼©</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">  u = <span class="built_in">find</span>(u), v = <span class="built_in">find</span>(v);</span><br><span class="line">  now += <span class="number">1ll</span> * siz[u] * siz[v];</span><br><span class="line">  sum = std::<span class="built_in">max</span>(sum, (std::<span class="built_in">max</span>(<span class="number">1ll</span> * mx[u] *  mx[v], <span class="number">1ll</span> * mn[u] * mn[v])));</span><br><span class="line">  <span class="keyword">if</span> (siz[u] &gt; siz[v]) std::<span class="built_in">swap</span>(u, v);</span><br><span class="line">  fa[u] = v, siz[v] += siz[u];</span><br><span class="line">  mx[v] = std::<span class="built_in">max</span>(mx[u], mx[v]);</span><br><span class="line">  mn[v] = std::<span class="built_in">min</span>(mn[u], mn[v]);</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="comment">// DSU</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> DSU;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// è¿™ä¸ªå¹¶æŸ¥é›†å±å®æ²¡æƒ³å‡ºæ¥</span></span><br><span class="line">  <span class="comment">// æ„Ÿè°¢ @Nemlit çš„é¢˜è§£ï¼Œå¤ªæ£’äº†ï¼Œå­¦åˆ°è®¸å¤š</span></span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d\n&quot;</span>, &amp;N);</span><br><span class="line">  <span class="built_in">fread</span>(s + <span class="number">1</span>, <span class="number">1</span>, N, stdin);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, z + i);</span><br><span class="line">  <span class="built_in">sufSort</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    fa[i] = i, siz[i] = <span class="number">1</span>;</span><br><span class="line">    mx[i] = mn[i] = z[sa[i]];</span><br><span class="line">    v[H[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k : v[i]) <span class="built_in">merge</span>(k, k - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (now) ans1[i] = now, ans2[i] = sum;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">    cout &lt;&lt; ans1[i] &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; ans2[i] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  cout.<span class="built_in">flush</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="ã€æ¨¡æ¿ã€‘å•è°ƒæ ˆ"><a href="#ã€æ¨¡æ¿ã€‘å•è°ƒæ ˆ" class="headerlink" title="ã€æ¨¡æ¿ã€‘å•è°ƒæ ˆ"></a><a href="https://www.luogu.com.cn/problem/P5788">ã€æ¨¡æ¿ã€‘å•è°ƒæ ˆ</a></h3><p>æ°´é¢˜ã€‚éšæ‰‹å†™äº†ä¸€å‘<del>ï¼Œç›®å‰(02-06 23:40)æœ€ä¼˜è§£ç¬¬äº”ã€‚</del>ï¼Œç›®å‰(02-23 21:50) æ›´æ–°äº†æ•°æ®ï¼Œé‡äº¤åæœ€ä¼˜è§£ç¬¬ä¸€ã€‚</p><h4 id="problem-1"><a href="#problem-1" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ªé•¿ä¸º $N$ çš„åºåˆ— $a$ã€‚å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œæ±‚å…¶åç¬¬ä¸€ä¸ªå¤§äº $a_i$ çš„å…ƒç´ çš„ä¸‹æ ‡ã€‚</p><h4 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h4><p>å¯¹åºåˆ—ä¸­å…ƒç´ çš„ä¸‹æ ‡å’Œå€¼ç»´æŠ¤ä¸€ä¸ªæ ˆã€‚å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œæ¯å½“æ ˆé¡¶å°äºå½“å‰å…ƒç´ ï¼Œè®°å½•æ ˆé¡¶æ‰€åœ¨å½“å‰ä¸‹æ ‡çš„ç­”æ¡ˆå¹¶å¼¹æ ˆï¼›æœ€åå°†å½“å‰å…ƒç´ å‹å…¥æ ˆã€‚</p><hr><h3 id="ã€æ¨¡æ¿ã€‘ä¹˜æ³•é€†å…ƒ2"><a href="#ã€æ¨¡æ¿ã€‘ä¹˜æ³•é€†å…ƒ2" class="headerlink" title="ã€æ¨¡æ¿ã€‘ä¹˜æ³•é€†å…ƒ2"></a><a href="https://www.luogu.com.cn/problem/P5431">ã€æ¨¡æ¿ã€‘ä¹˜æ³•é€†å…ƒ2</a></h3><p><del>é±¼è¯´æ˜¯å¡å¸¸ï¼Œå®é™…ä¸Šæ˜¯å¡äº†ä¸ªèƒ½è¿‡çš„é«˜å¤æ‚åº¦</del></p><p><del>å¡å®Œä¹‹åè¿™é¢˜å’Œé€†å…ƒå‡ ä¹æ²¡å…³ç³»äº†</del></p><h4 id="problem-2"><a href="#problem-2" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šé•¿ä¸º $n$ çš„æ­£æ•´æ•°åºåˆ— $a$ ä¸å¸¸æ•° $k, p(p \in \mathbb{P})$ï¼Œæ±‚</p><script type="math/tex; mode=display">\sum_{i = 1}^n \frac{k^i}{a_i}</script><p>åœ¨æ¨¡ $p$ æ„ä¹‰ä¸‹çš„å€¼ã€‚</p><h4 id="solution-2"><a href="#solution-2" class="headerlink" title="solution"></a>solution</h4><p>ç›´æ¥ç®—å¤æ‚åº¦æ˜¯ $O(n \log p)$ï¼Œå·®ä¸å¤šèƒ½è¿‡<del>ï¼Œä½†æ˜¯å®Œå…¨è¢«å¡æ‰äº†</del>ã€‚</p><p>è€ƒè™‘çæ¨å¼å­ã€‚è®¾ $\mathrm{Pre}_i$ è¡¨ç¤ºå‰ $i$ ä¸ªæ•°çš„å‰ç¼€ç§¯ï¼Œ$\mathrm{Suf}_i$ è¡¨ç¤ºå $i$ ä¸ªæ•°çš„åç¼€ç§¯ã€‚æš´åŠ›é€šåˆ†å¯å¾—æ‰€æ±‚ç­”æ¡ˆä¸º</p><script type="math/tex; mode=display">\frac{\sum \limits_{i = 1}^n k^i \mathrm{Pre}_{i - 1} \mathrm{Suf}_{i + 1}}{\mathrm{Pre}^n}</script><p>ã€‚æ—¶é—´å¤æ‚åº¦ $O(n)$ã€‚è·‘å¾—æŒºå¿«<del>ï¼Œç„¶è€Œå¤§ç©ºé—´é€‰æ‰‹éœ‡æ€’</del>ã€‚</p><hr><h3 id="æŠ„æ¥çš„-O-1-é¾Ÿé€Ÿä¹˜ï¼ˆï¼Ÿï¼‰"><a href="#æŠ„æ¥çš„-O-1-é¾Ÿé€Ÿä¹˜ï¼ˆï¼Ÿï¼‰" class="headerlink" title="æŠ„æ¥çš„ $O(1)$ é¾Ÿé€Ÿä¹˜ï¼ˆï¼Ÿï¼‰"></a>æŠ„æ¥çš„ $O(1)$ é¾Ÿé€Ÿä¹˜ï¼ˆï¼Ÿï¼‰</h3><p><del>æŠ„çš„ scape æŠ„çš„ dls çš„</del></p><p>å‰ä¸¤ä¸ªç‰¹åˆ¤æ˜¯ä¸ºäº†é¿å… $m$ è¾ƒå°æ—¶å‡ºé”™ã€‚</p><p>é€‚ç”¨äºä¸¤ä¸ª ll èŒƒå›´å†…çš„æ•°ç›¸ä¹˜æ¨¡ä¸€ä¸ª ll èŒƒå›´å†…çš„æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> ll = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> ldb = <span class="keyword">long</span> <span class="keyword">double</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">Mul</span><span class="params">(ll a, ll b, ll m)</span> </span>&#123;</span><br><span class="line">  a %= m, b %= m;</span><br><span class="line">  <span class="keyword">if</span> (m &lt;= <span class="number">1000000000</span>) <span class="keyword">return</span> a * b % m;</span><br><span class="line">  <span class="keyword">if</span> (m &lt;= <span class="number">1000000000000</span>)</span><br><span class="line">    <span class="keyword">return</span> (((a * (b &gt;&gt; <span class="number">20</span>) % m) &lt;&lt; <span class="number">20</span>) + a * (b &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">20</span>) - <span class="number">1</span>))) % m;</span><br><span class="line">  ll d = <span class="built_in">floor</span>(a * (ldb)b / m + <span class="number">0.5</span>);</span><br><span class="line">  ll ans = (a * b - d * m) % m;</span><br><span class="line">  <span class="keyword">if</span> (ans &lt; <span class="number">0</span>) ans += m;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="ã€æ¨¡æ¿ã€‘Johnson-å…¨æºæœ€çŸ­è·¯"><a href="#ã€æ¨¡æ¿ã€‘Johnson-å…¨æºæœ€çŸ­è·¯" class="headerlink" title="ã€æ¨¡æ¿ã€‘Johnson å…¨æºæœ€çŸ­è·¯"></a><a href="https://www.luogu.com.cn/problem/P5905">ã€æ¨¡æ¿ã€‘Johnson å…¨æºæœ€çŸ­è·¯</a></h3><h4 id="problem-3"><a href="#problem-3" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ªæœ‰å‘å›¾ï¼Œæ±‚ä»»æ„ä¸¤ç‚¹é—´çš„æœ€çŸ­è·¯ã€‚</p><p>è¿™ä¸ªå›¾æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>æœ‰è´Ÿæƒã€é‡è¾¹å’Œè‡ªç¯ã€‚éœ€è¦åˆ¤æ–­æœ‰æ— è´Ÿç¯ã€‚</li><li>æ•°æ®èŒƒå›´ floyd è¿‡ä¸å»ã€‚</li><li>è·‘ n æ¬¡ spfa ä¼šè¢«å¡ã€‚</li></ul><h4 id="solution-3"><a href="#solution-3" class="headerlink" title="solution"></a>solution</h4><ol><li>å»ºç«‹ä¸€ä¸ªè¶…çº§æºç‚¹ $S$ï¼Œå‘æ¯ä¸ªç‚¹ $i$ è¿è¾¹ $(S, i, 0)$ã€‚<ul><li>ç›¸å½“äºåœ¨ spfa å¼€å§‹ç›´æ¥å°†æ‰€æœ‰ç‚¹å…¥é˜Ÿã€‚</li></ul></li><li>ç”¨ spfaï¼ˆæˆ– Bellman-Fordï¼‰æ±‚å‡ºæ±‚å‡º $S$ åˆ°å…¶ä»–å„ç‚¹ $i$ çš„æœ€çŸ­è·¯ $d_i$ã€‚åˆ¤æ–­è´Ÿç¯åœ¨è¿™ä¸€æ­¥è¿›è¡Œã€‚</li><li>å°†æ¯æ¡è¾¹ $(u, v, w)$ æ”¹ä¸º $(u, v, w + h_u - h_v)$ã€‚<ul><li>æ­¤æ—¶å›¾ä¸­ä¸å­˜åœ¨è´Ÿæƒã€‚</li></ul></li><li>ç”¨ $n$ æ¬¡ dijkstra æ±‚å‡ºä»»æ„ä¸¤ç‚¹é—´çš„æœ€çŸ­è·¯ã€‚<ul><li>åˆ«å¿˜äº†æŠŠçœŸå®çš„è¾¹æƒæ”¹å›å»ã€‚è‹¥æ±‚å‡ºçš„è·ç¦»ä¸º <code>dis_[u][v]</code>ï¼Œå®é™…è·ç¦»ä¸º <code>dis[u][v]</code>ï¼Œåˆ™ <code>dis[u][v] = dis_[u][v] - h[u] + h[v]</code>ã€‚</li></ul></li></ol><h4 id="code-2"><a href="#code-2" class="headerlink" title="code"></a>code</h4><p>æœ‰ä¸€è¯´ä¸€ï¼Œæœ‰ç‚¹ç»†èŠ‚ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> ll = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line">std::bitset&lt;3003&gt; vis;</span><br><span class="line"><span class="keyword">int</span> N, M, tot, cnt[<span class="number">3003</span>], head[<span class="number">3003</span>], dis[<span class="number">3003</span>], d[<span class="number">3003</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> nxt, to, w;</span><br><span class="line">&#125; e[<span class="number">6003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span><span class="params">(<span class="keyword">int</span> s)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> u, v, w; M; --M) &#123;</span><br><span class="line">    cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">    <span class="built_in">addEdge</span>(u, v, w);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">spfa</span>()) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>), <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i, u = <span class="number">1</span>; u &lt;= N; ++u)</span><br><span class="line">    <span class="keyword">for</span> (i = head[u]; i; i = e[i].nxt)</span><br><span class="line">      e[i].w += d[u] - d[e[i].to];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="built_in">dijkstra</span>(i);</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; ++j)</span><br><span class="line">      <span class="keyword">if</span> (dis[j] == inf) ans += j * <span class="number">1000000000ll</span>;</span><br><span class="line">      <span class="keyword">else</span> ans += <span class="number">1ll</span> * j * (dis[j] - d[i] + d[j]);</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  cout.<span class="built_in">flush</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="ã€æ¨¡æ¿ã€‘åº·æ‰˜å±•å¼€"><a href="#ã€æ¨¡æ¿ã€‘åº·æ‰˜å±•å¼€" class="headerlink" title="ã€æ¨¡æ¿ã€‘åº·æ‰˜å±•å¼€"></a><a href="https://www.luogu.com.cn/problem/P5367">ã€æ¨¡æ¿ã€‘åº·æ‰˜å±•å¼€</a></h3><h4 id="problem-4"><a href="#problem-4" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®š $1 \sim N$ çš„ä¸€ä¸ªæ’åˆ— $P$ï¼Œæ±‚å®ƒåœ¨ $1 \sim N$ çš„æ‰€æœ‰æ’åˆ—ä¸­çš„æ’åã€‚</p><h4 id="solution-4"><a href="#solution-4" class="headerlink" title="solution"></a>solution</h4><p>ä»å‰å‘åæšä¸¾ $P$ çš„æ¯ä¸ªä½ç½®ã€‚å¯¹äºç¬¬ $i$ ä¸ªä½ç½®ï¼Œè‹¥å®ƒæ˜¯è¿˜æœªä½¿ç”¨çš„æ•°ä¸­ç¬¬ $j$ å°çš„ï¼Œåˆ™å¯¹ç­”æ¡ˆçš„è´¡çŒ®ä¸º $(N - i)! \times (j - 1)$ã€‚</p><p>ç”±äºæœ€ç»ˆç­”æ¡ˆè¦æ±‚æ’åï¼Œæ‰€ä»¥è¦åŠ  $1$ã€‚</p><hr><h3 id="ã€æ¨¡æ¿ã€‘æ ‘ä¸Š-k-çº§ç¥–å…ˆ"><a href="#ã€æ¨¡æ¿ã€‘æ ‘ä¸Š-k-çº§ç¥–å…ˆ" class="headerlink" title="ã€æ¨¡æ¿ã€‘æ ‘ä¸Š k çº§ç¥–å…ˆ"></a><a href="https://www.luogu.com.cn/problem/P5903">ã€æ¨¡æ¿ã€‘æ ‘ä¸Š k çº§ç¥–å…ˆ</a></h3><p>é•¿é“¾å‰–åˆ†ï¼Œä¹…ä»°å¤§åã€‚<del>å…¶å®è·Ÿé‡å‰–ä¹Ÿæ²¡å•¥åŒºåˆ«</del></p><h4 id="solution-5"><a href="#solution-5" class="headerlink" title="solution"></a>solution</h4><ul><li>é¢„å¤„ç†ï¼Œ$O(n \log n)$<ol><li>æ ‘ä¸Šå€å¢æ±‚å‡ºæ¯ä¸ªç‚¹çš„ $2^n$ çº§ç¥–å…ˆã€‚$O(n \log n)$ã€‚</li><li>å¯¹æ ‘è¿›è¡Œé•¿å‰–ï¼Œå¯¹äºæ¯ä¸ªç‚¹è®°å½•æ‰€åœ¨é“¾çš„é¡¶ç‚¹å’Œæ·±åº¦ï¼›å¯¹äºæ¯æ¡é“¾ï¼Œè‹¥å…¶é•¿åº¦ä¸º $l$ï¼Œåˆ™åœ¨å…¶é¡¶ç‚¹å¤„è®°å½•å‘ä¸Šçš„ $l$ ä¸ªç¥–å…ˆå’Œå‘ä¸‹çš„ $l$ ä¸ªé“¾ä¸Šçš„å„¿å­ã€‚$O(n)$ã€‚<ul><li>å¯ä»¥ä½¿ç”¨ <code>std::vector</code> å®ç°ã€‚</li><li>ä¹Ÿå¯åˆ©ç”¨ dfs åºï¼Œé­”æ”¹ <code>dfs</code>ï¼Œé€šè¿‡ä¸¤ä¸ªæ•°ç»„ä¿å­˜ã€‚é€Ÿåº¦å½“ç„¶æ˜¯è¦æ¯” <code>vector</code> å¿«çš„ã€‚</li></ul></li></ol></li><li>è¯¢é—® $u$ çš„ $k$ çº§ç¥–å…ˆï¼Œå•æ¬¡ $O(1)$<ol><li>å…ˆåˆ©ç”¨å€å¢æ•°ç»„è·³åˆ° $u$ çš„ $2^{\lfloor \log_2 k \rfloor}$ çº§ç¥–å…ˆã€‚å…¶ä¸­ $\lfloor \log_2 k \rfloor$ ä¹Ÿå¯ $O(n)$ é¢„å¤„ç†å‡ºã€‚</li><li>è‹¥å‰©ä½™ $kâ€™$ çº§ï¼Œæ˜¾ç„¶æœ‰ $kâ€™ &lt; 2^{\lfloor \log_2 k \rfloor}$ã€‚åˆ™å½“å‰é“¾é•¿ $\ge 2^{\lfloor \log_2 k \rfloor} &gt; kâ€™$ã€‚å› æ­¤å¯ä»¥å…ˆè·³åˆ°æ­¤æ—¶æ‰€åœ¨é“¾çš„é¡¶ç‚¹ã€‚æ ¹æ®å‰©ä½™ $k$ çš„æ­£è´Ÿï¼Œåˆ†åˆ«ç”¨å‘ä¸Šã€å‘ä¸‹çš„æ•°ç»„æ±‚å‡ºç­”æ¡ˆã€‚</li></ol></li></ul><p>æ€»å¤æ‚åº¦ $O(n \log n + q)$ã€‚</p><h4 id="code-3"><a href="#code-3" class="headerlink" title="code"></a>code</h4><p>è¿™ä¸ªé­”æ”¹çš„é‚ªæ•™ <code>dfs2</code> ä¼ äº†ä¸‰ä¸ªå‚ã€‚æ³¨æ„ç”±äºåŸé¢˜æ€§è´¨ï¼Œè¿™é‡Œ dfs æ—¶æ²¡æœ‰åˆ¤çˆ¹ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">18</span>; ++i)</span><br><span class="line">    fa[u][i] = fa[fa[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">  mxd[u] = dep[u] = dep[fa[u][<span class="number">0</span>]] + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u], v; i; i = e[i].nxt) &#123;</span><br><span class="line">    <span class="built_in">dfs1</span>(v = e[i].to);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">dmax</span>(mxd[u], mxd[v])) son[u] = v;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> t, <span class="keyword">int</span> up)</span> </span>&#123;</span><br><span class="line">  top[u] = t;</span><br><span class="line">  dfn[u] = ++dft, D[dft] = u, U[dft] = up;</span><br><span class="line">  <span class="keyword">if</span> (!son[u]) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">dfs2</span>(son[u], t, fa[up][<span class="number">0</span>]);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u], v; i; i = e[i].nxt)</span><br><span class="line">    <span class="keyword">if</span> ((v = e[i].to) != son[u])</span><br><span class="line">      <span class="built_in">dfs2</span>(v, v, v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!k) <span class="keyword">return</span> u;</span><br><span class="line">  u = fa[u][lg[k]];</span><br><span class="line">  k -= (<span class="number">1</span> &lt;&lt; lg[k]) + dep[u] - dep[top[u]];</span><br><span class="line">  u = top[u];</span><br><span class="line">  <span class="keyword">return</span> k &gt;= <span class="number">0</span> ? U[dfn[u] + k] : D[dfn[u] - k];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="ã€æ¨¡æ¿ã€‘æ— å‘å›¾ä¸‰å…ƒç¯è®¡æ•°"><a href="#ã€æ¨¡æ¿ã€‘æ— å‘å›¾ä¸‰å…ƒç¯è®¡æ•°" class="headerlink" title="ã€æ¨¡æ¿ã€‘æ— å‘å›¾ä¸‰å…ƒç¯è®¡æ•°"></a><a href="https://www.luogu.com.cn/problem/P1989">ã€æ¨¡æ¿ã€‘æ— å‘å›¾ä¸‰å…ƒç¯è®¡æ•°</a></h3><h4 id="solution-6"><a href="#solution-6" class="headerlink" title="solution"></a>solution</h4><p>é¦–å…ˆç»™æ¯æ¡è¾¹å®šå‘ï¼šåº¦æ•°å°çš„è¿å‘åº¦æ•°å¤§çš„ï¼Œåº¦æ•°ç›¸ç­‰åˆ™ç¼–å·å°çš„è¿å‘ç¼–å·å¤§çš„ã€‚</p><p>æšä¸¾æ¯ä¸ªç‚¹ã€å®ƒçš„å‡ºè¾¹ã€å®ƒçš„å‡ºè¾¹çš„å‡ºè¾¹ï¼Œæš´åŠ›ç»Ÿè®¡ç­”æ¡ˆã€‚</p><p>å¤æ‚åº¦æ˜¯ $O(m \sqrt m)$ çš„<del>ï¼Œä¸ä¼šè¯ä¸ä¼šè¯</del>ã€‚</p><hr><h3 id="SP10395-ABA12D-Sum-of-divisors"><a href="#SP10395-ABA12D-Sum-of-divisors" class="headerlink" title="SP10395 ABA12D - Sum of divisors!"></a><a href="https://www.luogu.com.cn/problem/SP10395">SP10395 ABA12D - Sum of divisors!</a></h3><p>è¿™é¢˜æœ‰ä¸€äº›å¾ˆæ£’çš„ä¸œè¥¿ï¼Œä¸è¿‡è¿™ç¯‡é¢˜è§£çš„åšæ³•ä¸­è§„ä¸­çŸ©ã€‚</p><p>æœ‰æ—¶é—´æ¢ç´¢ä¸€ä¸‹é‚£ä¸ªå¥‡å¦™çš„åšæ³•ã€‚</p><hr><p>46789 51939 54515 49653 48818</p><hr><h3 id="ã€æ¨¡æ¿ã€‘ç¬›å¡å°”æ ‘"><a href="#ã€æ¨¡æ¿ã€‘ç¬›å¡å°”æ ‘" class="headerlink" title="ã€æ¨¡æ¿ã€‘ç¬›å¡å°”æ ‘"></a><a href="https://www.luogu.com.cn/problem/P5854">ã€æ¨¡æ¿ã€‘ç¬›å¡å°”æ ‘</a></h3><h4 id="problem-5"><a href="#problem-5" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ª $1 \sim n$ çš„æ’åˆ— $p$ï¼Œæ„å»ºä¸€æ£µäºŒå‰æ ‘ï¼Œæ»¡è¶³ï¼š</p><ol><li>æ¯ä¸ªç»“ç‚¹çš„ç¼–å·æ»¡è¶³äºŒå‰æœç´¢æ ‘çš„æ€§è´¨ã€‚</li><li>ç»“ç‚¹ $i$ çš„æƒå€¼ä¸º $p_i$â€‹ï¼Œæ¯ä¸ªç»“ç‚¹çš„æƒå€¼æ»¡è¶³å°æ ¹å †çš„æ€§è´¨ã€‚</li></ol><h4 id="solution-7"><a href="#solution-7" class="headerlink" title="solution"></a>solution</h4><p>è¿™æ£µäºŒå‰æ ‘å³ä¸ºè¿™ä¸ªåºåˆ—çš„ç¬›å¡å°”æ ‘ã€‚å®ƒæœ‰ä»¥ä¸‹æ€§è´¨ï¼š</p><ol><li>å®ƒçš„ä¸­åºéå†æ˜¯åŸåºåˆ—ã€‚</li><li>ä»»æ„ä¸€ä¸ªç»“ç‚¹çš„å€¼éƒ½å¤§äºå®ƒçš„ä¸¤ä¸ªå„¿å­çš„å€¼ã€‚</li><li>ä¸¤ä¸ªç‚¹çš„ lca å°±æ˜¯ä»–ä»¬çš„ RMQã€‚</li></ol><p>æ„é€ æ–¹æ³•ï¼š</p><ol><li>ç»´æŠ¤ä¸€ä¸ªå•è°ƒæ ˆï¼ŒæŒ‰é¡ºåºæ’å…¥æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ åŒ…å«<strong>å€¼</strong>å’Œ<strong>åºå·</strong>ä¸¤ä¸ªä¿¡æ¯ã€‚</li><li>æ¯å½“æ ˆé¡¶å…ƒç´  $v$ çš„å€¼å¤§äºå½“å‰å…ƒç´  $u$ çš„å€¼ï¼Œå¼¹å‡º $v$ å¹¶å°†å…¶è®¾ä¸º $u$ çš„å·¦å„¿å­ã€‚å¦åˆ™å°† $u$ è®¾ä¸º $v$ çš„å³å„¿å­ã€‚æœ€åå°† $u$ å…¥æ ˆã€‚</li><li>æœ€ç»ˆæ ˆé¡¶å…ƒç´ çš„åºå·ä¸ºæ ‘æ ¹ã€‚</li></ol><h4 id="code-4"><a href="#code-4" class="headerlink" title="code"></a>code</h4><p><code>s[]</code> å­˜å‚¨ç¼–å·ï¼Œ<code>w[]</code> å­˜å‚¨å€¼ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, t; i &lt;= N; ++i) &#123;</span><br><span class="line">  cin &gt;&gt; t;</span><br><span class="line">  <span class="keyword">while</span> (top &amp;&amp; t &lt; w[top]) ls[i] = s[top--];</span><br><span class="line">  <span class="keyword">if</span> (top) rs[s[top]] = i;</span><br><span class="line">  s[++top] = i, w[top] = t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="ã€æ¨¡æ¿ã€‘Stoer-Wagner-ç®—æ³•"><a href="#ã€æ¨¡æ¿ã€‘Stoer-Wagner-ç®—æ³•" class="headerlink" title="ã€æ¨¡æ¿ã€‘Stoer-Wagner ç®—æ³•"></a><a href="https://www.luogu.com.cn/problem/P5632">ã€æ¨¡æ¿ã€‘Stoer-Wagner ç®—æ³•</a></h3><p><del>ä»€ä¹ˆè°”è°”ç©æ„ï¼Œå­¦ä¸ä¼š</del></p><hr><h3 id="ã€æ¨¡æ¿ã€‘Prufer-åºåˆ—"><a href="#ã€æ¨¡æ¿ã€‘Prufer-åºåˆ—" class="headerlink" title="ã€æ¨¡æ¿ã€‘Prufer åºåˆ—"></a><a href="https://www.luogu.com.cn/problem/P6086">ã€æ¨¡æ¿ã€‘Prufer åºåˆ—</a></h3><h4 id="Prufer-åºåˆ—ä¸å¸¦æ ‡å·æ— æ ¹æ ‘çš„ç›¸äº’è½¬åŒ–"><a href="#Prufer-åºåˆ—ä¸å¸¦æ ‡å·æ— æ ¹æ ‘çš„ç›¸äº’è½¬åŒ–" class="headerlink" title="Prufer åºåˆ—ä¸å¸¦æ ‡å·æ— æ ¹æ ‘çš„ç›¸äº’è½¬åŒ–"></a>Prufer åºåˆ—ä¸å¸¦æ ‡å·æ— æ ¹æ ‘çš„ç›¸äº’è½¬åŒ–</h4><p>Prufer åºåˆ—å¯ä»¥å°†ä¸€ä¸ªå¸¦æ ‡å· $n$ ä¸ªç»“ç‚¹çš„æ ‘ç”¨ $[1, n]$ ä¸­çš„ $n - 2$ ä¸ªæ•´æ•°è¡¨ç¤ºã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºå®Œå…¨å›¾çš„ç”Ÿæˆæ ‘ä¸æ•°åˆ—ä¹‹é—´çš„åŒå°„ã€‚</p><p>Prufer æ˜¯è¿™æ ·å»ºç«‹çš„ï¼šæ¯æ¬¡é€‰æ‹©ä¸€ä¸ªç¼–å·æœ€å°çš„å¶ç»“ç‚¹å¹¶åˆ æ‰å®ƒï¼Œç„¶ååœ¨åºåˆ—ä¸­è®°å½•ä¸‹å®ƒè¿æ¥åˆ°çš„é‚£ä¸ªç»“ç‚¹ã€‚é‡å¤ $n - 2$ æ¬¡åå°±åªå‰©ä¸‹ä¸¤ä¸ªç»“ç‚¹ï¼Œç®—æ³•ç»“æŸã€‚</p><p>é‡å»ºæ ‘çš„æ–¹æ³•æ˜¯ç±»ä¼¼çš„ã€‚æ ¹æ® Prufer åºåˆ—çš„æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åŸæ ‘ä¸Šæ¯ä¸ªç‚¹çš„åº¦æ•°ã€‚ç„¶åä½ ä¹Ÿå¯ä»¥å¾—åˆ°åº¦æ•°æœ€å°çš„å¶ç»“ç‚¹ç¼–å·ï¼Œè€Œè¿™ä¸ªç»“ç‚¹ä¸€å®šä¸ Prufer åºåˆ—çš„ç¬¬ä¸€ä¸ªæ•°è¿æ¥ã€‚ç„¶åæˆ‘ä»¬åŒæ—¶åˆ æ‰è¿™ä¸¤ä¸ªç»“ç‚¹çš„åº¦æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve1</span><span class="params">()</span> </span>&#123; <span class="comment">// tree -&gt; prufer code</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i)</span><br><span class="line">    cin &gt;&gt; f[i], ++d[f[i]];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">1</span>; i &lt;= N - <span class="number">2</span>; ++i, ++j) &#123;</span><br><span class="line">    <span class="keyword">while</span> (d[j]) ++j;</span><br><span class="line">    <span class="keyword">for</span> (p[i] = f[j]; i &lt;= N - <span class="number">2</span> &amp;&amp; !--d[p[i]] &amp;&amp; p[i] &lt; j; ++i)</span><br><span class="line">      p[i + <span class="number">1</span>] = f[p[i]];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve2</span><span class="params">()</span> </span>&#123; <span class="comment">// prufer code -&gt; tree</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N - <span class="number">2</span>; ++i)</span><br><span class="line">    cin &gt;&gt; p[i], ++d[p[i]];</span><br><span class="line">  p[N - <span class="number">1</span>] = N;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">1</span>; i &lt; N; ++i, ++j) &#123;</span><br><span class="line">    <span class="keyword">while</span> (d[j]) ++j;</span><br><span class="line">    <span class="keyword">for</span> (f[j] = p[i]; i &lt; N &amp;&amp; !--d[p[i]] &amp;&amp; p[i] &lt; j; ++i)</span><br><span class="line">      f[p[i]] = p[i + <span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="Prufer-åºåˆ—çš„æ€§è´¨"><a href="#Prufer-åºåˆ—çš„æ€§è´¨" class="headerlink" title="Prufer åºåˆ—çš„æ€§è´¨"></a>Prufer åºåˆ—çš„æ€§è´¨</h4><ol><li>åœ¨æ„é€ å®Œ Prufer åºåˆ—ååŸæ ‘ä¸­ä¼šå‰©ä¸‹ä¸¤ä¸ªç»“ç‚¹ï¼Œå…¶ä¸­ä¸€ä¸ªä¸€å®šæ˜¯ç¼–å·æœ€å¤§çš„ç‚¹ $n$ã€‚</li><li>æ¯ä¸ªç»“ç‚¹åœ¨åºåˆ—ä¸­å‡ºç°çš„æ¬¡æ•°æ˜¯å…¶åº¦æ•°å‡ $1$ã€‚ï¼ˆæ²¡æœ‰å‡ºç°çš„å°±æ˜¯å¶ç»“ç‚¹ï¼‰</li><li>é€šè¿‡ Prufer åºåˆ—æ˜¾ç„¶æœ‰ç»“è®ºï¼šå®Œå…¨å›¾ $K_n$ æœ‰ $n^{n - 2}$ æ£µç”Ÿæˆæ ‘ã€‚</li></ol><h4 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h4><ul><li><a href="https://oi-wiki.org/graph/prufer/">Prufer åºåˆ— - OI Wiki</a></li></ul><hr><h3 id="CF156D-Clues"><a href="#CF156D-Clues" class="headerlink" title="CF156D Clues"></a><a href="http://codeforces.com/problemset/problem/156/D">CF156D Clues</a></h3><h4 id="problem-6"><a href="#problem-6" class="headerlink" title="problem"></a>problem</h4><p>ä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„å¸¦æ ‡å·æ— å‘å›¾æœ‰ $k$ ä¸ªè¿é€šå—ã€‚æˆ‘ä»¬å¸Œæœ›æ·»åŠ  $k - 1$ æ¡è¾¹ä½¿å¾—æ•´ä¸ªå›¾è¿é€šã€‚æ±‚æ–¹æ¡ˆæ•°ã€‚</p><h4 id="solution-8"><a href="#solution-8" class="headerlink" title="solution"></a>solution</h4><blockquote><p>å‰ç½®çŸ¥è¯†ï¼š<a href="https://oi-wiki.org/math/combination/#_9">å¤šé‡ç»„åˆæ•°</a></p></blockquote><p>è®¾ $s_i(1 \le i \le k)$ è¡¨ç¤ºç¬¬ $i$ ä¸ªè”é€šå—ä¸­çš„ç‚¹æ•°ã€‚è®¾ $d_i$ ä¸ºæ„é€ çš„è¿é€šå›¾ä¸­ç¬¬ $i$ ä¸ªè¿é€šå—çš„åº¦æ•°ã€‚æ˜¾ç„¶æœ‰ $\sum_{i = 1}^k d_i = 2k - 2$ã€‚åˆ™å¯¹äºç»™å®šçš„ $d$ åºåˆ—æ„é€  Prufer åºåˆ—çš„æ–¹æ¡ˆæ•°æ˜¯</p><script type="math/tex; mode=display">\binom{k - 2}{d_1 - 1, d_2 - 1, \cdots, d_k - 1} = \frac{(k - 2)!}{\prod_{i = 1}^k (d_i - 1)!}</script><p>å¯¹äºç¬¬ $i$ ä¸ªè”é€šå—ï¼Œå®ƒå¯¹å¤–è¿æ¥çš„æ–¹å¼æœ‰ $s_i^{d_i}$ ç§ï¼Œå› æ­¤å¯¹äºç»™å®š $d$ åºåˆ—ä½¿å›¾è”é€šçš„æ–¹æ¡ˆæ•°æ˜¯</p><script type="math/tex; mode=display">\binom{k - 2}{d_1 - 1, d_2 - 1, \cdots, d_k - 1} \times \prod_{i = 1}^k s_i^{d_i}</script><p>ç„¶åæˆ‘ä»¬è¦æšä¸¾ $d$ åºåˆ—ï¼Œå¼å­å˜æˆ</p><script type="math/tex; mode=display">\sum_{d_i \ge 1, \sum_{i = 1}^k d_i = 2k - 2} \binom{k - 2}{d_1 - 1, d_2 - 1, \cdots, d_k - 1} \times \prod_{i = 1}^k s_i^{d_i}</script><blockquote><p>å¯¹äºå¤„ç†è¿™ä¸ªå¼å­ï¼Œæˆ‘ä»¬æœ‰å¤šå…ƒäºŒé¡¹å¼å®šç†</p><script type="math/tex; mode=display">(\sum_{i = 1}^m x_i)^p = \sum_{c_i \ge 0, \sum_{i = 1}^m c_i = p} \binom{p}{c_1, c_2, \cdots, c_m} \times \prod_{i = 1}^m x_i^{c_i}</script></blockquote><p>ä»¤ $e_i = d_i - 1$ï¼Œé‚£ä¹ˆæ˜¾ç„¶æœ‰ $\sum_{i = 1}^k e_i = k - 2$ï¼Œäºæ˜¯å¼å­æˆä¸º</p><script type="math/tex; mode=display">\begin{aligned}&\sum_{e_i \ge 0, \sum_{i = 1}^k e_i = k - 2} \binom{k - 2}{e_1, e_2, \cdots, e_k} \times \prod_{i = 1}^k s_i^{e_i + 1} \\=& (\sum_{i = 1}^k s_i)^{k - 2} \times \prod_{i = 1}^k s_i \\=& n^{k - 2} \times \prod_{i = 1}^k s_i\end{aligned}</script><p>è¿™ä¸ªå¼å­å°±å¾ˆå¥½æ±‚äº†ã€‚å¹¶æŸ¥é›†ç»Ÿè®¡ä¸€ä¸‹å³å¯ï¼Œå¯ä»¥å†™æˆ $O(n \alpha(n))$ çš„ã€‚</p><h4 id="Reference-1"><a href="#Reference-1" class="headerlink" title="Reference"></a>Reference</h4><ul><li><a href="https://oi-wiki.org/graph/prufer/">Prufer åºåˆ— - OI Wiki</a></li></ul><hr><h3 id="ã€æ¨¡æ¿ã€‘EXCRT"><a href="#ã€æ¨¡æ¿ã€‘EXCRT" class="headerlink" title="ã€æ¨¡æ¿ã€‘EXCRT"></a><a href="https://www.luogu.com.cn/problem/P4777">ã€æ¨¡æ¿ã€‘EXCRT</a></h3><h4 id="problem-7"><a href="#problem-7" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®š $n$ ç»„éè´Ÿæ•´æ•° $m_i, r_i$ï¼Œæ±‚è§£å…³äº $x$ çš„æ–¹ç¨‹ç»„çš„æœ€å°éè´Ÿæ•´æ•°è§£ã€‚</p><p>å…¶ä¸­æ–¹ç¨‹ç»„ä¸­çš„ç¬¬ $i(1 \le i \le n)$ ä¸ªæ–¹ç¨‹ä¸º</p><script type="math/tex; mode=display">x \equiv r_i \pmod{m_i}</script><h4 id="solution-9"><a href="#solution-9" class="headerlink" title="solution"></a>solution</h4><p>ä¸­å›½å‰©ä½™å®šç†å°±æ˜¯åƒåœ¾ã€‚</p><p>ç›´æ¥è·‘ $n$ æ¬¡ exgcd å¯ä»¥åœ¨ $O(n \log n)$ çš„æ—¶é—´å†…è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”ä¸è¦æ±‚ $m_i$ ä¸¤ä¸¤äº’è´¨ã€‚</p><h4 id="code-5"><a href="#code-5" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> ll = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">Mod</span><span class="params">(ll b, ll m)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">Mul</span><span class="params">(ll b, ll p, ll m)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;g, ll &amp;x, ll &amp;y)</span></span>;</span><br><span class="line"></span><br><span class="line">ll N, m[<span class="number">100003</span>], r[<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">EXCRT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  ll M = <span class="number">1</span>, ans = <span class="number">0</span>, a, b, c, x, y, g;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    a = M, b = m[i], c = <span class="built_in">Mod</span>(r[i] - ans, b);</span><br><span class="line">    <span class="built_in">exgcd</span>(a, b, g, x, y);</span><br><span class="line">    <span class="comment">// if (c % gcd) return -1;</span></span><br><span class="line">    ans += <span class="built_in">Mul</span>(x, c / g, b / g) * M;</span><br><span class="line">    ans = <span class="built_in">Mod</span>(ans, M *= b / g);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Mod</span>(ans, M);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin &gt;&gt; N;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    cin &gt;&gt; m[i] &gt;&gt; r[i];</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, <span class="built_in">EXCRT</span>());</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="AT1219-æ­´å²ã®ç ”ç©¶"><a href="#AT1219-æ­´å²ã®ç ”ç©¶" class="headerlink" title="AT1219 æ­´å²ã®ç ”ç©¶"></a><a href="https://www.luogu.com.cn/problem/AT1219">AT1219 æ­´å²ã®ç ”ç©¶</a></h3><p>ç¬¬ä¸€é“å›æ»šè«é˜Ÿé¢˜ç›®ã€‚</p><h4 id="problem-8"><a href="#problem-8" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šé•¿ä¸º $n (1 \le n \le 10^5)$ çš„åºåˆ— $a (1 \le a_i \le 10^9, 1 \le i \le n)$ å’Œ $q (1 \le q \le 10^5)$ ç»„è¯¢é—® $l_i, r_i$ã€‚</p><p>æ¯æ¬¡è¯¢é—® $\max_{i = l}^r a_i \times t_{a_i}$ï¼Œå…¶ä¸­ $t_x$ è¡¨ç¤º $x$ åœ¨ $a_{l..r}$ ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚</p><h4 id="solution-10"><a href="#solution-10" class="headerlink" title="solution"></a>solution</h4><p>ä¸éœ€è¦æ”¯æŒä¿®æ”¹ï¼Œè€ƒè™‘ç¦»çº¿ç®—æ³•ã€‚å‘ç°ç»Ÿè®¡çš„åŒºé—´å®¹æ˜“æ‰©å±•è€Œéš¾ä»¥åˆ é™¤ï¼Œäºæ˜¯è€ƒè™‘å›æ»šè«é˜Ÿï¼š</p><ul><li>é¢„å¤„ç†ï¼Œ$O(n \log n + q \log q)$<ul><li>åºåˆ—åˆ†å—ï¼Œæœ¬é¢˜éœ€è¦ç¦»æ•£åŒ–ï¼Œ$O(n \log n)$</li><li>å¯¹è¯¢é—®è¿›è¡Œæ’åºï¼Œ$O(q \log q)$</li></ul></li><li>è«é˜Ÿï¼Œå¯¹æ¯ä¸ªå—åˆ†åˆ«å¤„ç†å·¦ç«¯ç‚¹åœ¨è¯¥å—å†…çš„è¯¢é—®ï¼Œ$O(n \sqrt n)$<ul><li>ç¬¬ $i$ ä¸ªå—å³ç«¯ç‚¹ä¸º $R_i$ï¼Œåˆå§‹è®¾å·¦æŒ‡é’ˆä¸º $R_i + 1$ï¼Œå³æŒ‡é’ˆä¸º $R_i$ è¡¨ç¤ºç©ºåŒºé—´</li><li>å¯¹äº $r$ åœ¨å—å†…çš„è¯¢é—®ï¼ˆæˆ– $r - l \le \sqrt n$ çš„è¯¢é—®ï¼‰ï¼Œæš´åŠ›ç»Ÿè®¡</li><li>å‘å³æ‰©å±•åŒºé—´ç›´åˆ°å³æŒ‡é’ˆåˆ°è¾¾å½“å‰è¯¢é—®çš„ $r$ï¼Œå¹¶è®°å½•å½“å‰çš„ç­”æ¡ˆ</li><li>é‡‡å–æ‰‹æ®µå‘å·¦æ‰©å±•ï¼Œ<strong>åŒæ—¶ä¸å¯¹å‘å³æ‰©å±•è®°å½•çš„æ•°æ®äº§ç”Ÿå½±å“</strong></li><li>è®°å½•è¯¥æ¬¡è¯¢é—®çš„ç­”æ¡ˆï¼Œå¹¶é‡‡å–æ‰‹æ®µ<strong>è¿˜åŸä¸ºå‘å·¦æ‰©å±•å‰çš„çŠ¶æ€</strong></li><li>å®¹æ˜“æƒ³åˆ°è¿™æ ·<del>é€šè¿‡ç‰ºç‰²å¸¸æ•°</del>åšåˆ°äº† $O(n \sqrt n)$ çš„å¤æ‚åº¦</li></ul></li></ul><h4 id="code-6"><a href="#code-6" class="headerlink" title="code"></a>code</h4><p>å¥½åƒå†™å¾—éå¸¸ä¸å®¹æ˜“ç†è§£ï¼Œè¿˜æ˜¯çœ‹ä»£ç å§ï¼ˆ</p><p>å†™çš„æ—¶å€™æ³¨æ„å¤´è„‘æ¸…é†’ï¼ŒåŒæ—¶æ³¨æ„ä¸è¦æ»¥ç”¨ <code>memset</code> ç³»å‡½æ•°ã€‚</p><p>æˆ‘ç›¸ä¿¡ä½ èƒ½çœ‹æ‡‚è‡ªå·±çš„å˜é‡åã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">  now = std::<span class="built_in">max</span>(now, <span class="number">1ll</span> * ++c[z[p]] * z_[z[p]]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i)</span><br><span class="line">    ans = std::<span class="built_in">max</span>(ans, <span class="number">1ll</span> * ++c_[z[i]] * z_[z[i]]);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i)</span><br><span class="line">    --c_[z[i]];</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">1</span>, l, r; i &lt;= num &amp;&amp; j &lt;= M; ++i) &#123;</span><br><span class="line">    <span class="built_in">memset</span>(c + <span class="number">1</span>, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) * N);</span><br><span class="line">    r = R[i];</span><br><span class="line">    now = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; bel[q[j].l] == i; ++j) &#123;</span><br><span class="line">      <span class="keyword">if</span> (q[j].r &lt; r) &#123;</span><br><span class="line">        ans[q[j].id] = <span class="built_in">solve</span>(q[j].l, q[j].r);</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      l = R[i] + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">while</span> (r &lt; q[j].r) <span class="built_in">add</span>(++r);</span><br><span class="line">      ll t = now;</span><br><span class="line">      <span class="keyword">while</span> (l &gt; q[j].l) <span class="built_in">add</span>(--l);</span><br><span class="line">      ans[q[j].id] = now, now = t;</span><br><span class="line">      <span class="keyword">while</span> (l &lt;= R[i]) --c[z[l++]];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="ã€æ¨¡æ¿ã€‘å›æ»šè«é˜Ÿ"><a href="#ã€æ¨¡æ¿ã€‘å›æ»šè«é˜Ÿ" class="headerlink" title="ã€æ¨¡æ¿ã€‘å›æ»šè«é˜Ÿ"></a><a href="https://www.luogu.com.cn/problem/P5906">ã€æ¨¡æ¿ã€‘å›æ»šè«é˜Ÿ</a></h3><p>æ¯”ä¸Šé¢ä¸€é“éš¾å†™å¤šäº†ã€‚å†™æ³•æ˜¯è‡ªå·±æƒ³çš„ã€‚</p><p>ä¸ºä»€ä¹ˆæˆ‘å†™æ•°æ®ç»“æ„å¸¸æ•°è¿™ä¹ˆå¤§å•Šï¼ˆå“­ï¼‰</p><h4 id="problem-9"><a href="#problem-9" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šé•¿ä¸º $n (1 \le n \le 2 \times 10^5)$ çš„åºåˆ— $a (1 \le a_i \le 2 \times 10^9, 1 \le i \le n)$ å’Œ $q (1 \le q \le 2 \times 10^5)$ ç»„è¯¢é—® $l_i, r_i$ã€‚</p><p>æ¯æ¬¡è¯¢é—® $a_{l..r}$ ä¸­ç›¸åŒçš„æ•°çš„æœ€å¤§ä¸‹æ ‡å·®ã€‚</p><h4 id="code-7"><a href="#code-7" class="headerlink" title="code"></a>code</h4><p>æ²¡å•¥å¥½è¯´çš„ï¼Œçœ‹ä½ è‡ªå·±çš„ä»£ç å§ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">addR</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">dmax</span>(mx[z[p]], p);</span><br><span class="line">  <span class="built_in">dmin</span>(mn[z[p]], p);</span><br><span class="line">  <span class="built_in">dmax</span>(now, mx[z[p]] - mn[z[p]]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">addL</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">dmax</span>(mx_[z[p]], mx[z[p]]);</span><br><span class="line">  <span class="built_in">dmax</span>(mx_[z[p]], p);</span><br><span class="line">  <span class="built_in">dmin</span>(mn_[z[p]], mn[z[p]]);</span><br><span class="line">  <span class="built_in">dmin</span>(mn_[z[p]], p);</span><br><span class="line">  <span class="built_in">dmax</span>(now, mx_[z[p]] - mn_[z[p]]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">delL</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">  mx_[z[p]] = <span class="number">0</span>;</span><br><span class="line">  mn_[z[p]] = inf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i) &#123;</span><br><span class="line">    <span class="built_in">dmax</span>(mx_[z[i]], i);</span><br><span class="line">    <span class="built_in">dmin</span>(mn_[z[i]], i);</span><br><span class="line">    <span class="built_in">dmax</span>(ans, mx_[z[i]] - mn_[z[i]]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i)</span><br><span class="line">    mx_[z[i]] = <span class="number">0</span>, mn_[z[i]] = inf;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(mn_ + <span class="number">1</span>, <span class="number">0x3f</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) * N);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">1</span>, t, l, r; i &lt;= num &amp;&amp; j &lt;= M; ++i) &#123;</span><br><span class="line">    <span class="built_in">memset</span>(mx + <span class="number">1</span>, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) * N);</span><br><span class="line">    <span class="built_in">memset</span>(mn + <span class="number">1</span>, <span class="number">0x3f</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>) * N);</span><br><span class="line">    r = R[i];</span><br><span class="line">    now = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; bel[q[j].l] == i; ++j) &#123;</span><br><span class="line">      <span class="keyword">if</span> (q[j].r &lt; r) &#123;</span><br><span class="line">        ans[q[j].id] = <span class="built_in">solve</span>(q[j].l, q[j].r);</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      l = R[i] + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">while</span> (r &lt; q[j].r) <span class="built_in">addR</span>(++r);</span><br><span class="line">      t = now;</span><br><span class="line">      <span class="keyword">while</span> (l &gt; q[j].l) <span class="built_in">addL</span>(--l);</span><br><span class="line">      ans[q[j].id] = now, now = t;</span><br><span class="line">      <span class="keyword">while</span> (l &lt;= R[i]) <span class="built_in">delL</span>(l++);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="CF1285D-Dr-Evil-Underscores"><a href="#CF1285D-Dr-Evil-Underscores" class="headerlink" title="CF1285D Dr. Evil Underscores"></a><a href="http://codeforces.com/problemset/problem/1285/D">CF1285D Dr. Evil Underscores</a></h3><h4 id="problem-10"><a href="#problem-10" class="headerlink" title="problem"></a>problem</h4><p>ç»™å‡º $n (1 \le n \le 10^5)$ ä¸ªæ•° $a_i (0 \le a_i \le 2^{30} - 1)$ï¼Œæ‰¾åˆ° $x$ ä½¿å¾— $\max_{i = 1}^n a_i \oplus x$ æœ€å°ã€‚æ±‚å‡ºè¿™ä¸ªæœ€å°å€¼ã€‚</p><h4 id="solution-11"><a href="#solution-11" class="headerlink" title="solution"></a>solution</h4><p><del>åŠ¨è„‘å­ä¼šä»¥ä¸ºæ˜¯äºŒåˆ†ï¼Œä½†è¿™æ˜¾ç„¶å°±æ˜¯ Trie å¤§æ°´é¢˜</del></p><p>å»ºå‡º 01-Trieï¼Œåœ¨ Trie ä¸Š dfsï¼ˆæ ‘å½¢ dpï¼‰ï¼š</p><ul><li>è®¾å½“å‰ç»“ç‚¹ä¸º $u$ï¼Œåœ¨æ•°å­—ä»ä½åˆ°é«˜ç¬¬ $c$ ä½</li><li>ä»¤ $s$ ä¸ºé€’å½’å¤„ç† $\mathrm{nxt}_{u, 0}$ ä¸ $\mathrm{nxt}_{u, 1}$ è¿”å›ç­”æ¡ˆçš„è¾ƒå°å€¼ã€‚</li><li>è‹¥ $u$ çš„ä¸¤ä¸ªå„¿å­éƒ½å­˜åœ¨ï¼Œåˆ™ç­”æ¡ˆä¸º $s + 2^c$ï¼Œå¦åˆ™ç­”æ¡ˆä¸º $s$ã€‚</li></ul><p>ä»£ç å¾ˆä¸‘ï¼Œå°±ä¸æ”¾äº†ã€‚</p><hr><h3 id="AGC004C-AND-Grid"><a href="#AGC004C-AND-Grid" class="headerlink" title="AGC004C AND Grid"></a><a href="https://agc004.contest.atcoder.jp/tasks/agc004_c#">AGC004C AND Grid</a></h3><h4 id="problem-11"><a href="#problem-11" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ªç½‘æ ¼å›¾ï¼Œæœ‰äº›ä½ç½®å·²ç»è¢«æ¶‚è‰²ã€‚è¦æ±‚æ„é€ ä¸¤ä¸ªç›¸åŒå¤§å°çš„ç½‘æ ¼å›¾ï¼Œå¹¶ä¸”åœ¨ä¸Šé¢æ¶‚è‰²ï¼Œéœ€è¦ä¿è¯é¢œè‰²å››è¿é€šï¼Œä¸”æ»¡è¶³è¿™ä¸¤ä¸ªç½‘æ ¼çš„æ¶‚è‰²éƒ¨åˆ†çš„é‡åˆä½ç½®æ°å¥½æ˜¯ç»™å®šçš„ç½‘æ ¼å›¾çš„æ¶‚è‰²ä½ç½®ã€‚é¢˜ç›®ä¿è¯è¾¹ç•Œä¸Šä¸ä¼šè¢«æ¶‚è‰²ã€‚</p><h4 id="solution-12"><a href="#solution-12" class="headerlink" title="solution"></a>solution</h4><p>ç»´æŠ¤ä¸¤ä¸ªç½‘æ ¼å›¾ï¼Œéƒ½åˆå§‹åŒ–ä¸ºåŸç½‘æ ¼å›¾ã€‚å°†ç¬¬ä¸€ä¸ªç½‘æ ¼å›¾çš„ç¬¬ä¸€åˆ—å’Œå¥‡æ•°è¡Œï¼ˆé™¤æœ€åä¸€åˆ—ï¼‰å…¨éƒ¨æŸ“è‰²ï¼›ç¬¬äºŒä¸ªç½‘æ ¼å›¾çš„æœ€åä¸€åˆ—å’Œå¶æ•°è¡Œï¼ˆé™¤ç¬¬ä¸€åˆ—ï¼‰å…¨éƒ¨æŸ“è‰²ã€‚</p><p>å®¹æ˜“æƒ³åˆ°è¿™æ ·æ˜¯å¯¹çš„ã€‚</p><hr><h3 id="æ•°åˆ—åˆ†å—å…¥é—¨-9"><a href="#æ•°åˆ—åˆ†å—å…¥é—¨-9" class="headerlink" title="æ•°åˆ—åˆ†å—å…¥é—¨ 9"></a><a href="https://loj.ac/problem/6285">æ•°åˆ—åˆ†å—å…¥é—¨ 9</a></h3><p>ğŸ´çš„ï¼Œæ²¡æƒ³åˆ°æˆ‘ä¸€ç›´å’•æ‰çš„æ•°åˆ—åˆ†å— 9 æ˜¯å›æ»šè«é˜Ÿæ¿å­ï¼ˆ</p><hr><h3 id="CF576C-Points-on-Plane"><a href="#CF576C-Points-on-Plane" class="headerlink" title="CF576C Points on Plane"></a><a href="http://codeforces.com/problemset/problem/576/C">CF576C Points on Plane</a></h3><h4 id="problem-12"><a href="#problem-12" class="headerlink" title="problem"></a>problem</h4><p>ç»™å‡º $n (1 \le n \le 10^6)$ ä¸ªç‚¹ $(x_i, y_i) (0 \le x_i, y_i \le 10^6)$ï¼Œæ±‚ä¸€ä¸ªæ’åˆ— $p$ï¼Œä½¿å¾— $\sum_{i = 2}^n |x_{p_i} - x_{p_{i - 1}}| + |y_{p_i} - y_{p_{i - 1}}| \le 2.5 \times 10^9$ã€‚</p><h4 id="solution-13"><a href="#solution-13" class="headerlink" title="solution"></a>solution</h4><p>ä¾æ®è«é˜Ÿçš„åˆ†å—æ€æƒ³è¿›è¡Œæ’åºï¼Œç®—ä¸€ä¸‹ä¼šå‘ç°è¿™æ ·æœ€å¤šä¼šè·³ $3 \times 10^9$ã€‚åŠ ä¸€ä¸ªå¥‡å¶æ’åºï¼Œæœ€å¤šå°±æˆäº† $2 \times 10^9$ï¼Œå¾ˆç¨³ã€‚</p><hr><h3 id="CF679A-Bear-and-Prime-100"><a href="#CF679A-Bear-and-Prime-100" class="headerlink" title="CF679A Bear and Prime 100"></a><a href="http://codeforces.com/problemset/problem/679/A">CF679A Bear and Prime 100</a></h3><p>å¤§æ°´é¢˜ï¼Œæ²¡å•¥å¥½è¯´çš„ã€‚è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€é“äº¤äº’é¢˜ã€‚</p><hr><h3 id="CF727C-Guess-the-Array"><a href="#CF727C-Guess-the-Array" class="headerlink" title="CF727C Guess the Array"></a><a href="http://codeforces.com/problemset/problem/727/C">CF727C Guess the Array</a></h3><p>ä¸€çœ¼ç§’ã€‚ä»è¿™é¢˜çŸ¥é“äº†å¯ä»¥ä¸€æ¬¡è¾“å‡ºè¿›è¡Œå¤šæ¬¡è¯¢é—®ï¼ˆåªéœ€åœ¨æœ€å flush ä¸€æ¬¡ï¼‰ï¼Œä¹Ÿå¯å°†å¤šæ¬¡è¯¢é—®çš„å›ç­”ä¸€èµ·è¯»å…¥ã€‚å¯ä»¥å…³åŒæ­¥ã€‚å¯ä»¥ <code>::tie</code>ã€‚</p><hr><h3 id="CF730B-Minimum-and-Maximum"><a href="#CF730B-Minimum-and-Maximum" class="headerlink" title="CF730B Minimum and Maximum"></a><a href="http://codeforces.com/problemset/problem/730/B">CF730B Minimum and Maximum</a></h3><h4 id="problem-13"><a href="#problem-13" class="headerlink" title="problem"></a>problem</h4><p>è¿™æ˜¯ä¸€é“äº¤äº’é¢˜ã€‚è¾“å…¥æœ‰ $T (1 \le T \le 1000)$ ç»„æ•°æ®ã€‚</p><p>æœ‰ä¸€ä¸ªé•¿åº¦ä¸º $n (1 \le n \le 50)$ çš„åºåˆ—ï¼Œä½ éœ€è¦æ±‚å‡ºæœ€å°æ•°å’Œæœ€å¤§æ•°çš„ç¼–å·ã€‚æ¯æ¬¡å¯ä»¥è¯¢é—®åºåˆ—ä¸­ä¸¤ä¸ªæ•°çš„ç›¸å¯¹å¤§å°ï¼Œæœ€å¤šå¯ä»¥è¯¢é—® $\lceil \frac{3n}{2} \rceil - 2$ æ¬¡ã€‚</p><h4 id="solution-14"><a href="#solution-14" class="headerlink" title="solution"></a>solution</h4><p>æœ´ç´ çš„æƒ³æ³•æ˜¯æŠŠåºåˆ— $O(n)$ åœ°æ‰«ä¸€éã€‚è¿™æ ·çš„æ¯”è¾ƒæ¬¡æ•°æ˜¯ $2n - 2$ï¼Œä¼šè¶…è¿‡é™åˆ¶ã€‚ä¼˜åŒ–å¾ˆç®€å•ï¼šæ¯æ¬¡å–ç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ æ¯”è¾ƒå¤§å°ï¼Œå†åˆ†åˆ«å°†è¾ƒå¤§è€…ä¸å½“å‰çš„æœ€å¤§å€¼æ¯”è¾ƒï¼›å°†è¾ƒå°è€…ä¸å½“å‰çš„æœ€å°å€¼æ¯”è¾ƒã€‚è¿™æ ·å°†åŸå…ˆ $4$ æ¬¡çš„è¯¢é—®ä¼˜åŒ–æˆäº† $3$ æ¬¡ï¼Œæ°å¥½ç¬¦åˆè¦æ±‚ã€‚</p><h4 id="code-8"><a href="#code-8" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> c;</span><br><span class="line">  cout &lt;&lt; <span class="string">&#x27;?&#x27;</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; u &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; v &lt;&lt; endl;</span><br><span class="line">  cin &gt;&gt; c;</span><br><span class="line">  <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> T, N, mx, mn;</span><br><span class="line">  <span class="keyword">for</span> (cin &gt;&gt; T; T; --T) &#123;</span><br><span class="line">    cin &gt;&gt; N;</span><br><span class="line">    <span class="keyword">if</span> (N &amp; <span class="number">1</span>) mx = mn = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">ask</span>(<span class="number">1</span>, <span class="number">2</span>) == <span class="string">&#x27;&lt;&#x27;</span>) mn = <span class="number">1</span>, mx = <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">else</span> mn = <span class="number">2</span>, mx = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span> - (N &amp; <span class="number">1</span>), u, v; i &lt;= N; i += <span class="number">2</span>) &#123;</span><br><span class="line">      u = i, v = i + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">ask</span>(u, v) == <span class="string">&#x27;&gt;&#x27;</span>) std::<span class="built_in">swap</span>(u, v);</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">ask</span>(u, mn) == <span class="string">&#x27;&lt;&#x27;</span>) mn = u;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">ask</span>(v, mx) == <span class="string">&#x27;&gt;&#x27;</span>) mx = v;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&#x27;!&#x27;</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; mn &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; mx &lt;&lt; endl;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="CF750F-New-Year-and-Finding-Roots"><a href="#CF750F-New-Year-and-Finding-Roots" class="headerlink" title="CF750F New Year and Finding Roots"></a><a href="http://codeforces.com/problemset/problem/750/F">CF750F New Year and Finding Roots</a></h3><p>ä¸€ä¸Šåˆæ²¡åšå‡ºæ¥ï¼Œæˆ‘æ˜¯å‚»é€¼ã€‚</p><hr><h3 id="CF896B-Ithea-Plays-With-Chtholly"><a href="#CF896B-Ithea-Plays-With-Chtholly" class="headerlink" title="CF896B Ithea Plays With Chtholly"></a><a href="http://codeforces.com/problemset/problem/896/B">CF896B Ithea Plays With Chtholly</a></h3><p>æˆ‘è§‰å¾—è¿™é¢˜ç¿»è¯‘â‘§å¤ªå¯¹åŠ²ï¼Œæ‰€ä»¥æˆ‘ä¸ä¼šåšï¼Œä¹Ÿæƒ³ä¸åˆ°é¢˜è§£ä¸ºå•¥æ˜¯å¯¹çš„ï¼ˆ</p><hr><h3 id="P2153-SDOI2009-æ™¨è·‘"><a href="#P2153-SDOI2009-æ™¨è·‘" class="headerlink" title="P2153 [SDOI2009]æ™¨è·‘"></a><a href="https://www.luogu.com.cn/problem/P2153">P2153 [SDOI2009]æ™¨è·‘</a></h3><h4 id="problem-14"><a href="#problem-14" class="headerlink" title="problem"></a>problem</h4><p>æœ‰ä¸€ä¸ª $N$ ä¸ªç‚¹ $M$ æ¡è¾¹çš„æœ‰å‘å›¾ã€‚æ‰¾å‡ºè‹¥å¹²æ¡ $1 \sim N$ çš„äº’ä¸ç›¸äº¤è·¯å¾„ï¼Œä½¿å¾—è¿™äº›è·¯å¾„æ¡æ•°å°½é‡å¤šä¸”æ€»é•¿åº¦å°½é‡çŸ­ã€‚s</p><h4 id="solution-15"><a href="#solution-15" class="headerlink" title="solution"></a>solution</h4><p><del>æœ‰é™åˆ¶æ¡ä»¶çš„æœ€çŸ­è·¯ï¼Œæ˜¾ç„¶æ˜¯ç½‘ç»œæµã€‚</del>å¯¹äºæ¯ä¸ªç‚¹åªèƒ½ç»è¿‡ä¸€æ¬¡çš„é™åˆ¶æ¡ä»¶ï¼Œé€šè¿‡æ‹†ç‚¹è§£å†³ã€‚</p><p>å¯¹æ¯ä¸ªç‚¹æ‹†ç‚¹ $i, iâ€™$ï¼Œè¿è¾¹ $(i, iâ€™, 1, 0)$ï¼›å¯¹äºåŸå›¾ä¸­çš„è¾¹ $(u, v, w)$ï¼Œè¿è¾¹ $(u, v, 1, w)$ï¼Œè¶…çº§æºã€æ±‡åˆ†åˆ«ä¸º $1â€™, N$ï¼Œè·‘æœ€å°è´¹ç”¨æœ€å¤§æµå³å¯ã€‚</p><hr><h3 id="å¤ä¹ ä¸“é¢˜"><a href="#å¤ä¹ ä¸“é¢˜" class="headerlink" title="å¤ä¹ ä¸“é¢˜"></a>å¤ä¹ ä¸“é¢˜</h3><p>è¿™éƒ¨åˆ†æ˜¯ fa_555 çš„å¤ä¹ ã€‚ä¸å¯¹å¤–å…¬å¸ƒã€‚</p><p>è§ <code>_workspace\review\</code> ç›®å½•ä¸‹ <code>Treap.cpp</code>, <code>FHQ-Treap.cpp</code>, <code>FHQ-Treap2.cpp</code>, <code>Splay.cpp</code>, <code>Miller_Rabin.cpp</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2020 Jan Records</title>
      <link href="/2020/2020-Jan-Records/"/>
      <url>/2020/2020-Jan-Records/</url>
      
        <content type="html"><![CDATA[<p>èœé¸¡ fa_555 ä¼šæŠŠä¸€äº›åŠ¨æ€ç®€è¦åœ°è®°åœ¨è¿™é‡Œã€‚ä¸»è¦è¿˜æ˜¯ç•™ç»™è‡ªå·±ä»¥åçœ‹çš„ã€‚</p><span id="more"></span><p><em>æ‰€æœ‰ä»£ç ä¸ä¿è¯åŒ…æ‹¬æ— å…³ç´§è¦çš„éƒ¨åˆ†</em></p><hr><h3 id="é-OI"><a href="#é-OI" class="headerlink" title="é OI"></a>é OI</h3><p>ä¸€æœˆçš„å‰åŠæ®µä¸€ç›´åœ¨å‡†å¤‡æœŸæœ«è€ƒè¯•ã€‚æœŸæœ«è€ƒå¾—<strong>å¾ˆçƒ‚</strong>ã€‚</p><p>15 å·æ¥äº† qbxtã€‚</p><hr><h3 id="CF325D-Reclamation"><a href="#CF325D-Reclamation" class="headerlink" title="CF325D Reclamation"></a><a href="http://codeforces.com/problemset/problem/325/D">CF325D Reclamation</a></h3><h4 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h4><p>ç»™å®šä¸€ä¸ª $N \times M$ çš„<strong>ç¯å½¢</strong>ç½‘æ ¼å›¾ï¼ˆåœ†æŸ±çš„ä¾§é¢ï¼‰ã€‚</p><p>æŒ‰é¡ºåºç»™å‡º $K$ æ¬¡æ“ä½œï¼Œç¬¬ $i$ æ¬¡æ“ä½œä¼šé€‰ä¸­ä¸€ä¸ªæ ¼å­ $(x_i, y_i)$ã€‚å¦‚æœæŠŠè¿™ä¸ªæ ¼å­å˜æˆéšœç¢åï¼Œåœ†æŸ±çš„é¡¶é¢å’Œåº•é¢ä¾ç„¶ç›¸è¿é€šï¼Œé‚£ä¹ˆæŠŠè¿™ä¸ªæ ¼å˜æˆéšœç¢ã€‚</p><h4 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h4><p>è€ƒè™‘ç¯å½¢ï¼ŒæŠŠç½‘æ ¼æ¨ªå‘å¤åˆ¶ã€‚ç”¨å¹¶æŸ¥é›†ç»´æŠ¤ã€‚å¦‚æœä¸¤éƒ¨åˆ†ä¸­å¯¹åº”çš„ç‚¹åœ¨åŒä¸€ä¸ªé›†åˆä¸­ï¼Œåˆ™æ“ä½œä¸èƒ½æ‰§è¡Œã€‚</p><p>ç”±äº DSU éœ€è¦æ”¯æŒæ’¤é”€ï¼Œè·¯å¾„å‹ç¼©å¤±å»äº†æ­£ç¡®æ€§ã€‚ä¸ºäº†ä¿è¯å¤æ‚åº¦æ­£ç¡®ï¼ŒæŒ‰ç§©åˆå¹¶æ˜¯å¿…é¡»çš„ã€‚</p><h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><p>ç”±äºå¤ªé•¿æ—¶é—´æ²¡å†™ä»£ç ï¼Œsb fa_555 è¿™é¢˜å†™æŒ‚äº†å¥½å¤šåœ°æ–¹ã€‚</p><ul><li><p>æŒ‰ç§©åˆå¹¶ï¼Œé›†åˆå¤§å°è¦åˆå§‹åŒ–ï¼</p></li><li><p><code>std::bitset</code> çš„ä¸¤ç»´ä¸è¦å¼€åï¼</p></li></ul><p><del>è¿™ä»½ä»£ç ä¹Ÿæ˜¯æŠ„çš„ cf ä¸Šå¤–å›½å‹äººçš„</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* struct IO &#123; ... &#125; cin, cout; */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> dx[] = &#123;<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;, dy[] = &#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line">std::bitset&lt;6003&gt; vis[<span class="number">3003</span>];</span><br><span class="line"><span class="comment">// bitset ä¸¤ç»´å¤§å°å¼€åçœŸæ˜¯è‰äº†ï¼ˆ</span></span><br><span class="line"><span class="keyword">int</span> N, M, K, ans, top, U[<span class="number">19</span>], V[<span class="number">19</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> DSU &#123;</span><br><span class="line"><span class="comment">// è¿™ä¸ª DSU éœ€è¦æ”¯æŒæ’¤é”€ï¼Œä¸èƒ½è·¯å¾„å‹ç¼©ï¼</span></span><br><span class="line"><span class="comment">// ä¸ºäº†å¤æ‚åº¦æ­£ç¡®ï¼Œéœ€è¦æŒ‰ç§©åˆå¹¶</span></span><br><span class="line"><span class="keyword">int</span> fa[<span class="number">18000003</span>], siz[<span class="number">18000003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> u)</span></span>; <span class="comment">// æ— è·¯å¾„å‹ç¼©</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">  u = <span class="built_in">find</span>(u), v = <span class="built_in">find</span>(v);</span><br><span class="line">  <span class="keyword">if</span> (u == v) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span> (siz[u] &gt; siz[v]) std::<span class="built_in">swap</span>(u, v);</span><br><span class="line">  fa[u] = v, siz[v] += siz[u];</span><br><span class="line">  U[++top] = u, V[top] = v;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="comment">// DSU</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> DSU;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pos</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (M * (x - <span class="number">1</span>) &lt;&lt; <span class="number">1</span>) + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mark</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">  vis[x].<span class="built_in">set</span>(y);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>, p = <span class="built_in">pos</span>(x, y), nx, ny; k &lt; <span class="number">8</span>; ++k) &#123;</span><br><span class="line">    nx = x + dx[k], ny = y + dy[k];</span><br><span class="line">    <span class="keyword">if</span> (nx &lt; <span class="number">1</span> || nx &gt; N) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (ny &lt; <span class="number">1</span>) ny = M &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (ny &gt; M &lt;&lt; <span class="number">1</span>) ny = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (vis[nx][ny]) <span class="built_in">merge</span>(p, <span class="built_in">pos</span>(nx, ny));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin &gt;&gt; N &gt;&gt; M &gt;&gt; K;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N * M &lt;&lt; <span class="number">1</span>; ++i)</span><br><span class="line">    fa[i] = i, siz[i] = <span class="number">1</span>; <span class="comment">// åˆå§‹åŒ–ï¼</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> x, y; K; --K) &#123;</span><br><span class="line">    top = <span class="number">0</span>;</span><br><span class="line">    cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">    <span class="built_in">mark</span>(x, y), <span class="built_in">mark</span>(x, y + M);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">find</span>(<span class="built_in">pos</span>(x, y)) == <span class="built_in">find</span>(<span class="built_in">pos</span>(x, y + M))) &#123;</span><br><span class="line">      vis[x].<span class="built_in">reset</span>(y), vis[x].<span class="built_in">reset</span>(y + M);</span><br><span class="line">      <span class="keyword">do</span> &#123;</span><br><span class="line">        siz[V[top]] -= siz[U[top]];</span><br><span class="line">        fa[U[top]] = U[top];</span><br><span class="line">      &#125; <span class="keyword">while</span> (--top);</span><br><span class="line">    &#125; <span class="keyword">else</span> ++ans;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="P1456-Monkey-King"><a href="#P1456-Monkey-King" class="headerlink" title="P1456 Monkey King"></a><a href="https://www.luogu.com.cn/problem/P1456">P1456 Monkey King</a></h3><p>ç”¨æ¥å”¤é†’è®°å¿†çš„å·¦åæ ‘ä¾‹é¢˜ã€‚</p><h4 id="problem-1"><a href="#problem-1" class="headerlink" title="problem"></a>problem</h4><p>æœ‰ $N$ åªçŒ´å­ï¼Œåˆå§‹æ—¶ä»–ä»¬ä¸¤ä¸¤ä¸è®¤è¯†ï¼Œä¸”ç¬¬ $i$ åªçŒ´å­æœ‰ $a_i$ çš„æˆ˜æ–—åŠ›ã€‚æœ‰ $M$ ä¸ªäº‹ä»¶ä¼šå‘ç”Ÿï¼Œåœ¨ç¬¬ $i$ ä¸ªäº‹ä»¶ä¸­ï¼Œ$x_i, y_i$ ä¸¤åªçŒ´å­ä¼šå„è‡ªå«ä¸Šä»–ä»¬è®¤è¯†çš„çŒ´å­é‡Œæˆ˜æ–—åŠ›æœ€é«˜çš„æ‰“ä¸€æ¶ã€‚ä¸€æ¶ä¹‹åï¼Œä¸¤åªæˆ˜æ–—é‡Œæœ€é«˜çš„çŒ´å­çš„æˆ˜æ–—åŠ›ä¼šå„å‡å°ä¸€åŠï¼ˆå‘ä¸‹å–æ•´ï¼‰å¹¶äº’ç›¸è®¤è¯† <em><del>ä¸æ‰“ä¸ç›¸è¯†å˜›</del></em>ã€‚è®¤è¯†å…³ç³»å…·æœ‰ä¼ é€’æ€§ã€‚</p><h4 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h4><p>æ”¯æŒæ‰¾çˆ¹ã€æŸ¥è¯¢æœ€å¤§å€¼ã€ä¿®æ”¹å’Œåˆå¹¶ï¼Œ<del>ä¸€çœ‹å°±</del>æ˜¯å·¦åæ ‘ï¼</p><h4 id="code-1"><a href="#code-1" class="headerlink" title="code"></a>code</h4><p>ç›´æ¥çœ‹ä»£ç å§ã€‚å¥½å¥½çœ‹çœ‹æ¿å­å’Œä¿®æ”¹çš„æ“ä½œã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* struct IO &#123; ... &#125; cin, cout; */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> iarrN = <span class="keyword">int</span>[<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> DSU &#123;</span><br><span class="line">iarrN fa;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> u)</span></span>; <span class="comment">// æœ‰è·¯å¾„å‹ç¼©</span></span><br><span class="line">&#125; <span class="comment">// DSU</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> DSU;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> LTT &#123;</span><br><span class="line">iarrN ls, rs, dis, s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!p || !q) <span class="keyword">return</span> p + q;</span><br><span class="line">  <span class="keyword">if</span> (s[p] &lt; s[q])</span><br><span class="line">    std::<span class="built_in">swap</span>(p, q);</span><br><span class="line">  rs[p] = <span class="built_in">merge</span>(rs[p], q);</span><br><span class="line">  fa[rs[p]] = p;</span><br><span class="line">  <span class="keyword">if</span> (dis[ls[p]] &lt; dis[rs[p]])</span><br><span class="line">    std::<span class="built_in">swap</span>(ls[p], rs[p]);</span><br><span class="line">  dis[p] = dis[rs[p]] + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reduce</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// reduce the value of $p by half</span></span><br><span class="line">  s[p] &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">int</span> t = <span class="built_in">merge</span>(ls[p], rs[p]);</span><br><span class="line">  ls[p] = rs[p] = dis[p] = <span class="number">0</span>;</span><br><span class="line">  fa[t] = fa[p] = <span class="built_in">merge</span>(t, p);</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="comment">// LTT</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> LTT;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;N) != EOF) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">      ls[i] = rs[i] = dis[i] = <span class="number">0</span>;</span><br><span class="line">      fa[i] = i;</span><br><span class="line">      cin &gt;&gt; s[i];</span><br><span class="line">    &#125;</span><br><span class="line">    cin &gt;&gt; M;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> u, v; M; --M) &#123;</span><br><span class="line">      cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">      u = <span class="built_in">find</span>(u), v = <span class="built_in">find</span>(v);</span><br><span class="line">      <span class="keyword">if</span> (u == v) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&#x27;-&#x27;</span> &lt;&lt; <span class="string">&#x27;1&#x27;</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">reduce</span>(u), <span class="built_in">reduce</span>(v);</span><br><span class="line">      fa[fa[u]] = fa[fa[v]] = <span class="built_in">merge</span>(fa[u], fa[v]);</span><br><span class="line">      cout &lt;&lt; s[<span class="built_in">find</span>(u)] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  cout.<span class="built_in">flush</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="UVA11419-SAM-I-AM"><a href="#UVA11419-SAM-I-AM" class="headerlink" title="UVA11419 SAM I AM"></a><a href="https://www.luogu.com.cn/problem/UVA11419">UVA11419 SAM I AM</a></h3><p><em>ç”±äº UVa åœ¨å›½å†…ç½‘ç»œç¯å¢ƒé€Ÿåº¦è¿‡äºéš¾å—ï¼Œé“¾æ¥ç”¨äº†è°·</em></p><h4 id="problem-2"><a href="#problem-2" class="headerlink" title="problem"></a>problem</h4><p>$N \times M$ çš„ç½‘æ ¼å›¾ï¼Œ$K$ ä¸ªç‚¹ $(x_i, y_i)$ ä¸­æœ‰éšœç¢ã€‚ä¸€é¢—ç‚®å¼¹å¯ä»¥æ‘§æ¯ä¸€æ•´è¡Œ/ä¸€æ•´åˆ—çš„éšœç¢ã€‚æ±‚è‡³å°‘å‡ é¢—ç‚®å¼¹å¯ä»¥æ‘§æ¯æ‰€æœ‰çš„éšœç¢ã€‚</p><h4 id="solution-2"><a href="#solution-2" class="headerlink" title="solution"></a>solution</h4><p>äºŒåˆ†å›¾è£¸é¢˜ï¼Œä¸è¿‡æˆ‘åªæƒ³å†™ç½‘ç»œæµã€‚å¯¹äºç‚¹ $(x, y)$ï¼Œè¿è¾¹ $(S, x_L, 1), (x_L, y_R, \mathrm{inf}), (y_R, T, 1)$ï¼Œç­”æ¡ˆå³ä¸ºæœ€å°ç‚¹è¦†ç›–ï¼ˆæœ€å¤§æµï¼‰ã€‚</p><p>éš¾çš„æ˜¯<strong>è¾“å‡ºæ–¹æ¡ˆ</strong>ã€‚æˆ‘ä»¬å‘ç°ï¼Œå¯¹äº å·¦ä¾§æ‰€æœ‰å…¥è¾¹æ»¡æµçš„ç‚¹ ä¸ ä¸å·¦ä¾§ä¸æ»¡æµçš„ç‚¹ç›¸è¿çš„å³ä¾§çš„ç‚¹ éœ€è¦è®¡å…¥ç­”æ¡ˆã€‚</p><h4 id="code-2"><a href="#code-2" class="headerlink" title="code"></a>code</h4><p>ç”¨äº†é¢˜è§£çš„ä¸€ä¸ªå° trickï¼šåªå»ºéœ€è¦çš„è¾¹ã€‚æ­¤å¤–ï¼Œ<code>memset</code> å’Œ <code>memcpy</code> ç›´æ¥ç®—äº†å†…å­˜å¤§å°ï¼Œä¸å»ºè®®åƒæˆ‘ä¸€æ · <code>&lt;&lt; 2</code>ï¼Œè‡³å°‘ä¹Ÿè¦ <code>* sizeof(int)</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* struct IO &#123; ... &#125; cin; */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> iarrN = <span class="keyword">int</span>[<span class="number">2013</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line">std::bitset&lt;2013&gt; ex, vis;</span><br><span class="line"><span class="keyword">int</span> N, M, K, S, T, tot;</span><br><span class="line">iarrN cur, dep, head;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> nxt, to, w;</span><br><span class="line">&#125; e[<span class="number">6000003</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _aE(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w);</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  tot = <span class="number">1</span>, S = <span class="number">0</span>, T = N + M + <span class="number">1</span>;</span><br><span class="line">  ex.<span class="built_in">reset</span>(), vis.<span class="built_in">reset</span>();</span><br><span class="line">  <span class="built_in">memset</span>(head, <span class="number">0</span>, (N + M + <span class="number">2</span>) &lt;&lt; <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x, y; i &lt;= K; ++i) &#123;</span><br><span class="line">    cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">    <span class="built_in">addEdge</span>(x, y + N, inf);</span><br><span class="line">    <span class="keyword">if</span> (!ex[x]) <span class="built_in">addEdge</span>(S, x, <span class="number">1</span>), ex.<span class="built_in">set</span>(x);</span><br><span class="line">    <span class="keyword">if</span> (!ex[y + N]) <span class="built_in">addEdge</span>(y + N, T, <span class="number">1</span>), ex.<span class="built_in">set</span>(y + N);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* dinic: returns maxflow */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mark</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123; <span class="comment">// dfs</span></span><br><span class="line">  vis.<span class="built_in">set</span>(u);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; i; i = e[i].nxt)</span><br><span class="line">    <span class="keyword">if</span> (e[i].w &amp;&amp; !vis[e[i].to])</span><br><span class="line">      <span class="built_in">mark</span>(e[i].to);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (cin &gt;&gt; N &gt;&gt; M &gt;&gt; K, N) &#123;</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    std::cout &lt;&lt; <span class="built_in">dinic</span>(S, T);</span><br><span class="line">    <span class="built_in">mark</span>(S);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">      <span class="keyword">if</span> (ex[i] &amp;&amp; !vis[i])</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot; r&quot;</span> &lt;&lt; i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = N + <span class="number">1</span>; i &lt;= N + M; ++i)</span><br><span class="line">      <span class="keyword">if</span> (ex[i] &amp;&amp; vis[i])</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot; c&quot;</span> &lt;&lt; i - N;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="FJOI2007-è½®çŠ¶ç—…æ¯’"><a href="#FJOI2007-è½®çŠ¶ç—…æ¯’" class="headerlink" title="[FJOI2007]è½®çŠ¶ç—…æ¯’"></a><a href="https://www.luogu.com.cn/problem/P2144">[FJOI2007]è½®çŠ¶ç—…æ¯’</a></h3><p><del>åšé“åº”æ™¯çš„é¢˜</del></p><h4 id="solution-Luogu-WJiannan"><a href="#solution-Luogu-WJiannan" class="headerlink" title="solution (Luogu @WJiannan)"></a><a href="https://steaunk.blog.luogu.org/solution-p2144">solution (Luogu @WJiannan)</a></h4><p>æŠ„äº†é¢˜è§£è¿˜æ²¡çœ‹æ‡‚/kkï¼Œå¤è¯»ä¸€éå§ã€‚</p><blockquote><p>è€ƒè™‘æŠŠå…ˆä¸ç®¡ä¸­å¿ƒç‚¹ï¼Œç„¶åæŠŠå¤–å›´çš„ $n$ ä¸ªç‚¹æ‹†ç¯æˆé“¾ï¼Œæš‚æ—¶å¼ºåˆ¶ç¬¬ä¸€ä¸ªç‚¹ä¸èƒ½å’Œæœ€åä¸€ä¸ªç‚¹è¿è¾¹ã€‚</p><p>äºæ˜¯æ–¹æ¡ˆæ•°å°±ç±»ä¼¼ä¸€ä¸ªæ•´æ•°æ‹†åˆ†ï¼Œå°†å¤–å›´çš„ç‚¹åˆ†æˆè‹¥å¹²ä¸ªè”é€šå—ï¼Œ</p><p>å³è®¾ $f_i$ ä¸ºå½“å‰å·²ç»åˆ†é…äº†å‰ $i$ ä¸ªç‚¹çš„æ–¹æ¡ˆæ•°ï¼Œ$f_i = \sum_{j=1}^{i} f_{i-j} \times j$ï¼ˆå› ä¸ºæ¯åŠ å…¥ä¸€ä¸ªè”é€šå—ï¼Œä¸­å¿ƒç‚¹éƒ½å¯ä»¥å‘å…¶ä¸­çš„ä»»æ„ä¸€ä¸ªç‚¹è¿è¾¹ï¼‰ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘ä¸Šç¬¬ä¸€ä¸ªç‚¹ä¸æœ€åä¸€ä¸ªç‚¹è¿è¾¹çš„æƒ…å†µï¼Œå‘ç°ï¼Œå¦‚æœåˆ†é…ç¬¬ä¸€ä¸ªè”é€šå—å¤§å°ä¸º $x$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠè¿™å¼ å›¾é€†æ—¶é’ˆæ—‹è½¬ï¼Œåˆ™æ€»å…±æœ‰ $x$ ç§ä¸åŒçš„æ–¹æ¡ˆã€‚</p><p>äºæ˜¯ç­”æ¡ˆçš„è®¡ç®—æ–¹å¼å°±ç­‰äº</p><script type="math/tex; mode=display">f_i = \sum_{j = 1}^{i - 1} f_{i - j} \times j + f_0 \times i^2</script></blockquote><p>é«˜ç²¾åº¦è§†ä¸º $O(1)$ï¼Œæ€»å¤æ‚åº¦ $O(n^2)$ã€‚</p><h4 id="code-3"><a href="#code-3" class="headerlink" title="code"></a>code</h4><p>é«˜ç²¾åº¦å†™å¾—å¥‡ä¸‘æ— æ¯”ï¼Œä¸æ”¾äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* struct BigInteger &#123; ... &#125; f[103]; */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  std::cin &gt;&gt; N;</span><br><span class="line">  f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; ++j)</span><br><span class="line">    f[j] = f[j] + f[<span class="number">0</span>] * (j * j);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; i + j &lt;= N; ++j)</span><br><span class="line">      f[i + j] = f[i + j] + f[i] * j;</span><br><span class="line">  std::cout &lt;&lt; f[N];</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="APIO2012-æ´¾é£"><a href="#APIO2012-æ´¾é£" class="headerlink" title="[APIO2012]æ´¾é£"></a><a href="https://www.luogu.com.cn/problem/P1552">[APIO2012]æ´¾é£</a></h3><h4 id="solution-Luogu-amazingOZR"><a href="#solution-Luogu-amazingOZR" class="headerlink" title="solution (Luogu @amazingOZR)"></a><a href="https://www.luogu.com.cn/blog/user13180/solution-p1552">solution (Luogu @amazingOZR)</a></h4><p>è‡ªå·±æ²¡æƒ³å‡ºæ¥ã€‚è´´ä¸€ä¸‹æŠ„çš„é¢˜è§£ï¼Œé¡ºä¾¿ä¿®ä¸€ä¸‹æ ¼å¼ã€‚</p><p>æ˜æ˜¾é¢†å¯¼å…³ç³»å½¢æˆä¸€æ£µæ ‘ï¼Œåˆ™ç­”æ¡ˆä¸º $ans = max \{L_u \times k \}$ï¼Œå…¶ä¸­ $k$ ä»£è¡¨ä»¥ $u$ ä¸ºæ ¹çš„å­æ ‘ä¸­é€‰å‡ºçš„èŠ‚ç‚¹æ•°ä¸ªæ•°ï¼ˆè®¾è¿™äº›èŠ‚ç‚¹ä¸º $v_1, v_2, \cdots, v_k$ï¼‰ä¸”æœ‰ $\sum_{i = 1}^{k} C_{v_i} \leq M$ã€‚</p><p>æ‰€ä»¥ä»¥æ¯ä¸ªèŠ‚ç‚¹å»ºä¸€ä¸ªå¤§æ ¹å †ï¼Œç»´æŠ¤è–ªæ°´å€¼ã€‚åˆå§‹æ—¶è‹¥è‡ªå·±æ»¡è¶³æ¡ä»¶å°±é€‰è‡ªå·±ï¼Œå¦åˆ™ä¸é€‰ã€‚ä»å¶å­èŠ‚ç‚¹å¾€ä¸Šæ¨ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œå°†å®ƒä¸å®ƒçš„å„¿å­èŠ‚ç‚¹åˆå¹¶ã€‚å¦‚æœå½“å‰çš„é€‰æ‹©è´¹ç”¨è¶…å‡ºäº† $M$ï¼Œå°±å¼¹å‡ºå †é‡Œæœ€å¤§çš„ï¼Œä¸€ç›´åˆ°ä¸è¶…è¿‡ $M$ ä¸ºæ­¢ã€‚åŠ¨æ€ç»´æŠ¤å½“å‰é€‰æ‹©çš„èŠ‚ç‚¹æ•° <code>num</code> å’Œé€‰æ‹©è´¹ç”¨ <code>sum</code> å³å¯ã€‚</p><p>æ€»å¤æ‚åº¦ $O(n \log n)$ï¼ˆä¸å¤§ä¼šè¯ /wqï¼‰ã€‚</p><h4 id="code-4"><a href="#code-4" class="headerlink" title="code"></a>code</h4><p>å­¦ä¼šåšæ³•ï¼Œä»£ç å€’æ˜¯æŒºç®€å•<del>ï¼Œä¹Ÿæ˜¯æŠ„çš„é¢˜è§£ã€‚ä¸è¿‡è‡ªå·±å»äº†å»ç³Ÿç²•</del>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* struct IO &#123; ... &#125; cin; */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> iarrN = <span class="keyword">int</span>[<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, tot;</span><br><span class="line">iarrN head, L;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> nxt, to;</span><br><span class="line">&#125; e[<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> LTT &#123;</span><br><span class="line">iarrN rt, ls, rs, dis, s, cnt, sum;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!p || !q) <span class="keyword">return</span> p + q;</span><br><span class="line">  <span class="keyword">if</span> (s[p] &lt; s[q]) std::<span class="built_in">swap</span>(p, q);</span><br><span class="line">  rs[p] = <span class="built_in">merge</span>(rs[p], q);</span><br><span class="line">  <span class="keyword">if</span> (dis[ls[p]] &lt; dis[rs[p]])</span><br><span class="line">    std::<span class="built_in">swap</span>(ls[p], rs[p]);</span><br><span class="line">  dis[p] = dis[rs[p]] + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="comment">// LTT</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> LTT;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u; i &lt;= N; ++i) &#123;</span><br><span class="line">    cin &gt;&gt; u &gt;&gt; s[i] &gt;&gt; L[i];</span><br><span class="line">    <span class="built_in">addEdge</span>(u, i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i, u = N, v; u; --u) &#123;</span><br><span class="line">    rt[u] = u, cnt[u] = <span class="number">1</span>;</span><br><span class="line">    sum[u] = s[u];</span><br><span class="line">    <span class="keyword">for</span> (i = head[u]; i; i = e[i].nxt) &#123;</span><br><span class="line">      rt[u] = <span class="built_in">merge</span>(rt[u], rt[v = e[i].to]);</span><br><span class="line">      sum[u] += sum[v], cnt[u] += cnt[v];</span><br><span class="line">      <span class="keyword">while</span> (sum[u] &gt; M) &#123;</span><br><span class="line">        sum[u] -= s[rt[u]], --cnt[u];</span><br><span class="line">        rt[u] = <span class="built_in">merge</span>(ls[rt[u]], rs[rt[u]]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = std::<span class="built_in">max</span>(ans, <span class="number">1ll</span> * L[u] * cnt[u]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="JSOI2010-æ»¡æ±‰å…¨å¸­"><a href="#JSOI2010-æ»¡æ±‰å…¨å¸­" class="headerlink" title="[JSOI2010]æ»¡æ±‰å…¨å¸­"></a><a href="https://www.luogu.com.cn/problem/P4171">[JSOI2010]æ»¡æ±‰å…¨å¸­</a></h3><p>2-SAT æ¨¡æ¿é¢˜ã€‚</p><h4 id="solution-3"><a href="#solution-3" class="headerlink" title="solution"></a>solution</h4><p>æŠŠæ¯ç§ææ–™æ‹†æˆä¸¤ä¸ªç‚¹ã€‚</p><p>æ¯ç»„çš„ä¸¤ä¸ªé™åˆ¶éƒ½æ˜¯<strong>æˆ–</strong>çš„å½¢å¼ï¼šå¦‚æœä¸æ»¡è¶³å…¶ä¸­ä¸€ä¸ªé™åˆ¶ï¼Œåˆ™å¿…é¡»æ»¡è¶³å¦å¤–ä¸€ä¸ªé™åˆ¶ã€‚</p><p>æœ€åæ£€éªŒä¸€ä¸‹æ¯ç§ææ–™çš„ä¸¤ä¸ªç‚¹æ˜¯å¦<strong>ä¸åœ¨</strong>åŒä¸€ä¸ª SCC å†…ï¼ˆåˆæ³•ï¼‰ã€‚</p><p>æ€»å¤æ‚åº¦ $O(Tn)$ï¼Œ$T$ ä¸ºæ•°æ®ç»„æ•°ã€‚</p><h4 id="code-5"><a href="#code-5" class="headerlink" title="code"></a>code</h4><p>ä¸»è¦çœ‹çœ‹ tarjanã€‚</p><p>æŠŠæ¯ç§ææ–™ <code>i</code> æ‹†æˆä¸¤ä¸ªç‚¹ï¼š<code>i &lt;&lt; 1</code> ä»£è¡¨ <code>i</code> çš„æ»¡å¼åšæ³•ï¼Œ<code>i &lt;&lt; 1 | 1</code> ä»£è¡¨ <code>i</code> çš„æ±‰å¼åšæ³•ï¼Œæœ€ç»ˆç»“ç‚¹çš„å€¼åŸŸä¸º <code>[2, N &lt;&lt; 1 | 1]</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* struct IO &#123; ... &#125; cin; */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dmin</span><span class="params">(<span class="keyword">int</span> &amp;m, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n &lt; m) m = n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> iarr2N = <span class="keyword">int</span>[<span class="number">203</span>];</span><br><span class="line"></span><br><span class="line">std::bitset&lt;203&gt; vis;</span><br><span class="line"><span class="keyword">int</span> T, N, M, tot, top, dft, cntSCC;</span><br><span class="line">iarr2N head, s, dfn, low, bel;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> nxt, to;</span><br><span class="line">&#125; e[<span class="number">2003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cntSCC = tot = dft = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(dfn, <span class="number">0</span>, <span class="keyword">sizeof</span> dfn);</span><br><span class="line">  <span class="built_in">memset</span>(head, <span class="number">0</span>, <span class="keyword">sizeof</span> head);</span><br><span class="line"></span><br><span class="line">  cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">  <span class="keyword">char</span> u_, v_;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> u, v; M; --M) &#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªå»ºå›¾å¯ä»¥çœ‹ä¸€ä¸‹å—·</span></span><br><span class="line">    cin &gt;&gt; u_ &gt;&gt; u &gt;&gt; v_ &gt;&gt; v;</span><br><span class="line">    u &lt;&lt;= <span class="number">1</span>, v &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">addEdge</span>(u | (u_ == <span class="string">&#x27;m&#x27;</span>), v | (v_ == <span class="string">&#x27;h&#x27;</span>));</span><br><span class="line">    <span class="built_in">addEdge</span>(v | (v_ == <span class="string">&#x27;m&#x27;</span>), u | (u_ == <span class="string">&#x27;h&#x27;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> u)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (cin &gt;&gt; T; T; --T) &#123;</span><br><span class="line">    <span class="keyword">bool</span> f = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= (N &lt;&lt; <span class="number">1</span> | <span class="number">1</span>); ++i)</span><br><span class="line">      <span class="keyword">if</span> (!dfn[i]) <span class="built_in">tarjan</span>(i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">      <span class="keyword">if</span> (bel[i &lt;&lt; <span class="number">1</span>] == bel[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) &#123;</span><br><span class="line">        f = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    std::cout &lt;&lt; (f ? <span class="string">&quot;BAD&quot;</span> : <span class="string">&quot;GOOD&quot;</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="POJ2976-Dropping-tests"><a href="#POJ2976-Dropping-tests" class="headerlink" title="POJ2976 Dropping tests"></a><a href="http://poj.org/problem?id=2976">POJ2976 Dropping tests</a></h3><p>01 åˆ†æ•°è§„åˆ’æ¨¡æ¿é¢˜ã€‚</p><p>æ²¡å±Šåˆ°è¿™ä¸ªç®—æ³•è·Ÿåå­—æœ‰ä»€ä¹ˆå…³ç³»ï¼Œç”šè‡³ä¹Ÿæ²¡å±Šåˆ°è¿™æ˜¯ä¸ªä»€ä¹ˆç®—æ³•ï¼ˆ</p><h4 id="problem-3"><a href="#problem-3" class="headerlink" title="problem"></a>problem</h4><p>ç»™å‡º $n$ ç»„ $a, b$ï¼Œé€‰å‡ºå…¶ä¸­ $n - k$ ç»„ï¼Œä½¿å¾— $\frac{\sum a}{\sum b}$ æœ€å¤§ã€‚</p><h4 id="solution-4"><a href="#solution-4" class="headerlink" title="solution"></a>solution</h4><p>é¢˜ç›®è¦æ±‚ $\frac{\sum a}{\sum b} \ge x$ï¼Œå³ $\sum (a - x b) \ge 0$ ä¸­ $x$ çš„æœ€å¤§å€¼ã€‚</p><p>äºŒåˆ† $x$ï¼ŒæŠŠ $a_i - x b_i$ æ’åºï¼Œåˆ¤æ–­æœ€å¤§çš„ $n - k$ çš„å’Œæ˜¯å¦å¤§äºç­‰äº 0 å³å¯ã€‚</p><p>æ€»å¤æ‚åº¦ $O(n \log r)$ï¼Œ$r$ ä¸ºç­”æ¡ˆå€¼åŸŸå¤§å°ã€‚</p><p>ä»£ç è¿‡ä¸‘ï¼Œä¸æ”¾äº†ã€‚</p><hr><h3 id="P1642-è§„åˆ’"><a href="#P1642-è§„åˆ’" class="headerlink" title="P1642 è§„åˆ’"></a><a href="https://www.luogu.com.cn/problem/P1642">P1642 è§„åˆ’</a></h3><p>01 åˆ†æ•°è§„åˆ’æ¨¡æ¿é¢˜ã€‚</p><h4 id="problem-4"><a href="#problem-4" class="headerlink" title="problem"></a>problem</h4><p>$N$ ä¸ªç»“ç‚¹çš„æ ‘ï¼Œæ¯ä¸ªç»“ç‚¹ $i$ æœ‰ä¸¤ä¸ªå€¼ $a_i, b_i$ï¼Œåˆ å»å…¶ä¸­ $K$ ä¸ªç»“ç‚¹ï¼Œä½¿å¾—å‰©ä½™ç»“ç‚¹çš„ $\frac{\sum a_i}{\sum b_i}$ æœ€å¤§ã€‚</p><h4 id="solution-5"><a href="#solution-5" class="headerlink" title="solution"></a>solution</h4><p>é¦–å…ˆæŠŠ<em>åˆ é™¤ $K$ ä¸ªç‚¹</em>è½¬åŒ–ä¸º<em>ç•™ä¸‹ $N - K$ ä¸ªç‚¹</em>ï¼Œ<del>é‚£å®ƒé•¿å¾—å°±è·Ÿä¸ª 01 åˆ†æ•°è§„åˆ’ä¼¼çš„ã€‚</del>è€ƒè™‘äºŒåˆ†è¿™ä¸ªæœ€å¤§å€¼ï¼Œå¯ä»¥é€šè¿‡ä¸€æ¬¡æ ‘å½¢ dp <code>check</code>ã€‚</p><p>è®¾ <code>f[u][i]</code> ä¸ºä»¥ <code>u</code> ä¸ºæ ¹çš„å­æ ‘ä¸­<strong>æœ‰ä¸€ä¸ªåŒ…å« <code>u</code> ä¸” <code>siz = i</code> çš„è¿é€šå—</strong>æ—¶çš„æœ€å¤§å€¼ã€‚é‚£ä¹ˆè½¬ç§»æ–¹ç¨‹ä¸º</p><script type="math/tex; mode=display">f_{u, i} = \max\{f_{u, i - j} + f_{v, j}\}</script><p>å®ç°èµ·æ¥æœ‰äº›ç»†èŠ‚è¦æ³¨æ„ã€‚</p><h4 id="code-6"><a href="#code-6" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* struct IO &#123; ... &#125; cin; */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> iarrN = <span class="keyword">int</span>[<span class="number">103</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">double</span> eps = <span class="number">1e-4</span>, inf = <span class="number">1e9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, K, tot;</span><br><span class="line">iarrN head, siz, a, b;</span><br><span class="line"><span class="keyword">double</span> t[<span class="number">103</span>], f[<span class="number">103</span>][<span class="number">103</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> nxt, to;</span><br><span class="line">&#125; e[<span class="number">203</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">  f[u][<span class="number">0</span>] = <span class="number">0</span>, siz[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u], v; i; i = e[i].nxt) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((v = e[i].to) == fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(v, u);</span><br><span class="line">    siz[u] += siz[v];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = std::<span class="built_in">min</span>(siz[u], K); j; --j)</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= std::<span class="built_in">min</span>(siz[v], j); ++k)</span><br><span class="line">        f[u][j] = std::<span class="built_in">max</span>(f[u][j], f[u][j - k] + f[v][k]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = std::<span class="built_in">min</span>(siz[u], K); i; --i)</span><br><span class="line">    f[u][i] = f[u][i - <span class="number">1</span>] + t[u];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">double</span> mid)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    t[i] = a[i] - mid * b[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K; ++j)</span><br><span class="line">      f[i][j] = -inf;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    <span class="keyword">if</span> (f[i][K] &gt; -eps) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin &gt;&gt; N &gt;&gt; K;</span><br><span class="line">  K = N - K;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    cin &gt;&gt; a[i];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    cin &gt;&gt; b[i];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt; N; ++i) &#123;</span><br><span class="line">    cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">    <span class="built_in">addEdge</span>(u, v), <span class="built_in">addEdge</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">double</span> l = <span class="number">0</span>, r = <span class="number">10000</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">double</span> mid; r - l &gt; eps; ) &#123;</span><br><span class="line">    mid = (l + r) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">check</span>(mid)) l = mid;</span><br><span class="line">    <span class="keyword">else</span> r = mid;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%.1lf&quot;</span>, r);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="P3709-å¤§çˆ·çš„å­—ç¬¦ä¸²é¢˜"><a href="#P3709-å¤§çˆ·çš„å­—ç¬¦ä¸²é¢˜" class="headerlink" title="P3709 å¤§çˆ·çš„å­—ç¬¦ä¸²é¢˜"></a><a href="https://www.luogu.com.cn/problem/P3709">P3709 å¤§çˆ·çš„å­—ç¬¦ä¸²é¢˜</a></h3><blockquote><p>è¿™ä¸ªé¢˜å……åˆ†è€ƒå¯Ÿäº†å¤§å®¶çš„è¯­æ–‡æ°´å¹³</p><p>å¯ä»¥å‘ç°è¿™ä¸ªä¹±ä¸ƒå…«ç³Ÿçš„é¢˜é¢ï¼Œæœ¬è´¨æ˜¯æ¯æ¬¡ä»åŒºé—´ä¸­å–å‡ºä¸€ä¸ªä¸¥æ ¼ä¸Šå‡çš„åºåˆ—ï¼Œç„¶åé—®æœ€å°‘å–å‡ æ¬¡</p><p>ç”±äºæ˜¯ä¸¥æ ¼ä¸Šå‡ï¼Œæ‰€ä»¥åªå’Œç›¸åŒçš„æ•°ä¸ªæ•°æœ‰å…³ï¼Œå³è¦ç”¨åŒºé—´å‡ºç°æ¬¡æ•°æœ€å¤§çš„é‚£ä¸ªæ•°å‡ºç°æ¬¡æ•°é‚£ä¹ˆå¤šæ¬¡</p><p>ä»ä¸Šå¥è¯å¯ä»¥çœ‹å‡ºè¿™å‡ºé¢˜äººè¯­æ–‡æ²¡æ•‘</p><p>å³è¦æ±‚åŒºé—´ä¼—æ•°</p></blockquote><p>æˆ‘è§‰å¾—ä¹Ÿå°± lxl è¿™æ ·çš„äººæ‰èƒ½å†™å‡ºè¿™ä¹ˆéš¾è¯»çš„é¢˜é¢å’Œé¢˜è§£<del>ï¼Œæ‰€ä»¥æˆ‘ä¸åœ¨è¿™æ”¾é¢˜é¢äº†ï¼Œä½ å¤ä¹ çš„æ—¶å€™è‡ªå·±è¯»å»</del>ã€‚</p><h4 id="solution-6"><a href="#solution-6" class="headerlink" title="solution"></a>solution</h4><p>é¢˜é¢ç¿»è¯‘æˆäººè¯ï¼šç»™å‡ºä¸€ä¸ªåºåˆ—ï¼Œé€‰å®šè‹¥å¹²ä¸ªåŒºé—´ï¼Œ<strong>æ¯æ¬¡ä»ä¸­å–å‡ºä¸€ä¸ªå•è°ƒå¢åºåˆ—ï¼Œæ±‚æœ€å°‘å‡ æ¬¡å–å®Œ</strong>ã€‚</p><p>åŠ ç²—éƒ¨åˆ†å¯ä»¥è½¬åŒ–ä¸ºï¼š<strong>æ±‚è¯¥åŒºé—´çš„ä¼—æ•°çš„å‡ºç°æ¬¡æ•°</strong>ï¼Œå³<strong>åŒºé—´å†…æ‰€æœ‰æ•°å‡ºç°æ¬¡æ•°çš„æœ€å¤§å€¼</strong>ã€‚</p><p>è¿™æ ·è¿™ä¸ªé¢˜å°±æ²¡å•¥éš¾åº¦äº†ã€‚</p><h4 id="code-7"><a href="#code-7" class="headerlink" title="code"></a>code</h4><p>æ”¾ä¸€æ”¾ <code>add</code> å’Œ <code>del</code> å‡½æ•°çš„éƒ¨åˆ†ã€‚å¯è¯»æ€§å¾ˆä½ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">  --t[cnt[z[p]]];</span><br><span class="line">  <span class="keyword">if</span> (cnt[z[p]] == now) ++now;</span><br><span class="line">  ++t[++cnt[z[p]]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!--t[cnt[z[p]]] &amp;&amp; cnt[z[p]] == now) --now;</span><br><span class="line">  ++t[--cnt[z[p]]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="HNOI2009-æœ€å°åœˆ"><a href="#HNOI2009-æœ€å°åœˆ" class="headerlink" title="[HNOI2009]æœ€å°åœˆ"></a><a href="https://www.luogu.com.cn/problem/P3199">[HNOI2009]æœ€å°åœˆ</a></h3><p>é¢˜æ„çœŸéš¾è¯»ã€‚</p><h4 id="solution-7"><a href="#solution-7" class="headerlink" title="solution"></a>solution</h4><p>è¦æ±‚æ±‚å›¾ä¸­æ‰€æœ‰ç¯ä¸Šè¾¹æƒçš„å¹³å‡å€¼çš„æœ€å°å€¼ï¼Œå³æ±‚ $\min\{ \frac{\sum_{i = 1}^{k} w_i}k\}$ï¼Œå…¶ä¸­ $k$ ä¸ºç¯çš„è¾¹æ•°ã€‚</p><p>è®¾ $\mathrm{ans}$ ä¸ºè¿™ä¸ªæœ€å°å€¼ã€‚åˆ™ $\sum_{i = 1}^k (w_i - \mathrm{ans}) = 0$ã€‚äºŒåˆ†è¿™ä¸ªæœ€å°å€¼ï¼Œåˆ¤æ–­æ–°å›¾æœ‰æ— è´Ÿç¯å³å¯ã€‚</p><hr><h3 id="SCOI2014-æ–¹ä¼¯ä¼¯è¿æ¤°å­"><a href="#SCOI2014-æ–¹ä¼¯ä¼¯è¿æ¤°å­" class="headerlink" title="[SCOI2014]æ–¹ä¼¯ä¼¯è¿æ¤°å­"></a><a href="https://www.luogu.com.cn/problem/P3288">[SCOI2014]æ–¹ä¼¯ä¼¯è¿æ¤°å­</a></h3><p>æ²¡çœ‹æ‡‚<strong>ï¼Œä½ ä¸ªæ‡’ç†Šå›æ¥å¤ä¹ çš„æ—¶å€™è®°å¾—è¡¥ä¸Š</strong></p><hr><p>ä¸€æœˆç»“æŸäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2019 Dec Records</title>
      <link href="/2019/2019-Dec-Records/"/>
      <url>/2019/2019-Dec-Records/</url>
      
        <content type="html"><![CDATA[<p>èœé¸¡ fa_555 ä¼šæŠŠä¸€äº›åŠ¨æ€ç®€è¦åœ°è®°åœ¨è¿™é‡Œã€‚ä¸»è¦è¿˜æ˜¯ç•™ç»™è‡ªå·±ä»¥åçœ‹çš„ã€‚</p><span id="more"></span><p><em>æ‰€æœ‰ä»£ç ä¸ä¿è¯åŒ…æ‹¬æ— å…³ç´§è¦çš„éƒ¨åˆ†</em></p><hr><h3 id="P1131-ZJOI2007-æ—¶æ€åŒæ­¥"><a href="#P1131-ZJOI2007-æ—¶æ€åŒæ­¥" class="headerlink" title="P1131 [ZJOI2007]æ—¶æ€åŒæ­¥"></a>P1131 [ZJOI2007]æ—¶æ€åŒæ­¥</h3><p>ç”±äºæˆ‘ä¸ä¼š dpï¼Œæœºæˆ¿ç¥ä»™è€ƒå‰å¼ºæ¨ç»™æˆ‘çš„<del>ï¼Œä½†æˆ‘ç°åœ¨æ‰æ¥åš</del>ã€‚</p><p>é¢˜ç›®æè¿°å¾ˆé•¿å¾ˆå”¬äººï¼Œä½†å®é™…éå¸¸æ°´ï¼Œä¸€çœ¼åˆ‡ï¼Œå°±ç®—åˆ‡ä¸æ‰ä¹Ÿèƒ½çœ‹ä¸€çœ¼ä»£ç å°±èƒ½å®Œå…¨æ˜ç™½çš„é‚£ç§ã€‚</p><p>å®ç°èµ·æ¥å¯ä»¥ç”¨ä¸€äº›å°ä¼˜åŒ–å‡å°å¸¸æ•°ã€‚</p><p><strong>ã€å·²è§£å†³ã€‘</strong>ä½†æ˜¯æœ‰ä¸€ä¸ªå¤§é—®é¢˜ï¼šä¸ºä»€ä¹ˆå¿«è¯»çš„ <code>buf[]</code> æ•°ç»„å¼€ <code>1&lt;&lt;20|1</code> å°±ä¼š RE ä¸€ä¸ªç‚¹ï¼Œ<code>1&lt;&lt;24|1</code> å°±ä¸ä¼šï¼Ÿå®³æ€•è‡ªå·±å¿«è¯»å‡ºé”…äº†/kk</p><p><strong>ç ´æ¡ˆï¼Œå¿«è¯»çš„ä¸‰ç›®å¿˜äº†åŠ  <code>p1 == p2</code></strong><del>ï¼Œæˆ‘æ˜¯ sb</del></p><hr><h3 id="åœ¨-c-11-ä¸­ä½¿ç”¨-using-è€Œé-typedef"><a href="#åœ¨-c-11-ä¸­ä½¿ç”¨-using-è€Œé-typedef" class="headerlink" title="åœ¨ c++11 ä¸­ä½¿ç”¨ using è€Œé typedef"></a>åœ¨ c++11 ä¸­ä½¿ç”¨ <code>using</code> è€Œé <code>typedef</code></h3><p><code>typedef</code> æ˜¯ c çš„é—ç•™ç‰©ã€‚</p><p>c++11 å¼ºåŒ–äº† <code>using</code> çš„ä½œç”¨ã€‚è‡ªæ­¤ï¼Œ<code>using</code> èƒ½åšçš„äº‹æƒ…æ˜¯ <code>typedef</code> çš„è¶…é›†ã€‚</p><p>e.g.</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- typedef long long ll;</span></span><br><span class="line"><span class="deletion">- typedef int iarrN[100003];</span></span><br><span class="line"></span><br><span class="line"><span class="addition">+ using ll = long long;</span></span><br><span class="line"><span class="addition">+ using iarrN = int[100003];</span></span><br></pre></td></tr></table></figure><hr><h3 id="P5755-NOI2000-å•è¯æŸ¥æ‰¾æ ‘"><a href="#P5755-NOI2000-å•è¯æŸ¥æ‰¾æ ‘" class="headerlink" title="P5755 [NOI2000]å•è¯æŸ¥æ‰¾æ ‘"></a>P5755 [NOI2000]å•è¯æŸ¥æ‰¾æ ‘</h3><p>å‘ç° Luogu æ–°ä¸Šäº†ä¸€é¢ NOI / çœé€‰é¢˜ï¼Œç‚¹å¼€ä¸€é“é¢˜ç›®ä¼¼ä¹å¾ˆæ¯’ç˜¤çš„çœ‹äº†çœ‹ã€‚</p><p>ï¼Ÿï¼Ÿï¼Ÿ</p><p>è¿™ä¸æ˜¯æ£µ Trie æ ‘é©¬ï¼è´´å¿ƒçš„ CCF ç”Ÿæ€•é€‰æ‰‹çœ‹ä¸å‡ºè¿˜ç»™äº†å¼ å›¾ï¼ˆ</p><p>å†™äº†å†™äº†<del>ï¼Œè¿˜èƒ½é¡ºä¾¿è¹­ç¯‡é¢˜è§£</del></p><p><strong>TODO: ä½†æ˜¯å¹¶ä¸æ˜¯å¾ˆä¼šç®— Trie çš„ç©ºé—´/kkã€‚</strong></p><p><strong>TODO: ä¼¼ä¹å¯ä»¥æ’åº + éªšæ“ä½œæè¿‡å»</strong></p><p>ä½†æ˜¯æ•°æ®å¥½åƒå¾ˆæ°´çš„æ ·å­ï¼Œ<code>std::cin</code> + <code>std::string</code> è¿˜èƒ½ 3ms ACï¼ˆ</p><h3 id="P3369-ã€æ¨¡æ¿ã€‘æ™®é€šå¹³è¡¡æ ‘"><a href="#P3369-ã€æ¨¡æ¿ã€‘æ™®é€šå¹³è¡¡æ ‘" class="headerlink" title="P3369 ã€æ¨¡æ¿ã€‘æ™®é€šå¹³è¡¡æ ‘"></a>P3369 ã€æ¨¡æ¿ã€‘æ™®é€šå¹³è¡¡æ ‘</h3><p>çœ‹ AgOH çš„è§†é¢‘å­¦ä¼šäº† FHQ-Treapã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åŠ¨æ€ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>fa_555 çš„ CSP-S 2019 é€€å½¹è®°</title>
      <link href="/2019/fa-555-%E7%9A%84-CSP-S-2019-%E9%80%80%E5%BD%B9%E8%AE%B0/"/>
      <url>/2019/fa-555-%E7%9A%84-CSP-S-2019-%E9%80%80%E5%BD%B9%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h2 id="Day-3"><a href="#Day-3" class="headerlink" title="Day -3"></a>Day -3</h2><p>ç”±äºèœ fa_555 ä¸€ç›´ä¸ä¼š dp å’Œä¼˜åŒ–ï¼Œæ‰€ä»¥åœ¨æ‰“å„ç§ dpã€‚</p><p>ç”¨æš´åŠ›è¿‡æ‰äº†<a href="https://www.luogu.org/problem/P4719">ã€æ¨¡æ¿ã€‘åŠ¨æ€ dp</a>ï¼Œå¹¶ä¸”è¿˜ä¸Šäº†æœ€ä¼˜è§£ç¬¬äºŒ <strong><em>ï¼ˆæ¶ˆè€— rpï¼‰</em></strong>ã€‚</p><p>æœºæˆ¿çš„åŒå­¦å‘ç°å¥‡æ•°å¹´ NOIP éƒ½è€ƒäº†æ¨¡æ‹Ÿ/æœç´¢ï¼Œäºæ˜¯è®¤å®šä»Šå¹´ CSP ä¸€å®šä¼šæœ‰æ¨¡æ‹Ÿæˆ–æœç´¢é¢˜ <strong><em>ï¼ˆflag1ï¼‰</em></strong>ã€‚</p><hr><h2 id="Day-1"><a href="#Day-1" class="headerlink" title="Day -1"></a>Day -1</h2><p>æœŸä¸­è€ƒè¯•åå…¨æ ¡<strong>é™¤äº† OI é€‰æ‰‹</strong>éƒ½æ”¾å‡äº†ã€‚è€ƒå‰æƒ³è¦å‡ºå»æ”¾æ”¾é£ï¼Œäºæ˜¯ä¸‹åˆå…¨æœºæˆ¿æºœå‡ºå»çœ‹äº†ã€Œå¤©æ°—ã®å­ã€ã€‚</p><p>çœŸçš„å¤ªçˆ±è¿™éƒ¨å‰§çš„ä¸–ç•Œè§‚è¾£ <del>ï¼Œå¦‚æœèƒ½ç»™æˆ‘ä¸ªå¦¹å­æˆ‘ä¹Ÿå®å¯æŠŠä¸€åº§åŸæ·¹æ‰çš„</del>ï¼</p><p><del>æˆ‘æ°¸è¿œå–œæ¬¢å¤©é‡é™½èœï¼</del></p><hr><h2 id="Day-0"><a href="#Day-0" class="headerlink" title="Day 0"></a>Day 0</h2><p>ä¸­åˆ 12 ç‚¹ä¸åˆ°å°±åˆ°äº†æ—¥ç…§ï¼Œè¢«å‘ŠçŸ¥å®¿èˆæ²¡æœ‰æ”¶æ‹¾å¥½ï¼Œäºæ˜¯é¡¶ç€å¤§å¤ªé˜³ç«™äº†ä¸€å°æ—¶ï¼Œæ™’å¾—æœ‰ç‚¹åèƒƒã€‚</p><p>ä¸‹åˆåœ¨å®¿èˆé‡Œç„¦æ€¥åœ°å¤ä¹ äº†å„ç§æ¨¡æ¿ï¼Œ<del>å’Œ</del>å¬ $\texttt{I}\color{red}{\texttt{rressey}}$ã€$\texttt{q}\color{red}{\texttt{azswedx}}$ è®¨è®ºäº†å¡å¸¸ä¹‹ç±»çš„ä¸œè¥¿ï¼Œæ²¡æœ‰é¢“åºŸã€‚</p><hr><p>æ™šä¸Šè¯•æœºï¼Œå‘ç°è€ƒåœºé—¨å£æ˜¯â€œç¥å„ä½åŒå­¦ <strong>CPS</strong> å–å¾—å¥½æˆç»©â€ã€‚</p><p>å…¥åœºé—®ç›‘è€ƒè€å¸ˆå¸¦çš„åŒ…æ”¾åœ¨å“ªé‡Œï¼Œç»“æœç«Ÿç„¶è®©æˆ‘éšèº«å¸¦ç€ï¼ˆé»‘äººé—®å·è„¸ï¼‰ã€‚è€ƒåœºç”µè„‘ç”¨ <code>getchar</code> å’Œ <code>fread</code> éƒ½è´¼æ…¢ï¼Œç¬¬äºŒå¤©æ‰å‘ç°æ˜¯ç«ç»’çš„é”…ã€‚æœºå­æ²¡å•¥é—®é¢˜ã€‚</p><p>å‘ç° D ç›˜é‡Œæœ‰ä¸ª <code>day1.rar</code>ï¼Œé‡Œé¢æœ‰ <code>robot</code>, <code>route</code>, <code>consequence</code> ä¸‰ä¸ªæ–‡ä»¶å¤¹ã€‚å¤©çœŸçš„æˆ‘ä»¥ä¸ºè¿™æ˜¯ç¬¬äºŒå¤©çš„é¢˜ï¼Œäºæ˜¯å¼€å§‹å…´å¥‹åœ°è¯•å¯†ç  <del>ï¼Œè¿˜ä»¥ä¸ºè‡ªå·±è¦è¢«ç¦èµ›äº†</del>ã€‚å‡ºåœºé—®äº† $\texttt{I}\color{red}{\texttt{rressey}}$ æ‰çŸ¥é“è¿™æ˜¯ NOI 2019 day1ã€‚</p><hr><p>å®¿èˆæœ‰ä»¨äººæ‰“å‘¼å™œï¼Œç¡å¾—å¾ˆå·®ã€‚ç¡äº†å¤§æ¦‚æœ‰ 4h çš„æ ·å­ã€‚</p><hr><h2 id="Day-1-1"><a href="#Day-1-1" class="headerlink" title="Day 1"></a>Day 1</h2><p>æ—©é¥­çœŸéš¾åƒã€‚</p><p>é—¨å£å·²ç»æ”¹æˆäº†â€œç¥å„ä½åŒå­¦ <strong>CSP</strong> å–å¾—å¥½æˆç»©â€ã€‚</p><hr><p>å¼€åŒ…çœ‹é¢˜ã€‚ç”¨å¤§æ¦‚ 20min åˆ‡æ‰äº† T1ï¼Œåå¤ç¡®è®¤äº† <code>1ull</code> ä¹‹ç±»çš„ç»†èŠ‚é—®é¢˜ã€‚</p><p>ä¿è¯ä¸ä¼šå‡ºé”™ä»¥åå¼€äº† T2ã€‚å‘ç°é“¾çš„åšæ³•å¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰©å±•åˆ°æ ‘ä¸Šï¼Œäºæ˜¯å¼€å§‹æ¨é“¾çš„ $O(1)$ è½¬ç§»çš„åšæ³•ã€‚ç”¨äº†å¤§çº¦ 30min çš„æ ·å­ã€‚å†™å‡ºä»£ç æ¥å‘ç°æ€ä¹ˆä¹Ÿè¿‡ä¸äº†æ ‘çš„å¤§æ ·ä¾‹ï¼Œåˆè°ƒäº†åŠå°æ—¶æ‰å‘ç°æ˜¯ä¸€å¤„ä¸‹æ ‡å†™é”™äº† <del>ï¼Œæˆ‘äº‹ sb</del>ã€‚ç”±äºæ„Ÿè§‰èŠ±äº†å¾ˆé•¿æ—¶é—´ï¼Œè¿‡äº†å¤§æ ·ä¾‹å°±è·‘å» T3 äº†ã€‚</p><p>æ­¤æ—¶æ‰å¤§çº¦ 10:10ï¼Œå¿ƒæƒ³ï¼šâ€œæˆ‘è¿˜èƒ½ 2h éª—ä¸å‡º 60 åˆ†ä¸æˆï¼Ÿâ€<strong><em>ï¼ˆflag2ï¼‰</em></strong>ã€‚è¯»å®Œé¢˜å‘ç°ä¸å¤§å¯åšï¼Œåƒäº†æ¡å£«åŠ›æ¶å†·é™äº†ä¸€ä¸‹ã€‚æ­»ç£• 2h æ— æœï¼Œå…¨æ’åˆ— 10 åˆ† + <code>std::random_shuffle</code> èµ°äººã€‚</p><hr><p>å‡ºåœºä»¥ä¸ºè‡ªå·±æŒ‚æ‰ï¼Œå¿ƒæ€å¾ˆæ˜¯çˆ†ç‚¸ã€‚ç»“æœ $\texttt{å›}\color{red}{\texttt{è«ç¬‘ï½}}$ ç­‰åŒå­¦éƒ½è¯´è‡ªå·±å¤§çº¦åªèƒ½æ‹¿ 150 åˆ†ï¼Œç”šè‡³ $\texttt{I}\color{red}{\texttt{rressey}}$ ä¹Ÿåªæœ‰ 210 åˆ†ï¼Œå¿ƒæƒ…ç¬é—´ä¸é‚£ä¹ˆç³Ÿäº†ã€‚</p><p>åˆé¥­æŒºä¸é”™ã€‚å¤§å®¶å£°è®¨äº†å‡ºé¢˜äººï¼Œå¹¶çº·çº·è¡¨ç¤ºâ€œæ˜å¤© T1 å¯æ€œï¼ŒT2 ç”±ä¹ƒï¼ŒT3 å°è‘±ï¼Œæˆ‘ 8:31 ç¦»åœºâ€<strong><em>ï¼ˆflag3ï¼‰</em></strong>ã€‚<del>æœç„¶ä¸€ä¸ªéƒ½æ²¡æœ‰ã€‚</del></p><p>åˆé¥­åè·Ÿ $\texttt{I}\color{red}{\texttt{rressey}}$ å°å£°è¯´äº†ä¸€å¥ï¼šâ€œæ˜å¤©ä¸ä¼šè€ƒ<strong>å±é…</strong>å§â€<strong><em>(flag4)</em></strong>ã€‚</p><hr><p>å¬è¯´ T2 å¤§æ ·ä¾‹å¾ˆæ°´ï¼Œå¾ˆæ…Œï¼Œä¸è¿‡ç”±äºè°ƒäº†å¾ˆé•¿æ—¶é—´ï¼Œå¿ƒé‡Œè¿˜æ˜¯æœ‰åº•ã€‚</p><p>ä¸‹åˆå’Œ $\texttt{I}\color{red}{\texttt{rressey}}$ ä¸€èµ·é¢“äº†ä¸€ä¼šï¼Œæ‰æ„è¯†åˆ°è‡ªå·±åº”è¯¥å»å­¦ä¹ ã€‚åšäº†ä¸‹æ–°å‡ºçš„<a href="https://www.luogu.org/problem/P5656">ã€æ¨¡æ¿ã€‘äºŒå…ƒä¸€æ¬¡ä¸å®šæ–¹ç¨‹</a>ï¼Œå¹¶ç¡®ä¿¡è‡ªå·±å®Œå…¨æ˜ç™½äº†ã€‚</p><p>æ™šä¸Šä¸ºäº†ç¡å¥½ï¼Œç´§æ€¥æŠŠæˆ‘çˆ¸ä»éš”å£å¸‚å–Šæ¥ï¼Œå‡ºå»ä½äº†é…’åº—ã€‚åœ¨é…’åº—å†™äº†æ‰«æçº¿æ±‚é¢ç§¯ï¼Œä½†æ±‚å‘¨é•¿æ€ä¹ˆä¹Ÿå†™ä¸å¯¹ã€‚</p><p>æœç„¶ç¡å¾—æŒºå¥½ã€‚ç¬¬äºŒå¤©è„‘å­éƒ½ç¡ç³Šæ¶‚äº†ã€‚</p><hr><h2 id="Day-2"><a href="#Day-2" class="headerlink" title="Day 2"></a>Day 2</h2><p>å›åˆ°å­¦æ ¡å®¿èˆï¼ŒèŠ± 5min è°ƒå‡ºæ¥äº†æ‰«æçº¿æ±‚å‘¨é•¿ <strong><em>ï¼ˆrp è€—å…‰ï¼‰</em></strong>ï¼Œè¿˜è›®é«˜å…´çš„ã€‚</p><p>å»è€ƒåœºçš„è·¯ä¸Šå‘ç°æ²¡å¸¦æ°´ï¼Œå¿ƒæ€æœ‰ç‚¹å´©ã€‚æœç„¶æ¥ä¸‹æ¥åº¦è¿‡äº†äººç”Ÿæœ€é˜´æš—çš„ 3.5hã€‚</p><hr><p>çœ‹åˆ° T1 çš„ <code>Yazid</code> å‘ç°è‡ªå·±å¥¶ä¸­ï¼Œç›´æ¥æ‡µé€¼ã€‚è¯»é”™äº†é¢˜ç›®ï¼Œä»¥ä¸ºæœ€å¤šåªèƒ½é€‰ <code>M</code> é“èœï¼Œç»“æœèŠ±äº† 2hï¼Œè¿‡ä¸äº†å¤§æ ·ä¾‹ 3ã€‚æš´åŠ›å’Œæ­£è§£é”™å¾—ä¸€æ ·ï¼Œä½†ç´§å¼ åˆ°è¯»äº†å¥½å‡ éé¢˜éƒ½æ²¡å‘ç°é”™è¯¯ã€‚</p><p>æ„Ÿè§‰ä¸èƒ½ç»§ç»­æµªè´¹æ—¶é—´ï¼Œå¼€äº† T2ã€‚è‡ªæˆ‘æ„Ÿè§‰åªä¼š $O(2 ^ n)$ æš´åŠ›ï¼Œäºæ˜¯å…‰é€Ÿæ‰“å®Œç»§ç»­è°ƒ T1ã€‚</p><p>è¿˜å‰© 40min æ—¶æ„è¯†åˆ°å¿…é¡»å¼€ T3ï¼Œå‘è§‰éƒ¨åˆ†åˆ†å……è¶³ï¼Œäºæ˜¯å†™äº† $O(n ^ 2)$ + é“¾çš„ 55 åˆ†ã€‚äºŒå‰æ ‘æ²¡ç©ºå†™äº†ã€‚</p><hr><p>å‡ºè€ƒåœºå·®ç‚¹å“­äº†å‡ºæ¥ã€‚</p><p>æ™šä¸Šå‚åŠ äº†æˆ‘æ ¡ä¼ ç»Ÿçš„é€€å½¹é€‰æ‰‹é€åˆ«ä¼šï¼Œäº¤æµå‘ç°é«˜äºŒé€‰æ‰‹äººå‡è€ƒæŒ‚ã€‚</p><hr><p><strong>100 + 100 + 10 + 8 + 12 + 55 = 285</strong></p><p>å› ä¸ºè¯»é”™é¢˜æµªè´¹æ—¶é—´è€Œæ‰”æ‰ WC ç”šè‡³ 1= çš„åˆ†æ•°æ˜¯æˆ‘ä»æ¥æ²¡æƒ³è¿‡çš„æå…¶æ„šè ¢çš„é€€å½¹æ–¹å¼ã€‚</p><p>å‘ç°äººå‡æ¯”æˆ‘åˆ†é«˜ï¼Œæ„è¯†åˆ°è‡ªå·±å®Œè›‹äº†ã€‚ä»æ²¡æƒ³è¿‡è‡ªå·±ä¼šè”èµ›é€€å½¹ï¼Œå¿ƒæƒ…æç«¯å·®ã€‚</p><p>æ†§æ†¬çš„ WC APIO CTS NOI éƒ½å°†ä¸æˆ‘æ— å…³ã€‚</p><hr><h2 id="Day-3-1"><a href="#Day-3-1" class="headerlink" title="Day 3"></a>Day 3</h2><p>æ–‡åŒ–è¯¾çœŸå¥½ç©ï¼ŒæŒ¨è€å¸ˆè®­çœŸä¸å¥½ç©ã€‚</p><p>æ•™å®¤ä¸€ç‚¹ä¹Ÿä¸åƒæœºæˆ¿ã€‚è¿™é‡Œæ²¡æœ‰ä¸€ç‚¹å®¶çš„æ„Ÿè§‰ã€‚</p><p>å›æœºæˆ¿çœ‹äº†ä¸€çœ¼ã€‚æˆ‘çš„ä½ç½®ä¸Šå·²ç»æ²¡æœ‰ç”µè„‘äº†ã€‚æ˜¨æ™šæœ‰äººæŠŠå€’è®¡æ—¶æ”¹æˆäº† â€œè· CSP-S 2019 è¿˜å‰© -1 å¤©â€ã€‚æˆ‘åŠ äº†ä¸¤ç¬”ï¼Œæˆäº† â€œ-2 å¤©â€ã€‚</p><hr><h2 id="Day-6"><a href="#Day-6" class="headerlink" title="Day 6"></a>Day 6</h2><p>æœºæˆ¿çš„å€’è®¡æ—¶æˆ‘æ¯å¤©éƒ½å»æ”¹ä¸€æ¬¡ã€‚æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆæƒ³è¿™æ ·åšã€‚</p><p>æºç¨‹åºå…¬ç¤ºäº†ï¼Œå¥½åœ¨æ²¡æœ‰æŒ‚åˆ†ã€‚$\texttt{ä¸€}\color{red}{\texttt{æ‰¶è‹ä¸€}}$ è‡ªæµ‹çš„ç»“æœé™¤å»é«˜ä¸‰é€‰æ‰‹ï¼Œæˆ‘æ˜¯ rk67ï¼Œå’Œå»å¹´ $\texttt{I}\color{red}{\texttt{rressey}}$ ä¸€æ¨¡ä¸€æ ·ã€‚åˆä¸­ç¥ä»™ $\texttt{q}\color{red}{\texttt{azswedx}}$ ç›´æ¥æåˆ°äº† rk1ï¼Œåœ¨è¿™é‡Œç¥è´ºä»–ã€‚</p><p>åŒçº§çš„é€‰æ‰‹çœŸçš„å‡ ä¹å…¨æŒ‚äº†ã€‚ä¸€æ‰¹å®åŠ›ç¨³ 1= çš„é€‰æ‰‹ç«Ÿç„¶æœ‰äº›ç”šè‡³è¿ 2= éƒ½ä¿ä¸ä½ï¼ŒçœŸçš„å¾ˆå¯æƒœã€‚</p><p>æˆ‘ä¼¼ä¹æ²¡æœ‰é€€å½¹ï¼Ÿå‰æ–¹çš„é“è·¯è¿˜æ˜¯ç”±æˆ‘æ¥é€‰æ‹©å§ã€‚</p><h2 id="Day-17"><a href="#Day-17" class="headerlink" title="Day 17"></a>Day 17</h2><p>SD çš„æˆç»©å‘äº†ã€‚</p><p>åˆ†æ•°ä¸€ç‚¹æ²¡å˜ï¼Œåæ¬¡å˜æˆäº†è¿å¸¦é«˜ä¸‰ rk 79ã€‚</p><p>è¿™ä¸ªåæ¬¡æ‹¿ä¸åˆ° 7 çº§ã€‚</p><p>å°±è¯´è¿™äº›å§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¸¸è®° </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>é¢˜è§£ CF985E ã€Pencils and Boxesã€‘</title>
      <link href="/2019/%E9%A2%98%E8%A7%A3-CF985E-%E3%80%90Pencils-and-Boxes%E3%80%91/"/>
      <url>/2019/%E9%A2%98%E8%A7%A3-CF985E-%E3%80%90Pencils-and-Boxes%E3%80%91/</url>
      
        <content type="html"><![CDATA[<p>under é¢˜è§£ <a href="https://www.luogu.org/problem/CF985E">CF985E</a></p><hr><span id="more"></span><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™å®šå¤§å°ä¸º $n$ çš„å¯é‡é›†åˆ $T$ ä¸æ•´æ•° $k, d$ï¼Œæ±‚è‹¥å¹²äº’ä¸ç›¸äº¤çš„å¯é‡é›†åˆ $S_i$ï¼Œä½¿å¾—</p><ul><li>$\bigcup S_i = T$</li><li>$|S_i| \ge k$</li><li>$\max\{S_i\} - \min\{S_i\} \le d$</li></ul><p>åˆ¤æ–­èƒ½å¦æ‰¾åˆ°ä¸€ç»„åˆæ³•çš„è§£ã€‚</p><ul><li>$1 \le k, n \le 5 \times 10^5, \ d \le 10^9$</li></ul><h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><p>åˆçœ‹é¢˜é¢ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ç§è´ªå¿ƒåšæ³•ï¼š</p><p>ä»å°åˆ°å¤§æ’åºï¼Œæ¯æ¬¡é€‰æ‹©ç¬¬ä¸€ä¸ªæœªè¢«é€‰ç”¨çš„æ•° $a_i$ï¼Œå°† $a_i \sim a_i + d$ çš„æ‰€æœ‰æ•°åˆ’åˆ†åˆ°åŒä¸€é›†åˆä¸­ã€‚</p><p>ä¸éš¾æƒ³åˆ°è¿™ç§ç®—æ³•æ˜¯é”™è¯¯çš„ã€‚è€ƒè™‘æ•°æ® <code>4 2 1 1 2 2 3</code>ï¼Œå°±å¯ä»¥æŠŠè¿™ç§ç®—æ³•å¡æ‰ã€‚å¯¹äºè¿™ç»„æ•°æ®ï¼Œå”¯ä¸€åˆæ³•çš„åˆ’åˆ†æ–¹æ¡ˆä¸º $S_1 = \{1, 2\}, S_2 = \{2, 3\}$ã€‚ä¸Šè¿°è´ªå¿ƒå°†ä¸¤ä¸ªå…ƒç´  <code>2</code> åˆ’åˆ†åˆ°äº†åŒä¸€ä¸ªé›†åˆä¸­ï¼Œå¯¼è‡´ <code>3</code> æ— æ³•åˆ†é…ã€‚</p><p><del>è‡ªç„¶æƒ³åˆ°</del>åˆ©ç”¨ dpã€‚</p><p>ä»¤ <code>f[i]</code> è¡¨ç¤ºå‰ i ä¸ªæ•°æœ‰æ— åˆæ³•åˆ’åˆ†æ–¹æ¡ˆã€‚è½¬ç§»æ—¶åˆ©ç”¨é˜Ÿåˆ—ï¼Œè€ƒè™‘ <code>a[i] - a[i - K]</code> çš„å·®å€¼ä¸ <code>k</code> çš„å¤§å°å…³ç³»ã€‚ç»†èŠ‚è§ä»£ç ã€‚</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::bitset&lt;500003&gt; f;</span><br><span class="line"><span class="keyword">int</span> N, K, D, z[<span class="number">500003</span>];</span><br><span class="line">std::queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = K; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (f[i - K]) q.<span class="built_in">push</span>(z[i - K + <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">while</span> (q.<span class="built_in">size</span>() &amp;&amp; z[i] - q.<span class="built_in">front</span>() &gt; D)</span><br><span class="line">      q.<span class="built_in">pop</span>();</span><br><span class="line">    f.<span class="built_in">set</span>(i, (<span class="keyword">bool</span>)q.<span class="built_in">size</span>());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> f[N];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  std::cin &gt;&gt; N &gt;&gt; K &gt;&gt; D;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">    std::cin &gt;&gt; z[i];</span><br><span class="line">  std::<span class="built_in">sort</span>(z + <span class="number">1</span>, z + N + <span class="number">1</span>);</span><br><span class="line">  std::cout &lt;&lt; (<span class="built_in">dp</span>() ? <span class="string">&quot;YES&quot;</span> : <span class="string">&quot;NO&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢˜è§£ P3593 ã€[POI2015]TABã€‘</title>
      <link href="/2019/%E9%A2%98%E8%A7%A3-P3593-%E3%80%90POI2015-TAB%E3%80%91/"/>
      <url>/2019/%E9%A2%98%E8%A7%A3-P3593-%E3%80%90POI2015-TAB%E3%80%91/</url>
      
        <content type="html"><![CDATA[<p>under é¢˜è§£ <a href="https://www.luogu.org/problem/P3593">P3593</a></p><span id="more"></span><hr><p>æœ¬ç¯‡é¢˜è§£ä»£ç å·²<a href="http://darkbzoj.tk/submission/38792">åœ¨ darkbzoj AC</a>ï¼ˆå¹³å‡ 128ms æ¯æµ‹è¯•ç‚¹ï¼‰ï¼Œä½†<a href="https://www.luogu.org/record/24905515">åœ¨æ´›è°·å…¨ TLE</a>ã€‚</p><p>åœ¨æœ¬æœºå¯è¿‡æé™æ•°æ® ï¼ˆ131 MBï¼Œç”Ÿæˆä»£ç é™„äºæ–‡æœ«ï¼‰ã€‚å› æ— äºº ACï¼ŒçŒœæµ‹å¯èƒ½æ˜¯æ´›è°·æ•°æ®å‡ºé”…ï¼Œçƒ¦è¯·å„ä½ç®¡ç†å‘˜æ ¸å®ã€‚</p><hr><p>qbxt çš„ä¾‹é¢˜ï¼Œè·‘æ¥<del>æ°´</del>åšä¸€å‘ï¼Œç»“æœæ²¡æƒ³åˆ°æ˜¯é“å‘é¢˜!</p><p><em>ä¸Šé¢æœ¬æ¥æœ‰ä¸¤å¼ è¡¨æƒ…ï¼Œä½†æ˜¯æ´›è°·å›¾åºŠä¸èƒ½åœ¨å¤–é“¾è®¿é—®ï¼Œæ‰€ä»¥â€¦â€¦</em></p><hr><h3 id="å‘æ˜é¢˜ç›®ä¿¡æ¯"><a href="#å‘æ˜é¢˜ç›®ä¿¡æ¯" class="headerlink" title="å‘æ˜é¢˜ç›®ä¿¡æ¯"></a>å‘æ˜é¢˜ç›®ä¿¡æ¯</h3><ul><li>çŸ©é˜µä¸­çš„æ•°ä¸¤ä¸¤ä¸åŒ</li><li>æ“ä½œï¼šäº¤æ¢ä»»æ„ æ•´è¡Œ / æ•´åˆ—</li><li>å…ƒç´ å€¼åŸŸ <code>[-1e6, 1e6]</code>ï¼Œæ•´æ•°</li></ul><p>å¯¹äºåŸçŸ©é˜µä¸­åŒä¸€è¡Œä¸­çš„å…ƒç´ ï¼š</p><ol><li>è€ƒè™‘è¡Œäº¤æ¢ï¼Œäº¤æ¢åæ˜¾ç„¶ä»åœ¨åŒä¸€è¡Œå†…ï¼›</li><li>è€ƒè™‘åˆ—äº¤æ¢ï¼Œäº¤æ¢åé¡ºåºæ”¹å˜ï¼Œä½†ä»åœ¨åŒä¸€è¡Œå†…ã€‚</li></ol><p>åŸçŸ©é˜µä¸­åŒä¸€åˆ—ä¸­å…ƒç´ çš„æƒ…å†µç±»ä¼¼ã€‚</p><p>å› æ­¤ç›´æ¥åˆ¤æ–­åŸçŸ©é˜µåŒä¸€ è¡Œ/åˆ— ä¸­çš„å…ƒç´ åœ¨å˜æ¢åçŸ©é˜µå†…æ˜¯å¦å‡ä»åœ¨åŒä¸€ è¡Œ/åˆ—ï¼Œå¤æ‚åº¦ $O(Tnm)$ï¼Œå¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚ç»†èŠ‚è§ä»£ç ã€‚</p><p><del>ä½ ä»¥ä¸ºè¿™å°±å®Œäº†å—ï¼Ÿå½“ç„¶æ²¡æœ‰ã€‚</del></p><h3 id="å‘ç‚¹"><a href="#å‘ç‚¹" class="headerlink" title="å‘ç‚¹"></a>å‘ç‚¹</h3><ul><li>æ¯ç»„æ•°æ®ç¬¬äºŒä¸ªçŸ©é˜µä¸­çš„å…ƒç´ å¯èƒ½åœ¨ç¬¬ä¸€ä¸ªçŸ©é˜µä¸­å¹¶æœªå‡ºç°ï¼Œä½†å¯èƒ½åœ¨ä¸Šä¸€ç»„æ•°æ®ä¸­å‡ºç°è¿‡ï¼Œéœ€è¦è¿›è¡Œå¤„ç†ã€‚è€ƒè™‘ <code>memset</code> çš„å·¨å¤§å¸¸æ•°ï¼Œé€‰ç”¨æ¸…é›¶è¾ƒå¿«çš„ <code>std::bitset</code>ã€‚</li><li>å¦‚æœè¾¹è¯»è¾¹åšï¼Œå‘ç°æ•°æ® NIE ååº”è¯¥æŠŠå½“å‰ç»„æ•°æ®è¯»å®Œï¼Œè€Œä¸æ˜¯ç›´æ¥åšä¸‹ä¸€ç»„æ•°æ®ã€‚</li><li>åˆ«å¿˜äº†ç»™ä¸ªåç§»é‡</li></ul><hr><p><del>ä½ ä»¥ä¸ºè¿™å°±å®Œäº†å—ï¼Ÿå½“ç„¶æ²¡æœ‰ã€‚</del></p><h3 id="çˆ†é›¶åçš„æ¢ç´¢"><a href="#çˆ†é›¶åçš„æ¢ç´¢" class="headerlink" title="çˆ†é›¶åçš„æ¢ç´¢"></a>çˆ†é›¶åçš„æ¢ç´¢</h3><p>æˆ‘åœ¨æ´›è°· TLE åçŒœæµ‹æ˜¯ç®—æ³•å¸¸æ•°è¿‡å¤§ï¼Œäºæ˜¯åœ¨æœ¬åœ°æµ‹è¯•äº†æé™æ•°æ®ã€‚</p><p>å‘ç°æ•ˆç‡ç“¶é¢ˆåœ¨<strong>è¯»å…¥</strong>ï¼š<code>scanf 10s+</code>, <code>getchar 3s+</code>, <code>fread ~0.35s</code>ã€‚ç„¶è€Œï¼Œè¿™ä»½ä½¿ç”¨äº† <code>fread</code> çš„ä»£ç ä»ç„¶åœ¨æ´›è°·ä¸èƒ½é€šè¿‡æœ¬é¢˜ã€‚</p><hr><p>darkbzoj AC ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IO</span> &#123;</span></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">gc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">char</span> buf[<span class="number">10000000</span>],*p1=buf,*p2=buf;</span><br><span class="line">    <span class="keyword">return</span> p1==p2&amp;&amp;(p2=(p1=buf)+<span class="built_in">fread</span>(buf,<span class="number">1</span>,<span class="number">10000000</span>,stdin),p1==p2)?EOF:*p1++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">  <span class="keyword">inline</span> IO <span class="keyword">operator</span>&gt;&gt;(T &amp;n) &#123;</span><br><span class="line">    n=<span class="number">0</span>; <span class="keyword">bool</span> s=<span class="number">0</span>; <span class="keyword">char</span> c=<span class="built_in">gc</span>();</span><br><span class="line">    <span class="keyword">while</span>(c&lt;<span class="string">&#x27;0&#x27;</span>||c&gt;<span class="string">&#x27;9&#x27;</span>) s|=c==<span class="string">&#x27;-&#x27;</span>,c=<span class="built_in">gc</span>();</span><br><span class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) n=(n&lt;&lt;<span class="number">3</span>)+(n&lt;&lt;<span class="number">1</span>)+(c^<span class="number">48</span>),c=<span class="built_in">gc</span>();</span><br><span class="line">    <span class="keyword">if</span>(s) n=-n;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; cin;</span><br><span class="line"></span><br><span class="line">std::bitset&lt;2000003&gt; vis;</span><br><span class="line"><span class="keyword">int</span> T, N, M, nr[<span class="number">1003</span>], nc[<span class="number">1003</span>], r[<span class="number">2000003</span>], c[<span class="number">2000003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  vis.<span class="built_in">reset</span>();</span><br><span class="line">  <span class="built_in">memset</span>(nr, <span class="number">0</span>, <span class="keyword">sizeof</span> nr);</span><br><span class="line">  <span class="built_in">memset</span>(nc, <span class="number">0</span>, <span class="keyword">sizeof</span> nc);</span><br><span class="line">  <span class="keyword">bool</span> f = <span class="number">1</span>;</span><br><span class="line">  cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, t; i &lt;= N; ++i)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; ++j) &#123;</span><br><span class="line">      cin &gt;&gt; t;</span><br><span class="line">      t += <span class="number">1000000</span>;</span><br><span class="line">      vis.<span class="built_in">set</span>(t);</span><br><span class="line">      r[t] = i, c[t] = j;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, t; i &lt;= N; ++i)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; ++j) &#123;</span><br><span class="line">      cin &gt;&gt; t;</span><br><span class="line">      <span class="keyword">if</span> (!f) <span class="keyword">continue</span>;</span><br><span class="line">      t += <span class="number">1000000</span>;</span><br><span class="line">      <span class="keyword">if</span> (!vis[t]) &#123; f = <span class="number">0</span>; <span class="keyword">continue</span>; &#125;</span><br><span class="line">      <span class="keyword">if</span> (!nr[r[t]]) nr[r[t]] = i;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (nr[r[t]] != i) f = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> (!nc[c[t]]) nc[c[t]] = j;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (nc[c[t]] != j) f = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (cin &gt;&gt; T; T; --T)</span><br><span class="line">    <span class="built_in">puts</span>(<span class="built_in">solve</span>() ? <span class="string">&quot;TAK&quot;</span> : <span class="string">&quot;NIE&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æé™æ•°æ®ç”Ÿæˆä»£ç ï¼ˆT = 10ï¼ŒN = M = 1000ï¼Œå‡ TAKï¼‰ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;10&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> T = <span class="number">10</span>; T; --T) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1000 1000&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">1000</span>; ++i) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">1000</span>; ++j)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ++t);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">1000</span>; ++i) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">1000</span>; ++j)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ++t);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœè¿™ç¯‡é¢˜è§£å‡ºç°äº†é”™è¯¯ï¼Œæ¬¢è¿å„ä½ dalao æ–§æ­£ã€‚<strong>è°¢è°¢å¤§å®¶ qwqï¼</strong></p>]]></content>
      
      
      <categories>
          
          <category> é¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¨¡æ‹Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢˜è§£ SP913 ã€QTREE2 - Query on a tree IIã€‘</title>
      <link href="/2019/%E9%A2%98%E8%A7%A3-SP913-%E3%80%90QTREE2-Query-on-a-tree-II%E3%80%91/"/>
      <url>/2019/%E9%A2%98%E8%A7%A3-SP913-%E3%80%90QTREE2-Query-on-a-tree-II%E3%80%91/</url>
      
        <content type="html"><![CDATA[<p>under é¢˜è§£ <a href="https://www.luogu.org/problem/SP913">SP913</a></p><hr><p>æ‰¾æ ‘å‰–é¢˜çš„æ—¶å€™å‘ç°è¿™é¢˜ï¼Œå‘ç°ç”¨å€å¢å¾ˆ<del>æ°´</del>ç®€å•ï¼Œäºæ˜¯å†™äº†ä¸€å‘ï¼Œå‘ç°è·Ÿç°æœ‰é¢˜è§£è¿˜ä¸å¤§ä¸€æ ·ï¼Œäºæ˜¯å†™ç¯‡é¢˜è§£é€  (bao) ç¦ (fu) ç¤¾ä¼šã€‚</p><span id="more"></span><hr><h3 id="å‰ç½®èŠå£«"><a href="#å‰ç½®èŠå£«" class="headerlink" title="å‰ç½®èŠå£«"></a>å‰ç½®èŠå£«</h3><p>æ ‘ä¸Šå€å¢ï¼ŒLCA</p><p><del>å½“ç„¶ä½ ä¹Ÿå¯ä»¥é¡ºæ‰‹æ ‘å‰–ç»´æŠ¤ä¸ª LCA ç„¶åå€å¢ç»Ÿè®¡ç­”æ¡ˆ</del></p><hr><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p><em>ä»¥ä¸‹è®¾ <code>f</code> ä¸º <code>u</code> å’Œ <code>v</code> çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ</em></p><ol><li>ä»¥ç»“ç‚¹ <code>1</code> ä¸ºæ ¹ï¼Œå¥—è·¯æ€§ dfsï¼Œå¹¶æ±‚å‡ºå€å¢ç¥–å…ˆæ•°ç»„ <code>fa[][]</code> &amp; ç»“ç‚¹æ·±åº¦ <code>dep[]</code> &amp; æ ¹åˆ°æ¯ä¸ªç»“ç‚¹çš„è¾¹æƒå’Œ <code>wn[]</code><ul><li>$O(n \log n)$</li></ul></li><li>å¯¹äºæ¯ä¸ª <code>DIST u v</code> æ“ä½œï¼Œç­”æ¡ˆæ˜¾ç„¶ä¸º <code>wn[u] + wn[v] - 2 * wn[f]</code><ul><li>å•æ¬¡ $O( \log n)$</li></ul></li><li>å¯¹äºæ¯ä¸ª <code>KTH u v k</code> æ“ä½œï¼Œåˆ†æƒ…å†µè®¨è®ºã€‚<ul><li>è‹¥ <code>dep[u] - dep[f] + 1 &lt; k</code>ï¼Œç­”æ¡ˆå³ä¸º <code>u</code> çš„ <code>k</code> çº§ç¥–å…ˆï¼›</li><li>è‹¥ <code>dep[u] - dep[f] + 1 &gt; k</code>ï¼Œç­”æ¡ˆä¸º <code>v</code> çš„ ç¥–å…ˆï¼Œä¸”ä¸º <code>dep[u] + dep[v] - 2 * dep[k] + 2 - k</code> çº§ç¥–å…ˆã€‚è€ƒè™‘ <code>u</code> åˆ° <code>v</code> çš„è·¯å¾„ä¸Šå…±æœ‰ <code>dep[u] + dep[v] - 2 * dep[f] + 1</code> ä¸ªç»“ç‚¹ï¼Œå¾—åˆ°è¿™ä¸ªå¼å­ï¼›</li><li>è‹¥ <code>dep[u] - dep[f] + 1 == k</code>ï¼Œ ç­”æ¡ˆä¸º <code>f</code>ã€‚å¯ç‰¹åˆ¤ï¼Œä¹Ÿå¯å¹¶å…¥å‰ä¸¤ç§æƒ…å†µå¤„ç†ã€‚</li><li>å•æ¬¡ $ O( \log n) $</li></ul></li></ol><p>æ€»å¤æ‚åº¦ $ O((n + q) \log n) $</p><hr><h3 id="å˜é‡è§£é‡Šä¸ä»£ç "><a href="#å˜é‡è§£é‡Šä¸ä»£ç " class="headerlink" title="å˜é‡è§£é‡Šä¸ä»£ç "></a>å˜é‡è§£é‡Šä¸ä»£ç </h3><p><del><code>cin:</code> é‡è½½çš„å¿«è¯»</del></p><p><code>MX:</code> $ \lfloor \log_2 N \rfloor $</p><p><code>queryt(u, v, k):</code> è¿”å› <code>KTH u v k</code> æ“ä½œçš„ç­”æ¡ˆ</p><p><em>å…¶ä½™å˜é‡æ„ä¹‰åŒ <strong>æ€è·¯</strong> éƒ¨åˆ†</em></p><p>ä»£ç  (c++11) :</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IO</span> &#123;</span></span><br><span class="line">  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">  <span class="keyword">inline</span> IO <span class="keyword">operator</span>&gt;&gt;(T &amp;n) &#123;</span><br><span class="line">    n=<span class="number">0</span>; <span class="keyword">char</span> c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(c&lt;<span class="string">&#x27;0&#x27;</span>||c&gt;<span class="string">&#x27;9&#x27;</span>) c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) n=(n&lt;&lt;<span class="number">3</span>)+(n&lt;&lt;<span class="number">1</span>)+(c^<span class="number">48</span>),c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>; <span class="comment">// n &gt;= 0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125; cin;</span><br><span class="line"><span class="comment">// ä¸è¦ iostream + using namespace stdï¼ä¼š CE çš„ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> MX = <span class="number">14</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> op[<span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> T, N, u, v, w, tot, head[<span class="number">10003</span>], dep[<span class="number">10003</span>], wn[<span class="number">10003</span>], fa[<span class="number">10003</span>][<span class="number">15</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> nxt, to, w;</span><br><span class="line">&#125; e[<span class="number">20003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">  e[++tot] = &#123;head[u], v, w&#125;;</span><br><span class="line">  head[u] = tot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// é¢„å¤„ç†</span></span><br><span class="line">  dep[u] = dep[f] + <span class="number">1</span>;</span><br><span class="line">  fa[u][<span class="number">0</span>] = f;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; (<span class="number">1</span> &lt;&lt; i) &lt;= dep[u]; ++i)</span><br><span class="line">    fa[u][i] = fa[fa[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = head[u], v; i; i = e[i].nxt) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((v = e[i].to) == f) <span class="keyword">continue</span>;</span><br><span class="line">    wn[v] = wn[u] + e[i].w;</span><br><span class="line">    <span class="built_in">dfs</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// å€å¢æ±‚ LCA</span></span><br><span class="line">  <span class="keyword">if</span> (dep[u] &lt; dep[v]) std::<span class="built_in">swap</span>(u, v);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = MX; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">    <span class="keyword">if</span> (dep[v] &lt;= dep[u] - (<span class="number">1</span> &lt;&lt; i))</span><br><span class="line">      u = fa[u][i];</span><br><span class="line">  <span class="keyword">if</span> (u == v) <span class="keyword">return</span> u;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = MX; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">    <span class="keyword">if</span> (fa[u][i] != fa[v][i])</span><br><span class="line">      u = fa[u][i], v = fa[v][i];</span><br><span class="line">  <span class="keyword">return</span> fa[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">queryt</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// åˆ†ç±»è®¨è®º</span></span><br><span class="line">  <span class="keyword">int</span> f = <span class="built_in">Lca</span>(u, v);</span><br><span class="line">  <span class="keyword">if</span> (dep[u] - dep[f] + <span class="number">1</span> &lt;= k) &#123;</span><br><span class="line">    <span class="comment">// è‹¥ç­”æ¡ˆä¸º $v çš„ç¥–å…ˆï¼Œåˆ™è½¬æ¢ä¸ºæ±‚ u çš„ç¥–å…ˆçš„æƒ…å†µï¼Œç®€åŒ–ä»£ç </span></span><br><span class="line">    k = dep[u] + dep[v] - (dep[f] &lt;&lt; <span class="number">1</span>) + <span class="number">2</span> - k;</span><br><span class="line">    u = v;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = MX; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">    <span class="comment">// å€å¢ç»´æŠ¤ç­”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">if</span> (k &gt;= (<span class="number">1</span> &lt;&lt; i) + <span class="number">1</span>) &#123;</span><br><span class="line">      u = fa[u][i];</span><br><span class="line">      k -= (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">return</span> u;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// å¤šæµ‹ä¸æ¸…ç©ºï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª</span></span><br><span class="line">  tot = wn[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(fa, <span class="number">0</span>, <span class="keyword">sizeof</span> fa);</span><br><span class="line">  <span class="built_in">memset</span>(head, <span class="number">0</span>, <span class="keyword">sizeof</span> head);</span><br><span class="line">  cin &gt;&gt; N;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">    cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">    <span class="built_in">addEdge</span>(u, v, w);</span><br><span class="line">    <span class="built_in">addEdge</span>(v, u, w);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (cin &gt;&gt; T; T; --T) &#123;</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, op);</span><br><span class="line">      <span class="keyword">if</span> (op[<span class="number">1</span>] == <span class="string">&#x27;O&#x27;</span>) <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> (op[<span class="number">1</span>] == <span class="string">&#x27;I&#x27;</span>) &#123;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, wn[u] + wn[v] - (wn[<span class="built_in">Lca</span>(u, v)] &lt;&lt; <span class="number">1</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">queryt</span>(u, v, w));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœæœ‰é”™è¯¯æˆ–ä¸æ‡‚çš„åœ°æ–¹ï¼Œè¯·åœ¨ç§ä¿¡æˆ–è¯„è®ºä¸­å‘ŠçŸ¥æˆ‘ï¼Œ<strong>è°¢è°¢ä½ ä»¬ qwq</strong></p>]]></content>
      
      
      <categories>
          
          <category> é¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘å½¢ç»“æ„ </tag>
            
            <tag> å€å¢ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢˜è§£ UVA10288 ã€ä¼˜æƒ åˆ¸ Couponsã€‘</title>
      <link href="/2019/%E9%A2%98%E8%A7%A3-UVA10288-%E3%80%90%E4%BC%98%E6%83%A0%E5%88%B8%20Coupons%E3%80%91/"/>
      <url>/2019/%E9%A2%98%E8%A7%A3-UVA10288-%E3%80%90%E4%BC%98%E6%83%A0%E5%88%B8%20Coupons%E3%80%91/</url>
      
        <content type="html"><![CDATA[<p>under é¢˜è§£ <a href="https://www.luogu.org/problem/UVA10288">UVA10288</a></p><hr><p>ä¹çœ‹è¿™é¢˜ï¼šè¿™ä¸æ˜¯è£¸çš„æ¦‚ç‡ dp å—ï¼</p><span id="more"></span><p>ç›´åˆ°æˆ‘çœ‹åˆ°<a href="https://www.luogu.org/discuss/show/65737">è¾“å‡ºæ ¼å¼</a>â€¦â€¦</p><p>ä¸ºå•¥è¦è¾“å‡ºå¸¦åˆ†æ•°å•Š <del>è‡ªé—­äº†ï¼Œæ€ä¹ˆä»£ç æ¯”æ¨å¯¼éš¾å•Š</del></p><hr><p>è‡ªé—­å½’è‡ªé—­ï¼Œé¢˜ç›®è¿˜æ˜¯è¦åšçš„ã€‚æ ¹æ® <del>æ•°å­¦ç›´è§‰</del> <a href="https://www.luogu.org/problem/SP1026">è¿™é“é¢˜</a>çš„ç»éªŒï¼Œæˆ‘ä»¬çŸ¥é“ç­”æ¡ˆåº”è¯¥æ˜¯ $\ n\sum_{i = 1}^n \tfrac{1}{i} \ $ï¼ˆè¿™é“é¢˜éš¾ç‚¹ä¸åœ¨è¿™ä¸ªç»“è®ºï¼Œå°±ä¸è¿›è¡Œè¯æ˜äº†ï¼‰ã€‚</p><p>è¦è¾“å‡ºåˆ†æ•°ï¼Œè°ƒå’Œçº§æ•° $ ( \sum_{i = 1} \frac{1}{i} ) $ æ±‚èµ·æ¥å°±æ²¡æœ‰é‚£ä¹ˆå¿«ä¹äº†ã€‚æˆ‘ä»¬å‡è®¾å·²ç»æ±‚å‡ºè°ƒå’Œçº§æ•°çš„å‰ $i - 1 \ (i &gt; 1)$ é¡¹æ˜¯ $\frac{a}{b}$ï¼Œé‚£ä¹ˆç¬¬ $i$ é¡¹å°±æ˜¯</p><script type="math/tex; mode=display">\frac{a}{b} + \frac{1}{i} = \frac{ai + b}{bi}</script><p>ä¸€ä¸ªç®€å•çš„é€šåˆ†ï¼Œä½¿å¾—è¿™é¢˜å¯ä»¥ç›´æ¥è®¡ç®—äº†ã€‚</p><p>åˆçœ‹å¼å­ï¼Œæˆ‘ä»¥ä¸ºä¼šçˆ†ç²¾åº¦ã€‚ï¼ˆç”±äºå¹¶ä¸ä¼šå¤„ç†æœªçŸ¥ç»„æ•°æ•°æ®ï¼‰æ‰“ç®—ç”¨ python æ‰“è¡¨ï¼Œå†™å‡ºäº†è¿™æ®µä»£ç  (python3)ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line">A = [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">B = [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">34</span>): <span class="comment"># [2, 34)</span></span><br><span class="line">  a = A[-<span class="number">1</span>]</span><br><span class="line">  b = B[-<span class="number">1</span>]</span><br><span class="line">  A.append(a * i + b)</span><br><span class="line">  B.append(b * i)</span><br><span class="line">  d = gcd(A[-<span class="number">1</span>], B[-<span class="number">1</span>])</span><br><span class="line">  A[-<span class="number">1</span>] //= d</span><br><span class="line">  B[-<span class="number">1</span>] //= d</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">34</span>):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125; &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(A[i], B[i]))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¾“å‡ºä½æ•°æœ€å¤šçš„ä¸€è¡Œæ˜¯ <code>586061125622639 144403552893600</code>ã€‚ç”±æ­¤å‘ç°è¾¹ç®—è¾¹çº¦åˆ†ï¼Œå¹¶ä¸ä¼šçˆ† <code>long long</code>ã€‚äºæ˜¯è¿™é¢˜å°±å¯ä»¥ç›´æ¥ç”¨ c++ Aæ‰äº†ã€‚å…·ä½“<del>æ¶å¿ƒ</del>çš„è¾“å‡ºæ ¼å¼è¯¦è§ä»£ç ã€‚</p><hr><p>å˜é‡è§£é‡Šä¸å‚è€ƒä»£ç  (c++11):</p><p><code>A[i]</code> ä¸ºè°ƒå’Œçº§æ•°å‰ç¼€å’Œç¬¬ i é¡¹çš„åˆ†å­</p><p><code>B[i]</code> ä¸ºè°ƒå’Œçº§æ•°å‰ç¼€å’Œç¬¬ i é¡¹çš„åˆ†æ¯</p><p><code>void Red(ll &amp;m, ll &amp;n)</code> å¯¹ &amp;m å’Œ &amp;n è¿›è¡Œçº¦åˆ†</p><p><code>int Len(ll n)</code> è¿”å›æ•´æ•° n çš„æ•°ä½ä¸ªæ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">ll A[<span class="number">35</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, B[<span class="number">35</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="comment">// B[1] éœ€è¦é¢„å¤„ç†ï¼Œå¦åˆ™æ— æ³•è®¡ç®—</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Red</span><span class="params">(ll &amp;m, ll &amp;n)</span> </span>&#123;</span><br><span class="line">  ll d = __gcd(m, n);</span><br><span class="line">    <span class="comment">// åº“å‡½æ•° __gcd() è”èµ›ä¸å¯ç”¨</span></span><br><span class="line">  m /= d, n /= d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(ll i = <span class="number">2</span>, a, b; i &lt;= <span class="number">33</span>; ++i) &#123;</span><br><span class="line">    a = A[i - <span class="number">1</span>], b  = B[i - <span class="number">1</span>];</span><br><span class="line">    A[i] = (ll)a * i + b;</span><br><span class="line">    B[i] = (ll)b * i;</span><br><span class="line">    <span class="built_in">Red</span>(A[i], B[i]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Len</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span> ++ans; <span class="keyword">while</span>(n /= <span class="number">10</span>);</span><br><span class="line">    <span class="comment">// do-while å¯ä»¥é¿å… n == 0 çš„æƒ…å†µå‡ºé”™</span></span><br><span class="line">    <span class="comment">// ä¸è¿‡åœ¨è¿™é‡Œç”¨ while ä¹Ÿä¸ä¼šå‡ºé—®é¢˜</span></span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">init</span>();</span><br><span class="line">  <span class="keyword">while</span>(cin &gt;&gt; N) &#123;</span><br><span class="line">    ll a = A[N] * N, b = B[N];</span><br><span class="line">    <span class="built_in">Red</span>(a, b); <span class="comment">// ç”±äºä¹˜äº†ä¸€ä¸ª $Nï¼Œéœ€è¦å†æ¬¡çº¦åˆ†</span></span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="comment">// å¦‚æœèƒ½æ•´é™¤ï¼Œç›´æ¥ç‰¹åˆ¤ï¼Œä¸éœ€è¾“å‡ºåˆ†æ•°</span></span><br><span class="line">      cout &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll k = a / b; <span class="comment">// k ä¸ºå¸¦åˆ†æ•°çš„æ•´æ•°éƒ¨åˆ†</span></span><br><span class="line">    a -= k * b;</span><br><span class="line">    <span class="keyword">int</span> lb = <span class="built_in">Len</span>(b), lk = <span class="built_in">Len</span>(k);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä»¥ä¸‹åˆ†åˆ«è¾“å‡ºå¸¦åˆ†æ•°çš„ä¸‰è¡Œ</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= lk + <span class="number">1</span>; ++i)</span><br><span class="line">      cout &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    cout &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    cout &lt;&lt; k &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= lb; ++i)</span><br><span class="line">      cout &lt;&lt; <span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= lk + <span class="number">1</span>; ++i)</span><br><span class="line">      cout &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    cout &lt;&lt; b &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœæœ‰é”™è¯¯æˆ–ä¸æ‡‚çš„åœ°æ–¹ï¼Œè¯·åœ¨ç§ä¿¡æˆ–è¯„è®ºä¸­å‘ŠçŸ¥æˆ‘ã€‚<strong>è°¢è°¢å¤§å®¶qwq</strong></p>]]></content>
      
      
      <categories>
          
          <category> é¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
            <tag> æ¦‚ç‡æœŸæœ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢˜è§£ UVA10214 ã€æ ‘æ—é‡Œçš„æ ‘ Trees in a Wood.ã€‘</title>
      <link href="/2019/%E9%A2%98%E8%A7%A3-UVA10214-%E3%80%90%E6%A0%91%E6%9E%97%E9%87%8C%E7%9A%84%E6%A0%91%20Trees%20in%20a%20Wood%E3%80%91/"/>
      <url>/2019/%E9%A2%98%E8%A7%A3-UVA10214-%E3%80%90%E6%A0%91%E6%9E%97%E9%87%8C%E7%9A%84%E6%A0%91%20Trees%20in%20a%20Wood%E3%80%91/</url>
      
        <content type="html"><![CDATA[<p>under é¢˜è§£ <a href="https://www.luogu.org/problem/UVA10214">UVA10214</a></p><hr><p>çœŸå¿ƒæ¨èåˆšå­¦è«åçš„åŒå­¦æ¥åšä¸€ä¸‹è¿™é“é¢˜ç›®ï¼Œè¿™æ‰æ˜¯çœŸæ­£çš„ Mobius åæ¼”å…¥é—¨é¢˜å•Šï¼</p><span id="more"></span><p><a href="https://www.luogu.org/problem/P2158">P2158 ä»ªä»—é˜Ÿ</a>æ˜¯è¿™é¢˜çš„ç‰¹æ®Šæƒ…å†µï¼Œå‰è€…å¯ä»¥ç”¨æ¬§æ‹‰ $\varphi$ å‡½æ•°è§£å†³ï¼Œè€Œè¿™é¢˜ç”¨ Mobius åæ¼”ç®€å•å¾—å¤šã€‚</p><p>æ²¡å­¦è¿‡è«åçš„å¯ä»¥æ¥æˆ‘çš„<a href="https://www.luogu.org/blog/fa555/solution-p4450">è¿™ç¯‡é¢˜è§£</a>çš„ å‰ç½®çŸ¥è¯† éƒ¨åˆ†å­¦ä¹ ä¸€ä¸‹ã€‚</p><p>æˆ‘ä»¬å›åˆ°è¿™é¢˜ã€‚</p><hr><p>åˆ†æé¢˜æ„ï¼Œæˆ‘ä»¬åªéœ€å°†å››ä¸ªè±¡é™ä¹‹ä¸€çš„ç­”æ¡ˆæ±‚å‡ºï¼Œå°±å¯æ¨å¹¿åˆ°æ•´ä¸ªåæ ‡ç³»ã€‚</p><p>ç®€åŒ–ç‰ˆé¢˜æ„ï¼šç»™å®šä¸€ä¸ª N * M çš„çŸ©é˜µï¼Œæ±‚</p><script type="math/tex; mode=display">\sum \limits_{i = 1}^N \sum \limits_{j = 1}^M [\gcd(i, j) = 1]</script><p>å°è¯•å¯¹è¿™ä¸ªå¼å­è¿›è¡Œå¥—è·¯æ€§çš„è«åå˜å½¢ï¼Œå¾—åˆ°</p><script type="math/tex; mode=display">\sum \limits_{i = 1}^N \sum \limits_{j = 1}^M \sum \limits_{d | \gcd(i, j)} \mu(d)</script><p>å¯ä»¥å°† $d | \gcd(i, j)$ æ‹†å¼€</p><script type="math/tex; mode=display">\sum \limits_{i = 1}^N \sum \limits_{j = 1}^M \sum \limits_{d | i, d | j} \mu(d)</script><p>æ”¹å˜æšä¸¾é¡ºåºï¼Œå¾—åˆ°</p><script type="math/tex; mode=display">\sum \limits_{d = 1}^{\min(N, M)} \mu(d) \lfloor \tfrac{N}{d} \rfloor \lfloor \tfrac{M}{d} \rfloor</script><p>å°±å¯ä»¥å•æ¬¡ $O(n)$ æšä¸¾ç­”æ¡ˆäº†ï¼</p><p>ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“æ•°æ®ç»„æ•° <del>åƒåœ¾UVA</del>ï¼Œæ‰€ä»¥ä¼˜åŒ–æ˜¯å¿…è¦çš„ã€‚å’Œå¼å«æœ‰ä¸¤ä¸ªå½¢å¦‚ $\lfloor \tfrac{N}{d} \rfloor$ çš„å› å­ï¼Œæ„å‘³ç€å¯ä»¥é€šè¿‡æ•°è®ºåˆ†å—ä¼˜åŒ–åˆ°å•æ¬¡ $O( \sqrt{N})$ çš„å¤æ‚åº¦ï¼Œå¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚</p><p>TIPS:</p><ol><li><p>æ±‚å‡ºçš„ <code>ans</code> æ˜¯å•ä¸ªè±¡é™ä¸­çš„ç­”æ¡ˆï¼ŒåŠ ä¸Šåæ ‡è½´å››ä¸ªæ–¹å‘çš„è´¡çŒ®å‡ä¸º <code>1</code>ï¼Œå› æ­¤ç­”æ¡ˆçš„åˆ†å­æ˜¯ <code>ans * 4 + 4</code>ã€‚</p></li><li><p>åŸç‚¹æ˜¯æ²¡æœ‰æ ‘çš„ï¼Œå› æ­¤åˆ†æ¯æ˜¯ <code>(N * 2 + 1) * (M * 2 + 1) - 1</code>ã€‚</p></li><li><p>æç«¯æ•°æ®çš„åˆ†æ¯ä¼šçˆ† <code>int</code>ï¼Œä¸è¦å¿˜è®° <code>long long</code> å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</p></li></ol><p>code(c++):</p><p><em>è¯·æ‰‹åŠ¨ä¼˜åŒ–å¸¸æ•°</em></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line">bitset&lt;2003&gt; v; <span class="comment">// æ­¤å¤„ä½œç”¨ç­‰ä»·äº bool v[2003];</span></span><br><span class="line"><span class="keyword">int</span> N, M, p[<span class="number">305</span>], mu[<span class="number">2003</span>];</span><br><span class="line">ll ans, tot;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">  mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span>(!v[i]) p[++m] = i, mu[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>, x; j &lt;= m &amp;&amp; i * p[j] &lt;= N; ++j) &#123;</span><br><span class="line">      x = i * p[j];</span><br><span class="line">      v.<span class="built_in">set</span>(x); <span class="comment">// v[x] = 1;</span></span><br><span class="line">      <span class="keyword">if</span>(i % p[j] == <span class="number">0</span>) <span class="keyword">break</span>; <span class="comment">// æ­¤æ—¶ mu[x] = 0;</span></span><br><span class="line">      mu[x] = -mu[i];</span><br><span class="line">    &#125;</span><br><span class="line">    mu[i] += mu[i - <span class="number">1</span>]; <span class="comment">// é¡ºä¾¿æ±‚å‡ºå‰ç¼€å’Œ</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cout &lt;&lt; fixed &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">7</span>);</span><br><span class="line">    <span class="comment">// è§„å®šè¾“å‡ºå°æ•°ä½æ•°</span></span><br><span class="line">  <span class="built_in">sieve</span>(<span class="number">2000</span>); <span class="comment">// min(maxa, maxb) = 2000</span></span><br><span class="line">  <span class="keyword">while</span>(cin &gt;&gt; N &gt;&gt; M) &#123;</span><br><span class="line">    <span class="keyword">if</span>(!N) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ans = <span class="number">0</span>; <span class="comment">// å¤šæµ‹ä¸æ¸…ç©ºï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª</span></span><br><span class="line">    <span class="keyword">if</span>(N &gt; M) <span class="built_in">swap</span>(N, M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, j, n, m; i &lt;= N; i = j + <span class="number">1</span>) &#123;</span><br><span class="line">      n = N / i, m = M / i; <span class="comment">// å¯æœ‰å¯æ— çš„å°å¸¸æ•°ä¼˜åŒ–</span></span><br><span class="line">      j = <span class="built_in">min</span>(N / n, M / m);</span><br><span class="line">      ans += (ll)(mu[j] - mu[i - <span class="number">1</span>]) * n * m;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = ans * <span class="number">4</span> + <span class="number">4</span>;</span><br><span class="line">    tot = (ll)(N * <span class="number">2</span> + <span class="number">1</span>) * (M * <span class="number">2</span> + <span class="number">1</span>) - <span class="number">1</span>;</span><br><span class="line">    cout &lt;&lt; (<span class="keyword">double</span>)ans / tot &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœæœ‰é”™è¯¯æˆ–ä¸æ‡‚çš„åœ°æ–¹ï¼Œè¯·åœ¨ç§ä¿¡æˆ–è¯„è®ºä¸­å‘ŠçŸ¥æˆ‘ã€‚<strong>è°¢è°¢å¤§å®¶ï¼</strong></p>]]></content>
      
      
      <categories>
          
          <category> é¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
            <tag> è«æ¯”ä¹Œæ–¯åæ¼” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢˜è§£ P4450 ã€åŒäº²æ•°ã€‘</title>
      <link href="/2019/%E9%A2%98%E8%A7%A3-P4450-%E3%80%90%E5%8F%8C%E4%BA%B2%E6%95%B0%E3%80%91/"/>
      <url>/2019/%E9%A2%98%E8%A7%A3-P4450-%E3%80%90%E5%8F%8C%E4%BA%B2%E6%95%B0%E3%80%91/</url>
      
        <content type="html"><![CDATA[<p><strong>updï¼š256 å¤©åçš„æ›´æ–°ï¼Œä¿®å¤äº†é”™è¯¯å’Œå…¬å¼æ ¼å¼ï¼Œå……å®äº†å†…å®¹</strong></p><p>under é¢˜è§£ <a href="https://www.luogu.org/problem/P4450">P4450</a></p><p><em>è’Ÿè’»ç¬¬ä¸€é“è«åé¢˜</em></p><p><em>æœ¬é¢˜è§£é€‚åˆæ–°æ‰‹å­¦ä¹ åŸºç¡€ï¼Œdalao è¯·è·³è¿‡ï¼Œä¸è¦å˜²è®½ qwq</em></p><span id="more"></span><hr><h3 id="å‰ç½®çŸ¥è¯†ï¼š"><a href="#å‰ç½®çŸ¥è¯†ï¼š" class="headerlink" title="å‰ç½®çŸ¥è¯†ï¼š"></a>å‰ç½®çŸ¥è¯†ï¼š</h3><h4 id="å•ä½å‡½æ•°ï¼ˆ-epsilon-ï¼‰ï¼š"><a href="#å•ä½å‡½æ•°ï¼ˆ-epsilon-ï¼‰ï¼š" class="headerlink" title="å•ä½å‡½æ•°ï¼ˆ$\epsilon$ï¼‰ï¼š"></a>å•ä½å‡½æ•°ï¼ˆ$\epsilon$ï¼‰ï¼š</h4><script type="math/tex; mode=display">\epsilon(i) = \begin{cases}1 &, i = 1 \\0 &, i \ne 1\end{cases}</script><p>å³å½“ä¸”ä»…å½“ <code>i = 1</code> æ—¶å–å€¼å–å€¼ä¸º <code>1</code>ï¼Œå¦åˆ™ä¸º <code>0</code>ã€‚å¾ˆç®€å•å¯¹ä¸å¯¹ï¼Ÿ</p><h4 id="Dirichlet-å·ç§¯ï¼ˆ-ast-ï¼‰ï¼š"><a href="#Dirichlet-å·ç§¯ï¼ˆ-ast-ï¼‰ï¼š" class="headerlink" title="Dirichlet å·ç§¯ï¼ˆ$\ast$ï¼‰ï¼š"></a>Dirichlet å·ç§¯ï¼ˆ$\ast$ï¼‰ï¼š</h4><p>Dirichlet å·ç§¯æ˜¯æ•°è®ºå‡½æ•°ä¹‹é—´çš„è¿ç®—ã€‚å³</p><script type="math/tex; mode=display">h = f \ast g</script><p>å…¶ä¸­ $f, g, h$ å‡ä¸ºæ•°è®ºå‡½æ•°ã€‚åˆ™</p><script type="math/tex; mode=display">h(n) = \sum_{d | n}{f(d) g \left(\frac nd \right)}</script><p>ä¹Ÿå¯ä»¥å†™ä½œ</p><script type="math/tex; mode=display">h(n) = \sum_{i Â· j = n}{f(i) g(j)}</script><p>æˆ‘ä»¬å‘ç°ï¼š$\epsilon$ å‡½æ•°æ˜¯ Dirichlet å·ç§¯çš„å•ä½å…ƒï¼Œå³ $f = f \ast \epsilon$ã€‚</p><h4 id="Mobius-å‡½æ•°ï¼ˆ-mu-ï¼‰ï¼š"><a href="#Mobius-å‡½æ•°ï¼ˆ-mu-ï¼‰ï¼š" class="headerlink" title="Mobius å‡½æ•°ï¼ˆ$\mu$ï¼‰ï¼š"></a>Mobius å‡½æ•°ï¼ˆ$\mu$ï¼‰ï¼š</h4><script type="math/tex; mode=display">\mu(n) = \begin{cases}1 &, n = 1 \\(-1)^m &, n = p_1p_2 \cdots p_m \\0 &, \mathrm{otherwise}\end{cases}</script><p>å…¶ä¸­ $p_1,p_2, \cdots, p_m$ æ˜¯ä¸åŒçš„è´¨æ•°ã€‚$\mu(n)$ æ°åœ¨ $n$ æ— å¹³æ–¹å› å­æ—¶å–å€¼éé›¶ã€‚æ˜¾ç„¶ $\mu$ æ˜¯ç§¯æ€§å‡½æ•°ã€‚</p><script type="math/tex; mode=display">\sum_{d | n}{\mu(d)} = \epsilon(n) \\\epsilon = 1 \ast \mu</script><h4 id="Mobius-å˜æ¢"><a href="#Mobius-å˜æ¢" class="headerlink" title="Mobius å˜æ¢"></a>Mobius å˜æ¢</h4><p>è®¾ $f$ æ˜¯æ•°è®ºå‡½æ•°ï¼Œè‹¥æ•°è®ºå‡½æ•° $g$ æ»¡è¶³</p><script type="math/tex; mode=display">\begin{align}g &=  f * \mathbf1 \\\textrm{That is} \quad g(n) &= \sum_{d | n}{f(d)}\end{align}</script><p>åˆ™ç§° $g$ æ˜¯ $f$ çš„ Mobius å˜æ¢ã€‚</p><p>æ¨ä¸€ä¸‹å¼å­ã€‚</p><script type="math/tex; mode=display">g = f \ast 1 \Rightarrow f = f \ast \epsilon = f \ast 1 \ast \mu = g \ast \mu</script><p>å³</p><script type="math/tex; mode=display">g = f \ast 1 \Leftrightarrow f = g \ast \mu</script><p>è‡³æ­¤å°±å¯ä»¥æ¥åšè¿™é“é¢˜äº†ã€‚</p><hr><p>å›åˆ°äº†åŸé¢˜ã€‚é¢˜ç›®è¦æ±‚çš„æ˜¯</p><script type="math/tex; mode=display">\sum_{i = 1}^A{\sum_{j = 1}^B{[\gcd(i, j) = d]}}</script><p>å¯¹å¼å­è¿›è¡Œå¥—è·¯æ€§çš„å˜å½¢</p><script type="math/tex; mode=display">\sum_{i = 1}^{\lfloor A / d \rfloor}{\sum_{j = 1}^{\lfloor B / d \rfloor}{[\gcd(i, j) = 1]}}</script><p>å‡ºç°äº† $[ \gcd(i, j) = 1]$ï¼Œä¹Ÿå³ $\epsilon( \gcd(i, j))$ã€‚æŠŠ $\epsilon = 1 \ast \mu$ ä»£å…¥ï¼Œå¾—åˆ°äº†</p><script type="math/tex; mode=display">\sum_{i = 1}^{\lfloor A / d \rfloor}{\sum_{j = 1}^{\lfloor B / d \rfloor}{\sum_{g | \gcd(i, j)}{\mu(g)}}}</script><p><del>ï¼ˆä¼¼ä¹è¶Šæ¥è¶Šä¸‘äº†ï¼‰</del>æ­¤æ—¶å¯ä»¥æŠŠ $d | \gcd(i, j)$ æ‹†å¼€ï¼š</p><script type="math/tex; mode=display">\begin{align}& \sum_{i = 1}^{\lfloor A / d \rfloor}{\sum_{j = 1}^{\lfloor B / d \rfloor}{\sum_{g | i, g | j}{\mu(g)}}} \\=& \sum_{g = 1}^{\min(A / d, B / d)}{\mu(g) \left\lfloor \frac{A}{dg} \right\rfloor \left\lfloor \frac{B}{dg} \right\rfloor}\end{align}</script><p>è‡³æ­¤ï¼Œè®¡ç®—ç­”æ¡ˆå¯ä»¥ $O(n)$ è§£å†³ã€‚</p><p>ç®—æ³•è¿˜å¯ä»¥ç»§ç»­ä¼˜åŒ–ã€‚å‘ç°å¼å­é‡Œè¿˜æœ‰ä¸¤ä¸ªå½¢å¦‚ $\lfloor n / d \rfloor$ çš„å› å­ï¼Œå› æ­¤å¯ä»¥æ•´é™¤åˆ†å—ä¼˜åŒ–æˆ $O(\sqrt{n})$ çš„ã€‚é…åˆ $O(n)$ çš„çº¿æ€§ç­› $\mu$ å‡½æ•°ï¼Œæ€»å¤æ‚åº¦ $O(n)$ï¼Œå¯ä»¥è½»æ¾é€šè¿‡æœ¬é¢˜ã€‚</p><hr><h3 id="code-1"><a href="#code-1" class="headerlink" title="code 1"></a>code 1</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">std::bitset&lt;1000003&gt; v;</span><br><span class="line"><span class="keyword">int</span> p[<span class="number">78501</span>], mu[<span class="number">1000003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  v.<span class="built_in">set</span>(<span class="number">1</span>), mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!v[i]) p[++m] = i, mu[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m &amp;&amp; i * p[j] &lt;= N; ++j) &#123;</span><br><span class="line">      v.<span class="built_in">set</span>(i * p[j]);</span><br><span class="line">      <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">      mu[i * p[j]] = -mu[i];</span><br><span class="line">    &#125;</span><br><span class="line">    mu[i] += mu[i - <span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> A, B, d;</span><br><span class="line">  <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  std::cin &gt;&gt; A &gt;&gt; B &gt;&gt; d;</span><br><span class="line">  A /= d, B /= d;</span><br><span class="line">  <span class="keyword">if</span> (A &gt; B) std::<span class="built_in">swap</span>(A, B);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">sieve</span>(A);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r, a, b; l &lt;= A; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">    a = A / l, b = B / l;</span><br><span class="line">    r = std::<span class="built_in">min</span>(A / a, B / b);</span><br><span class="line">    ans += <span class="number">1ll</span> * a * b * (mu[r] - mu[l - <span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  std::cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="code-2"><a href="#code-2" class="headerlink" title="code 2"></a>code 2</h3><p><del>å¦‚æœä½ åƒæˆ‘ä¸€æ ·é—²å¾—éš¾å—ï¼Œå¯ä»¥å­¦æ¥æœæ•™ç­›å†™å†™è¿™é¢˜ï¼Œå¤æ‚åº¦å¥½åƒè¿˜æ›´é«˜äº†ã€‚</del></p><p>ä¸ä¼šæœæ•™ç­›ä½†æƒ³å­¦çš„æœ‹å‹å¯ä»¥æ¥çœ‹æˆ‘çš„<a href="https://fa555.github.io/2020/æœæ•™ç­›å­¦ä¹ ç¬”è®°/">è¿™ç¯‡é¢˜è§£</a>ã€‚</p><p>è¿™ä¸ªå¤šæ¬¡è¯¢é—®çš„é¢˜ç›®è®©æˆ‘å¯¹æœæ•™ç­›åŠç©ºé—´ä¼˜åŒ–æœ‰äº†æ›´æ·±å…¥çš„ç†è§£ï¼ˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">std::bitset&lt;10003&gt; v, vm;</span><br><span class="line"><span class="keyword">int</span> MX, base, p[<span class="number">1231</span>], mu[<span class="number">10003</span>], mu_[<span class="number">10003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">to</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> MX / x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> N)</span></span>; <span class="comment">// åŒ code 1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getMu</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (N &lt;= base) <span class="keyword">return</span> mu[N];</span><br><span class="line">  <span class="keyword">if</span> (vm[<span class="built_in">to</span>(N)]) <span class="keyword">return</span> mu_[<span class="built_in">to</span>(N)];</span><br><span class="line">  <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>, r, L; l &lt;= N; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">    L = N / l, r = N / L;</span><br><span class="line">    ans += (r - l + <span class="number">1</span>) * <span class="built_in">getMu</span>(L);</span><br><span class="line">  &#125;</span><br><span class="line">  vm.<span class="built_in">set</span>(<span class="built_in">to</span>(N));</span><br><span class="line">  <span class="keyword">return</span> mu_[<span class="built_in">to</span>(N)] = <span class="number">1</span> - ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> A, B, d;</span><br><span class="line">  <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  std::cin &gt;&gt; A &gt;&gt; B &gt;&gt; d;</span><br><span class="line">  A /= d, B /= d;</span><br><span class="line">  <span class="keyword">if</span> (A &gt; B) std::<span class="built_in">swap</span>(A, B);</span><br><span class="line"></span><br><span class="line">  MX = A, base = <span class="built_in">pow</span>(A, <span class="number">2.</span> / <span class="number">3</span>);</span><br><span class="line">  <span class="built_in">sieve</span>(base);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r, a, b, gR, gL; l &lt;= A; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">    a = A / l, b = B / l;</span><br><span class="line">    r = std::<span class="built_in">min</span>(A / a, B / b);</span><br><span class="line">    vm.<span class="built_in">reset</span>(), gR = <span class="built_in">getMu</span>(r);</span><br><span class="line">    vm.<span class="built_in">reset</span>(), gL = <span class="built_in">getMu</span>(l - <span class="number">1</span>);</span><br><span class="line">    ans += <span class="number">1ll</span> * a * b * (gR - gL);</span><br><span class="line">  &#125;</span><br><span class="line">  std::cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
            <tag> è«æ¯”ä¹Œæ–¯åæ¼” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢˜è§£ P5142 ã€åŒºé—´æ–¹å·®ã€‘</title>
      <link href="/2019/%E9%A2%98%E8%A7%A3-P5142-%E3%80%90%E5%8C%BA%E9%97%B4%E6%96%B9%E5%B7%AE%E3%80%91/"/>
      <url>/2019/%E9%A2%98%E8%A7%A3-P5142-%E3%80%90%E5%8C%BA%E9%97%B4%E6%96%B9%E5%B7%AE%E3%80%91/</url>
      
        <content type="html"><![CDATA[<p>under é¢˜è§£ <a href="https://www.luogu.org/problemnew/show/P5142">P5142</a></p><hr><p>é¢˜ç›®è¦æ±‚ç»´æŠ¤æ¨¡æ„ä¹‰ä¸‹çš„åŒºé—´æ–¹å·®ï¼Œæ˜¾ç„¶æ˜¯æ•°æ®ç»“æ„é¢˜ã€‚</p><span id="more"></span><p>è€ƒè™‘æ–¹å·®å…¬å¼ï¼š</p><script type="math/tex; mode=display">\begin{aligned}\sigma^2 &= \frac{1}{n} \sum \limits_{i = 1}^n (x_i - \bar{x})^2 \\&= \frac{1}{n} (\sum \limits_{i = 1}^n x_i^2 - 2 \bar{x} \sum \limits_{i = 1}^nx_i + n \bar{x}^2) \\&= \frac{1}{n} (\sum \limits_{i = 1}^n x_i^2 - 2 \bar{x} \times n \bar{x} + n \bar{x}^2) \\&= \frac{1}{n} \sum \limits_{i = 1}^n x_i^2 - \bar{x}^2\end{aligned}</script><p>è€Œç®—æœ¯å¹³å‡æ•°</p><script type="math/tex; mode=display">\begin{aligned} \bar{x} &= \frac{1}{n} \sum \limits_{i = 1}^n x_i \end{aligned}</script><p>å¯ä»¥å‘ç°ï¼Œåªè¦ç»´æŠ¤åºåˆ—çš„<strong>åŒºé—´å’Œ</strong>å’Œ<strong>åŒºé—´å¹³æ–¹å’Œ</strong>ï¼Œå°±å¯ä»¥ç»´æŠ¤å¹³å‡æ•°å’Œæ–¹å·®ã€‚</p><p><strong>åŒºé—´å’Œ</strong>å’Œ<strong>åŒºé—´å¹³æ–¹å’Œ</strong>éƒ½<strong>æ»¡è¶³ç»“åˆå¾‹</strong>ï¼Œå› æ­¤å¯ä»¥ç”¨<strong>çº¿æ®µæ ‘</strong>ç»´æŠ¤ã€‚</p><hr><p>é¢˜ç›®è¦æ±‚å¯¹ $ 1e9+7 $ å–æ¨¡ï¼Œè€Œ $ 1e9+7 &lt; \frac{INT _ MAX}{2} $ï¼Œå®Œå…¨å¯ä»¥ä¸ä½¿ç”¨ <code>long long</code> å˜é‡ç»´æŠ¤ã€‚</p><p><em>æ³¨ï¼šæ­¤å¤„ MathJax å‡ºé”…ï¼Œå®é™…ä¸º INT_MAX</em></p><p>äºæ˜¯å†™äº†ä¸€å‘ä»£ç ï¼Œçœ‹çœ‹<del>æ¯’ç˜¤</del>çœŸæ­£çš„å–æ¨¡å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢<del>çš„å¤§å¸¸æ•°</del>æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼š</p><p>ä»£ç (c++11) å«æ³¨é‡Šï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, op, x, y, s1, s2, inv, ave, ans, z[<span class="number">100003</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> b, <span class="keyword">int</span> p = mod - <span class="number">2</span>, <span class="keyword">int</span> m = mod)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// å¿«é€Ÿå¹‚ç”¨äºè´¹é©¬å°å®šç†æ±‚é€†å…ƒ </span></span><br><span class="line">  b %= m;</span><br><span class="line">  <span class="keyword">int</span> s = <span class="number">1</span> % m;</span><br><span class="line">  <span class="keyword">for</span>(; p; p &gt;&gt;= <span class="number">1</span>, b = (ll)b * b % m)</span><br><span class="line">    <span class="keyword">if</span>(p &amp; <span class="number">1</span>) s = (ll)s * b % m;</span><br><span class="line">  <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> SGT &#123;</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> ls p&lt;&lt;1</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> rs p&lt;&lt;1|1</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> sr(x) ((ll)(x)*(x)%mod) <span class="comment">// æ³¨æ„è¿™ä¸ªå® </span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> L[<span class="number">400003</span>], R[<span class="number">400003</span>], s1[<span class="number">4000003</span>], s2[<span class="number">400003</span>];</span><br><span class="line">    <span class="comment">// s1[] å­˜å‚¨åŒºé—´å’Œï¼Œs2[] å­˜å‚¨åŒºé—´å¹³æ–¹å’Œ </span></span><br><span class="line">    <span class="comment">// ç”±äºæ— åŒºé—´ä¿®æ”¹ï¼Œä¸éœ€è¦ lazytag å’Œ pushdown æ“ä½œ </span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    s1[p] = (s1[ls] + s1[rs]) % mod;</span><br><span class="line">    s2[p] = (s2[ls] + s2[rs]) % mod;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    L[p] = l, R[p] = r;</span><br><span class="line">    <span class="keyword">if</span>(l == r) &#123;</span><br><span class="line">      s1[p] = z[l] % mod;</span><br><span class="line">      s2[p] = <span class="built_in">sr</span>(z[l]) % mod;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(ls, l, m);</span><br><span class="line">    <span class="built_in">build</span>(rs, m + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> k, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å•ç‚¹ä¿®æ”¹ </span></span><br><span class="line">    <span class="keyword">if</span>(L[p] == R[p]) &#123;</span><br><span class="line">      s1[p] = v % mod;</span><br><span class="line">      s2[p] = <span class="built_in">sr</span>(v) % mod;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m = (L[p] + R[p]) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= m) <span class="built_in">modify</span>(ls, k, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">modify</span>(rs, k, v);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">query1</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¯¢é—®åŒºé—´å’Œ </span></span><br><span class="line">    <span class="keyword">if</span>(l == L[p] &amp;&amp; r == R[p]) <span class="keyword">return</span> s1[p] % mod;</span><br><span class="line">    <span class="keyword">int</span> m = (L[p] + R[p]) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(r &lt;= m) <span class="keyword">return</span> <span class="built_in">query1</span>(ls, l, r) % mod;</span><br><span class="line">    <span class="keyword">if</span>(l &gt; m) <span class="keyword">return</span> <span class="built_in">query1</span>(rs, l, r) % mod;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">query1</span>(ls, l, m) + <span class="built_in">query1</span>(rs, m + <span class="number">1</span>, r)) % mod;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">query2</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¯¢é—®åŒºé—´å¹³æ–¹å’Œ </span></span><br><span class="line">    <span class="keyword">if</span>(l == L[p] &amp;&amp; r == R[p]) <span class="keyword">return</span> s2[p] % mod;</span><br><span class="line">    <span class="keyword">int</span> m = (L[p] + R[p]) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(r &lt;= m) <span class="keyword">return</span> <span class="built_in">query2</span>(ls, l, r) % mod;</span><br><span class="line">    <span class="keyword">if</span>(l &gt; m) <span class="keyword">return</span> <span class="built_in">query2</span>(rs, l, r) % mod;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">query2</span>(ls, l, m) + <span class="built_in">query2</span>(rs, m + <span class="number">1</span>, r)) % mod;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;N, &amp;M);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;z[i]);</span><br><span class="line">  SGT::<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, N);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">while</span>(M--) &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line">    <span class="keyword">if</span>(op == <span class="number">1</span>) SGT::<span class="built_in">modify</span>(<span class="number">1</span>, x, y % mod);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// ä»¥ä¸‹å„å˜é‡å‡åœ¨æ¨¡æ„ä¹‰ä¸‹ </span></span><br><span class="line">      <span class="comment">// å¼ºåˆ¶ç±»å‹è½¬æ¢ (ll) ä¸€ä¸ªä¹Ÿä¸èƒ½å°‘ï¼ </span></span><br><span class="line">      s1 = SGT::<span class="built_in">query1</span>(<span class="number">1</span>, x, y) % mod;    <span class="comment">// åŒºé—´å’Œ </span></span><br><span class="line">      s2 = SGT::<span class="built_in">query2</span>(<span class="number">1</span>, x, y) % mod;    <span class="comment">// åŒºé—´å¹³æ–¹å’Œ </span></span><br><span class="line">      inv = <span class="built_in">qpow</span>(y - x + <span class="number">1</span>);              <span class="comment">// åŒºé—´é•¿åº¦ï¼ˆåˆ†æ¯ï¼‰çš„é€†å…ƒ </span></span><br><span class="line">      ave = (ll)s1 * inv % mod;           <span class="comment">// åŒºé—´ç®—æœ¯å¹³å‡æ•° </span></span><br><span class="line">      ans = (ll)s2 * inv % mod - (ll)ave * ave % mod;</span><br><span class="line">      ans = (ans % mod + mod) % mod;      <span class="comment">// åŒºé—´æ–¹å·®ï¼Œå‰æ–‡æœ‰å‡æ³•æ“ä½œï¼Œé˜²æ­¢å‡ºç°è´Ÿæ•°</span></span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><p>åè®°ï¼š</p><p>æ•…æ„ä¸å¼€ <code>long long</code> å¹¶ä¸æ˜¯ä¸ºäº†æ¯’ç˜¤ï¼Œè€Œæ˜¯ä¸ºäº†ç£¨ç‚¼è‡ªå·±çš„åŸºæœ¬åŠŸã€‚</p><p>åœ¨å¹³å¸¸çš„ç»ƒä¹ ä¸­æŠŠåˆ€ç£¨é”‹åˆ©ï¼Œæ‰èƒ½åœ¨è€ƒè¯•ä¸­å¾—å¿ƒåº”æ‰‹åœ°ä½¿ç”¨ã€‚</p><p><del>ï¼ˆå¯“è¨€æ•…äº‹è‰ï¼‰</del></p><p>å¦‚æœæœ‰é”™è¯¯æˆ–ä¸æ‡‚çš„åœ°æ–¹ï¼Œè¯·åœ¨ç§ä¿¡æˆ–è¯„è®ºä¸­å‘ŠçŸ¥æˆ‘ã€‚<strong>è°¢è°¢å¤§å®¶ï¼</strong></p>]]></content>
      
      
      <categories>
          
          <category> é¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢˜è§£ AT2648 ã€pushpushã€‘</title>
      <link href="/2019/%E9%A2%98%E8%A7%A3-AT2648-%E3%80%90pushpush%E3%80%91/"/>
      <url>/2019/%E9%A2%98%E8%A7%A3-AT2648-%E3%80%90pushpush%E3%80%91/</url>
      
        <content type="html"><![CDATA[<p>under é¢˜è§£ <a href="https://www.luogu.org/problemnew/show/AT2648">AT2648</a></p><hr><p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬å¤šæ¬¡ç¿»è½¬åºåˆ—ï¼Œä½†æ—¶é—´å¤æ‚åº¦æ˜¾ç„¶ä¸å…è®¸ã€‚</p><p>æ€è€ƒå‘ç°å¯ä»¥åœ¨åºåˆ—é¦–å°¾æ’å…¥æ¥é¿å…ç¿»è½¬æ“ä½œã€‚</p><p>å¯ä»¥å€ŸåŠ© STL å®¹å™¨ã€‚ä½†æ˜¯è¯¥é€‰æ‹©å“ªä¸€ç§å®¹å™¨å‘¢ï¼Ÿ</p><span id="more"></span><hr><p>ä»¥ä¸‹å†…å®¹éƒ¨åˆ†å¼•ç”¨è‡ª <a href="https://zh.cppreference.com/w/%E9%A6%96%E9%A1%B5">cppreference</a></p><p>STL ä¸­æä¾›äº†ä¸‰ç§æ”¯æŒé¦–å°¾æ’å…¥çš„å®¹å™¨ã€‚</p><p><strong><code>std::vector</code></strong></p><ul><li>éšæœºè®¿é—®â€”â€”å¸¸æ•° O(1)</li><li>åœ¨æœ«å°¾æ’å…¥æˆ–ç§»é™¤å…ƒç´ â€”â€”å‡æ‘Šå¸¸æ•° O(1)</li><li>æ’å…¥æˆ–ç§»é™¤å…ƒç´ â€”â€”ä¸åˆ° vector ç»“å°¾çš„è·ç¦»æˆçº¿æ€§ O(n)</li></ul><p><strong><code>std::deque</code></strong></p><ul><li>éšæœºè®¿é—®â€”â€”å¸¸æ•° O(1)</li><li>åœ¨ç»“å°¾æˆ–èµ·å§‹æ’å…¥æˆ–ç§»é™¤å…ƒç´ â€”â€”å¸¸æ•° O(1)</li><li>æ’å…¥æˆ–ç§»é™¤å…ƒç´ â€”â€”çº¿æ€§ O(n)</li></ul><p><strong><code>std::list</code></strong></p><p><del>cppreference å¹¶æ²¡æœ‰æ ‡æ³¨å¤æ‚åº¦</del></p><p>list é€šå¸¸å®ç°ä¸ºåŒå‘é“¾è¡¨ï¼Œå› æ­¤å…·æœ‰ç±»ä¼¼é“¾è¡¨çš„å¤æ‚åº¦ï¼ˆå’Œæ›´å¤§çš„å¸¸æ•°ï¼‰ã€‚</p><p>ä»å®é™…è¿è¡Œæ¥çœ‹ï¼Œlist å…·æœ‰ O(1) çš„éšæœºæ’å…¥ / ç§»é™¤å¤æ‚åº¦ï¼Œä½†åªæœ‰ O(N) çš„éšæœºè®¿é—®ã€‚ <del>ä¸å°±æ˜¯ä¸èƒ½éšæœºè®¿é—®å—è¯´é‚£ä¹ˆå¤šå¹²å•¥</del></p><p><a href="http://www.cppblog.com/sailing/articles/161659.html">é™„æ€§èƒ½æµ‹è¯•å®éªŒä¸€ç»„</a></p><hr><p>å›åˆ°æœ¬é¢˜ã€‚é¢˜ç›®éœ€è¦ä»åºåˆ—é¦–å°¾æ’å…¥ï¼Œä½†ä¸éœ€è¦éšæœºè®¿é—®ï¼Œå› æ­¤ deque å’Œ list éƒ½å¯ä»¥é€‰æ‹©ã€‚ä¸ºäº†é¿å…å¸¸æ•°å½±å“ï¼Œæˆ‘ä»¬é€‰æ‹©è¾ƒå¿«çš„ dequeã€‚</p><p>ä»£ç  (C++11) ï¼ˆå¡åˆ°äº†æœ€ä¼˜è§£ç¬¬ä¸€ç‚æµ·æ˜Ÿï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, a;</span><br><span class="line">deque&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin &gt;&gt; N;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">    cin &gt;&gt; a;</span><br><span class="line">    <span class="keyword">if</span>(i &amp; <span class="number">1</span>) q.<span class="built_in">push_back</span>(a);</span><br><span class="line">    <span class="keyword">else</span> q.<span class="built_in">push_front</span>(a);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(N &amp; <span class="number">1</span>) <span class="built_in">reverse</span>(q.<span class="built_in">begin</span>(), q.<span class="built_in">end</span>());</span><br><span class="line">    <span class="comment">// åºåˆ—é•¿åº¦æ˜¯å¥‡æ•°æ—¶æœ€ååˆ«å¿˜äº†ç¿»è½¬</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it = q.<span class="built_in">begin</span>(); it != q.<span class="built_in">end</span>(); ++it)</span><br><span class="line">    cout &lt;&lt; *it &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong><del>æˆ‘æ°¸è¿œå–œæ¬¢ STL</del></strong></p>]]></content>
      
      
      <categories>
          
          <category> é¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> é˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢˜è§£ AT1157 ã€2015ã€‘</title>
      <link href="/2019/%E9%A2%98%E8%A7%A3-AT1157-%E3%80%902015%E3%80%91/"/>
      <url>/2019/%E9%A2%98%E8%A7%A3-AT1157-%E3%80%902015%E3%80%91/</url>
      
        <content type="html"><![CDATA[<p>under é¢˜è§£ <a href="https://www.luogu.org/problemnew/show/AT1157">AT1157</a></p><span id="more"></span><hr><p><strong>é¢˜æ„</strong></p><p>ç»™å®šæ•°å­— $N$ï¼Œåˆ¤æ–­å®ƒçš„äºŒè¿›åˆ¶æ˜¯å¦æ˜¯å›æ–‡ã€‚</p><p>äºŒè¿›åˆ¶ï¼Ÿå½“ç„¶æ˜¯ç”¨ bitsetï¼</p><p>$O( \frac{n}{w})$ çš„æ—¶ç©ºå¤æ‚åº¦ã€å®ç°äº†ä¸ <code>unsigned long</code> å’Œ <code>std::string</code> ä¹‹é—´çš„ç±»å‹è½¬æ¢ï¼Œç®€ç›´ä¸è¦æ›´å¥½ç”¨ï¼</p><p>ç›´æ¥ä¸Šä»£ç ï¼Œ<del>æ³¨é‡Šæ‰æ˜¯æœ¬ä½“</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span> <span class="comment">// std::bitset å¤´æ–‡ä»¶ </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line">bitset&lt;32&gt; bit; <span class="comment">// N &lt;= 10^9ï¼Œä¸å°‘äº 30 ä½ </span></span><br><span class="line">string s, r;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cin &gt;&gt; N;</span><br><span class="line">  bit = (<span class="keyword">unsigned</span>)N;</span><br><span class="line">    <span class="comment">// bitset æ”¯æŒä¸ unsigned long ä¹‹é—´ä½¿ç”¨ = è¿ç®—ç¬¦èµ‹å€¼ </span></span><br><span class="line"></span><br><span class="line">  s = r = bit.<span class="built_in">to_string</span>().<span class="built_in">substr</span>(<span class="number">32</span> - <span class="built_in">log2</span>(N));</span><br><span class="line">    <span class="comment">// æˆå‘˜å‡½æ•° to_string() è¿”å› std::string </span></span><br><span class="line">    <span class="comment">// æ³¨æ„é«˜ä½ä¸è¶³æ—¶ä¼šç”¨ &#x27;0&#x27; è¡¥é½ï¼Œè¦å»é™¤é«˜ä½çš„ &#x27;0&#x27; </span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">reverse</span>(r.<span class="built_in">begin</span>(), r.<span class="built_in">end</span>());</span><br><span class="line">  cout &lt;&lt; (s == r ? <span class="string">&quot;Yes&quot;</span> : <span class="string">&quot;No&quot;</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­å¹¶è¾“å‡º </span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong><del>æˆ‘æ°¸è¿œçˆ±STL</del></strong></p>]]></content>
      
      
      <categories>
          
          <category> é¢˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¨¡æ‹Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠå¤œç¡ä¸ç€æ‰¯æ·¡æ–‡å­¦</title>
      <link href="/2003/%E5%8D%8A%E5%A4%9C%E7%9D%A1%E4%B8%8D%E7%9D%80%E6%89%AF%E6%B7%A1%E6%96%87%E5%AD%A6/"/>
      <url>/2003/%E5%8D%8A%E5%A4%9C%E7%9D%A1%E4%B8%8D%E7%9D%80%E6%89%AF%E6%B7%A1%E6%96%87%E5%AD%A6/</url>
      
        <content type="html"><![CDATA[<p>çº¯ä¹±å†™çš„ï¼Œå¦‚æœ‰é›·åŒçº¯å±å·§åˆã€‚è¿˜æ²¡å†™å®Œã€‚</p><hr><p>ã€€ã€€é«˜ä¸­å‰ä¸¤å¹´ä¸­æœ‰ä¸€å¹´åŠç»å¸¸å»æœºæˆ¿ï¼Œä¸æ€ä¹ˆåœ¨æ•™å®¤å‘†ï¼Œå°¤å…¶æ˜¯è¯­æ–‡è‹±è¯­åŒ–å­¦ç”Ÿç‰©è¯¾æœæ–­å…¨ç¿˜ï¼Œå•¥éƒ½æ²¡å­¦è¿‡ã€‚<br>ã€€ã€€é«˜äºŒä¸‹å­¦æœŸç”±äºç–«æƒ…æ™šæ”¾å‡äº†ä¸€ä¸ªæœˆï¼Œå½¼æ—¶æˆ‘å·²ç»ç«èµ›å¤±è´¥å›ç­äº†ã€‚è™½è¯´å¤±å»äº†ç¿˜è¯¾çš„ç†ç”±ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸æƒ³ä¸Šè¯­æ–‡è¯¾ï¼Œå°±ç»å¸¸å»å¯¹é¢æ•™å®¤è‡ªå·±å‘†ç€ã€‚<br>ã€€ã€€é‚£ä¸ªå­¦æœŸçš„æœ€åä¸€å¤©å¥½åƒæ˜¯ä¸ƒæœˆæœ«æˆ–å…«æœˆåˆã€‚ä¸‹è¯¾åæˆ‘èµ–åœ¨å¯¹é¢æ•™å®¤æ²¡å›å»ï¼Œç»“æœè¿›æ¥äº†æ€æ°”è…¾è…¾çš„è¯­æ–‡è€å¸ˆğŸ·ğŸšã€‚ğŸ·ğŸšæ¶ç‹ ç‹ åœ°æå“æˆ‘ï¼Œè¯´è®©æˆ‘æš‘å‡æŠŠå¤è¯—æ–‡éƒ½èƒŒäº†ï¼Œå›æ¥ç‹ ç‹ åœ°æé—®æˆ‘ã€‚<br>ã€€ã€€æˆ‘ï¼šæ˜‚ã€‚<br>ã€€ã€€è½¬å¤´å›äº†ç­é‡Œè·Ÿå“¥ä»¬æ‰“å¬èƒŒè¯µæé—®åˆ°å“ªäº†ï¼Œç­”æ›° xxxã€‚ç¿»å¼€ä¹¦ä¸€çœ‹ä¸‹ä¸€ç¯‡ï¼Œé¡¹è„Šè½©å¿—ã€‚å¾—äº†ï¼Œå°±ä»è¿™å¼€å§‹èƒŒâ€¦â€¦<br>ã€€ã€€å—ï¼Ÿä¸å¯èƒ½çš„ã€‚è™½è¯´ä¸€ç›´æ²¡å¿˜ï¼Œä½†æ˜¯æˆ‘è¿™ b æ‹–å»¶ç—‡ç›´åˆ°å¼€å­¦æ‰å¼€å§‹ç„¦è™‘è¿™äº‹ã€‚åˆšå¼€å­¦çš„å‰å‡ å¤©æˆ‘æå¿ƒåŠèƒ†ï¼Œæ¯ä¸ªæ—©è¯»éƒ½æ­»äº†å‘½çš„èƒŒé¡¹è„Šè½©å¿—ã€‚å½“æ—¶æ»¡è„‘å­éƒ½æ˜¯æ€äº†æˆ‘å§è¿™æ–‡ç« æ€ä¹ˆè¿™ä¹ˆéš¾èƒŒå•Šã€‚<br>ã€€ã€€è¿‡äº†ä¸€å‘¨ğŸ·ğŸšå¼€å§‹æé—®äº†ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªç¬‘ç‚¹ã€‚ç¬‘ç‚¹è§£æ 1ï¼šğŸ·ğŸšå‹æ ¹å¿˜äº†å¥¹è¯´è¦æé—®æˆ‘çš„äº‹ï¼Œå¤©å¤©ç„¦è™‘çš„æˆ‘æ˜¯å°ä¸‘ã€‚ç¬‘ç‚¹è§£æ 2ï¼šå±±ä¸œæ–°é«˜è€ƒå‹æ ¹ä¸è€ƒé¡¹è„Šè½©å¿—ï¼Œä¸ç”¨èƒŒè¿™ç¯‡ï¼Œæˆ‘æ˜¯å¤§ä¸‘ã€‚<br>ã€€ã€€ä¸è¿‡ğŸ·ğŸšå¿˜äº†è¦ä¸“é—¨æé—®æˆ‘ï¼Œè¿™äº‹å½’æ ¹ç»“åº•è¿˜æ˜¯æˆ‘èµ¢ã€‚</p><p>ã€€ã€€é«˜ä¸‰é‚£ä¼šä¹Ÿä¸çŸ¥é“å’‹å›äº‹ï¼Œæ¯å¤©æ—©èµ·æ™šç¡è¿˜ç¡ä¸ç€ï¼Œä½†æ˜¯å°±æ˜¯ä¸å›°ã€‚ä¸è¿‡æœ‰ä¸ªå‰¯ä½œç”¨æ˜¯æ¯å¤©ä¸ŠåˆåŒ–å­¦è¯¾éƒ½å‘åŠ¨è¢«åŠ¨æŠ€èƒ½æ—¶é—´å¿«è¿›ï¼Œä¸Šè¯¾çœ¼ä¸€çœ¨å°±ä¸‹è¯¾äº†ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘æŒæ¡äº†æŸç§æ§åˆ¶æ—¶é—´æµåŠ¨çš„æŠ€æœ¯ã€‚<br>ã€€ã€€é—®é—®å¤§ä¼™åº”è¯¥æ˜¯é—­ä¸€ä¸‹çœ¼å†çä¸€ä¸‹å°±ç®—çœ¨ä¸€æ¬¡çœ¼å§ï¼Ÿè¿™ä¸ªå®šä¹‰å¾ˆå…³é”®ï¼Œåœ¨çº¿ç­‰æŒºæ€¥çš„ã€‚<br>ã€€ã€€ä¸ºäº†é¿å…ä¸ŠåŒ–å­¦è¯¾æ—¶é—´å¿«è¿›ï¼Œæˆ‘ç»å¸¸å§”æ‰˜å¼ å“¥ç»™æˆ‘æ‰“å°æ­Œè¯ä¸Šè¯¾çœ‹ï¼Œè¿™æ ·æ—¶é—´å°±ä¸ä¼šå¿«è¿›äº†ã€‚é‚£æ®µæ—¶é—´è¯æ±‡é‡çœŸæ˜¯çªé£çŒ›è¿›ï¼Œå¯æƒœæ˜¯æ—¥è¯­è¯æ±‡é‡ï¼Œé«˜è€ƒç”¨ä¸ç€ã€‚ä¸è¿‡è¿™æ“ä½œä¹Ÿä¸æ˜¯ç™¾åˆ©æ— å®³çš„ï¼Œæ˜æ˜¾çš„åå¤„ä¸€æ˜¯åŒ–å­¦è¿˜æ˜¯ä¸€ç‚¹ä¸ä¼šï¼ŒäºŒæ˜¯ç™½å¤©ä¹Ÿå¼€å§‹çŠ¯å›°äº†ã€‚</p><p>ã€€ã€€å½“æ—¶æ¯å¤©ä¸‹åˆå¥½åƒè¿˜æ¯”æ™®é€šç­æå‰ä¸‹è¯¾å»åƒé¥­ã€‚å…‰è®°å¾—ä¸€åˆ°ç‚¹å°±å¼€å†²ï¼Œæå¸¦ç€çƒ¦æ¼ä¸€ä¸‹ä»Šå¤©è¯¥åƒä»€ä¹ˆäº†ã€‚å”‰ä¸å¾—ä¸è¯´é«˜ä¸­é‚£ç ´çƒ‚é£Ÿå ‚æ¯”åŒ—é‚®è¿˜æ˜¯ç¨å¾®å¼ºç‚¹ã€‚<br>ã€€ã€€å®éªŒä¸€ç­ç”·åŒå­¦ä»¬å‡èšåŠ›è¿˜æ˜¯ç›¸å½“çš„å¼ºçš„ï¼Œå¹¶ä¸”ä¹Ÿå¾ˆæœ‰é»˜å¥‘ï¼Œç»å¸¸èƒ½åœ¨åŒä¸€ä¸ªé£Ÿå ‚ç¢°å¤´ï¼Œç„¶åå…¨ååœ¨ä¸€èµ·ã€‚æœ‰æ®µæ—¶é—´é£Ÿå ‚æ¡Œå­å¥½åƒèƒ½æ¬åŠ¨ï¼Œå½“æ—¶å››å¼ æ¡Œå­æ‹¼ä¸€å—åäº†å°†è¿‘äºŒåä¸ªäººï¼Œå…¨ç­ä¸€å…±ä¹Ÿå°±æ‰ 24 ä¸ªç”·ç”Ÿã€‚æˆ‘åƒé¥­è´¼æ…¢ï¼Œæ¯æ¬¡éƒ½å‡ ä¹è€—æ»¡ 30 åˆ†é’Ÿæ™šé¥­æ—¶é—´ï¼Œæœ€åä¸€ä¸ªè¸©ç‚¹å›å»ã€‚<br>ã€€ã€€æ™šè‡ªä¹ çš„äº‘å½©æ€»æ˜¯å¾ˆå¥½çœ‹ï¼Œå¶å°”è¿˜æœ‰ç²‰è‰²æˆ–è€…ç´«è‰²çš„é‚£ç§æ™šéœï¼Œå¾ˆåƒ b ç«™é‚£ç§å›å¿†é’æ˜¥çš„è§†é¢‘é‡Œé‚£æ ·å¼çš„ï¼Œç‰¹åˆ«é€‚åˆå¯¹ç€çª—å¤–æ„£ç¥ã€‚æ–‡å­¦æ°´å¹³ä¸å¤ªå¥½å…‰ä¼šè¯´å¥½çœ‹äº†ï¼Œå¾—æ•´ç‚¹æ´»ã€‚å“¦å¯¹ï¼Œscenery ç¾æ™šéœã€‚<br>ã€€ã€€æ™šè‡ªä¹ å…«ç‚¹åŠä¸‹è¯¾æ˜¯ä¸€æ•´å¤©æœ€çˆ½çš„æ—¶å€™ã€‚ä¸€æ–¹é¢åˆšåˆšç»“æŸçš„ä¸€èŠ‚ä¸¤å°æ—¶è¶…é•¿æ™šè‡ªä¹ å·²ç»å¾ˆçˆ½äº†ï¼Œå¦ä¸€æ–¹é¢åé¢è¿˜æœ‰ä¸€ä¸ªæ›´çˆ½çš„è¶…é•¿æ™šè‡ªä¹ ã€‚è¿™ä¸ªè¯¾é—´æ°å¥½å‡‰å¿«ä¸”ä¸å›°ï¼Œå‡ºé—¨èµ°ä¸¤æ­¥ç›¸å½“èˆ’æœï¼Œå¤§ä¼™å” é€¼ç£•ä¹Ÿéƒ½çŠ¶æ€å¾ˆå¥½ã€‚<br>ã€€ã€€å½“æ—¶è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ä¼‘é—²æ´»åŠ¨ã€‚çº§éƒ¨è®¤ä¸ºä»å…¶ä»–åœ°æ–¹è¯·é«˜çº§è€å¸ˆæ¥å¼€è®²åº§èƒ½å¤Ÿå¤§å¹…æé«˜æˆç»©ã€‚æˆ‘ä»¬å½“ç„¶æ˜¯éå¸¸æ”¯æŒçš„ï¼Œå› ä¸ºè¿™æ ·å°±ä¸ç”¨ä¸Šæ­£å¸¸çš„è¯¾äº†ï¼Œå¯ä»¥å»å¤§ä¼šè®®å…æ‘¸é±¼ï¼Œå•Šä¸æ˜¯ï¼Œå­¦ä¹ æ›´åŠ å…ˆè¿›çš„çŸ¥è¯†ã€‚å½“æ—¶æ¯æ¬¡æ•´è¿™ä¸ªæ´»å°±æ„å‘³ç€æˆ‘è¦åƒæ—©é¥­äº†ã€‚æˆ‘æ¯æ¬¡éƒ½è®©å›å›ç»™æˆ‘å¸¦ä¸ªæ‘Šç…é¥¼ï¼Œé¦™å¾—å˜›ä¸è°ˆã€‚åå¸ˆä»¬è¿˜æ˜¯èƒ½å¸¦æ¥ä¸€äº›æ¢—çš„ï¼Œæ¯”å¦‚æœ‰ä¸ªå±±è¥¿æ¥çš„è¯­æ–‡è€å¸ˆï¼ˆå¥½åƒå§“é«˜ï¼Ÿï¼‰æŠŠè´¹å¿å«æˆäº†è´¹åŸï¼Œæå¤§åœ°å¢å¼ºäº†å¤§ä¼™çš„åœ°åŸŸè‡ªè±ªæ„Ÿã€‚</p><p>ã€€ã€€è€æ®µæ‰¾æˆ‘è°ˆè¯ã€‚è¯´å°æœå•Šï¼Œä½ å›æ¥ä¸Šäº†åŠä¸ªå­¦æœŸçš„è¯¾äº†æˆç»©ä¹Ÿæ²¡èµ·è‰²ï¼Œä¸€ç›´å¿ 30 åä¸Šä¸å»ä¸‹ä¸æ¥ï¼Œå¡åœ¨è¿™é‡Œäº†ã€‚æ˜¯ä¸æ˜¯ä¸Šè¯¾æ²¡è·Ÿç€è€å¸ˆèµ°å•Šï¼Ÿ<br>ã€€ã€€æˆ‘å¯»æ€ç€æˆ‘ä¸€äºŒå¹´çº§æ²¡å¤„ç†å¥½ï¼Œä¸€ç›´æ²¡ä¸Šæ–‡åŒ–è¯¾ï¼Œç°åœ¨è·Ÿç€è€å¸ˆç›´æ¥ä¸€è½®å¤ä¹ æ ¹æœ¬è·Ÿä¸ä¸Šã€‚æˆ‘å€’æ˜¯æƒ³è‡ªå­¦ï¼Œä½†æ˜¯ä½ ä¸€ç›´è®©æˆ‘è·Ÿï¼Œæˆ‘å°±è®¤çœŸè·Ÿäº†ã€‚æˆç»©ä¸å¥½ä½ åˆæ€ªæˆ‘ï¼Ÿ<br>ã€€ã€€è€æ®µå¯¹æˆ‘è¿›è¡Œäº†ä¸¥å‰æ‰¹è¯„ï¼Œæˆ‘è‡ªç„¶ä¹Ÿä¸å¤ªæœæ°”ã€‚è€æ®µè®¤ä¸ºæˆ‘ä¸€å®šæ˜¯æ²¡è®¤çœŸè·Ÿè€å¸ˆè¿›åº¦ï¼Œè¦æ±‚æˆ‘å¿…é¡»è·Ÿä¸Šï¼Œæˆ‘è¯´ okã€‚è¿™æ¬¡ä¼šæ™¤åæˆ‘ç«‹å³å½¢æˆä¸ªäººå†³è®®ï¼Œä¸å†ç†ä¼šä»»ä½•è€å¸ˆçš„å¤ä¹ è¿›åº¦ã€‚</p><p>ã€€ã€€è¿‡äº†åŠå¹´ï¼Œè¿˜å‰©ä¸€ä¸ªæ¥æœˆé«˜è€ƒäº†ï¼Œè€æ®µåˆæ‰¾æˆ‘è°ˆè¯ã€‚è¯´ä½ å°å­æœ€è¿‘ä¸é”™å•Šï¼Œä¸€ç›´è€ƒå‰å‡ ï¼Œæ˜¯ä¸æ˜¯ä¸Šæ¬¡å¬æˆ‘çš„è®¤çœŸè·Ÿè¿›åº¦å¥æ•ˆäº†ï¼Ÿ<br>ã€€ã€€æˆ‘å¿ƒæƒ³æˆ‘ä»–å¦ˆä»é‚£å¼€å§‹ä¸€å¥è¯¾æ²¡å¬è¿‡çº¯è‡ªå­¦çš„ï¼ŒæåŠå¤©è¿˜æ˜¯æˆ‘è‡ªå·±æ¥é è°±ï¼Œè€å¸ˆçœŸä¸è¡Œå§ã€‚å¹¶ä¸”æˆ‘éƒ½å›æ¥ 9 ä¸ªæœˆäº†ï¼Œè‡ªå­¦ä¸€éé«˜ä¸­æ–‡åŒ–è¯¾è€ƒå¿å‰ 5 éš¾åº¦ä¸å¤§å§ã€‚ä½ è¿™ä¹ˆçœ‹ä¸èµ·æˆ‘ï¼Ÿ<br>ã€€ã€€æˆ‘è¯´å˜¿å˜¿ï¼Œå•Šå¯¹ï¼Œè¿˜æ˜¯æ‚¨ç»™çš„æ€è·¯å¥½ï¼Œè¿™ä¹ˆä¿æŒä¸‹å»é«˜è€ƒåº”è¯¥æŒºä¸é”™çš„ã€‚ä»–è¯´ä½ çœ‹çœ‹ï¼Œæ—©ä¸å¬æˆ‘çš„ï¼Œä¸ç„¶æˆç»©ä¸æ˜¯æ›´å¥½äº†ï¼Œä½ å°å­èµ¶ç´§å›å»å¥½å¥½å­¦ä¹ å§ï¼Œå“ˆå“ˆï¼Œé«˜è€ƒè€ƒå¥½ç‚¹å•Šã€‚<br>ã€€ã€€æˆ‘å°±ç¬‘ä¹ˆä¹åœ°èµ°äº†ã€‚è¾¹èµ°è¾¹æƒ³ä»€ä¹ˆ b ç©æ„ï¼ŒçœŸå¬ä½ çš„æˆ‘æ—©ç¿»è½¦äº†ï¼Œè¶æ—©æ”¶æ‹¾æ”¶æ‹¾å¤è¯»å§ã€‚</p><hr><p>æ²¡å†™å®Œã€‚ä¸‹æ¬¡ç¡ä¸ç€çš„æ—¶å€™å†è¯´å§ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello Hexo!</title>
      <link href="/1999/Hello-Hexo/"/>
      <url>/1999/Hello-Hexo/</url>
      
        <content type="html"><![CDATA[<p>è¿™æ˜¯ Hexo åšå®¢è‡ªå¸¦çš„ä½¿ç”¨è¯´æ˜ã€‚</p><span id="more"></span><hr><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
